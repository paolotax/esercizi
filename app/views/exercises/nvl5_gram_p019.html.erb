<div class="max-w-6xl mx-auto bg-white dark:bg-gray-900 text-black dark:text-white p-3 md:p-6 transition-colors duration-300"
     data-controller="exercise-checker text-toggle font-controls"
     data-text-toggle-target="content"
     data-font-controls-target="content">

  <%= render 'shared/page_header', pagina: @pagina %>

  <div class="space-y-6">

  <!-- Info Box -->
  <div class="grid grid-cols-1 md:grid-cols-2 gap-4 leading-relaxed">
    <!-- Discorso diretto -->
    <div class="bg-white dark:bg-gray-800 rounded-lg p-4 md:p-6">
      <div class="bg-white dark:bg-gray-700 rounded-lg p-3 mb-3">
        <p class="text-gray-800 dark:text-gray-200">
          La nonna domanda a Miriam<strong class="text-cyan-700 dark:text-cyan-400">:</strong><br>
          <strong class="text-cyan-700 dark:text-cyan-400">– Vuoi</strong> un'altra fetta di torta?
        </p>
      </div>
      <div class="bg-yellow-100 dark:bg-yellow-900/30 rounded-lg p-3">
        <p class="text-gray-800 dark:text-gray-200">
          Il <strong class="text-cyan-700 dark:text-cyan-400">discorso diretto</strong> riporta le battute di un dialogo, introdotte dai due punti (<strong class="text-cyan-700 dark:text-cyan-400">:</strong>) seguiti dalla lineetta (<strong class="text-cyan-700 dark:text-cyan-400">–</strong>) o dalle virgolette (<strong class="text-cyan-700 dark:text-cyan-400">" "</strong>).
        </p>
      </div>
    </div>

    <!-- Discorso indiretto -->
    <div class="bg-white dark:bg-gray-800 rounded-lg p-4 md:p-6">
      <div class="bg-white dark:bg-gray-700 rounded-lg p-3 mb-3">
        <p class="text-gray-800 dark:text-gray-200">
          La nonna domanda a Miriam <strong class="text-red-600 dark:text-red-400">se vuole</strong> un'altra fetta di torta.
        </p>
      </div>
      <div class="bg-yellow-100 dark:bg-yellow-900/30 rounded-lg p-3">
        <p class="text-gray-800 dark:text-gray-200">
          Il <strong class="text-red-600 dark:text-red-400">discorso indiretto</strong> riferisce in terza persona le battute di un dialogo senza riportare le parole precise.
        </p>
      </div>
    </div>
  </div>

  <!-- Regole per passare da diretto a indiretto -->
  <div class="bg-white dark:bg-gray-800 rounded-lg p-4 md:p-6 leading-relaxed">
    <p class="text-gray-800 dark:text-gray-200 mb-3">
      Per passare dal <strong class="text-cyan-700 dark:text-cyan-400">discorso diretto</strong> al <strong class="text-red-600 dark:text-red-400">discorso indiretto</strong>:
    </p>
    <ul class="space-y-2">
      <li class="flex items-start">
        <span class="text-cyan-700 dark:text-cyan-400 font-bold mr-2">•</span>
        <span class="text-gray-800 dark:text-gray-200">si elimina la punteggiatura del discorso diretto;</span>
      </li>
      <li class="flex items-start">
        <span class="text-cyan-700 dark:text-cyan-400 font-bold mr-2">•</span>
        <span class="text-gray-800 dark:text-gray-200">si cambiano le forme verbali: <strong class="text-cyan-700 dark:text-cyan-400">vuoi</strong> → <strong class="text-red-600 dark:text-red-400">vuole</strong>;</span>
      </li>
      <li class="flex items-start">
        <span class="text-cyan-700 dark:text-cyan-400 font-bold mr-2">•</span>
        <span class="text-gray-800 dark:text-gray-200">si uniscono le frasi con le parole di collegamento → <strong class="text-red-600 dark:text-red-400">se</strong>, <strong class="text-red-600 dark:text-red-400">che</strong>, <strong class="text-red-600 dark:text-red-400">di</strong>;</span>
      </li>
      <li class="flex items-start">
        <span class="text-cyan-700 dark:text-cyan-400 font-bold mr-2">•</span>
        <span class="text-gray-800 dark:text-gray-200">si cambiano i pronomi personali e i pronomi o gli aggettivi determinativi.</span>
      </li>
    </ul>
  </div>

  <!-- Exercise 1 -->
  <div class="bg-white dark:bg-gray-800 rounded-lg p-4 md:p-6 border-4 border-yellow-400 dark:border-yellow-600">
    <h2 class="font-bold text-gray-800 dark:text-gray-200 mb-4 flex flex-wrap items-center gap-2">
      <span class="bg-blue-800 text-white rounded-full w-8 h-8 md:w-10 md:h-10 inline-flex items-center justify-center">1</span>
      <span class="bg-yellow-400 dark:bg-yellow-600 text-blue-800 dark:text-blue-200 px-2 py-1 rounded font-bold">IMPARARE TUTTI</span>
      <span>Scrivi le frasi sul quaderno trasformando i <strong class="text-cyan-700 dark:text-cyan-400">discorsi diretti</strong> in <strong class="text-red-600 dark:text-red-400">discorsi indiretti</strong>.</span>
    </h2>

    <div class="space-y-4">
      <% exercise_1_phrases = [
        {
          direct: "Il papà disse a Marco: – Stai attento in bicicletta.",
          answer: "Il papà disse a Marco di stare attento in bicicletta."
        },
        {
          direct: "La maestra chiede a Cecilia: – Hai letto il libro di Pinocchio? Ti è piaciuto?",
          answer: "La maestra chiede a Cecilia se ha letto il libro di Pinocchio e se le è piaciuto."
        },
        {
          direct: "Carlotta urlò felice: – Zia, da quanto non ti vedo! Voglio abbracciarti!",
          answer: "Carlotta urlò felice che da quanto non vedeva la zia e che voleva abbracciarla."
        }
      ] %>

      <% exercise_1_phrases.each do |phrase| %>
        <div class="rounded-lg p-4" data-controller="fill-blanks">
          <p class="text-gray-800 dark:text-gray-200 mb-3">
            <span class="text-cyan-700 dark:text-cyan-400 font-bold mr-2">•</span> <%= phrase[:direct] %>
          </p>
          <textarea class="w-full border-2 border-dotted border-gray-400 dark:border-gray-500 bg-transparent dark:text-white rounded-lg p-3 focus:outline-none"
                    rows="3"
                    data-fill-blanks-target="input"
                    data-correct-answer="<%= phrase[:answer] %>"
                    placeholder="Trasforma il discorso diretto in indiretto..."></textarea>
        </div>
      <% end %>
    </div>
  </div>

  <!-- Exercise 2 -->
  <div class="bg-white dark:bg-gray-800 rounded-lg p-4 md:p-6">
    <h2 class="font-bold text-gray-800 dark:text-gray-200 mb-4">
      <span class="bg-pink-600 text-white rounded-full w-8 h-8 md:w-10 md:h-10 inline-flex items-center justify-center mr-2">2</span>
      Osserva il disegno e scrivi <strong class="text-cyan-700 dark:text-cyan-400">nei fumetti</strong> il dialogo tra i due bambini.
    </h2>

    <div class="mb-4">
      <div class="dark:bg-white rounded-xl p-1 inline-block">
        <%= image_tag 'nvl5_gram/p019/p019_01.jpg', alt: 'Disegno con due bambini', class: 'w-full max-w-md mx-auto rounded-lg' %>
      </div>
    </div>

    <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
      <textarea class="w-full border-2 border-dotted border-gray-400 dark:border-gray-500 bg-transparent dark:text-white rounded-lg p-3 focus:outline-none"
                rows="3"
                placeholder="Fumetto del bambino a sinistra..."></textarea>
      <textarea class="w-full border-2 border-dotted border-gray-400 dark:border-gray-500 bg-transparent dark:text-white rounded-lg p-3 focus:outline-none"
                rows="3"
                placeholder="Risposta del bambino a destra..."></textarea>
    </div>
  </div>

  <!-- Exercise 3 -->
  <div class="bg-white dark:bg-gray-800 rounded-lg p-4 md:p-6">
    <h2 class="font-bold text-gray-800 dark:text-gray-200 mb-4">
      <span class="bg-pink-600 text-white rounded-full w-8 h-8 md:w-10 md:h-10 inline-flex items-center justify-center mr-2">3</span>
      Sul quaderno riporta il dialogo tra i due bambini dell'esercizio 2 usando la punteggiatura del <strong class="text-cyan-700 dark:text-cyan-400">discorso diretto</strong>. Poi trasformalo in <strong class="text-red-600 dark:text-red-400">discorso indiretto</strong>.
    </h2>

    <div class="space-y-4">
      <div>
        <label class="block font-semibold text-gray-800 dark:text-gray-200 mb-2">
          Dialogo in discorso diretto
        </label>
        <textarea class="w-full border-2 border-dotted border-gray-400 dark:border-gray-500 bg-transparent dark:text-white rounded-lg p-3 focus:outline-none"
                  rows="4"
                  placeholder="Usa i due punti, la lineetta e le virgolette per scrivere il dialogo..."></textarea>
      </div>
      <div>
        <label class="block font-semibold text-gray-800 dark:text-gray-200 mb-2">
          Dialogo trasformato in discorso indiretto
        </label>
        <textarea class="w-full border-2 border-dotted border-gray-400 dark:border-gray-500 bg-transparent dark:text-white rounded-lg p-3 focus:outline-none"
                  rows="4"
                  placeholder="Riscrivi il dialogo trasformandolo in discorso indiretto..."></textarea>
      </div>
    </div>
  </div>

  <!-- Exercise Controls -->
  <%= render 'shared/exercise_controls' %>
  </div><!-- chiude space-y-6 -->
</div>
