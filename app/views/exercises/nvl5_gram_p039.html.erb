<div class="max-w-6xl mx-auto bg-white dark:bg-gray-900 text-black dark:text-white p-3 md:p-6 transition-colors duration-300"
     data-controller="exercise-checker text-toggle font-controls"
     data-text-toggle-target="content"
     data-font-controls-target="content">

  <%= render 'shared/page_header', pagina: @pagina %>

  <!-- Exercise 6: Identify homonyms and grammatical values -->
  <div class="bg-white dark:bg-gray-800 p-4 md:p-6 pb-8" data-controller="fill-blanks">
    <h2 class="font-bold mb-4 flex items-center gap-2">
      <span class="flex-shrink-0 bg-<%= @pagina.base_color %>-500 text-white rounded-full w-8 h-8 md:w-10 md:h-10 inline-flex items-center justify-center">6</span>
      Evidenzia gli omonimi e indica per ognuno il valore grammaticale.
    </h2>

    <% homonym_sentences = [
      { text: "Aggiungi il sale all'insalata.", word: "sale", answer: "nome" },
      { text: "Siamo in troppi in ascensore. Chi sale a piedi?", word: "sale", answer: "verbo" },
      { text: "Mei porta i capelli a coda di cavallo.", word: "porta", answer: "verbo" },
      { text: "Ho appeso una cappelliera sopra la porta.", word: "porta", answer: "nome" }
    ] %>

    <div class="space-y-3">
      <% homonym_sentences.each do |sentence| %>
        <div class="rounded-lg p-3">
          <p class="text-gray-700 dark:text-gray-200 mb-2"><span class="text-<%= @pagina.base_color %>-500">•</span> <%= sentence[:text] %></p>
          <div class="flex items-center justify-between gap-4 ml-6">
            <span class="text-gray-500 dark:text-gray-400">valore grammaticale:</span>
            <input type="text"
                   class="w-28 border-b-2 border-dotted border-<%= @pagina.base_color %>-500 bg-transparent dark:text-white text-right px-2 focus:outline-none focus:border-<%= @pagina.base_color %>-700"
                   data-fill-blanks-target="input"
                   data-answer="<%= sentence[:answer] %>"
                   data-correct-answer="<%= sentence[:answer] %>"
                   maxlength="20">
          </div>
        </div>
      <% end %>
    </div>
  </div>

  <!-- Exercise 7: Identify sector language -->
  <div class="bg-white dark:bg-gray-800 p-4 md:p-6 pb-8" data-controller="exercise-group">
    <h2 class="font-bold mb-4 flex items-center gap-2">
      <span class="flex-shrink-0 bg-<%= @pagina.base_color %>-500 text-white rounded-full w-8 h-8 md:w-10 md:h-10 inline-flex items-center justify-center">7</span>
      Indica se la frase appartiene al linguaggio informatico, meteorologico, politico o dello spettacolo.
    </h2>

    <% sector_sentences = [
      { text: "Sono in arrivo venti da ponente.", sector: "meteorologico" },
      { text: "L'opposizione chiede elezioni anticipate.", sector: "politico" },
      { text: "Il processore è di ultima generazione.", sector: "informatico" },
      { text: "Dietro il palco ci sono i camerini.", sector: "dello spettacolo" }
    ] %>

    <div class="space-y-3">
      <% sector_sentences.each_with_index do |sentence, index| %>
        <div class="rounded-lg p-3">
          <p class="text-gray-700 dark:text-gray-200 mb-2"><span class="text-<%= @pagina.base_color %>-500">•</span> <%= sentence[:text] %></p>
          <div class="flex items-center justify-between gap-4 ml-6">
            <span class="text-gray-500 dark:text-gray-400">linguaggio:</span>
            <input type="text"
                   class="w-40 border-b-2 border-dotted border-<%= @pagina.base_color %>-500 bg-transparent dark:text-white text-right px-2 focus:outline-none focus:border-<%= @pagina.base_color %>-700"
                   data-correct-answer="<%= sentence[:sector] %>"
                   maxlength="30">
          </div>
        </div>
      <% end %>
    </div>
  </div>

  <!-- Exercise 8: Write sentences with proper meaning -->
  <div class="bg-white dark:bg-gray-800 p-4 md:p-6 pb-8">
    <h2 class="font-bold mb-4 flex items-center gap-2">
      <span class="flex-shrink-0 bg-<%= @pagina.base_color %>-500 text-white rounded-full w-8 h-8 md:w-10 md:h-10 inline-flex items-center justify-center">8</span>
      Le parole evidenziate hanno significato figurato. Scrivi una frase in cui la stessa parola è usata nel significato proprio.
    </h2>

    <% figurative_sentences = [
      "La tua proposta è una trappola, l'ho capito.",
      "Seguirò le orme di papà, che è falegname.",
      "Kevin spende tutto, ha le mani bucate.",
      "Il tuo arrivo segna una svolta in ufficio."
    ] %>

    <div class="space-y-3">
      <% figurative_sentences.each do |sentence| %>
        <div class="rounded-lg p-3">
          <p class="text-gray-700 dark:text-gray-200 mb-2 font-semibold"><span class="text-<%= @pagina.base_color %>-500">•</span> <%= sentence %></p>
          <p class="text-gray-500 dark:text-gray-400 ml-6">Scrivi qui la frase con significato proprio: ...............................................</p>
        </div>
      <% end %>
    </div>
  </div>

  <!-- Le mie competenze section -->
  <div class="bg-white dark:bg-gray-800 p-4 md:p-6 pb-8">
    <h2 class="font-bold text-<%= @pagina.base_color %>-700 mb-4">
      Le mie competenze
    </h2>

    <!-- Exercise 9: Identify metaphor -->
    <div class="mb-6" data-controller="exercise-group">
      <h3 class="font-bold mb-4 flex items-center gap-2">
        <span class="flex-shrink-0 bg-<%= @pagina.base_color %>-500 text-white rounded-full w-8 h-8 md:w-10 md:h-10 inline-flex items-center justify-center">9</span>
        In quale frase si usa una metafora? (seleziona una risposta)
      </h3>

      <% metaphor_sentences = [
        { text: "La voce di Susanna è dolce come il miele.", is_metaphor: false },
        { text: "Quando danza, Umberto si muove leggero come una piuma.", is_metaphor: false },
        { text: "Luca è forte come un toro, sposta scatoloni su scatoloni.", is_metaphor: false },
        { text: "Davide non aiuta mai nessuno, ha il cuore di pietra.", is_metaphor: true }
      ] %>

      <div class="space-y-3">
        <% metaphor_sentences.each_with_index do |sentence, index| %>
          <label class="flex items-start gap-3 rounded-lg p-3 cursor-pointer hover:bg-<%= @pagina.base_color %>-50 dark:hover:bg-<%= @pagina.base_color %>-900/30 transition">
            <input type="radio"
                   name="metaphor"
                   value="<%= index %>"
                   data-correct-answer="<%= sentence[:is_metaphor] ? 'true' : 'false' %>"
                   class="w-5 h-5 mt-0.5">
            <span class="text-gray-700 dark:text-gray-200"><span class="text-<%= @pagina.base_color %>-500">•</span> <%= sentence[:text] %></span>
          </label>
        <% end %>
      </div>
    </div>

    <!-- Exercise 10: Identify archaisms and neologisms -->
    <div data-controller="fill-blanks">
      <h3 class="font-bold mb-4 flex items-center gap-2">
        <span class="flex-shrink-0 bg-<%= @pagina.base_color %>-500 text-white rounded-full w-8 h-8 md:w-10 md:h-10 inline-flex items-center justify-center">10</span>
        Leggi le frasi, poi esegui e rispondi.
      </h3>

      <% sentences_10 = [
        "Comparve dal folto del bosco una donzella.",
        "Ti orienti, senza navigatore satellitare?",
        "Elisa e Rossella ebbero un alterco.",
        "Riconobbi il tracciato di un sentiero antico."
      ] %>

      <div class="space-y-3 mb-4">
        <% sentences_10.each do |sentence| %>
          <div class="rounded-lg p-3">
            <p class="text-gray-700 dark:text-gray-200"><span class="text-<%= @pagina.base_color %>-500">•</span> <%= sentence %></p>
          </div>
        <% end %>
      </div>

      <div class="space-y-3 ml-6">
        <p class="text-gray-700 dark:text-gray-200"><span class="text-<%= @pagina.base_color %>-500">•</span> Sottolinea una volta gli arcaismi, due volte il neologismo.</p>
        <div class="flex items-center justify-between gap-4">
          <span class="text-gray-700 dark:text-gray-200"><span class="text-<%= @pagina.base_color %>-500">•</span> Ci sono frasi senza arcaismi né neologismi? Quante?</span>
          <input type="text"
                 class="w-20 border-b-2 border-dotted border-<%= @pagina.base_color %>-500 bg-transparent dark:text-white text-right px-2 focus:outline-none focus:border-<%= @pagina.base_color %>-700"
                 data-fill-blanks-target="input"
                 data-answer="2"
                 data-correct-answer="2"
                 maxlength="5">
        </div>
      </div>
    </div>
  </div>

  <div class="text-right text-gray-500 dark:text-gray-400 mb-6">
    Esercizi p. <%= link_to "144", pagina_path("nvl5_gram_p144"), class: "text-gray-600 hover:text-gray-800 underline" %>
  </div>

  <!-- Exercise Controls -->
  <%= render 'shared/exercise_controls' %>
</div>
