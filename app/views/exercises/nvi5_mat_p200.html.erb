<div class="max-w-6xl mx-auto bg-white p-3 md:p-6"
     data-controller="exercise-checker text-toggle font-controls"
     data-text-toggle-target="content"
     data-font-controls-target="content">

  <%= render 'shared/page_header', pagina: @pagina %>

  <div class="space-y-6">
    <!-- Esercizio 1: IMPARARE TUTTI - Calcola in colonna -->
    <div class="p-4 bg-white rounded-2xl border-3 border-yellow-400">
      <p class="font-bold text-gray-700 mb-4">
        <%= imparare_tutti_badge(1) %>
        Calcola in colonna sul quaderno.
      </p>

      <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6">
        <!-- Colonna a - Addizioni -->
        <div class="space-y-2">
          <p class="font-bold text-cyan-600">a.</p>
          <p class="text-gray-700"><span class="whitespace-nowrap">142 356</span> + <span class="whitespace-nowrap">9 284 600</span> + 573 =</p>
          <p class="text-gray-700"><span class="whitespace-nowrap">498 752</span> + <span class="whitespace-nowrap">8 091 589</span> + <span class="whitespace-nowrap">1 966 023</span> =</p>
          <p class="text-gray-700"><span class="whitespace-nowrap">6 943 701,588</span> + <span class="whitespace-nowrap">71 890,36</span> + 7,602 =</p>
        </div>

        <!-- Colonna b - Sottrazioni -->
        <div class="space-y-2">
          <p class="font-bold text-cyan-600">b.</p>
          <p class="text-gray-700"><span class="whitespace-nowrap">8 640 340,02</span> – <span class="whitespace-nowrap">74 633,515</span> =</p>
          <p class="text-gray-700"><span class="whitespace-nowrap">3 891,202</span> – 678,439 =</p>
          <p class="text-gray-700"><span class="whitespace-nowrap">45 000 000</span> – <span class="whitespace-nowrap">6 129 034</span> =</p>
        </div>

        <!-- Colonna c - Moltiplicazioni -->
        <div class="space-y-2">
          <p class="font-bold text-cyan-600">c.</p>
          <p class="text-gray-700"><span class="whitespace-nowrap">65 702</span> × 48 =</p>
          <p class="text-gray-700">69,18 × 73 =</p>
          <p class="text-gray-700"><span class="whitespace-nowrap">184 762</span> × 6,5 =</p>
        </div>

        <!-- Colonna d - Divisioni -->
        <div class="space-y-2">
          <p class="font-bold text-cyan-600">d.</p>
          <p class="text-gray-700"><span class="whitespace-nowrap">572 906</span> : 26 =</p>
          <p class="text-gray-700"><span class="whitespace-nowrap">1 782 560</span> : 5,4 =</p>
          <p class="text-gray-700"><span class="whitespace-nowrap">75 568,061</span> : 651 =</p>
        </div>
      </div>
    </div>

    <!-- Esercizio 2: Proprietà delle operazioni -->
    <div>
      <p class="font-bold text-gray-700 mb-4">
        <%= numero_esercizio_badge(2) %>
        Per ogni operazione indica quale o quali proprietà sono state applicate. Poi esegui i calcoli sul quaderno.
      </p>

      <div class="space-y-4">
        <!-- Prima operazione -->
        <div class="flex flex-col md:flex-row md:items-center gap-2 md:gap-4">
          <p class="text-gray-700">354 + 700 + 146 = 354 + 146 + 700 = 500 + 700 =</p>
          <div class="flex items-center gap-2">
            <span class="text-gray-700 shrink-0">proprietà:</span>
            <input type="text" data-correct-answer="commutativa e associativa" class="min-w-0 flex-1 md:w-48 border-b-2 border-dotted border-gray-400 text-center bg-transparent">
          </div>
        </div>

        <!-- Seconda operazione -->
        <div class="flex flex-col md:flex-row md:items-center gap-2 md:gap-4">
          <p class="text-gray-700"><span class="whitespace-nowrap">7 200</span> : 900 = 72 : 9 =</p>
          <div class="flex items-center gap-2">
            <span class="text-gray-700 shrink-0">proprietà:</span>
            <input type="text" data-correct-answer="invariantiva" class="min-w-0 flex-1 md:w-48 border-b-2 border-dotted border-gray-400 text-center bg-transparent">
          </div>
        </div>

        <!-- Terza operazione -->
        <div class="flex flex-col md:flex-row md:items-center gap-2 md:gap-4">
          <p class="text-gray-700">5 × 9 × 4 × 2 = 5 × 9 × 8 =</p>
          <div class="flex items-center gap-2">
            <span class="text-gray-700 shrink-0">proprietà:</span>
            <input type="text" data-correct-answer="associativa" class="min-w-0 flex-1 md:w-48 border-b-2 border-dotted border-gray-400 text-center bg-transparent">
          </div>
        </div>
      </div>
    </div>

    <!-- Esercizio 3: Applica le proprietà -->
    <div>
      <p class="font-bold text-gray-700 mb-4">
        <%= numero_esercizio_badge(3) %>
        Applica le proprietà indicate e calcola.
      </p>

      <div class="space-y-3">
        <!-- Invariantiva - sottrazione -->
        <div class="flex flex-col md:flex-row md:items-center gap-2">
          <div class="flex items-center gap-2">
            <span class="px-2 py-1 bg-cyan-100 border border-cyan-400 rounded font-bold text-gray-700">invariantiva</span>
            <span class="text-cyan-500">→</span>
            <span class="text-gray-700"><span class="whitespace-nowrap">1 525</span> – 315 =</span>
          </div>
          <input type="text" data-correct-answer="1210" class="min-w-0 flex-1 md:w-32 border-b-2 border-dotted border-gray-400 text-center font-bold bg-transparent">
        </div>

        <!-- Commutativa e associativa -->
        <div class="flex flex-col md:flex-row md:items-center gap-2">
          <div class="flex items-center gap-2">
            <span class="px-2 py-1 bg-cyan-100 border border-cyan-400 rounded font-bold text-gray-700">commutativa e associativa</span>
            <span class="text-cyan-500">→</span>
            <span class="text-gray-700">670 + 240 + 130 + 60 =</span>
          </div>
          <input type="text" data-correct-answer="1100" class="min-w-0 flex-1 md:w-32 border-b-2 border-dotted border-gray-400 text-center font-bold bg-transparent">
        </div>

        <!-- Associativa -->
        <div class="flex flex-col md:flex-row md:items-center gap-2">
          <div class="flex items-center gap-2">
            <span class="px-2 py-1 bg-cyan-100 border border-cyan-400 rounded font-bold text-gray-700">associativa</span>
            <span class="text-cyan-500">→</span>
            <span class="text-gray-700">750 × 5 × 20 =</span>
          </div>
          <input type="text" data-correct-answer="75000" class="min-w-0 flex-1 md:w-32 border-b-2 border-dotted border-gray-400 text-center font-bold bg-transparent">
        </div>

        <!-- Distributiva -->
        <div class="flex flex-col md:flex-row md:items-center gap-2">
          <div class="flex items-center gap-2">
            <span class="px-2 py-1 bg-cyan-100 border border-cyan-400 rounded font-bold text-gray-700">distributiva</span>
            <span class="text-cyan-500">→</span>
            <span class="text-gray-700">572 × 5 =</span>
          </div>
          <input type="text" data-correct-answer="2860" class="min-w-0 flex-1 md:w-32 border-b-2 border-dotted border-gray-400 text-center font-bold bg-transparent">
        </div>

        <!-- Invariantiva - divisione -->
        <div class="flex flex-col md:flex-row md:items-center gap-2">
          <div class="flex items-center gap-2">
            <span class="px-2 py-1 bg-cyan-100 border border-cyan-400 rounded font-bold text-gray-700">invariantiva</span>
            <span class="text-cyan-500">→</span>
            <span class="text-gray-700"><span class="whitespace-nowrap">3 500</span> : 25 =</span>
          </div>
          <input type="text" data-correct-answer="140" class="min-w-0 flex-1 md:w-32 border-b-2 border-dotted border-gray-400 text-center font-bold bg-transparent">
        </div>
      </div>
    </div>

    <!-- Esercizio 4: Espressioni -->
    <div>
      <p class="font-bold text-gray-700 mb-4">
        <%= numero_esercizio_badge(4) %>
        Risolvi le espressioni sul quaderno.
      </p>

      <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
        <div class="space-y-3">
          <p class="text-gray-700">3 × {6 × 6 – 3 × [15 – (9 + 1)]} : 7 – 6 =</p>
          <p class="text-gray-700">{9 × 5 – [20 : (13 – 9) + 1] × 4 : 8} : 6 + 3 =</p>
          <p class="text-gray-700">(10 – 2 × 3) : 4 + [(18 : 2 + 56 : 8) – (5 × 3 – 11) + 2] =</p>
        </div>
        <div class="space-y-3">
          <p class="text-gray-700">[3 × 5 – (15 – 3 × 4) + 5 × 3] : 3 + 1 =</p>
          <p class="text-gray-700">6 × 7 – [(4 + 18 : 9 – 36 : 12) + (8 × 8 – 3 × 9)] =</p>
        </div>
      </div>
    </div>

    <!-- Esercizio 5: Problema con schema -->
    <div>
      <p class="font-bold text-gray-700 mb-4">
        <%= numero_esercizio_badge(5) %>
        Leggi il problema e inserisci i dati nello schema. Poi risolvi con l'espressione.
      </p>

      <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
        <!-- Testo del problema -->
        <div class="space-y-4">
          <p class="text-gray-700">
            Anna vuole fare un maglione per sua nipote e ha bisogno di 675 grammi di lana. Se ogni gomitolo pesa 45 grammi, quanti gomitoli occorrono per realizzare il maglione? Se ogni gomitolo costa € 9, quanto spende in tutto?
          </p>

          <div class="flex items-center gap-2">
            <span class="text-gray-700">(675 : 45) × 9 =</span>
            <input type="text" data-correct-answer="135" class="w-24 border-b-2 border-dotted border-gray-400 text-center font-bold bg-transparent">
            <span class="text-gray-700 shrink-0">€</span>
          </div>
        </div>

        <!-- Schema -->
        <div class="flex justify-center">
          <%= image_tag "nvi5_mat/p200/p200_01.jpg", class: "max-w-full h-auto", alt: "Schema problema" %>
        </div>
      </div>
    </div>

    <%= render 'shared/exercise_controls' %>
  </div>
</div>
