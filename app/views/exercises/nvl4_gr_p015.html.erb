<div class="max-w-6xl mx-auto p-6 bg-gradient-to-br from-pink-50 to-red-50 dark:from-gray-900 dark:to-gray-800 rounded-lg shadow-lg" data-controller="exercise-checker">
  <!-- Header -->
  <div class="flex items-center justify-between mb-8 border-b-4 border-pink-500 pb-4">
    <div class="flex items-center gap-4">
      <div class="bg-pink-500 text-white rounded-full w-16 h-16 flex items-center justify-center">
        <span class="text-3xl">ðŸ’¡</span>
      </div>
      <div>
        <div class="text-sm text-pink-600 font-semibold uppercase">ORTOGRAFIA</div>
        <h1 class="text-4xl font-bold text-pink-700">Si scrive con GN o NI?</h1>
      </div>
    </div>
    <div class="bg-pink-500 text-white font-bold text-4xl px-8 py-4 rounded-full">
      15
    </div>
  </div>

  <!-- Illustration and explanation -->
  <div class="bg-purple-50 dark:bg-purple-900/30 border-4 border-purple-300 dark:border-purple-600 rounded-lg p-6 mb-8">
    <div class="flex items-start gap-6">
      <div class="flex-1">
        <div class="bg-white dark:bg-gray-800 rounded-lg p-4 mb-4">
          <p class="text-lg italic text-gray-700 dark:text-gray-300">"Zhen e Giulia giocano agli indovinelli!"</p>
          <p class="text-lg italic text-gray-700 dark:text-gray-300">"Se alla compagnia di amici tolgo la I, chi resta?"</p>
          <p class="text-lg italic text-gray-700 dark:text-gray-300">"Una compagna!"</p>
        </div>

        <div class="bg-yellow-50 dark:bg-yellow-900/30 border-2 border-yellow-400 dark:border-yellow-600 rounded-lg p-4">
          <p class="text-lg font-bold mb-2">Dopo il gruppo <span class="text-pink-600">GN</span> non si mette la <span class="text-pink-600">I</span> â†’ <span class="text-pink-600">lasagne, ognuno</span>...</p>
          <p class="text-lg font-bold">Fanno eccezione:</p>
          <ul class="ml-6 space-y-1">
            <li>â€¢ la parola <span class="text-pink-600">compagnia</span>;</li>
            <li>â€¢ la 1Âª persona plurale dei verbi che finiscono in <span class="text-pink-600">-gnare</span>:</li>
            <li class="ml-4"><span class="text-pink-600">disegnare</span> â†’ noi dise<span class="text-pink-600">gniamo</span></li>
          </ul>
        </div>
      </div>
    </div>
  </div>

  <!-- Exercise 1: Completa con GNI, GN o NI -->
  <div class="mb-12 bg-white dark:bg-gray-800 rounded-lg p-4 md:p-6 shadow-md">
    <h2 class="text-xl md:text-2xl font-bold text-pink-600 dark:text-pink-400 mb-4 md:mb-6">
      <span class="bg-pink-600 text-white rounded-full w-8 h-8 md:w-10 md:h-10 inline-flex items-center justify-center mr-2 text-sm md:text-base">1</span>
      IMPARARE TUTTI Completa con <span class="font-bold">GNI, GN</span> o <span class="font-bold">NI</span>.
    </h2>

    <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-5 gap-4 md:gap-6" data-controller="fill-blanks">
      <% completions = [
        {prefix: 'mi', suffix: 'era', answer: 'ni'},
        {prefix: 'inse', suffix: 'amo', answer: 'gni'},
        {prefix: 'a', suffix: 'ello', answer: 'gn'},
        {prefix: 'so', suffix: 'amo', answer: 'gni'},
        {prefix: 'cer', suffix: 'era', answer: 'ni'},
        {prefix: 'fale', suffix: 'ame', answer: 'gn'},
        {prefix: 'ba', suffix: 'amo', answer: 'gni'},
        {prefix: '', suffix: 'ente', answer: 'gn'},
        {prefix: 'ma', suffix: 'fico', answer: 'gni'},
        {prefix: 'dise', suffix: 'o', answer: 'gn'}
      ] %>

      <% completions.each do |item| %>
        <div class="flex flex-wrap items-center gap-1 md:gap-2 text-base md:text-xl font-bold">
          <span class="whitespace-nowrap">â€¢ <%= item[:prefix] %></span>
          <input type="text"
                 class="border-b-4 border-pink-500 bg-transparent dark:text-white w-12 md:w-16 text-center focus:outline-none focus:border-pink-700 flex-shrink-0"
                 data-fill-blanks-target="input"
                 data-answer="<%= item[:answer] %>"
                 data-correct-answer="<%= item[:answer] %>"
                 maxlength="3">
          <span class="whitespace-nowrap"><%= item[:suffix] %></span>
        </div>
      <% end %>
    </div>

    <button class="mt-6 bg-pink-500 hover:bg-pink-600 text-white font-bold py-3 px-6 rounded-full transition"
            data-action="click->fill-blanks#checkAnswers">
      Controlla
    </button>
  </div>

  <!-- Exercise 2: Completa con compagna o compagnia -->
  <div class="mb-12 bg-white dark:bg-gray-800 rounded-lg p-4 md:p-6 shadow-md">
    <h2 class="text-xl md:text-2xl font-bold text-pink-600 dark:text-pink-400 mb-4 md:mb-6">
      <span class="bg-pink-600 text-white rounded-full w-8 h-8 md:w-10 md:h-10 inline-flex items-center justify-center mr-2 text-sm md:text-base">2</span>
      Completa con <span class="text-blue-600 font-bold">compagna</span> o <span class="text-blue-600 font-bold">compagnia</span>.
    </h2>

    <div class="space-y-3 md:space-y-4">
      <% sentences = [
        {text: 'Giulia Ã¨ una nuova', answer: 'compagna'},
        {text: 'Ti facciamo', answer: 'compagnia'},
        {text: 'Sto bene in tua', answer: 'compagnia'},
        {text: "Com'Ã¨ simpatica la tua", answer: 'compagna'}
      ] %>

      <% sentences.each do |item| %>
        <div class="flex flex-wrap items-center gap-2 md:gap-3">
          <span class="text-lg md:text-xl flex-shrink-0">â€¢</span>
          <span class="text-base md:text-xl font-semibold"><%= item[:text] %></span>
          <input type="text"
                 class="border-b-2 border-pink-500 bg-transparent dark:text-white flex-1 min-w-[120px] md:max-w-xs text-base md:text-xl font-bold focus:outline-none focus:border-pink-700 px-2"
                 data-answer="<%= item[:answer] %>"
                 data-correct-answer="<%= item[:answer] %>"
                 >
          <span class="text-lg md:text-xl font-semibold flex-shrink-0">.</span>
        </div>
      <% end %>
    </div>
  </div>

  <!-- GIOCO: Crossword -->
  <div class="mb-12 bg-gradient-to-r from-yellow-100 via-orange-100 to-red-100 dark:from-yellow-900/30 dark:via-orange-900/30 dark:to-red-900/30 rounded-lg p-4 md:p-6 shadow-lg border-4 border-yellow-400 dark:border-yellow-600">
    <div class="flex items-center gap-3 mb-4">
      <span class="text-3xl md:text-4xl">ðŸŽ®</span>
      <h2 class="text-2xl md:text-3xl font-bold" style="color: #ff6b35;">GIOCO</h2>
    </div>

    <h3 class="text-lg md:text-xl font-bold text-gray-800 dark:text-gray-100 mb-4 md:mb-6">Completa lo schema.</h3>

    <div class="grid grid-cols-1 md:grid-cols-[1fr_2fr] gap-6 md:gap-8">
      <!-- Clues -->
      <div class="bg-white dark:bg-gray-800 rounded-lg p-4 md:p-6 md:max-w-xs">
        <h4 class="font-bold text-base md:text-lg mb-3 md:mb-4">Definizioni:</h4>
        <ol class="space-y-2 md:space-y-3 text-sm md:text-base">
          <li><span class="font-bold text-pink-600">1.</span> Si stende sul tavolo per apparecchiare.</li>
          <li><span class="font-bold text-pink-600">2.</span> Ci fa ridere al circo.</li>
          <li><span class="font-bold text-pink-600">3.</span> Se l'appoggi all'orecchio, senti il mare.</li>
          <li><span class="font-bold text-pink-600">4.</span> Ãˆ una casetta di ghiaccio.</li>
          <li><span class="font-bold text-pink-600">5.</span> Vende gioielli.</li>
        </ol>
      </div>

      <!-- Crossword grid -->
      <div class="bg-white dark:bg-gray-800 rounded-lg p-4 md:p-6 md:overflow-x-auto">
        <h4 class="font-bold text-base md:text-lg mb-3 md:mb-4">Schema:</h4>
        <div class="space-y-4 md:space-y-6" data-controller="crossword">
          <!-- Row 1: TOVAGLIA -->
          <div class="flex flex-wrap md:flex-nowrap gap-1 items-center">
            <span class="font-bold text-pink-600 w-6 flex-shrink-0">1</span>
            <input type="text" maxlength="1" class="w-8 h-8 md:w-10 md:h-10 border-2 border-gray-400 dark:border-gray-600 text-center dark:text-white dark:bg-gray-700 font-bold uppercase focus:border-pink-500 focus:outline-none text-sm md:text-base flex-shrink-0" data-answer="T" data-correct-answer="T">
            <% 'OVAGLIA'.chars.each do |char| %>
              <input type="text" maxlength="1" class="w-8 h-8 md:w-10 md:h-10 border-2 border-gray-400 dark:border-gray-600 text-center dark:text-white dark:bg-gray-700 font-bold uppercase focus:border-pink-500 focus:outline-none text-sm md:text-base flex-shrink-0" data-answer="<%= char %>" data-correct-answer="<%= char %>">
            <% end %>
          </div>

          <!-- Row 2: PAGLIACCIO -->
          <div class="flex flex-wrap md:flex-nowrap gap-1 items-center">
            <span class="font-bold text-pink-600 w-6 flex-shrink-0">2</span>
            <input type="text" maxlength="1" class="w-8 h-8 md:w-10 md:h-10 border-2 border-gray-400 dark:border-gray-600 text-center dark:text-white dark:bg-gray-700 font-bold uppercase focus:border-pink-500 focus:outline-none text-sm md:text-base flex-shrink-0" data-answer="P" data-correct-answer="P">
            <% 'AGLIACCIO'.chars.each do |char| %>
              <input type="text" maxlength="1" class="w-8 h-8 md:w-10 md:h-10 border-2 border-gray-400 dark:border-gray-600 text-center dark:text-white dark:bg-gray-700 font-bold uppercase focus:border-pink-500 focus:outline-none text-sm md:text-base flex-shrink-0" data-answer="<%= char %>" data-correct-answer="<%= char %>">
            <% end %>
          </div>

          <!-- Row 3: CONCHIGLIA -->
          <div class="flex flex-wrap md:flex-nowrap gap-1 items-center">
            <span class="font-bold text-pink-600 w-6 flex-shrink-0">3</span>
            <input type="text" maxlength="1" class="w-8 h-8 md:w-10 md:h-10 border-2 border-gray-400 dark:border-gray-600 text-center dark:text-white dark:bg-gray-700 font-bold uppercase focus:border-pink-500 focus:outline-none text-sm md:text-base flex-shrink-0" data-answer="C" data-correct-answer="C">
            <% 'ONCHIGLIA'.chars.each do |char| %>
              <input type="text" maxlength="1" class="w-8 h-8 md:w-10 md:h-10 border-2 border-gray-400 dark:border-gray-600 text-center dark:text-white dark:bg-gray-700 font-bold uppercase focus:border-pink-500 focus:outline-none text-sm md:text-base flex-shrink-0" data-answer="<%= char %>" data-correct-answer="<%= char %>">
            <% end %>
          </div>

          <!-- Row 4: IGLÃ™ -->
          <div class="flex flex-wrap md:flex-nowrap gap-1 items-center">
            <span class="font-bold text-pink-600 w-6 flex-shrink-0">4</span>
            <input type="text" maxlength="1" class="w-8 h-8 md:w-10 md:h-10 border-2 border-gray-400 dark:border-gray-600 text-center dark:text-white dark:bg-gray-700 font-bold uppercase focus:border-pink-500 focus:outline-none text-sm md:text-base flex-shrink-0" data-answer="I" data-correct-answer="I">
            <% 'GLÃ™'.chars.each do |char| %>
              <input type="text" maxlength="1" class="w-8 h-8 md:w-10 md:h-10 border-2 border-gray-400 dark:border-gray-600 text-center dark:text-white dark:bg-gray-700 font-bold uppercase focus:border-pink-500 focus:outline-none text-sm md:text-base flex-shrink-0" data-answer="<%= char %>" data-correct-answer="<%= char %>">
            <% end %>
          </div>

          <!-- Row 5: GIOIELLIERE -->
          <div class="flex flex-wrap md:flex-nowrap gap-1 items-center">
            <span class="font-bold text-pink-600 w-6 flex-shrink-0">5</span>
            <input type="text" maxlength="1" class="w-8 h-8 md:w-10 md:h-10 border-2 border-gray-400 dark:border-gray-600 text-center dark:text-white dark:bg-gray-700 font-bold uppercase focus:border-pink-500 focus:outline-none text-sm md:text-base flex-shrink-0" data-answer="G" data-correct-answer="G">
            <% 'IOIELLIERE'.chars.each do |char| %>
              <input type="text" maxlength="1" class="w-8 h-8 md:w-10 md:h-10 border-2 border-gray-400 dark:border-gray-600 text-center dark:text-white dark:bg-gray-700 font-bold uppercase focus:border-pink-500 focus:outline-none text-sm md:text-base flex-shrink-0" data-answer="<%= char %>" data-correct-answer="<%= char %>">
            <% end %>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- Page reference -->
  <div class="text-center text-gray-500 dark:text-gray-400 mb-6">
    <p class="font-semibold">Esercizi p. 138</p>
  </div>

  <!-- Exercise Controls -->
  <%= render 'shared/exercise_controls', color: 'pink', current_page: 'nvl4_gr_p015' %>
</div>
