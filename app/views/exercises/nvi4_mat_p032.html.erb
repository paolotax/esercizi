<div class="max-w-6xl mx-auto bg-white dark:bg-gray-900 p-3 md:p-6 transition-colors duration-300"
     data-controller="exercise-checker text-toggle font-controls"
     data-text-toggle-target="content"
     data-font-controls-target="content">

  <%= render 'shared/page_header', pagina: @pagina %>

  <div class="space-y-6">

    <!-- Box Teoria -->
    <div class="p-4 md:p-6 space-y-4 border-3 border-blue-500 dark:border-blue-600 rounded-2xl">
      <p class="font-bold text-gray-700 dark:text-gray-200">
        <span class="text-<%= @pagina.base_color %>-500">•</span> Leggi e osserva.
      </p>

      <!-- Proprietà invariantiva -->
      <div>
        <h3 class="font-bold text-<%= @pagina.base_color %>-600 mb-2">Proprietà invariantiva</h3>
        <div class="flex flex-col md:flex-row gap-6 items-start">
          <div class="p-3 bg-pink-light dark:bg-pink-900/30 rounded-2xl md:max-w-[200px]">
            <p class="text-gray-700 dark:text-gray-200">
              Per la proprietà invariantiva, se <span class="font-bold">aggiungi</span> o <span class="font-bold">togli uno stesso numero al minuendo e al sottraendo</span> il risultato non cambia.
            </p>
          </div>
          <div class="flex-1 space-y-4">
            <!-- Con le frecce -->
            <div class="text-center">
              <p class="font-bold text-<%= @pagina.base_color %>-600 mb-2">Con le frecce</p>
              <div class="flex justify-center gap-6">
                <%= render 'shared/invariantiva_frecce', a: 25, b: 18, n: 2 %>
                <%= render 'shared/invariantiva_frecce', a: 25, b: 18, n: -5 %>
              </div>
            </div>
            <!-- Con le parentesi -->
            <div class="text-center">
              <p class="font-bold text-<%= @pagina.base_color %>-600 mb-2">Con le parentesi</p>
              <div class="flex justify-center gap-6">
                <%= render 'shared/invariantiva_parentesi', a: 25, b: 18, n: 2 %>
                <%= render 'shared/invariantiva_parentesi', a: 25, b: 18, n: -5 %>
              </div>
            </div>
          </div>
        </div>
      </div>

      <!-- La prova della sottrazione -->
      <div>
        <h3 class="font-bold text-<%= @pagina.base_color %>-600 mb-2">La prova della sottrazione</h3>
        <div class="flex flex-col md:flex-row gap-6 items-start">
          <div class="shrink-0">
            <%= image_tag "nvi4_mat/p032/p032_01.jpg", alt: "La prova della sottrazione", class: "min-w-72 dark:bg-white dark:rounded-lg dark:p-1" %>
          </div>
          <div>
            <p class="text-gray-700 dark:text-gray-200 mb-2">La sottrazione è l'<span class="font-bold">operazione inversa</span> dell'addizione.</p>
            <p class="text-gray-700 dark:text-gray-200">Per eseguire la prova di una sottrazione aggiungi al <span class="font-bold text-red-600">resto</span> il <span class="font-bold text-green-600">sottraendo</span> e ottieni il <span class="font-bold text-cyan-600">minuendo</span>.</p>
          </div>
        </div>
      </div>
    </div>

    <!-- ESERCIZI -->
    <div class="p-4 md:p-6 bg-orange-100 dark:bg-orange-900/30 rounded-2xl">

      <div class="grid grid-cols-1 md:grid-cols-2 gap-6 md:divide-x-2 md:divide-orange-300">
        <!-- Colonna sinistra -->
        <div class="md:pr-4">
          <!-- Esercizio 1 -->
          <div>
            <p class="font-bold text-gray-700 dark:text-gray-200 mb-4">
              <%= numero_esercizio_badge(1) %>
              Calcola applicando la proprietà invariantiva come nell'esempio.
            </p>

            <div class="space-y-3">
              <p class="text-gray-700 dark:text-gray-200">
                57 − 43 = <span class="font-bold text-<%= @pagina.base_color %>-600">(57 − 3) − (43 − 3) = 54 − 40 = 14</span>
              </p>

              <div class="flex items-center gap-2">
                <span>65 − 38 =</span>
                <input type="text" data-correct-answer="(65 + 2) - (38 + 2) = 67 - 40 = 27" class="flex-1 border-b-2 border-dotted border-gray-400 dark:border-gray-500 text-center font-bold bg-transparent dark:text-white">
              </div>
              <div class="flex items-center gap-2">
                <span>94 − 72 =</span>
                <input type="text" data-correct-answer="(94 - 2) - (72 - 2) = 92 - 70 = 22" class="flex-1 border-b-2 border-dotted border-gray-400 dark:border-gray-500 text-center font-bold bg-transparent dark:text-white">
              </div>
              <div class="flex items-center gap-2">
                <span>178 − 25 =</span>
                <input type="text" data-correct-answer="(178 + 5) - (25 + 5) = 183 - 30 = 153" class="flex-1 border-b-2 border-dotted border-gray-400 dark:border-gray-500 text-center font-bold bg-transparent dark:text-white">
              </div>
              <div class="flex items-center gap-2">
                <span>286 − 39 =</span>
                <input type="text" data-correct-answer="(286 + 1) - (39 + 1) = 287 - 40 = 247" class="flex-1 border-b-2 border-dotted border-gray-400 dark:border-gray-500 text-center font-bold bg-transparent dark:text-white">
              </div>
            </div>
          </div>
        </div>

        <!-- Colonna destra -->
        <div class="md:pl-4">
          <!-- Esercizio 2 -->
          <div>
            <p class="font-bold text-gray-700 dark:text-gray-200 mb-4">
              <%= numero_esercizio_badge(2) %>
              Trova il minuendo. Per calcolarlo esegui l'operazione inversa come nell'esempio.
            </p>

            <div class="space-y-3">
              <p class="text-gray-700 dark:text-gray-200">
                88 − 10 = 78 <span class="text-<%= @pagina.base_color %>-500">→</span> <span class="font-bold text-<%= @pagina.base_color %>-600">78 + 10 = 88</span>
              </p>

              <div class="flex items-center gap-2 flex-wrap">
                <input type="text" data-correct-answer="395" class="w-16 border-b-2 border-dotted border-gray-400 dark:border-gray-500 text-center font-bold bg-transparent dark:text-white">
                <span>− 50 = 345</span>
                <span class="text-<%= @pagina.base_color %>-500">→</span>
                <span>345 + 50 =</span>
                <input type="text" data-correct-answer="395" class="w-16 border-b-2 border-dotted border-gray-400 dark:border-gray-500 text-center font-bold bg-transparent dark:text-white">
              </div>
              <div class="flex items-center gap-2 flex-wrap">
                <input type="text" data-correct-answer="945" class="w-16 border-b-2 border-dotted border-gray-400 dark:border-gray-500 text-center font-bold bg-transparent dark:text-white">
                <span>− 73 = 872</span>
                <span class="text-<%= @pagina.base_color %>-500">→</span>
                <span>872 + 73 =</span>
                <input type="text" data-correct-answer="945" class="w-16 border-b-2 border-dotted border-gray-400 dark:border-gray-500 text-center font-bold bg-transparent dark:text-white">
              </div>
              <div class="flex items-center gap-2 flex-wrap">
                <input type="text" data-correct-answer="689" class="w-16 border-b-2 border-dotted border-gray-400 dark:border-gray-500 text-center font-bold bg-transparent dark:text-white">
                <span>− 57 = 632</span>
                <span class="text-<%= @pagina.base_color %>-500">→</span>
                <span>632 + 57 =</span>
                <input type="text" data-correct-answer="689" class="w-16 border-b-2 border-dotted border-gray-400 dark:border-gray-500 text-center font-bold bg-transparent dark:text-white">
              </div>
              <div class="flex items-center gap-2 flex-wrap">
                <input type="text" data-correct-answer="680" class="w-16 border-b-2 border-dotted border-gray-400 dark:border-gray-500 text-center font-bold bg-transparent dark:text-white">
                <span>− 39 = 641</span>
                <span class="text-<%= @pagina.base_color %>-500">→</span>
                <span>641 + 39 =</span>
                <input type="text" data-correct-answer="680" class="w-16 border-b-2 border-dotted border-gray-400 dark:border-gray-500 text-center font-bold bg-transparent dark:text-white">
              </div>
            </div>
          </div>
        </div>
      </div>

    </div>

    <%= render 'shared/quaderno_link', pagine: [183] %>

    <%= render 'shared/exercise_controls' %>
  </div>
</div>
