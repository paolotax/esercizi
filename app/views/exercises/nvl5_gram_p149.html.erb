<div class="max-w-6xl mx-auto p-3 md:p-8 bg-white" data-controller="exercise-checker">

  <%= render 'shared/page_header', pagina: @pagina %>

  <!-- Exercise 1: Collective nouns -->
  <div class="mb-6 bg-<%= @pagina.base_color %>-100 rounded-lg p-4 md:p-6" data-controller="fill-blanks">
    <h2 class="text-lg md:text-xl font-bold text-<%= @pagina.base_color %>-700 mb-4 flex items-center flex-wrap gap-2">
      <span class="bg-<%= @pagina.base_color %>-500 text-white rounded-full w-8 h-8 md:w-10 md:h-10 inline-flex items-center justify-center text-sm font-bold">1</span>
      <span class="bg-yellow-400 text-<%= @pagina.base_color %>-900 px-3 py-1 rounded-lg font-bold text-sm">IMPARARE TUTTI</span>
      <span>Scrivi per ciascuna espressione il <span class="text-<%= @pagina.base_color %>-600 font-bold">nome collettivo</span> corrispondente. Scegli fra:</span>
    </h2>

    <div class="bg-white rounded-lg px-4 py-3 mb-4 text-base md:text-lg text-center">
      <span class="font-bold text-<%= @pagina.base_color %>-700">flotta • nugolo • comitiva • nidiata • branco • costellazione • muta • ciurma</span>
    </div>

    <% collective_nouns = [
      { expression: "un gruppo di pirati", answer: "ciurma" },
      { expression: "un gruppo di navi", answer: "flotta" },
      { expression: "un gruppo di insetti", answer: "nugolo" },
      { expression: "un gruppo di cani", answer: "muta" },
      { expression: "un insieme di stelle", answer: "costellazione" },
      { expression: "un gruppo di turisti", answer: "comitiva" },
      { expression: "un gruppo di pulcini", answer: "nidiata" },
      { expression: "un gruppo di lupi", answer: "branco" }
    ] %>

    <div class="space-y-3 text-base md:text-lg">
      <% collective_nouns.each do |item| %>
        <div class="flex items-center gap-3 bg-white rounded-lg p-3">
          <span class="text-<%= @pagina.base_color %>-600 font-bold">•</span>
          <span class="text-gray-700 font-semibold"><%= item[:expression] %></span>
          <span class="text-gray-400">→</span>
          <input type="text"
                 class="border-b-2 border-dotted border-gray-400 bg-transparent px-2 py-1 focus:outline-none focus:border-<%= @pagina.base_color %>-500 flex-grow"
                 data-fill-blanks-target="input"
                 data-answer="<%= item[:answer] %>"
                 data-correct-answer="<%= item[:answer] %>">
        </div>
      <% end %>
    </div>
  </div>

  <!-- Exercise 2: Explain collective nouns -->
  <div class="mb-6 bg-<%= @pagina.base_color %>-50 rounded-lg p-4 md:p-6" data-controller="fill-blanks">
    <h2 class="text-lg md:text-xl font-bold text-<%= @pagina.base_color %>-700 mb-4 flex items-center gap-2">
      <span class="bg-<%= @pagina.base_color %>-500 text-white rounded-full w-8 h-8 md:w-10 md:h-10 inline-flex items-center justify-center text-sm font-bold">2</span>
      <span>Spiega il significato dei seguenti <span class="text-<%= @pagina.base_color %>-600 font-bold">nomi collettivi</span>, come nell'esempio.</span>
    </h2>

    <% explanations = [
      { noun: "pinacoteca", explanation: "insieme di dipinti", example: true },
      { noun: "clientela", explanation: "insieme di clienti", example: false },
      { noun: "gregge", explanation: "insieme di pecore", example: false },
      { noun: "equipaggio", explanation: "insieme di marinai", example: false },
      { noun: "pineta", explanation: "insieme di pini", example: false },
      { noun: "arcipelago", explanation: "insieme di isole", example: false },
      { noun: "sciame", explanation: "insieme di api", example: false }
    ] %>

    <div class="space-y-3 text-base md:text-lg">
      <% explanations.each do |item| %>
        <div class="flex items-center gap-3">
          <span class="text-<%= @pagina.base_color %>-600 font-bold">•</span>
          <span class="text-gray-700 font-semibold w-28"><%= item[:noun] %></span>
          <span class="text-gray-400">→</span>
          <% if item[:example] %>
            <span class="font-bold text-<%= @pagina.base_color %>-700"><%= item[:explanation] %></span>
          <% else %>
            <input type="text"
                   class="border-b-2 border-dotted border-gray-400 bg-transparent px-2 py-1 focus:outline-none focus:border-<%= @pagina.base_color %>-500 flex-grow"
                   data-fill-blanks-target="input"
                   data-answer="<%= item[:explanation] %>"
                   data-correct-answer="<%= item[:explanation] %>">
          <% end %>
        </div>
      <% end %>
    </div>
  </div>

  <!-- Exercise 3: Compound nouns -->
  <div class="mb-6 bg-<%= @pagina.base_color %>-50 rounded-lg p-4 md:p-6" data-controller="fill-blanks">
    <h2 class="text-lg md:text-xl font-bold text-<%= @pagina.base_color %>-700 mb-4 flex items-center gap-2">
      <span class="bg-<%= @pagina.base_color %>-500 text-white rounded-full w-8 h-8 md:w-10 md:h-10 inline-flex items-center justify-center text-sm font-bold">3</span>
      <span>Scrivi due <span class="text-<%= @pagina.base_color %>-600 font-bold">nomi composti</span> a partire dalla parola nel riquadro.</span>
    </h2>

    <div class="grid grid-cols-1 md:grid-cols-2 gap-6 text-base md:text-lg">
      <!-- dopo -->
      <div class="bg-white rounded-lg p-4">
        <div class="flex items-center gap-3 mb-3">
          <div class="bg-<%= @pagina.base_color %>-500 text-white font-bold px-4 py-2 rounded-lg text-center min-w-[80px]">
            dopo
          </div>
          <div class="flex-1">
            <div class="flex items-center gap-2 mb-2">
              <span class="text-<%= @pagina.base_color %>-500">→</span>
              <span class="font-bold text-<%= @pagina.base_color %>-700">dopolavoro</span>
            </div>
            <div class="flex items-center gap-2">
              <span class="text-<%= @pagina.base_color %>-500">→</span>
              <input type="text"
                     class="border-b-2 border-dotted border-gray-400 bg-transparent px-2 py-1 focus:outline-none focus:border-<%= @pagina.base_color %>-500 flex-1"
                     data-fill-blanks-target="input"
                     data-answer="dopobarba">
            </div>
          </div>
        </div>
      </div>

      <!-- terra -->
      <div class="bg-white rounded-lg p-4">
        <div class="flex items-center gap-3 mb-3">
          <div class="bg-<%= @pagina.base_color %>-500 text-white font-bold px-4 py-2 rounded-lg text-center min-w-[80px]">
            terra
          </div>
          <div class="flex-1">
            <div class="flex items-center gap-2 mb-2">
              <span class="text-<%= @pagina.base_color %>-500">→</span>
              <input type="text"
                     class="border-b-2 border-dotted border-gray-400 bg-transparent px-2 py-1 focus:outline-none focus:border-<%= @pagina.base_color %>-500 flex-1"
                     data-fill-blanks-target="input"
                     data-answer="terracotta">
            </div>
            <div class="flex items-center gap-2">
              <span class="text-<%= @pagina.base_color %>-500">→</span>
              <input type="text"
                     class="border-b-2 border-dotted border-gray-400 bg-transparent px-2 py-1 focus:outline-none focus:border-<%= @pagina.base_color %>-500 flex-1"
                     data-fill-blanks-target="input"
                     data-answer="terremoto">
            </div>
          </div>
        </div>
      </div>

      <!-- auto -->
      <div class="bg-white rounded-lg p-4">
        <div class="flex items-center gap-3 mb-3">
          <div class="bg-<%= @pagina.base_color %>-500 text-white font-bold px-4 py-2 rounded-lg text-center min-w-[80px]">
            auto
          </div>
          <div class="flex-1">
            <div class="flex items-center gap-2 mb-2">
              <span class="text-<%= @pagina.base_color %>-500">→</span>
              <input type="text"
                     class="border-b-2 border-dotted border-gray-400 bg-transparent px-2 py-1 focus:outline-none focus:border-<%= @pagina.base_color %>-500 flex-1"
                     data-fill-blanks-target="input"
                     data-answer="autostrada">
            </div>
            <div class="flex items-center gap-2">
              <span class="text-<%= @pagina.base_color %>-500">→</span>
              <input type="text"
                     class="border-b-2 border-dotted border-gray-400 bg-transparent px-2 py-1 focus:outline-none focus:border-<%= @pagina.base_color %>-500 flex-1"
                     data-fill-blanks-target="input"
                     data-answer="autobus">
            </div>
          </div>
        </div>
      </div>

      <!-- capo -->
      <div class="bg-white rounded-lg p-4">
        <div class="flex items-center gap-3 mb-3">
          <div class="bg-<%= @pagina.base_color %>-500 text-white font-bold px-4 py-2 rounded-lg text-center min-w-[80px]">
            capo
          </div>
          <div class="flex-1">
            <div class="flex items-center gap-2 mb-2">
              <span class="text-<%= @pagina.base_color %>-500">→</span>
              <input type="text"
                     class="border-b-2 border-dotted border-gray-400 bg-transparent px-2 py-1 focus:outline-none focus:border-<%= @pagina.base_color %>-500 flex-1"
                     data-fill-blanks-target="input"
                     data-answer="capoluogo">
            </div>
            <div class="flex items-center gap-2">
              <span class="text-<%= @pagina.base_color %>-500">→</span>
              <input type="text"
                     class="border-b-2 border-dotted border-gray-400 bg-transparent px-2 py-1 focus:outline-none focus:border-<%= @pagina.base_color %>-500 flex-1"
                     data-fill-blanks-target="input"
                     data-answer="capostazione">
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>

  <%= render 'shared/exercise_controls' %>

</div>
