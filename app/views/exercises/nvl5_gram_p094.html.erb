<div class="max-w-6xl mx-auto bg-white dark:bg-gray-900 text-black dark:text-white p-3 md:p-6 transition-colors duration-300"
     data-controller="exercise-checker text-toggle font-controls"
     data-text-toggle-target="content"
     data-font-controls-target="content">

  <%= render 'shared/page_header', pagina: @pagina %>

  <!-- Reference box -->
  <div class="bg-<%= @pagina.base_color %>-50 dark:bg-<%= @pagina.base_color %>-900/30 p-4 md:p-6 pb-8 rounded-lg mb-6">
    <p class="text-base md:text-lg text-gray-700 dark:text-gray-200 font-semibold text-center">
      <span class="text-<%= @pagina.base_color %>-500">•</span> Vai alle pp. 10-12 del BLOCCO DELLE MAPPE E DEGLI SCHEMI: ti aiuteranno a svolgere le attività.
    </p>
  </div>

  <!-- Exercise 1 -->
  <div class="p-4 md:p-6 pb-8" data-controller="word-highlighter" data-word-highlighter-multi-color-value="false">
    <h2 class="text-lg md:text-xl font-bold mb-4 flex items-center gap-2">
      <span class="flex-shrink-0 bg-<%= @pagina.base_color %>-500 text-white rounded-full w-8 h-8 md:w-10 md:h-10 inline-flex items-center justify-center">1</span>
      Sottolinea gli avverbi<span class="inline-block w-5 h-5 bg-blue-300 rounded ml-1"></span>
    </h2>

    <!-- Color Selector (hidden for mono-color) -->
    <div class="hidden">
      <div class="w-6 h-6 bg-blue-300" data-word-highlighter-target="colorBox" data-color="blue"></div>
    </div>

    <div class="space-y-2 text-base md:text-lg cursor-pointer">
      <div class="bg-<%= @pagina.base_color %>-50 dark:bg-<%= @pagina.base_color %>-900/30 rounded-lg p-4">
        <span class="text-gray-700 dark:text-gray-200"><span class="text-<%= @pagina.base_color %>-500">•</span> <span class="transition" data-word-highlighter-target="word" data-action="click->word-highlighter#toggleHighlight" data-correct="blue">Oggi</span> rivedo quel film che mi era piaciuto <span class="transition" data-word-highlighter-target="word" data-action="click->word-highlighter#toggleHighlight" data-correct="blue">tanto</span>.</span>
      </div>
      <div class="bg-<%= @pagina.base_color %>-50 dark:bg-<%= @pagina.base_color %>-900/30 rounded-lg p-4">
        <span class="text-gray-700 dark:text-gray-200"><span class="text-<%= @pagina.base_color %>-500">•</span> <span class="transition" data-word-highlighter-target="word" data-action="click->word-highlighter#toggleHighlight" data-correct="blue">Laggiù</span>, se guardi <span class="transition" data-word-highlighter-target="word" data-action="click->word-highlighter#toggleHighlight" data-correct="blue">attentamente</span>, si possono vedere le tane delle marmotte.</span>
      </div>
      <div class="bg-<%= @pagina.base_color %>-50 dark:bg-<%= @pagina.base_color %>-900/30 rounded-lg p-4">
        <span class="text-gray-700 dark:text-gray-200"><span class="text-<%= @pagina.base_color %>-500">•</span> Devi pedalare <span class="transition" data-word-highlighter-target="word" data-action="click->word-highlighter#toggleHighlight" data-correct="blue">velocemente</span> se non vuoi arrivare <span class="transition" data-word-highlighter-target="word" data-action="click->word-highlighter#toggleHighlight" data-correct="blue">tardi</span> all'appuntamento.</span>
      </div>
      <div class="bg-<%= @pagina.base_color %>-50 dark:bg-<%= @pagina.base_color %>-900/30 rounded-lg p-4">
        <span class="text-gray-700 dark:text-gray-200"><span class="text-<%= @pagina.base_color %>-500">•</span> Dicono che una volpe passi <span class="transition" data-word-highlighter-target="word" data-action="click->word-highlighter#toggleHighlight" data-correct="blue">sempre</span> di <span class="transition" data-word-highlighter-target="word" data-action="click->word-highlighter#toggleHighlight" data-correct="blue">qua</span>.</span>
      </div>
      <div class="bg-<%= @pagina.base_color %>-50 dark:bg-<%= @pagina.base_color %>-900/30 rounded-lg p-4">
        <span class="text-gray-700 dark:text-gray-200"><span class="text-<%= @pagina.base_color %>-500">•</span> Vado <span class="transition" data-word-highlighter-target="word" data-action="click->word-highlighter#toggleHighlight" data-correct="blue">spesso</span> in biblioteca: mi piace <span class="transition" data-word-highlighter-target="word" data-action="click->word-highlighter#toggleHighlight" data-correct="blue">molto</span> leggere.</span>
      </div>
      <div class="bg-<%= @pagina.base_color %>-50 dark:bg-<%= @pagina.base_color %>-900/30 rounded-lg p-4">
        <span class="text-gray-700 dark:text-gray-200"><span class="text-<%= @pagina.base_color %>-500">•</span> <span class="transition" data-word-highlighter-target="word" data-action="click->word-highlighter#toggleHighlight" data-correct="blue">Forse</span> quel vestito è corto: sei cresciuta <span class="transition" data-word-highlighter-target="word" data-action="click->word-highlighter#toggleHighlight" data-correct="blue">tanto</span>!</span>
      </div>
      <div class="bg-<%= @pagina.base_color %>-50 dark:bg-<%= @pagina.base_color %>-900/30 rounded-lg p-4">
        <span class="text-gray-700 dark:text-gray-200"><span class="text-<%= @pagina.base_color %>-500">•</span> <span class="transition" data-word-highlighter-target="word" data-action="click->word-highlighter#toggleHighlight" data-correct="blue">Adesso</span> devo tornare, sono <span class="transition" data-word-highlighter-target="word" data-action="click->word-highlighter#toggleHighlight" data-correct="blue">già</span> in ritardo. Ci rivedremo <span class="transition" data-word-highlighter-target="word" data-action="click->word-highlighter#toggleHighlight" data-correct="blue">presto</span>!</span>
      </div>
      <div class="bg-<%= @pagina.base_color %>-50 dark:bg-<%= @pagina.base_color %>-900/30 rounded-lg p-4">
        <span class="text-gray-700 dark:text-gray-200"><span class="text-<%= @pagina.base_color %>-500">•</span> Se vai a dormire <span class="transition" data-word-highlighter-target="word" data-action="click->word-highlighter#toggleHighlight" data-correct="blue">troppo</span> <span class="transition" data-word-highlighter-target="word" data-action="click->word-highlighter#toggleHighlight" data-correct="blue">tardi</span>, <span class="transition" data-word-highlighter-target="word" data-action="click->word-highlighter#toggleHighlight" data-correct="blue">domani</span> sarai <span class="transition" data-word-highlighter-target="word" data-action="click->word-highlighter#toggleHighlight" data-correct="blue">sicuramente</span> assonnato.</span>
      </div>
    </div>
  </div>

  <!-- Exercise 2 -->
  <div class="p-4 md:p-6 pb-8" data-controller="fill-blanks">
    <h2 class="text-lg md:text-xl font-bold mb-4 flex items-center gap-2">
      <span class="flex-shrink-0 bg-<%= @pagina.base_color %>-500 text-white rounded-full w-8 h-8 md:w-10 md:h-10 inline-flex items-center justify-center">2</span>
      Completa le frasi inserendo un avverbio o una locuzione avverbiale a scelta tra quelli dell'elenco. Fai attenzione agli intrusi!
    </h2>

    <div class="mb-4 bg-<%= @pagina.base_color %>-50 dark:bg-<%= @pagina.base_color %>-900/30 rounded-lg p-4">
      <div class="grid grid-cols-2 md:grid-cols-4 gap-3 text-base md:text-lg text-center font-semibold text-<%= @pagina.base_color %>-700 dark:text-<%= @pagina.base_color %>-300">
        <div>un po' troppo</div>
        <div>nemmeno</div>
        <div>spesso</div>
        <div>davanti</div>
        <div>all'incirca</div>
        <div>volentieri</div>
        <div>prima o poi</div>
        <div>abbastanza</div>
      </div>
    </div>

    <div class="space-y-3 text-base md:text-lg">
      <div class="bg-<%= @pagina.base_color %>-50 dark:bg-<%= @pagina.base_color %>-900/30 rounded-lg p-4">
        <div class="flex flex-wrap items-center gap-2">
          <span class="text-<%= @pagina.base_color %>-500">•</span>
          <span class="text-gray-700 dark:text-gray-200">Verrei</span>
          <input type="text" class="w-28 border-b-2 border-dotted border-<%= @pagina.base_color %>-500 bg-transparent dark:text-white text-right px-2 focus:outline-none" data-fill-blanks-target="input" data-answer="volentieri" data-correct-answer="volentieri">
          <span class="text-gray-700 dark:text-gray-200">con te al campus di musica, ma papà non vuole. Speriamo che</span>
          <input type="text" class="w-28 border-b-2 border-dotted border-<%= @pagina.base_color %>-500 bg-transparent dark:text-white text-right px-2 focus:outline-none" data-fill-blanks-target="input" data-answer="prima o poi" data-correct-answer="prima o poi">
          <span class="text-gray-700 dark:text-gray-200">cambi idea!</span>
        </div>
      </div>

      <div class="bg-<%= @pagina.base_color %>-50 dark:bg-<%= @pagina.base_color %>-900/30 rounded-lg p-4">
        <div class="flex flex-wrap items-center gap-2">
          <span class="text-<%= @pagina.base_color %>-500">•</span>
          <span class="text-gray-700 dark:text-gray-200">Ho speso</span>
          <input type="text" class="w-28 border-b-2 border-dotted border-<%= @pagina.base_color %>-500 bg-transparent dark:text-white text-right px-2 focus:outline-none" data-fill-blanks-target="input" data-answer="un po' troppo" data-correct-answer="un po' troppo">
          <span class="text-gray-700 dark:text-gray-200">e ora non ho i soldi per il pranzo.</span>
        </div>
      </div>

      <div class="bg-<%= @pagina.base_color %>-50 dark:bg-<%= @pagina.base_color %>-900/30 rounded-lg p-4">
        <div class="flex flex-wrap items-center gap-2">
          <span class="text-<%= @pagina.base_color %>-500">•</span>
          <span class="text-gray-700 dark:text-gray-200">L'ultimo giorno di scuola non ho</span>
          <input type="text" class="w-28 border-b-2 border-dotted border-<%= @pagina.base_color %>-500 bg-transparent dark:text-white text-right px-2 focus:outline-none" data-fill-blanks-target="input" data-answer="nemmeno" data-correct-answer="nemmeno">
          <span class="text-gray-700 dark:text-gray-200">fatto in tempo a salutare tutti i compagni.</span>
        </div>
      </div>
    </div>
  </div>

  <!-- Exercise 3 -->
  <div class="p-4 md:p-6 pb-8" data-controller="word-highlighter" data-word-highlighter-multi-color-value="true">
    <h2 class="text-lg md:text-xl font-bold mb-4 flex items-center flex-wrap gap-2">
      <span class="flex-shrink-0 bg-<%= @pagina.base_color %>-500 text-white rounded-full w-8 h-8 md:w-10 md:h-10 inline-flex items-center justify-center">3</span>
      <span>Sottolinea preposizioni articolate<span class="inline-block w-5 h-5 bg-yellow-300 rounded ml-1 cursor-pointer" data-word-highlighter-target="colorBox" data-color="yellow" data-action="click->word-highlighter#selectColor"></span> e articoli partitivi<span class="inline-block w-5 h-5 bg-blue-300 rounded ml-1 cursor-pointer" data-word-highlighter-target="colorBox" data-color="blue" data-action="click->word-highlighter#selectColor"></span>.</span>
    </h2>

    <div class="bg-<%= @pagina.base_color %>-50 dark:bg-<%= @pagina.base_color %>-900/30 rounded-lg p-4 cursor-pointer">
      <p class="text-base md:text-lg text-gray-700 dark:text-gray-200 leading-relaxed">
        <span class="text-<%= @pagina.base_color %>-500">•</span> D'estate, quando non vado a scuola, aiuto la mamma e il papà a fare <span class="transition" data-word-highlighter-target="word" data-action="click->word-highlighter#toggleHighlight" data-correct="blue">delle</span> faccende di casa e spesso devo rimettere a posto i giocattoli <span class="transition" data-word-highlighter-target="word" data-action="click->word-highlighter#toggleHighlight" data-correct="yellow">delle</span> mie sorelline. I miei genitori mi mandano anche a fare <span class="transition" data-word-highlighter-target="word" data-action="click->word-highlighter#toggleHighlight" data-correct="blue">delle</span> piccole compere. Mi piace andare <span class="transition" data-word-highlighter-target="word" data-action="click->word-highlighter#toggleHighlight" data-correct="yellow">al</span> panificio, dove c'è sempre l'odore buono <span class="transition" data-word-highlighter-target="word" data-action="click->word-highlighter#toggleHighlight" data-correct="yellow">del</span> pane. Ieri mattina sono andata anche <span class="transition" data-word-highlighter-target="word" data-action="click->word-highlighter#toggleHighlight" data-correct="yellow">al</span> supermercato, dove ho comprato <span class="transition" data-word-highlighter-target="word" data-action="click->word-highlighter#toggleHighlight" data-correct="blue">del</span> formaggio e <span class="transition" data-word-highlighter-target="word" data-action="click->word-highlighter#toggleHighlight" data-correct="blue">della</span> verdura per la cena.
      </p>
    </div>
  </div>

  <%= render 'shared/exercise_controls' %>
</div>
