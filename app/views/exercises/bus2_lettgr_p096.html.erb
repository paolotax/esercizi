<% content_for :titolo, "Il Rimedio Più Bello - Pagine 96-97" %>

<div class="max-w-[1800px] mx-auto p-4 lg:p-8 bg-gradient-to-b from-red-50 via-orange-50 to-white dark:from-gray-900 dark:via-gray-800 dark:to-gray-900" data-controller="exercise-checker text-toggle text-to-speech rhyme-highlighter">
  <!-- Header Navigation -->
  <div class="mb-6 flex items-center justify-between">
    <div class="flex items-center gap-4">
      <div class="bg-gradient-to-r from-amber-500 to-orange-600 text-white px-6 py-3 rounded-lg font-bold text-xl shadow-lg">
        BANDA DEL BUS 2
      </div>
      <h1 class="text-2xl lg:text-3xl font-bold text-orange-600 dark:text-orange-400">Lettura e Grammatica</h1>
    </div>
    <div class="flex gap-2 text-sm text-gray-600 dark:text-gray-400">
      <span class="bg-white dark:bg-gray-800 px-4 py-2 rounded-lg font-bold shadow">Pagine 96-97</span>
    </div>
  </div>


  <!-- Two-page horizontal layout like an open book -->
  <div class="grid lg:grid-cols-2 gap-6 lg:gap-8">

    <!-- LEFT PAGE - Page 96: Story -->
    <div class="bg-white dark:bg-gray-800 rounded-xl shadow-2xl relative border-4 border-orange-200 dark:border-orange-800 overflow-hidden min-h-[800px]" data-text-toggle-target="content" data-text-to-speech-target="textContent">

      <!-- Background Image -->
      <div class="absolute inset-0 flex items-end justify-center">
        <%= image_tag "bus2_lettgr/p96_01.jpg",
            alt: "Mamma e bambino con aquilone",
            class: "w-full h-auto object-contain opacity-80" %>
      </div>

      <!-- Content with white semi-transparent background -->
      <div class="relative z-10 p-6 lg:p-8">
        <!-- Page number top right -->
        <div class="absolute top-4 right-4 bg-red-600 text-white rounded-full w-10 h-10 flex items-center justify-center font-bold text-xl shadow-lg">
          96
        </div>

        <!-- Page Header -->
        <div class="mb-6">
          <div class="flex items-center gap-3 mb-4">
            <div class="bg-red-500 text-white px-4 py-1 rounded-full text-xs font-bold transform -rotate-3 shadow">
              HO IMPARATO
            </div>
            <h2 class="text-xl lg:text-2xl font-bold text-red-600">IL RIMEDIO PIÙ BELLO</h2>
          </div>
        </div>

        <!-- Story Text with numbered lines - transparent to show background -->
        <div class="rounded-lg p-4 lg:p-6 space-y-1 text-sm lg:text-base leading-relaxed">
          <div class="flex gap-3 items-center">
            <span class="text-orange-500 font-bold text-xs w-5 flex-shrink-0 text-right">1</span>
            <p class="text-gray-800 dark:text-gray-200">Questa mattina Leonardo è di cattivo umore perché</p>
          </div>
          <div class="flex gap-3 items-center">
            <span class="text-orange-500 font-bold text-xs w-5 flex-shrink-0 text-right">2</span>
            <p class="text-gray-800 dark:text-gray-200">la mamma non andrà a lavorare, come al solito.</p>
          </div>
          <div class="flex gap-3 items-center">
            <span class="text-orange-500 font-bold text-xs w-5 flex-shrink-0 text-right">3</span>
            <p class="text-gray-800 dark:text-gray-200">Lui, invece, dovrà andare a scuola. – Non è giusto! –</p>
          </div>
          <div class="flex gap-3 items-center">
            <span class="text-orange-500 font-bold text-xs w-5 flex-shrink-0 text-right">4</span>
            <p class="text-gray-800 dark:text-gray-200">esclama Leonardo con il viso scuro come un nuvolone</p>
          </div>
          <div class="flex gap-3 items-center">
            <span class="text-orange-500 font-bold text-xs w-5 flex-shrink-0 text-right">5</span>
            <p class="text-gray-800 dark:text-gray-200">grigio. – Io voglio stare a casa con te, mamma!</p>
          </div>
          <div class="flex gap-3 items-center">
            <span class="text-orange-500 font-bold text-xs w-5 flex-shrink-0 text-right">6</span>
            <p class="text-gray-800 dark:text-gray-200">La mamma spiega al bambino che lei non può andare</p>
          </div>
          <div class="flex gap-3 items-center">
            <span class="text-orange-500 font-bold text-xs w-5 flex-shrink-0 text-right">7</span>
            <p class="text-gray-800 dark:text-gray-200">in ufficio perché è chiuso per lavori, mentre la scuola</p>
          </div>
          <div class="flex gap-3 items-center">
            <span class="text-orange-500 font-bold text-xs w-5 flex-shrink-0 text-right">8</span>
            <p class="text-gray-800 dark:text-gray-200">è aperta ed è importante non perdere le lezioni.</p>
          </div>
          <div class="flex gap-3 items-center">
            <span class="text-orange-500 font-bold text-xs w-5 flex-shrink-0 text-right">9</span>
            <p class="text-gray-800 dark:text-gray-200">Poi, canticchia una filastrocca nel tentativo</p>
          </div>
          <div class="flex gap-3 items-center">
            <span class="text-orange-500 font-bold text-xs w-5 flex-shrink-0 text-right">10</span>
            <p class="text-gray-800 dark:text-gray-200">di riportare il sorriso sulla bocca di Leonardo.</p>
          </div>

          <div class="my-4 border-t-2 border-transparent"></div>

          <div class="flex gap-3 items-center">
            <span class="text-orange-500 font-bold text-xs w-5 flex-shrink-0 text-right">11</span>
            <p class="text-gray-800 dark:text-gray-200 italic">Oggi il mio bambino è di cattivo <span class="cursor-pointer hover:underline" data-rhyme-highlighter-target="rhymeWord" data-rhyme-group="1" data-action="click->rhyme-highlighter#highlightRhyme">umore</span>,</p>
          </div>
          <div class="flex gap-3 items-center">
            <span class="text-orange-500 font-bold text-xs w-5 flex-shrink-0 text-right">12</span>
            <p class="text-gray-800 dark:text-gray-200 italic">allora gli preparo la torta con le <span class="cursor-pointer hover:underline" data-rhyme-highlighter-target="rhymeWord" data-rhyme-group="1" data-action="click->rhyme-highlighter#highlightRhyme">more</span>.</p>
          </div>
          <div class="flex gap-3 items-center">
            <span class="text-orange-500 font-bold text-xs w-5 flex-shrink-0 text-right">13</span>
            <p class="text-gray-800 dark:text-gray-200 italic">Se il suo viso rimane <span class="cursor-pointer hover:underline" data-rhyme-highlighter-target="rhymeWord" data-rhyme-group="2" data-action="click->rhyme-highlighter#highlightRhyme">imbronciato</span>,</p>
          </div>
          <div class="flex gap-3 items-center">
            <span class="text-orange-500 font-bold text-xs w-5 flex-shrink-0 text-right">14</span>
            <p class="text-gray-800 dark:text-gray-200 italic">corro subito a comprare il <span class="cursor-pointer hover:underline" data-rhyme-highlighter-target="rhymeWord" data-rhyme-group="2" data-action="click->rhyme-highlighter#highlightRhyme">gelato</span>.</p>
          </div>

          <div class="my-4 border-t-2 border-transparent"></div>

          <div class="flex gap-3 items-center">
            <span class="text-orange-500 font-bold text-xs w-5 flex-shrink-0 text-right">15</span>
            <p class="text-gray-800 dark:text-gray-200 italic">Ma sono sicura che il rimedio più <span class="cursor-pointer hover:underline" data-rhyme-highlighter-target="rhymeWord" data-rhyme-group="3" data-action="click->rhyme-highlighter#highlightRhyme">bello</span></p>
          </div>
          <div class="flex gap-3 items-center">
            <span class="text-orange-500 font-bold text-xs w-5 flex-shrink-0 text-right">16</span>
            <p class="text-gray-800 dark:text-gray-200 italic">è farmi trovare davanti al <span class="cursor-pointer hover:underline" data-rhyme-highlighter-target="rhymeWord" data-rhyme-group="3" data-action="click->rhyme-highlighter#highlightRhyme">cancello</span></p>
          </div>
          <div class="flex gap-3 items-center">
            <span class="text-orange-500 font-bold text-xs w-5 flex-shrink-0 text-right">17</span>
            <p class="text-gray-800 dark:text-gray-200 italic">con un bell'aquilone che nel cielo <span class="cursor-pointer hover:underline" data-rhyme-highlighter-target="rhymeWord" data-rhyme-group="4" data-action="click->rhyme-highlighter#highlightRhyme">vola</span>,</p>
          </div>
          <div class="flex gap-3 items-center">
            <span class="text-orange-500 font-bold text-xs w-5 flex-shrink-0 text-right">18</span>
            <p class="text-gray-800 dark:text-gray-200 italic">quando il mio bambino uscirà da <span class="cursor-pointer hover:underline" data-rhyme-highlighter-target="rhymeWord" data-rhyme-group="4" data-action="click->rhyme-highlighter#highlightRhyme">scuola</span>.</p>
          </div>

          <div class="my-4 border-t-2 border-transparent"></div>

          <div class="flex gap-3 items-center">
            <span class="text-orange-500 font-bold text-xs w-5 flex-shrink-0 text-right">19</span>
            <p class="text-gray-800 dark:text-gray-200">Leonardo non resiste a lungo</p>
          </div>
          <div class="flex gap-3 items-center">
            <span class="text-orange-500 font-bold text-xs w-5 flex-shrink-0 text-right">20</span>
            <p class="text-gray-800 dark:text-gray-200">con il broncio: alla fine</p>
          </div>
          <div class="flex gap-3 items-center">
            <span class="text-orange-500 font-bold text-xs w-5 flex-shrink-0 text-right">21</span>
            <p class="text-gray-800 dark:text-gray-200">sorride, abbraccia la mamma</p>
          </div>
          <div class="flex gap-3 items-center mb-24">
            <span class="text-orange-500 font-bold text-xs w-5 flex-shrink-0 text-right">22</span>
            <p class="text-gray-800 dark:text-gray-200">e le dà un grosso bacio.</p>
          </div>
        </div>
      </div>

    </div>

    <!-- RIGHT PAGE - Page 97: Exercises -->
    <div class="bg-white dark:bg-gray-800 rounded-xl shadow-2xl p-6 lg:p-8 relative border-4 border-red-200 dark:border-red-800" data-text-toggle-target="content">

      <!-- Page number top right -->
      <div class="absolute top-4 right-4 bg-red-600 text-white rounded-full w-10 h-10 flex items-center justify-center font-bold text-xl shadow-lg">
        97
      </div>

      <!-- COMPRENDO Section -->
      <div class="mb-6 pb-6">
        <div class="bg-gradient-to-r from-red-500 to-orange-500 text-white px-3 py-1.5 rounded-lg font-bold text-sm mb-4 inline-block">
          COMPRENDO
        </div>

        <!-- Exercise 1 -->
        <div class="flex items-start gap-2 mb-4">
          <div class="bg-red-500 text-white rounded-full w-6 h-6 flex items-center justify-center font-bold text-sm flex-shrink-0">
            1
          </div>
          <div class="flex-1">
            <p class="text-gray-700 dark:text-gray-300 text-sm mb-3">Completa.</p>

            <div class="space-y-3 text-sm">
              <div class="flex items-center gap-2">
                <span class="text-gray-700 dark:text-gray-300">I versi della filastrocca sono:</span>
                <label class="flex items-center gap-1">
                  <input type="radio" name="versi" value="2" data-correct-answer="false" class="w-4 h-4" />
                  <span>2</span>
                </label>
                <label class="flex items-center gap-1">
                  <input type="radio" name="versi" value="4" data-correct-answer="true" class="w-4 h-4" />
                  <span>4</span>
                </label>
                <label class="flex items-center gap-1">
                  <input type="radio" name="versi" value="8" data-correct-answer="false" class="w-4 h-4" />
                  <span>8</span>
                </label>
              </div>

              <div class="flex items-center gap-2">
                <span class="text-gray-700 dark:text-gray-300">Le strofe sono:</span>
                <label class="flex items-center gap-1">
                  <input type="radio" name="strofe" value="2" data-correct-answer="false" class="w-4 h-4" />
                  <span>2</span>
                </label>
                <label class="flex items-center gap-1">
                  <input type="radio" name="strofe" value="4" data-correct-answer="true" class="w-4 h-4" />
                  <span>4</span>
                </label>
                <label class="flex items-center gap-1">
                  <input type="radio" name="strofe" value="8" data-correct-answer="false" class="w-4 h-4" />
                  <span>8</span>
                </label>
              </div>
            </div>
          </div>
        </div>

        <!-- Exercise 2 -->
        <div class="flex items-start gap-2 mb-4">
          <div class="bg-red-500 text-white rounded-full w-6 h-6 flex items-center justify-center font-bold text-sm flex-shrink-0">
            2
          </div>
          <div class="flex-1">
            <!-- Color selection boxes inline with text -->
            <div class="flex items-center gap-3 mb-3 flex-wrap">
              <span class="text-gray-700 dark:text-gray-300 text-sm">Sottolinea con colori diversi le rime.</span>
              <div class="flex gap-2 items-center">
                <button class="w-6 h-6 bg-yellow-400 rounded border-2 border-gray-300 hover:scale-110 transition cursor-pointer shadow-md"
                        data-rhyme-highlighter-target="colorBox"
                        data-color="yellow"
                        data-action="click->rhyme-highlighter#selectColor"
                        title="Giallo">
                </button>
                <button class="w-6 h-6 bg-pink-400 rounded border-2 border-gray-300 hover:scale-110 transition cursor-pointer shadow-md"
                        data-rhyme-highlighter-target="colorBox"
                        data-color="pink"
                        data-action="click->rhyme-highlighter#selectColor"
                        title="Rosa">
                </button>
                <button class="w-6 h-6 bg-blue-400 rounded border-2 border-gray-300 hover:scale-110 transition cursor-pointer shadow-md"
                        data-rhyme-highlighter-target="colorBox"
                        data-color="blue"
                        data-action="click->rhyme-highlighter#selectColor"
                        title="Blu">
                </button>
                <button class="w-6 h-6 bg-green-400 rounded border-2 border-gray-300 hover:scale-110 transition cursor-pointer shadow-md"
                        data-rhyme-highlighter-target="colorBox"
                        data-color="green"
                        data-action="click->rhyme-highlighter#selectColor"
                        title="Verde">
                </button>
              </div>
              <button class="text-xs text-gray-600 dark:text-gray-400 hover:text-gray-800 dark:hover:text-gray-200 underline"
                      data-action="click->rhyme-highlighter#clearHighlights">
                Cancella
              </button>
              <button class="text-xs bg-red-500 hover:bg-red-600 text-white px-3 py-1 rounded font-semibold"
                      data-action="click->rhyme-highlighter#checkAnswers">
                Controlla
              </button>
            </div>
            
            <p class="text-gray-600 dark:text-gray-400 text-xs italic">Seleziona un colore e clicca sulle parole che pensi facciano rima. Poi clicca "Controlla" per verificare.</p>
          </div>
        </div>

        <!-- Exercise 3 -->
        <div class="flex items-start gap-2 mb-4">
          <div class="bg-red-500 text-white rounded-full w-6 h-6 flex items-center justify-center font-bold text-sm flex-shrink-0">
            3
          </div>
          <div class="flex-1">
            <p class="text-gray-700 dark:text-gray-300 text-sm mb-2">Scrivi nel fumetto le parole che Leonardo potrebbe dire alla mamma, alla fine. (Per aiutarti rileggi le righe 19 e 22.)</p>
            <%# <textarea
              class="w-full px-3 py-2 border-2 border-orange-300 rounded-lg resize-none focus:outline-none focus:ring-2 focus:ring-orange-500 text-sm"
              rows="2"
              placeholder="Scrivi qui..."></textarea> %>
          </div>
        </div>

        <!-- Exercise 4 -->
        <div class="flex items-start gap-2">
          <div class="bg-red-500 text-white rounded-full w-6 h-6 flex items-center justify-center font-bold text-sm flex-shrink-0">
            4
          </div>
          <div class="flex-1">
            <p class="text-gray-700 dark:text-gray-300 text-sm mb-2">Rileggi il testo (righe 4 e 5) e completa con le parole che ricordano immagini.</p>
            <div class="mb-3 flex items-center gap-1">
              <p class="text-gray-700 dark:text-gray-300 text-sm flex-shrink-0">Il viso scuro come</p>
              <input type="text" data-correct-answer="un nuvolone grigio" class="w-full px-3 py-1 border-b-2 border-orange-300 dark:border-orange-600 text-sm outline-none focus:border-orange-500 bg-transparent dark:text-white" />
            </div>
          </div>
        </div>
      </div>

      <!-- SCOPRO LE PAROLE Section -->
      <div class="mb-6 pb-6">
        <div class="bg-gradient-to-r from-orange-500 to-amber-500 text-white px-3 py-1.5 rounded-lg font-bold text-sm mb-4 inline-block">
          SCOPRO LE PAROLE
        </div>

        <!-- Exercise 5: Titolo alternativo -->
        <div class="flex items-start gap-2 mb-4">
          <div class="bg-orange-500 text-white rounded-full w-6 h-6 flex items-center justify-center font-bold text-sm flex-shrink-0">
            5
          </div>
          <div class="flex-1">
            <p class="text-gray-700 dark:text-gray-300 text-sm mb-3">Quale altro titolo può andare bene per il racconto?</p>

            <div class="space-y-2">
              <label class="flex items-start gap-2 cursor-pointer">
                <input type="radio" name="titolo" value="cantante" data-correct-answer="false" class="mt-1 w-4 h-4" />
                <span class="text-sm text-gray-700 dark:text-gray-300">Una brava cantante</span>
              </label>
              <label class="flex items-start gap-2 cursor-pointer">
                <input type="radio" name="titolo" value="aquilone" data-correct-answer="false" class="mt-1 w-4 h-4" />
                <span class="text-sm text-gray-700 dark:text-gray-300">L'aquilone di Leonardo</span>
              </label>
              <label class="flex items-start gap-2 cursor-pointer">
                <input type="radio" name="titolo" value="canzone" data-correct-answer="true" class="mt-1 w-4 h-4" />
                <span class="text-sm text-gray-700 dark:text-gray-300">Una canzoncina aggiustatutto</span>
              </label>
            </div>
          </div>
        </div>

        <!-- Exercise 6: Quale parola -->
        <div class="flex items-start gap-2">
          <div class="bg-orange-500 text-white rounded-full w-6 h-6 flex items-center justify-center font-bold text-sm flex-shrink-0">
            6
          </div>
          <div class="flex-1">
            <p class="text-gray-700 dark:text-gray-300 text-sm mb-2">Quale parola non sta bene con le altre? Cerchiala.</p>

            <div class="flex flex-wrap gap-2 text-sm">
              <label class="flex items-center gap-1 cursor-pointer">
                <input type="radio" name="word-choice" value="torta" data-correct-answer="false" class="w-4 h-4" />
                <span class="font-semibold">torta</span>
              </label>
              <span class="text-gray-400 dark:text-gray-500">•</span>
              <label class="flex items-center gap-1 cursor-pointer">
                <input type="radio" name="word-choice" value="aquilone" data-correct-answer="true" class="w-4 h-4" />
                <span class="font-semibold">aquilone</span>
              </label>
              <span class="text-gray-400 dark:text-gray-500">•</span>
              <label class="flex items-center gap-1 cursor-pointer">
                <input type="radio" name="word-choice" value="gelato" data-correct-answer="false" class="w-4 h-4" />
                <span class="font-semibold">gelato</span>
              </label>
              <span class="text-gray-400 dark:text-gray-500">•</span>
              <label class="flex items-center gap-1 cursor-pointer">
                <input type="radio" name="word-choice" value="more" data-correct-answer="false" class="w-4 h-4" />
                <span class="font-semibold">more</span>
              </label>
            </div>
          </div>
        </div>
      </div>

      <!-- SCRIVO Section -->
      <div class="mb-4">
        <div class="bg-gradient-to-r from-green-500 to-teal-500 text-white px-3 py-1.5 rounded-lg font-bold text-sm mb-4 inline-block">
          SCRIVO
        </div>

        <!-- Exercise 7 -->
        <div class="flex items-start gap-2 mb-3">
          <div class="bg-green-500 text-white rounded-full w-6 h-6 flex items-center justify-center font-bold text-sm flex-shrink-0">
            7
          </div>
          <p class="text-gray-700 dark:text-gray-300 text-sm">Osserva i disegni e completa i versi con parole in rima.</p>
        </div>

        <!-- Images with exercises -->
        <div class="grid grid-cols-1 md:grid-cols-2 gap-3">
          <div class="bg-blue-50 dark:bg-blue-900/30 rounded-lg p-3">
            <%= image_tag "bus2_lettgr/p96_02.png",
                alt: "Bambino in bicicletta",
                class: "w-full rounded-lg mb-2" %>
            <div class="space-y-1">
              <p class="text-xs text-gray-700 dark:text-gray-300">Mentre vado in bicicletta</p>
              <div class="flex items-center gap-1">
                <p class="text-xs text-gray-700 dark:text-gray-300">mi rincorre una</p>
                <input type="text" data-correct-answer="capretta" class="flex-1 px-2 py-1 border-2 border-blue-300 dark:border-blue-600 rounded text-xs bg-transparent dark:text-white" placeholder="......" />
              </div>
            </div>
          </div>

          <div class="bg-green-50 dark:bg-green-900/30 rounded-lg p-3">
            <%= image_tag "bus2_lettgr/p96_03.png",
                alt: "Bambino con pallone",
                class: "w-full rounded-lg mb-2" %>
            <div class="space-y-1">
              <p class="text-xs text-gray-700 dark:text-gray-300">Mentre gioco col pallone</p>
              <div class="flex items-center gap-1">
                <p class="text-xs text-gray-700 dark:text-gray-300">vedo nel prato un</p>
                <input type="text" data-correct-answer="pavone" class="flex-1 px-2 py-1 border-2 border-green-300 dark:border-green-600 rounded text-xs bg-transparent dark:text-white" placeholder="......" />
              </div>
            </div>
          </div>
        </div>
      </div>

    </div>

  </div>

  <!-- Footer controls -->
  <%= render 'shared/exercise_controls', color: 'red', current_page: 'bus2_lettgr_p096' %>

</div>
