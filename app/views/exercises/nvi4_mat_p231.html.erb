<div class="max-w-6xl mx-auto bg-white dark:bg-gray-900 p-3 md:p-6 transition-colors duration-300"
     data-controller="exercise-checker text-toggle font-controls"
     data-text-toggle-target="content"
     data-font-controls-target="content">

  <%= render 'shared/page_header', pagina: @pagina %>

  <div class="space-y-6">

    <!-- Box Formule -->
    <div class="p-4 bg-custom-blue dark:bg-cyan-900 rounded-2xl">
      <div class="flex flex-wrap justify-center gap-x-8 gap-y-2 text-gray-700 dark:text-gray-200">
        <p><span class="text-<%= @pagina.base_color %>-600 dark:text-<%= @pagina.base_color %>-400 font-bold underline">Spesa</span> = Ricavo – Guadagno</p>
        <p><span class="text-<%= @pagina.base_color %>-600 dark:text-<%= @pagina.base_color %>-400 font-bold underline">Ricavo</span> = Spesa + Guadagno</p>
        <p><span class="text-<%= @pagina.base_color %>-600 dark:text-<%= @pagina.base_color %>-400 font-bold underline">Guadagno</span> = Ricavo – Spesa</p>
      </div>
    </div>

    <!-- Esercizio 1 IMPARARE TUTTI -->
    <div class="p-5 bg-white dark:bg-gray-800 rounded-2xl border-3 border-yellow-400 dark:border-yellow-500 space-y-4">
      <p class="font-bold text-gray-700 dark:text-gray-200">
        <%= imparare_tutti_badge(1) %>
        Colora il riquadro con il termine corretto.
      </p>

      <div class="space-y-4">
        <!-- Domanda 1 -->
        <div class="flex flex-col md:flex-row md:items-center gap-2 md:gap-4">
          <span class="text-gray-700 dark:text-gray-200">Per il negoziante il prezzo che il cliente paga è</span>
          <div class="flex gap-2 flex-wrap">
            <label class="flex items-center gap-2 cursor-pointer hover:bg-gray-50 dark:hover:bg-gray-700 p-2 rounded border border-gray-200 dark:border-gray-600 text-gray-700 dark:text-gray-200">
              <input type="radio" name="commercio1" class="w-4 h-4" data-correct-answer="true">
              <span>il ricavo</span>
            </label>
            <label class="flex items-center gap-2 cursor-pointer hover:bg-gray-50 dark:hover:bg-gray-700 p-2 rounded border border-gray-200 dark:border-gray-600 text-gray-700 dark:text-gray-200">
              <input type="radio" name="commercio1" class="w-4 h-4">
              <span>la spesa</span>
            </label>
            <label class="flex items-center gap-2 cursor-pointer hover:bg-gray-50 dark:hover:bg-gray-700 p-2 rounded border border-gray-200 dark:border-gray-600 text-gray-700 dark:text-gray-200">
              <input type="radio" name="commercio1" class="w-4 h-4">
              <span>il guadagno</span>
            </label>
          </div>
        </div>

        <!-- Domanda 2 -->
        <div class="flex flex-col md:flex-row md:items-center gap-2 md:gap-4">
          <span class="text-gray-700 dark:text-gray-200">Il prezzo che paga il negoziante al suo fornitore è</span>
          <div class="flex gap-2 flex-wrap">
            <label class="flex items-center gap-2 cursor-pointer hover:bg-gray-50 dark:hover:bg-gray-700 p-2 rounded border border-gray-200 dark:border-gray-600 text-gray-700 dark:text-gray-200">
              <input type="radio" name="commercio2" class="w-4 h-4">
              <span>il ricavo</span>
            </label>
            <label class="flex items-center gap-2 cursor-pointer hover:bg-gray-50 dark:hover:bg-gray-700 p-2 rounded border border-gray-200 dark:border-gray-600 text-gray-700 dark:text-gray-200">
              <input type="radio" name="commercio2" class="w-4 h-4" data-correct-answer="true">
              <span>la spesa</span>
            </label>
            <label class="flex items-center gap-2 cursor-pointer hover:bg-gray-50 dark:hover:bg-gray-700 p-2 rounded border border-gray-200 dark:border-gray-600 text-gray-700 dark:text-gray-200">
              <input type="radio" name="commercio2" class="w-4 h-4">
              <span>il guadagno</span>
            </label>
          </div>
        </div>

        <!-- Domanda 3 -->
        <div class="flex flex-col md:flex-row md:items-center gap-2 md:gap-4">
          <span class="text-gray-700 dark:text-gray-200">La differenza tra il ricavo e la spesa è</span>
          <div class="flex gap-2 flex-wrap">
            <label class="flex items-center gap-2 cursor-pointer hover:bg-gray-50 dark:hover:bg-gray-700 p-2 rounded border border-gray-200 dark:border-gray-600 text-gray-700 dark:text-gray-200">
              <input type="radio" name="commercio3" class="w-4 h-4">
              <span>il ricavo</span>
            </label>
            <label class="flex items-center gap-2 cursor-pointer hover:bg-gray-50 dark:hover:bg-gray-700 p-2 rounded border border-gray-200 dark:border-gray-600 text-gray-700 dark:text-gray-200">
              <input type="radio" name="commercio3" class="w-4 h-4">
              <span>la spesa</span>
            </label>
            <label class="flex items-center gap-2 cursor-pointer hover:bg-gray-50 dark:hover:bg-gray-700 p-2 rounded border border-gray-200 dark:border-gray-600 text-gray-700 dark:text-gray-200">
              <input type="radio" name="commercio3" class="w-4 h-4" data-correct-answer="true">
              <span>il guadagno</span>
            </label>
          </div>
        </div>
      </div>
    </div>

    <!-- Esercizio 2 IMPARARE TUTTI -->
    <div class="p-5 bg-white dark:bg-gray-800 rounded-2xl border-3 border-yellow-400 dark:border-yellow-500 space-y-4">
      <p class="font-bold text-gray-700 dark:text-gray-200">
        <%= imparare_tutti_badge(2) %>
        Esegui le operazioni sul quaderno e completa le tabelle.
      </p>

      <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
        <!-- Tabella sinistra -->
        <div class="overflow-x-auto">
          <table class="w-full border-2 border-cyan-400 dark:border-cyan-600">
            <thead>
              <tr class="bg-custom-blue-light dark:bg-cyan-900/50">
                <th class="p-2 border-2 border-cyan-400 dark:border-cyan-600 text-gray-700 dark:text-gray-200 font-bold">Spesa</th>
                <th class="p-2 border-2 border-cyan-400 dark:border-cyan-600 text-gray-700 dark:text-gray-200 font-bold">Ricavo</th>
                <th class="p-2 border-2 border-cyan-400 dark:border-cyan-600 text-gray-700 dark:text-gray-200 font-bold">Guadagno</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td class="p-2 border-2 border-cyan-400 dark:border-cyan-600 text-center text-cyan-600 dark:text-cyan-400 font-bold underline">€ 6,40</td>
                <td class="p-2 border-2 border-cyan-400 dark:border-cyan-600 text-center font-bold text-gray-700 dark:text-gray-200">€ 9,50</td>
                <td class="p-2 border-2 border-cyan-400 dark:border-cyan-600 text-center font-bold text-gray-700 dark:text-gray-200">€ 3,10</td>
              </tr>
              <tr>
                <td class="p-2 border-2 border-cyan-400 dark:border-cyan-600 text-center text-gray-700 dark:text-gray-200">€ 12,50</td>
                <td class="p-2 border-2 border-cyan-400 dark:border-cyan-600 text-center">
                  <input type="text" data-correct-answer="17" class="w-16 border-b-2 border-dotted border-gray-400 dark:border-gray-500 text-center font-bold bg-transparent dark:text-white">
                  <span class="text-gray-700 dark:text-gray-200">€</span>
                </td>
                <td class="p-2 border-2 border-cyan-400 dark:border-cyan-600 text-center text-gray-700 dark:text-gray-200">€ 4,50</td>
              </tr>
              <tr>
                <td class="p-2 border-2 border-cyan-400 dark:border-cyan-600 text-center text-gray-700 dark:text-gray-200">€ 18,00</td>
                <td class="p-2 border-2 border-cyan-400 dark:border-cyan-600 text-center text-gray-700 dark:text-gray-200">€ 25,30</td>
                <td class="p-2 border-2 border-cyan-400 dark:border-cyan-600 text-center">
                  <input type="text" data-correct-answer="7,30" class="w-16 border-b-2 border-dotted border-gray-400 dark:border-gray-500 text-center font-bold bg-transparent dark:text-white">
                  <span class="text-gray-700 dark:text-gray-200">€</span>
                </td>
              </tr>
            </tbody>
          </table>
        </div>

        <!-- Tabella destra -->
        <div class="overflow-x-auto">
          <table class="w-full border-2 border-cyan-400 dark:border-cyan-600">
            <thead>
              <tr class="bg-custom-blue-light dark:bg-cyan-900/50">
                <th class="p-2 border-2 border-cyan-400 dark:border-cyan-600 text-gray-700 dark:text-gray-200 font-bold">Spesa</th>
                <th class="p-2 border-2 border-cyan-400 dark:border-cyan-600 text-gray-700 dark:text-gray-200 font-bold">Ricavo</th>
                <th class="p-2 border-2 border-cyan-400 dark:border-cyan-600 text-gray-700 dark:text-gray-200 font-bold">Guadagno</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td class="p-2 border-2 border-cyan-400 dark:border-cyan-600 text-center text-gray-700 dark:text-gray-200">€ 138,40</td>
                <td class="p-2 border-2 border-cyan-400 dark:border-cyan-600 text-center text-gray-700 dark:text-gray-200">€ 185,50</td>
                <td class="p-2 border-2 border-cyan-400 dark:border-cyan-600 text-center">
                  <input type="text" data-correct-answer="47,10" class="w-16 border-b-2 border-dotted border-gray-400 dark:border-gray-500 text-center font-bold bg-transparent dark:text-white">
                  <span class="text-gray-700 dark:text-gray-200">€</span>
                </td>
              </tr>
              <tr>
                <td class="p-2 border-2 border-cyan-400 dark:border-cyan-600 text-center text-gray-700 dark:text-gray-200">€ 7,65</td>
                <td class="p-2 border-2 border-cyan-400 dark:border-cyan-600 text-center">
                  <input type="text" data-correct-answer="10" class="w-16 border-b-2 border-dotted border-gray-400 dark:border-gray-500 text-center font-bold bg-transparent dark:text-white">
                  <span class="text-gray-700 dark:text-gray-200">€</span>
                </td>
                <td class="p-2 border-2 border-cyan-400 dark:border-cyan-600 text-center text-gray-700 dark:text-gray-200">€ 2,35</td>
              </tr>
              <tr>
                <td class="p-2 border-2 border-cyan-400 dark:border-cyan-600 text-center">
                  <input type="text" data-correct-answer="132,30" class="w-16 border-b-2 border-dotted border-gray-400 dark:border-gray-500 text-center font-bold bg-transparent dark:text-white">
                  <span class="text-gray-700 dark:text-gray-200">€</span>
                </td>
                <td class="p-2 border-2 border-cyan-400 dark:border-cyan-600 text-center text-gray-700 dark:text-gray-200">€ 178,20</td>
                <td class="p-2 border-2 border-cyan-400 dark:border-cyan-600 text-center text-gray-700 dark:text-gray-200">€ 45,90</td>
              </tr>
            </tbody>
          </table>
        </div>
      </div>
    </div>

    <!-- Esercizio 3 -->
    <div class="space-y-4">
      <p class="text-gray-700 dark:text-gray-200">
        <%= numero_esercizio_badge(3) %> Esegui le operazioni sul quaderno e completa la tabella. Per ciascun prodotto calcola prima quanto richiesto nel riquadro evidenziato.
      </p>

      <div class="overflow-x-auto">
        <table class="w-full border-2 border-cyan-400 dark:border-cyan-600 text-sm">
          <thead>
            <tr class="bg-custom-blue-light dark:bg-cyan-900/50">
              <th class="p-2 border-2 border-cyan-400 dark:border-cyan-600 text-gray-700 dark:text-gray-200 font-bold">Prodotto</th>
              <th class="p-2 border-2 border-cyan-400 dark:border-cyan-600 text-gray-700 dark:text-gray-200 font-bold">Quantità</th>
              <th class="p-2 border-2 border-cyan-400 dark:border-cyan-600 text-gray-700 dark:text-gray-200 font-bold">Spesa unitaria (€)</th>
              <th class="p-2 border-2 border-cyan-400 dark:border-cyan-600 text-gray-700 dark:text-gray-200 font-bold">Spesa totale (€)</th>
              <th class="p-2 border-2 border-cyan-400 dark:border-cyan-600 text-gray-700 dark:text-gray-200 font-bold">Ricavo unitario (€)</th>
              <th class="p-2 border-2 border-cyan-400 dark:border-cyan-600 text-gray-700 dark:text-gray-200 font-bold">Ricavo totale (€)</th>
              <th class="p-2 border-2 border-cyan-400 dark:border-cyan-600 text-gray-700 dark:text-gray-200 font-bold">Guadagno unitario (€)</th>
              <th class="p-2 border-2 border-cyan-400 dark:border-cyan-600 text-gray-700 dark:text-gray-200 font-bold">Guadagno totale (€)</th>
            </tr>
          </thead>
          <tbody>
            <!-- Biscotti -->
            <tr>
              <td class="p-2 border-2 border-cyan-400 dark:border-cyan-600 text-center text-gray-700 dark:text-gray-200">Biscotti</td>
              <td class="p-2 border-2 border-cyan-400 dark:border-cyan-600 text-center text-gray-700 dark:text-gray-200">12 pacchi</td>
              <td class="p-2 border-2 border-cyan-400 dark:border-cyan-600 text-center text-gray-700 dark:text-gray-200">2,30</td>
              <td class="p-2 border-2 border-cyan-400 dark:border-cyan-600 text-center">
                <input type="text" data-correct-answer="27,60" class="w-14 border-b-2 border-dotted border-gray-400 dark:border-gray-500 text-center font-bold bg-transparent dark:text-white">
              </td>
              <td class="p-2 border-2 border-cyan-400 dark:border-cyan-600 text-center text-gray-700 dark:text-gray-200">2,80</td>
              <td class="p-2 border-2 border-cyan-400 dark:border-cyan-600 text-center">
                <input type="text" data-correct-answer="33,60" class="w-14 border-b-2 border-dotted border-gray-400 dark:border-gray-500 text-center font-bold bg-transparent dark:text-white">
              </td>
              <td class="p-2 border-2 border-cyan-400 dark:border-cyan-600 text-center bg-yellow-100 dark:bg-yellow-900/30">
                <input type="text" data-correct-answer="0,50" class="w-14 border-b-2 border-dotted border-gray-400 dark:border-gray-500 text-center font-bold bg-transparent dark:text-white">
              </td>
              <td class="p-2 border-2 border-cyan-400 dark:border-cyan-600 text-center">
                <input type="text" data-correct-answer="6" class="w-14 border-b-2 border-dotted border-gray-400 dark:border-gray-500 text-center font-bold bg-transparent dark:text-white">
              </td>
            </tr>
            <!-- Caffè -->
            <tr>
              <td class="p-2 border-2 border-cyan-400 dark:border-cyan-600 text-center text-gray-700 dark:text-gray-200">Caffè</td>
              <td class="p-2 border-2 border-cyan-400 dark:border-cyan-600 text-center text-gray-700 dark:text-gray-200">10 pacchi</td>
              <td class="p-2 border-2 border-cyan-400 dark:border-cyan-600 text-center">
                <input type="text" data-correct-answer="2,20" class="w-14 border-b-2 border-dotted border-gray-400 dark:border-gray-500 text-center font-bold bg-transparent dark:text-white">
              </td>
              <td class="p-2 border-2 border-cyan-400 dark:border-cyan-600 text-center bg-yellow-100 dark:bg-yellow-900/30">
                <input type="text" data-correct-answer="22" class="w-14 border-b-2 border-dotted border-gray-400 dark:border-gray-500 text-center font-bold bg-transparent dark:text-white">
              </td>
              <td class="p-2 border-2 border-cyan-400 dark:border-cyan-600 text-center">
                <input type="text" data-correct-answer="3,20" class="w-14 border-b-2 border-dotted border-gray-400 dark:border-gray-500 text-center font-bold bg-transparent dark:text-white">
              </td>
              <td class="p-2 border-2 border-cyan-400 dark:border-cyan-600 text-center text-gray-700 dark:text-gray-200">32</td>
              <td class="p-2 border-2 border-cyan-400 dark:border-cyan-600 text-center">
                <input type="text" data-correct-answer="1" class="w-14 border-b-2 border-dotted border-gray-400 dark:border-gray-500 text-center font-bold bg-transparent dark:text-white">
              </td>
              <td class="p-2 border-2 border-cyan-400 dark:border-cyan-600 text-center text-gray-700 dark:text-gray-200">10</td>
            </tr>
            <!-- Pasta -->
            <tr>
              <td class="p-2 border-2 border-cyan-400 dark:border-cyan-600 text-center text-gray-700 dark:text-gray-200">Pasta</td>
              <td class="p-2 border-2 border-cyan-400 dark:border-cyan-600 text-center text-gray-700 dark:text-gray-200">15 pacchi</td>
              <td class="p-2 border-2 border-cyan-400 dark:border-cyan-600 text-center bg-yellow-100 dark:bg-yellow-900/30">
                <input type="text" data-correct-answer="0,80" class="w-14 border-b-2 border-dotted border-gray-400 dark:border-gray-500 text-center font-bold bg-transparent dark:text-white">
              </td>
              <td class="p-2 border-2 border-cyan-400 dark:border-cyan-600 text-center">
                <input type="text" data-correct-answer="12" class="w-14 border-b-2 border-dotted border-gray-400 dark:border-gray-500 text-center font-bold bg-transparent dark:text-white">
              </td>
              <td class="p-2 border-2 border-cyan-400 dark:border-cyan-600 text-center text-gray-700 dark:text-gray-200">1,05</td>
              <td class="p-2 border-2 border-cyan-400 dark:border-cyan-600 text-center">
                <input type="text" data-correct-answer="15,75" class="w-14 border-b-2 border-dotted border-gray-400 dark:border-gray-500 text-center font-bold bg-transparent dark:text-white">
              </td>
              <td class="p-2 border-2 border-cyan-400 dark:border-cyan-600 text-center text-gray-700 dark:text-gray-200">0,25</td>
              <td class="p-2 border-2 border-cyan-400 dark:border-cyan-600 text-center">
                <input type="text" data-correct-answer="3,75" class="w-14 border-b-2 border-dotted border-gray-400 dark:border-gray-500 text-center font-bold bg-transparent dark:text-white">
              </td>
            </tr>
            <!-- Olio -->
            <tr>
              <td class="p-2 border-2 border-cyan-400 dark:border-cyan-600 text-center text-gray-700 dark:text-gray-200">Olio</td>
              <td class="p-2 border-2 border-cyan-400 dark:border-cyan-600 text-center text-gray-700 dark:text-gray-200">6 bottiglie</td>
              <td class="p-2 border-2 border-cyan-400 dark:border-cyan-600 text-center">
                <input type="text" data-correct-answer="1,80" class="w-14 border-b-2 border-dotted border-gray-400 dark:border-gray-500 text-center font-bold bg-transparent dark:text-white">
              </td>
              <td class="p-2 border-2 border-cyan-400 dark:border-cyan-600 text-center bg-yellow-100 dark:bg-yellow-900/30">
                <input type="text" data-correct-answer="10,80" class="w-14 border-b-2 border-dotted border-gray-400 dark:border-gray-500 text-center font-bold bg-transparent dark:text-white">
              </td>
              <td class="p-2 border-2 border-cyan-400 dark:border-cyan-600 text-center">
                <input type="text" data-correct-answer="5,40" class="w-14 border-b-2 border-dotted border-gray-400 dark:border-gray-500 text-center font-bold bg-transparent dark:text-white">
              </td>
              <td class="p-2 border-2 border-cyan-400 dark:border-cyan-600 text-center text-gray-700 dark:text-gray-200">32,40</td>
              <td class="p-2 border-2 border-cyan-400 dark:border-cyan-600 text-center">
                <input type="text" data-correct-answer="3,60" class="w-14 border-b-2 border-dotted border-gray-400 dark:border-gray-500 text-center font-bold bg-transparent dark:text-white">
              </td>
              <td class="p-2 border-2 border-cyan-400 dark:border-cyan-600 text-center text-gray-700 dark:text-gray-200">21,60</td>
            </tr>
            <!-- Riso -->
            <tr>
              <td class="p-2 border-2 border-cyan-400 dark:border-cyan-600 text-center text-gray-700 dark:text-gray-200">Riso</td>
              <td class="p-2 border-2 border-cyan-400 dark:border-cyan-600 text-center text-gray-700 dark:text-gray-200">10 pacchi</td>
              <td class="p-2 border-2 border-cyan-400 dark:border-cyan-600 text-center text-gray-700 dark:text-gray-200">2,50</td>
              <td class="p-2 border-2 border-cyan-400 dark:border-cyan-600 text-center">
                <input type="text" data-correct-answer="25" class="w-14 border-b-2 border-dotted border-gray-400 dark:border-gray-500 text-center font-bold bg-transparent dark:text-white">
              </td>
              <td class="p-2 border-2 border-cyan-400 dark:border-cyan-600 text-center bg-yellow-100 dark:bg-yellow-900/30">
                <input type="text" data-correct-answer="3,30" class="w-14 border-b-2 border-dotted border-gray-400 dark:border-gray-500 text-center font-bold bg-transparent dark:text-white">
              </td>
              <td class="p-2 border-2 border-cyan-400 dark:border-cyan-600 text-center">
                <input type="text" data-correct-answer="33" class="w-14 border-b-2 border-dotted border-gray-400 dark:border-gray-500 text-center font-bold bg-transparent dark:text-white">
              </td>
              <td class="p-2 border-2 border-cyan-400 dark:border-cyan-600 text-center text-gray-700 dark:text-gray-200">0,80</td>
              <td class="p-2 border-2 border-cyan-400 dark:border-cyan-600 text-center">
                <input type="text" data-correct-answer="8" class="w-14 border-b-2 border-dotted border-gray-400 dark:border-gray-500 text-center font-bold bg-transparent dark:text-white">
              </td>
            </tr>
            <!-- Latte -->
            <tr>
              <td class="p-2 border-2 border-cyan-400 dark:border-cyan-600 text-center text-gray-700 dark:text-gray-200">Latte</td>
              <td class="p-2 border-2 border-cyan-400 dark:border-cyan-600 text-center text-gray-700 dark:text-gray-200">5 bottiglie</td>
              <td class="p-2 border-2 border-cyan-400 dark:border-cyan-600 text-center text-gray-700 dark:text-gray-200">1,45</td>
              <td class="p-2 border-2 border-cyan-400 dark:border-cyan-600 text-center">
                <input type="text" data-correct-answer="7,25" class="w-14 border-b-2 border-dotted border-gray-400 dark:border-gray-500 text-center font-bold bg-transparent dark:text-white">
              </td>
              <td class="p-2 border-2 border-cyan-400 dark:border-cyan-600 text-center text-gray-700 dark:text-gray-200">2</td>
              <td class="p-2 border-2 border-cyan-400 dark:border-cyan-600 text-center">
                <input type="text" data-correct-answer="10" class="w-14 border-b-2 border-dotted border-gray-400 dark:border-gray-500 text-center font-bold bg-transparent dark:text-white">
              </td>
              <td class="p-2 border-2 border-cyan-400 dark:border-cyan-600 text-center bg-yellow-100 dark:bg-yellow-900/30">
                <input type="text" data-correct-answer="0,55" class="w-14 border-b-2 border-dotted border-gray-400 dark:border-gray-500 text-center font-bold bg-transparent dark:text-white">
              </td>
              <td class="p-2 border-2 border-cyan-400 dark:border-cyan-600 text-center">
                <input type="text" data-correct-answer="2,75" class="w-14 border-b-2 border-dotted border-gray-400 dark:border-gray-500 text-center font-bold bg-transparent dark:text-white">
              </td>
            </tr>
          </tbody>
        </table>
      </div>
    </div>

    <%= render 'shared/exercise_controls' %>
  </div>
</div>
