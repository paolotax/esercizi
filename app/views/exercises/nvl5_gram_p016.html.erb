<div class="max-w-6xl mx-auto bg-white dark:bg-gray-900 text-black dark:text-white p-3 md:p-6 transition-colors duration-300"
     data-controller="exercise-checker text-toggle font-controls"
     data-text-toggle-target="content"
     data-font-controls-target="content">

  <%= render 'shared/page_header', pagina: @pagina %>

  <div class="space-y-6">

  <!-- Info Box -->
  <div class="bg-yellow-100 dark:bg-yellow-900/30 rounded-lg p-4 md:p-6 leading-relaxed">
    <p class="mb-3 text-gray-800 dark:text-gray-200">
      L'<span class="font-bold text-cyan-700 dark:text-cyan-400">elisione</span> è l'eliminazione della vocale finale di una parola davanti a un'altra che inizia per vocale.
      Al posto della vocale eliminata si scrive <span class="font-bold">l'apostrofo</span>:
      un<span class="font-bold text-cyan-700 dark:text-cyan-400">a</span> idea <span class="font-bold text-cyan-700 dark:text-cyan-400">→</span> un<span class="font-bold text-cyan-700 dark:text-cyan-400">'</span>idea</span>.
    </p>
    <p class="text-gray-800 dark:text-gray-200 mb-3">Si usa l'apostrofo:</p>
    <ul class="space-y-2">
      <li class="flex items-start">
        <span class="text-cyan-700 dark:text-cyan-400 font-bold mr-2">•</span>
        <span class="text-gray-800 dark:text-gray-200">con gli articoli <strong class="text-cyan-700 dark:text-cyan-400">lo, la, una  →  l'</strong>albero, <strong class="text-cyan-700 dark:text-cyan-400">l'</strong>entrata, <strong class="text-cyan-700 dark:text-cyan-400">un'</strong>amica;</span>
      </li>
      <li class="flex items-start">
        <span class="text-cyan-700 dark:text-cyan-400 font-bold mr-2">•</span>
        <span class="text-gray-800 dark:text-gray-200">con alcuni aggettivi
        <strong class="text-cyan-700 dark:text-cyan-400"> →  quest'</strong> anno,
        <strong class="text-cyan-700 dark:text-cyan-400">quell'</strong> idea,
        <strong class="text-cyan-700 dark:text-cyan-400">bell'</strong> amico;</span>
      </li>
      <li class="flex items-start">
        <span class="text-cyan-700 dark:text-cyan-400 font-bold mr-2">•</span>
        <span class="text-gray-800 dark:text-gray-200">con <strong class="text-cyan-700 dark:text-cyan-400">mi, ti, ci, si, vi</strong> + verbo essere
        <strong class="text-cyan-700 dark:text-cyan-400"> →  m'</strong>è sembrato, <strong class="text-cyan-700 dark:text-cyan-400">c'</strong>era;</span>
      </li>
      <li class="flex items-start">
        <span class="text-cyan-700 dark:text-cyan-400 font-bold mr-2">•</span>
        <span class="text-gray-800 dark:text-gray-200">con <strong class="text-cyan-700 dark:text-cyan-400">come, dove</strong> + verbo essere
        <strong class="text-cyan-700 dark:text-cyan-400"> →  com'</strong>è, <strong class="text-cyan-700 dark:text-cyan-400">dov'</strong>era;</span>
      </li>
      <li class="flex items-start">
        <span class="text-cyan-700 dark:text-cyan-400 font-bold mr-2">•</span>
        <span class="text-gray-800 dark:text-gray-200">in espressioni
        <strong class="text-cyan-700 dark:text-cyan-400"> →  senz'</strong>altro, <strong class="text-cyan-700 dark:text-cyan-400">mezz'</strong>ora, <strong class="text-cyan-700 dark:text-cyan-400">d'</strong>accordo, <strong class="text-cyan-700 dark:text-cyan-400">tutt'</strong>altro…</span>
      </li>
    </ul>
  </div>

  <!-- Exercise 1 -->
  <div class="bg-white dark:bg-gray-800 rounded-lg p-4 md:p-6 border-4 border-yellow-400 dark:border-yellow-600" data-controller="fill-blanks">
    <h2 class="font-bold text-gray-800 dark:text-gray-200 mb-4 flex flex-wrap items-center gap-2">
      <span class="bg-blue-700 text-white rounded-full w-8 h-8 md:w-10 md:h-10 inline-flex items-center justify-center">1</span>
      <span class="bg-yellow-400 dark:bg-yellow-600 text-blue-800 dark:text-blue-200 px-2 py-1 rounded font-bold">IMPARARE TUTTI</span>
      <span>Scrivi inserendo l'<span class="font-bold text-cyan-700 dark:text-cyan-400">elisione</span>, come nell'esempio.</span>
    </h2>

    <div class="space-y-4 leading-relaxed">
      <div class="p-3 rounded-lg flex flex-wrap items-center gap-2">
        <span class="font-bold text-cyan-700 dark:text-cyan-400">Esempio:</span>
        <span class="text-gray-800 dark:text-gray-200">mezza ora → <span class="font-bold text-cyan-700 dark:text-cyan-400">mezz'ora</span></span>
      </div>

      <% exercise_1_pairs = [
        { prompt: 'di accordo', answer: 'd\'accordo' },
        { prompt: 'lo altro ieri', answer: 'l\'altro ieri' },
        { prompt: 'allo interno', answer: 'all\'interno' },
        { prompt: 'bravo uomo', answer: 'brav\'uomo' },
        { prompt: 'cento anni', answer: 'cent\'anni' }
      ] %>

      <% exercise_1_pairs.each do |item| %>
        <div class="px-3 py-1 rounded-lg flex flex-wrap items-center gap-2">
          <span class="text-gray-700 dark:text-gray-300"><span class="text-cyan-700 dark:text-cyan-400 font-bold mr-2">•</span> <%= item[:prompt] %> →</span>
          <input type="text"
                 class="border-b-2 border-pink-500 dark:border-pink-400 bg-transparent dark:text-white w-40 md:w-56 text-center focus:outline-none focus:border-pink-700"
                 data-fill-blanks-target="input"
                 data-answer="<%= item[:answer] %>"
                 data-correct-answer="<%= item[:answer] %>"
                 maxlength="20">
        </div>
      <% end %>
    </div>
  </div>

  <!-- Exercise 2 -->
  <div class="bg-white dark:bg-gray-800 rounded-lg p-4 md:p-6" data-controller="fill-blanks">
    <h2 class="font-bold text-gray-800 dark:text-gray-200 mb-4">
      <span class="bg-pink-600 text-white rounded-full w-8 h-8 md:w-10 md:h-10 inline-flex items-center justify-center mr-2">2</span>
      Sottolinea l'espressione cui può essere applicata l'<span class="font-bold text-cyan-700 dark:text-cyan-400">elisione</span> e scrivila con l'<span class="font-bold">apostrofo</span>.
    </h2>

    <% exercise_2_sentences = [
      [
        'Perché il film non ',
        { answer: 't\'è' },
        ' piaciuto? È stato divertente.'
      ],
      [
        'Raya ',
        { answer: 's\'era' },
        ' presentata puntualmente agli allenamenti, come ogni sera.'
      ],
      [
        'Allora ci vediamo alle cinque. Verrò ',
        { answer: 'senz\'altro' },
        '!'
      ],
      [
        'Meglio parlarne a quattro occhi, ',
        { answer: 'd\'accordo' },
        '. È un argomento importante.'
      ],
      [
        '',
        { answer: 'quell\'albero' },
        ' è il primo a fiorire, ',
        { answer: 'all\'inizio' },
        ' di marzo.'
      ]
    ] %>

    <div class="sm:ml-7 space-y-0 leading-relaxed">
      <% exercise_2_sentences.each do |sentence| %>
        <div class="px-3 py-1 rounded-lg flex flex-wrap items-center gap-1">
          <span class="text-cyan-700 dark:text-cyan-400 font-bold mr-2">•</span>
          <% sentence.each do |part| %>
            <% if part.is_a?(Hash) %>
              <input type="text"
                     class="border-b-2 border-pink-500 dark:border-pink-400 bg-transparent dark:text-white w-40 md:w-56 text-center focus:outline-none focus:border-pink-700"
                     data-fill-blanks-target="input"
                     data-answer="<%= part[:answer] %>"
                     data-correct-answer="<%= part[:answer] %>"
                     maxlength="20">
            <% else %>
              <span class="text-gray-800 dark:text-gray-200"><%= part %></span>
            <% end %>
          <% end %>
        </div>
      <% end %>
    </div>
  </div>

  <!-- Exercise 3 -->
  <div class="bg-white dark:bg-gray-800 rounded-lg p-4 md:p-6">
    <h2 class="font-bold text-gray-800 dark:text-gray-200 mb-4">
      <span class="bg-pink-600 text-white rounded-full w-8 h-8 md:w-10 md:h-10 inline-flex items-center justify-center mr-2">3</span>
      Scrivi sul quaderno una frase con ciascuna espressione.
    </h2>

    <div class="grid grid-cols-1 md:grid-cols-3 gap-4">
      <% [
        { label: "mezz'ora", color: 'from-pink-100 to-pink-50 dark:from-pink-900/30 dark:to-pink-900/10' },
        { label: "d'ora in poi", color: 'from-blue-100 to-blue-50 dark:from-blue-900/30 dark:to-blue-900/10' },
        { label: "d'altronde", color: 'from-purple-100 to-purple-50 dark:from-purple-900/30 dark:to-purple-900/10' }
      ].each do |item| %>
        <div class="bg-gradient-to-br <%= item[:color] %> border-2 border-pink-200 dark:border-pink-700 rounded-lg p-4">
          <div class="font-bold text-pink-700 dark:text-pink-400 uppercase tracking-wide mb-2"><%= item[:label] %></div>
          <textarea class="w-full border-2 border-pink-300 dark:border-pink-600 bg-white dark:bg-gray-700 dark:text-white rounded-lg p-3 focus:outline-none focus:border-pink-600 dark:focus:border-pink-400"
                    rows="3"
                    placeholder="Scrivi qui la tua frase..."></textarea>
        </div>
      <% end %>
    </div>
  </div>

  <!-- Exercise Controls -->
  <%= render 'shared/exercise_controls' %>
  </div><!-- chiude space-y-6 -->
</div>

