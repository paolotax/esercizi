<% content_for :titolo, "#{@pagina.titolo} - #{@pagina.numero}" %>

<div class="max-w-4xl mx-auto p-3 md:p-6 bg-white dark:bg-gray-900 text-black dark:text-white font-mono transition-colors duration-300"
     data-controller="exercise-checker page-viewer fill-blanks auto-advance text-toggle font-controls"
     data-page-viewer-image-url-value="<%= asset_path('bus3_mat/p113/page.png') %>"
     data-text-toggle-target="content"
     data-font-controls-target="content">

  <!-- Header -->
  <%= render 'shared/page_header', pagina: @pagina %>

  <!-- Esercizio 1 -->
  <div class="mb-16">
    <div class="flex items-start gap-3 mb-4">
      <div class="bg-red-500 text-white rounded-full w-8 h-8 flex items-center justify-center font-bold flex-shrink-0">1</div>
      <p class="text-gray-700 dark:text-gray-200"><strong>Scomponi come nell'esempio. Ricorda: il simbolo che rappresenta l'unità di misura si riferisce alla cifra delle unità.</strong></p>
    </div>

    <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
      <div class="space-y-2">
        <p>500 dg = <span class="text-blue-600 dark:text-blue-400">5 dag, 0 g, 0 dg</span></p>
        <p>546 dag = <input type="text" data-fill-blanks-target="input" data-correct-answer="5 kg 4 hg 6 dag" class="w-40 border-b-2 border-dotted border-gray-400 dark:border-gray-500 bg-transparent dark:text-white"></p>
        <p>891 g = <input type="text" data-fill-blanks-target="input" data-correct-answer="8 hg 9 dag 1 g" class="w-40 border-b-2 border-dotted border-gray-400 dark:border-gray-500 bg-transparent dark:text-white"></p>
        <p>5487 mg = <input type="text" data-fill-blanks-target="input" data-correct-answer="5 g 4 dg 8 cg 7 mg" class="w-40 border-b-2 border-dotted border-gray-400 dark:border-gray-500 bg-transparent dark:text-white"></p>
      </div>
      <div class="space-y-2">
        <p>1248 cg = <input type="text" data-fill-blanks-target="input" data-correct-answer="1 dag 2 g 4 dg 8 cg" class="w-40 border-b-2 border-dotted border-gray-400 dark:border-gray-500 bg-transparent dark:text-white"></p>
        <p>502 mg = <input type="text" data-fill-blanks-target="input" data-correct-answer="5 dg 0 cg 2 mg" class="w-40 border-b-2 border-dotted border-gray-400 dark:border-gray-500 bg-transparent dark:text-white"></p>
        <p>67 hg = <input type="text" data-fill-blanks-target="input" data-correct-answer="6 kg 7 hg" class="w-40 border-b-2 border-dotted border-gray-400 dark:border-gray-500 bg-transparent dark:text-white"></p>
        <p>3214 dg = <input type="text" data-fill-blanks-target="input" data-correct-answer="3 hg 2 dag 1 g 4 dg" class="w-40 border-b-2 border-dotted border-gray-400 dark:border-gray-500 bg-transparent dark:text-white"></p>
      </div>
    </div>
  </div>

  <!-- Esercizio 2 -->
  <div class="mb-16">
    <div class="flex items-start gap-3 mb-4">
      <div class="bg-red-500 text-white rounded-full w-8 h-8 flex items-center justify-center font-bold flex-shrink-0">2</div>
      <p class="text-gray-700 dark:text-gray-200"><strong>Componi come nell'esempio.</strong></p>
    </div>

    <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
      <div class="space-y-2">
        <p>1 dag, 6 g = <span class="text-blue-600 dark:text-blue-400">16</span> g</p>
        <p>8 g, 5 dg, 1 cg = <input type="text" data-fill-blanks-target="input" data-correct-answer="851" class="w-16 border-b-2 border-dotted border-gray-400 dark:border-gray-500 bg-transparent dark:text-white text-center"> cg</p>
        <p>7 hg, 4 dag = <input type="text" data-fill-blanks-target="input" data-correct-answer="74" class="w-16 border-b-2 border-dotted border-gray-400 dark:border-gray-500 bg-transparent dark:text-white text-center"> dag</p>
        <p>5 g, 5 dg, 12 mg = <input type="text" data-fill-blanks-target="input" data-correct-answer="5512" class="w-16 border-b-2 border-dotted border-gray-400 dark:border-gray-500 bg-transparent dark:text-white text-center"> mg</p>
        <p>4 g, 3 dg, 1 cg = <input type="text" data-fill-blanks-target="input" data-correct-answer="431" class="w-16 border-b-2 border-dotted border-gray-400 dark:border-gray-500 bg-transparent dark:text-white text-center"> cg</p>
      </div>
    </div>
  </div>

  <!-- Esercizio 3 -->
  <div class="mb-16">
    <div class="flex items-start gap-3 mb-4">
      <div class="bg-red-500 text-white rounded-full w-8 h-8 flex items-center justify-center font-bold flex-shrink-0">3</div>
      <p class="text-gray-700 dark:text-gray-200"><strong>Esegui le equivalenze.</strong></p>
    </div>

    <div class="grid grid-cols-2 md:grid-cols-3 gap-4">
      <p>600 dg = <input type="text" data-fill-blanks-target="input" data-correct-answer="60" class="w-16 border-b-2 border-dotted border-gray-400 dark:border-gray-500 bg-transparent dark:text-white text-center"> dag</p>
      <p>540 g = <input type="text" data-fill-blanks-target="input" data-correct-answer="54" class="w-16 border-b-2 border-dotted border-gray-400 dark:border-gray-500 bg-transparent dark:text-white text-center"> dag</p>
      <p>450 g = <input type="text" data-fill-blanks-target="input" data-correct-answer="45" class="w-16 border-b-2 border-dotted border-gray-400 dark:border-gray-500 bg-transparent dark:text-white text-center"> dg</p>
      <p>90 hg = <input type="text" data-fill-blanks-target="input" data-correct-answer="9" class="w-16 border-b-2 border-dotted border-gray-400 dark:border-gray-500 bg-transparent dark:text-white text-center"> kg</p>
      <p>550 g = 55 <input type="text" data-fill-blanks-target="input" data-correct-answer="dag" class="w-16 border-b-2 border-dotted border-gray-400 dark:border-gray-500 bg-transparent dark:text-white text-center"></p>
      <p>5700 mg = 570 <input type="text" data-fill-blanks-target="input" data-correct-answer="cg" class="w-16 border-b-2 border-dotted border-gray-400 dark:border-gray-500 bg-transparent dark:text-white text-center"></p>
      <p>83 g = <input type="text" data-fill-blanks-target="input" data-correct-answer="8,3" class="w-16 border-b-2 border-dotted border-gray-400 dark:border-gray-500 bg-transparent dark:text-white text-center"> dg</p>
      <p>2 kg = <input type="text" data-fill-blanks-target="input" data-correct-answer="20" class="w-16 border-b-2 border-dotted border-gray-400 dark:border-gray-500 bg-transparent dark:text-white text-center"> hg</p>
      <p>4000 g = <input type="text" data-fill-blanks-target="input" data-correct-answer="4" class="w-16 border-b-2 border-dotted border-gray-400 dark:border-gray-500 bg-transparent dark:text-white text-center"> kg</p>
      <p>64 hg = <input type="text" data-fill-blanks-target="input" data-correct-answer="640" class="w-16 border-b-2 border-dotted border-gray-400 dark:border-gray-500 bg-transparent dark:text-white text-center"> dag</p>
    </div>
  </div>

  <!-- Esercizio 4 -->
  <div class="mb-16">
    <div class="flex items-start gap-3 mb-4">
      <div class="bg-red-500 text-white rounded-full w-8 h-8 flex items-center justify-center font-bold flex-shrink-0">4</div>
      <p class="text-gray-700 dark:text-gray-200"><strong>Completa le addizioni. Poi fai l'equivalenza.</strong></p>
    </div>

    <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
      <p>30 dg + 50 dg = <input type="text" data-fill-blanks-target="input" data-correct-answer="80" class="w-16 border-b-2 border-dotted border-gray-400 dark:border-gray-500 bg-transparent dark:text-white text-center"> dg → <input type="text" data-fill-blanks-target="input" data-correct-answer="8" class="w-16 border-b-2 border-dotted border-gray-400 dark:border-gray-500 bg-transparent dark:text-white text-center"> g</p>
      <p>2500 mg + 500 mg = <input type="text" data-fill-blanks-target="input" data-correct-answer="3000" class="w-16 border-b-2 border-dotted border-gray-400 dark:border-gray-500 bg-transparent dark:text-white text-center"> mg → 300 <input type="text" data-fill-blanks-target="input" data-correct-answer="cg" class="w-16 border-b-2 border-dotted border-gray-400 dark:border-gray-500 bg-transparent dark:text-white text-center"></p>
      <p>10 kg + 3 kg = <input type="text" data-fill-blanks-target="input" data-correct-answer="13" class="w-16 border-b-2 border-dotted border-gray-400 dark:border-gray-500 bg-transparent dark:text-white text-center"> kg → <input type="text" data-fill-blanks-target="input" data-correct-answer="130" class="w-16 border-b-2 border-dotted border-gray-400 dark:border-gray-500 bg-transparent dark:text-white text-center"> dag</p>
      <p>200 g + 200 g + 100 g = <input type="text" data-fill-blanks-target="input" data-correct-answer="500" class="w-16 border-b-2 border-dotted border-gray-400 dark:border-gray-500 bg-transparent dark:text-white text-center"> g → <input type="text" data-fill-blanks-target="input" data-correct-answer="50" class="w-16 border-b-2 border-dotted border-gray-400 dark:border-gray-500 bg-transparent dark:text-white text-center"> dg</p>
    </div>
  </div>

  <!-- Box TUTTI A TAVOLA -->
  <div class="bg-green-50 dark:bg-green-900/30 border-2 border-green-300 dark:border-green-600 rounded-lg p-4 mb-8">
    <div class="flex items-center gap-2 mb-3">
      <span class="bg-green-500 text-white px-2 py-1 rounded font-bold">mate VIVA</span>
      <span class="font-bold text-green-700 dark:text-green-400">TUTTI A TAVOLA!</span>
    </div>
    <p class="mb-2">Hai invitato a casa 5 amici e vuoi preparare per loro e per te gli spaghetti. Se la dose di spaghetti per una persona è 80 grammi, ti basta una confezione da mezzo chilo?</p>
    <div class="flex gap-4 mb-2">
      <label class="flex items-center gap-2">
        <input type="radio" name="spaghetti" value="si"> Sì
      </label>
      <label class="flex items-center gap-2">
        <input type="radio" name="spaghetti" value="no"> No
      </label>
    </div>
    <p>• Perché? <input type="text" data-fill-blanks-target="input" data-correct-answer="6 × 80 = 480 g" class="w-full border-b-2 border-dotted border-gray-400 dark:border-gray-500 bg-transparent dark:text-white"></p>
  </div>

  <!-- Quaderno -->
  <div class="p-4 mb-8 text-right">
    <span class="text-gray-600 dark:text-gray-400">Quaderno →</span> <span class="text-blue-600 dark:text-blue-400 font-bold">p. 169</span>
  </div>

  <%= render 'shared/exercise_controls' %>
</div>
