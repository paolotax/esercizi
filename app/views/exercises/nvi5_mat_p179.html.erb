<div class="max-w-6xl mx-auto bg-white p-3 md:p-6"
     data-controller="exercise-checker text-toggle font-controls"
     data-text-toggle-target="content"
     data-font-controls-target="content">

  <%= render 'shared/page_header', pagina: @pagina %>

  <div class="space-y-6">
    <div class="p-4 md:p-6 bg-<%= @pagina.base_color %>-100 rounded-lg">
      <!-- Esercizio 1: IMPARARE TUTTI -->
      <div class="p-4 bg-white rounded-2xl -mx-4 md:-mx-6 -mt-4 md:-mt-6 mb-6 border-3 border-blue-500">
        <p class="font-bold text-gray-700 mb-4">
          <%= imparare_tutti_badge(1) %>
          Completa facendo attenzione al valore posizionale di ogni cifra.
        </p>

        <div class="overflow-x-auto">
          <table class="w-full border-collapse border border-gray-300">
            <thead>
              <tr>
                <th rowspan="2" class="p-2 border border-gray-300 bg-gray-50"></th>
                <th colspan="6" class="p-2 border border-gray-300 bg-<%= @pagina.base_color %>-100 text-center font-bold">PARTE INTERA</th>
                <th rowspan="2" class="p-2 border border-gray-300 bg-gray-50 text-center font-bold">,</th>
                <th colspan="3" class="p-2 border border-gray-300 bg-green-100 text-center font-bold">PARTE DECIMALE</th>
              </tr>
              <tr>
                <th class="p-2 border border-gray-300 bg-<%= @pagina.base_color %>-50 text-center font-bold">hk</th>
                <th class="p-2 border border-gray-300 bg-<%= @pagina.base_color %>-50 text-center font-bold">dak</th>
                <th class="p-2 border border-gray-300 bg-<%= @pagina.base_color %>-50 text-center font-bold">uk</th>
                <th class="p-2 border border-gray-300 bg-<%= @pagina.base_color %>-50 text-center font-bold">h</th>
                <th class="p-2 border border-gray-300 bg-<%= @pagina.base_color %>-50 text-center font-bold">da</th>
                <th class="p-2 border border-gray-300 bg-<%= @pagina.base_color %>-50 text-center font-bold">u</th>
                <th class="p-2 border border-gray-300 bg-green-50 text-center font-bold">d</th>
                <th class="p-2 border border-gray-300 bg-green-50 text-center font-bold">c</th>
                <th class="p-2 border border-gray-300 bg-green-50 text-center font-bold">m</th>
              </tr>
            </thead>
            <tbody>
              <!-- Esempio: 10,103 -->
              <tr>
                <td class="p-2 border border-gray-300 bg-gray-50 font-bold">10,103</td>
                <td class="p-2 border border-gray-300 text-center bg-white"></td>
                <td class="p-2 border border-gray-300 text-center bg-white"></td>
                <td class="p-2 border border-gray-300 text-center bg-white"></td>
                <td class="p-2 border border-gray-300 text-center bg-white"></td>
                <td class="p-2 border border-gray-300 text-center bg-white font-bold text-<%= @pagina.base_color %>-600">1</td>
                <td class="p-2 border border-gray-300 text-center bg-white font-bold text-<%= @pagina.base_color %>-600">0</td>
                <td class="p-2 border border-gray-300 text-center bg-gray-50">,</td>
                <td class="p-2 border border-gray-300 text-center bg-white font-bold text-<%= @pagina.base_color %>-600">1</td>
                <td class="p-2 border border-gray-300 text-center bg-white font-bold text-<%= @pagina.base_color %>-600">0</td>
                <td class="p-2 border border-gray-300 text-center bg-white font-bold text-<%= @pagina.base_color %>-600">3</td>
              </tr>
              <!-- Da completare -->
              <% ["1 457,08", "28 480,127", "184,02", "165 489,435", "4 562,103", "1 089,2"].each do |num| %>
                <tr>
                  <td class="p-2 border border-gray-300 bg-gray-50"><%= num %></td>
                  <% 6.times do %>
                    <td class="p-2 border border-gray-300 text-center bg-white">
                      <input type="text" class="w-6 text-center border-b border-dotted border-gray-400 bg-transparent">
                    </td>
                  <% end %>
                  <td class="p-2 border border-gray-300 text-center bg-gray-50">,</td>
                  <% 3.times do %>
                    <td class="p-2 border border-gray-300 text-center bg-white">
                      <input type="text" class="w-6 text-center border-b border-dotted border-gray-400 bg-transparent">
                    </td>
                  <% end %>
                </tr>
              <% end %>
            </tbody>
          </table>
        </div>
      </div>

      <!-- Layout 2 colonne -->
      <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
        <!-- Colonna sinistra -->
        <div class="space-y-6">
          <!-- Esercizio 2 -->
          <div>
            <p class="font-bold text-gray-700 mb-4">
              <%= numero_esercizio_badge(2) %>
              Componi i numeri decimali e inserisci gli zeri se necessario. Segui l'esempio.
            </p>

            <div class="space-y-3">
              <div class="flex items-center gap-2 flex-wrap p-2 bg-<%= @pagina.base_color %>-50 rounded">
                <span class="font-bold">4 u 1 d 9 m</span>
                <span class="text-<%= @pagina.base_color %>-500">→</span>
                <span class="font-bold text-<%= @pagina.base_color %>-600">4,109</span>
              </div>
              <% [
                ["8 da 3 u 7 d 2 c", "83,72"],
                ["5 da 6 d 1 c", "50,61"],
                ["2 u 1 c 7 m", "2,017"],
                ["5 h 8 d 4 c", "500,84"],
                ["6 h 6 u 8 m", "606,008"]
              ].each do |expr, answer| %>
                <div class="flex items-center gap-2 flex-wrap">
                  <span class="text-gray-700"><%= expr %></span>
                  <span class="text-<%= @pagina.base_color %>-500">→</span>
                  <input type="text" data-correct-answer="<%= answer %>" class="w-24 border-b-2 border-dotted border-gray-400 text-center font-bold bg-transparent">
                </div>
              <% end %>
            </div>
          </div>

          <!-- Esercizio 3 -->
          <div>
            <p class="font-bold text-gray-700 mb-4">
              <%= numero_esercizio_badge(3) %>
              Scrivi in cifre i numeri decimali.
            </p>

            <div class="space-y-3">
              <% [
                ["sedici centesimi", "0,16"],
                ["sette decimi", "0,7"],
                ["ottocentoventi millesimi", "0,820"],
                ["ventuno unità e nove centesimi", "21,09"],
                ["centodue unità e quattro millesimi", "102,004"],
                ["undici unità e sei decimi", "11,6"]
              ].each do |word, answer| %>
                <div class="flex items-center gap-2 flex-wrap">
                  <span class="text-gray-700"><%= word %></span>
                  <span class="text-<%= @pagina.base_color %>-500">→</span>
                  <input type="text" data-correct-answer="<%= answer %>" class="w-24 border-b-2 border-dotted border-gray-400 text-center font-bold bg-transparent">
                </div>
              <% end %>
            </div>
          </div>
        </div>

        <!-- Colonna destra -->
        <div class="space-y-6">
          <!-- Esercizio 4 -->
          <div>
            <p class="font-bold text-gray-700 mb-4">
              <%= numero_esercizio_badge(4) %>
              Controlla le uguaglianze, individua gli eventuali errori e correggi.
            </p>

            <div class="space-y-4">
              <% [
                ["85/10", "8,5", "8,5"],
                ["41/1000", "0,41", "0,041"],
                ["26/100", "2,6", "0,26"]
              ].each do |fraz, sbagliato, corretto| %>
                <div class="flex items-center gap-2 flex-wrap p-3 bg-white rounded-lg">
                  <%= render 'shared/frazione', num: fraz.split('/')[0].to_i, den: fraz.split('/')[1].to_i %>
                  <span class="mx-2">=</span>
                  <span class="text-gray-700"><%= sbagliato %></span>
                  <span class="text-<%= @pagina.base_color %>-500 mx-2">→</span>
                  <input type="text" data-correct-answer="<%= corretto %>" class="w-20 border-b-2 border-dotted border-gray-400 text-center font-bold bg-transparent">
                </div>
              <% end %>
            </div>
          </div>

          <!-- Esercizio 5 -->
          <div>
            <p class="font-bold text-gray-700 mb-4">
              <%= numero_esercizio_badge(5) %>
              Completa la tabella come nell'esempio.
            </p>

            <div class="overflow-x-auto">
              <table class="w-full border-collapse border border-gray-300">
                <thead>
                  <tr>
                    <th class="p-2 border border-gray-300 bg-gray-50 text-center font-bold">Frazione</th>
                    <th class="p-2 border border-gray-300 bg-gray-50 text-center font-bold">Numero</th>
                    <th class="p-2 border border-gray-300 bg-gray-50 text-center font-bold">da</th>
                    <th class="p-2 border border-gray-300 bg-gray-50 text-center font-bold">u</th>
                    <th class="p-2 border border-gray-300 bg-gray-50 text-center font-bold">,</th>
                    <th class="p-2 border border-gray-300 bg-gray-50 text-center font-bold">d</th>
                    <th class="p-2 border border-gray-300 bg-gray-50 text-center font-bold">c</th>
                    <th class="p-2 border border-gray-300 bg-gray-50 text-center font-bold">m</th>
                    <th class="p-2 border border-gray-300 bg-gray-50 text-center font-bold">Numero in lettere</th>
                  </tr>
                </thead>
                <tbody>
                  <!-- Esempio: 24/100 -->
                  <tr>
                    <td class="p-2 border border-gray-300 text-center bg-<%= @pagina.base_color %>-50">
                      <%= render 'shared/frazione', num: 24, den: 100 %>
                    </td>
                    <td class="p-2 border border-gray-300 text-center bg-<%= @pagina.base_color %>-50 font-bold">0,24</td>
                    <td class="p-2 border border-gray-300 text-center bg-<%= @pagina.base_color %>-50"></td>
                    <td class="p-2 border border-gray-300 text-center bg-<%= @pagina.base_color %>-50 font-bold">0</td>
                    <td class="p-2 border border-gray-300 text-center bg-<%= @pagina.base_color %>-50">,</td>
                    <td class="p-2 border border-gray-300 text-center bg-<%= @pagina.base_color %>-50 font-bold">2</td>
                    <td class="p-2 border border-gray-300 text-center bg-<%= @pagina.base_color %>-50 font-bold">4</td>
                    <td class="p-2 border border-gray-300 text-center bg-<%= @pagina.base_color %>-50"></td>
                    <td class="p-2 border border-gray-300 text-center bg-<%= @pagina.base_color %>-50 font-bold">ventiquattro centesimi</td>
                  </tr>
                  <!-- 9/10 -->
                  <tr>
                    <td class="p-2 border border-gray-300 text-center bg-white">
                      <%= render 'shared/frazione', num: 9, den: 10 %>
                    </td>
                    <td class="p-2 border border-gray-300 text-center bg-white">
                      <input type="text" data-correct-answer="0,9" class="w-12 text-center border-b border-dotted border-gray-400 bg-transparent">
                    </td>
                    <td class="p-2 border border-gray-300 text-center bg-white">
                      <input type="text" class="w-6 text-center border-b border-dotted border-gray-400 bg-transparent">
                    </td>
                    <td class="p-2 border border-gray-300 text-center bg-white">
                      <input type="text" class="w-6 text-center border-b border-dotted border-gray-400 bg-transparent">
                    </td>
                    <td class="p-2 border border-gray-300 text-center bg-white">,</td>
                    <td class="p-2 border border-gray-300 text-center bg-white">
                      <input type="text" class="w-6 text-center border-b border-dotted border-gray-400 bg-transparent">
                    </td>
                    <td class="p-2 border border-gray-300 text-center bg-white">
                      <input type="text" class="w-6 text-center border-b border-dotted border-gray-400 bg-transparent">
                    </td>
                    <td class="p-2 border border-gray-300 text-center bg-white">
                      <input type="text" class="w-6 text-center border-b border-dotted border-gray-400 bg-transparent">
                    </td>
                    <td class="p-2 border border-gray-300 text-center bg-white">
                      <input type="text" class="w-28 text-center border-b border-dotted border-gray-400 bg-transparent">
                    </td>
                  </tr>
                  <!-- 56/1000 -->
                  <tr>
                    <td class="p-2 border border-gray-300 text-center bg-white">
                      <%= render 'shared/frazione', num: 56, den: 1000 %>
                    </td>
                    <td class="p-2 border border-gray-300 text-center bg-white">
                      <input type="text" data-correct-answer="0,056" class="w-12 text-center border-b border-dotted border-gray-400 bg-transparent">
                    </td>
                    <td class="p-2 border border-gray-300 text-center bg-white">
                      <input type="text" class="w-6 text-center border-b border-dotted border-gray-400 bg-transparent">
                    </td>
                    <td class="p-2 border border-gray-300 text-center bg-white">
                      <input type="text" class="w-6 text-center border-b border-dotted border-gray-400 bg-transparent">
                    </td>
                    <td class="p-2 border border-gray-300 text-center bg-white">,</td>
                    <td class="p-2 border border-gray-300 text-center bg-white">
                      <input type="text" class="w-6 text-center border-b border-dotted border-gray-400 bg-transparent">
                    </td>
                    <td class="p-2 border border-gray-300 text-center bg-white">
                      <input type="text" class="w-6 text-center border-b border-dotted border-gray-400 bg-transparent">
                    </td>
                    <td class="p-2 border border-gray-300 text-center bg-white">
                      <input type="text" class="w-6 text-center border-b border-dotted border-gray-400 bg-transparent">
                    </td>
                    <td class="p-2 border border-gray-300 text-center bg-white">
                      <input type="text" class="w-28 text-center border-b border-dotted border-gray-400 bg-transparent">
                    </td>
                  </tr>
                </tbody>
              </table>
            </div>
          </div>
        </div>
      </div>
    </div>

    <%= render 'shared/exercise_controls' %>
  </div>
</div>
