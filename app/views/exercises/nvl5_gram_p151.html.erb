<div class="max-w-6xl mx-auto p-3 md:p-8 bg-white" data-controller="exercise-checker">

  <%= render 'shared/page_header', pagina: @pagina %>

  <!-- Exercise 3: Substitute with altered nouns -->
  <div class="mb-6 bg-<%= @pagina.base_color %>-50 rounded-lg p-4 md:p-6" data-controller="fill-blanks">
    <h2 class="text-lg md:text-xl font-bold text-<%= @pagina.base_color %>-700 mb-4 flex items-center gap-2">
      <span class="bg-<%= @pagina.base_color %>-500 text-white rounded-full w-8 h-8 md:w-10 md:h-10 inline-flex items-center justify-center text-sm font-bold">3</span>
      <span>Sostituisci alle seguenti espressioni un <span class="text-<%= @pagina.base_color %>-600 font-bold">alterato</span> adatto.</span>
    </h2>

    <% alterations = [
      { expression: "pioggia leggera", altered: "pioggerella" },
      { expression: "vento leggero", altered: "ventolino" },
      { expression: "piede grosso", altered: "piedone" },
      { expression: "voce sgraziata", altered: "vociaccia" },
      { expression: "vino leggero", altered: "vinello" },
      { expression: "pesce grosso", altered: "pescione" },
      { expression: "roba vecchia", altered: "robaccia" },
      { expression: "bocca graziosa", altered: "boccuccia" },
      { expression: "piccolo cane", altered: "cagnolino" },
      { expression: "taglio piccolo", altered: "taglietto" },
      { expression: "brutto colpo", altered: "colpaccio" },
      { expression: "piccola poltrona", altered: "poltroncina" },
      { expression: "piccolo asino", altered: "asinello" },
      { expression: "naso piccolo", altered: "nasino" }
    ] %>

    <div class="grid grid-cols-1 sm:grid-cols-2 gap-3 text-base md:text-lg">
      <% alterations.each do |item| %>
        <div class="flex items-center gap-3 bg-white rounded-lg p-3">
          <span class="text-<%= @pagina.base_color %>-600 font-bold">•</span>
          <span class="text-gray-700 font-semibold"><%= item[:expression] %></span>
          <span class="text-gray-400">→</span>
          <input type="text"
                 class="border-b-2 border-dotted border-gray-400 bg-transparent px-2 py-1 focus:outline-none focus:border-<%= @pagina.base_color %>-500 flex-grow"
                 data-fill-blanks-target="input"
                 data-answer="<%= item[:altered] %>"
                 data-correct-answer="<%= item[:altered] %>">
        </div>
      <% end %>
    </div>
  </div>

  <!-- Exercise 4: Underline with colors -->
  <div class="mb-6 bg-<%= @pagina.base_color %>-50 rounded-lg p-4 md:p-6" data-controller="word-highlighter" data-word-highlighter-multi-color-value="true">
    <h2 class="text-lg md:text-xl font-bold text-<%= @pagina.base_color %>-700 mb-4 flex items-center gap-2">
      <span class="bg-<%= @pagina.base_color %>-500 text-white rounded-full w-8 h-8 md:w-10 md:h-10 inline-flex items-center justify-center text-sm font-bold">4</span>
      <span>Sottolinea in rosso i <span class="text-red-600 font-bold">nomi primitivi<span class="inline-block w-6 h-6 bg-red-300 rounded ml-1 align-middle cursor-pointer" data-word-highlighter-target="colorBox" data-color="red" data-action="click->word-highlighter#selectColor"></span></span>, in verde i <span class="text-green-600 font-bold">derivati<span class="inline-block w-6 h-6 bg-green-300 rounded ml-1 align-middle cursor-pointer" data-word-highlighter-target="colorBox" data-color="green" data-action="click->word-highlighter#selectColor"></span></span>, in blu gli <span class="text-blue-600 font-bold">alterati<span class="inline-block w-6 h-6 bg-blue-300 rounded ml-1 align-middle cursor-pointer" data-word-highlighter-target="colorBox" data-color="blue" data-action="click->word-highlighter#selectColor"></span></span>.</span>
    </h2>

    <div class="bg-white rounded-lg px-4 py-4 text-base md:text-lg text-gray-700 leading-relaxed">
      <p>
        <span data-word-highlighter-target="word" data-correct-color="blue" data-action="click->word-highlighter#toggleHighlight" class="px-1 rounded">pastorello</span> •
        <span data-word-highlighter-target="word" data-correct-color="green" data-action="click->word-highlighter#toggleHighlight" class="px-1 rounded">manubrio</span> •
        <span data-word-highlighter-target="word" data-correct-color="green" data-action="click->word-highlighter#toggleHighlight" class="px-1 rounded">ombrello</span> •
        <span data-word-highlighter-target="word" data-correct-color="green" data-action="click->word-highlighter#toggleHighlight" class="px-1 rounded">mareggiata</span> •
        <span data-word-highlighter-target="word" data-correct-color="green" data-action="click->word-highlighter#toggleHighlight" class="px-1 rounded">nevicata</span> •
        <span data-word-highlighter-target="word" data-correct-color="blue" data-action="click->word-highlighter#toggleHighlight" class="px-1 rounded">nonnina</span> •
        <span data-word-highlighter-target="word" data-correct-color="red" data-action="click->word-highlighter#toggleHighlight" class="px-1 rounded">avvoltoio</span> •
        <span data-word-highlighter-target="word" data-correct-color="green" data-action="click->word-highlighter#toggleHighlight" class="px-1 rounded">ottone</span> •
        <span data-word-highlighter-target="word" data-correct-color="blue" data-action="click->word-highlighter#toggleHighlight" class="px-1 rounded">orsacchiotto</span> •
        <span data-word-highlighter-target="word" data-correct-color="green" data-action="click->word-highlighter#toggleHighlight" class="px-1 rounded">timone</span> •
        <span data-word-highlighter-target="word" data-correct-color="green" data-action="click->word-highlighter#toggleHighlight" class="px-1 rounded">ventata</span> •
        <span data-word-highlighter-target="word" data-correct-color="blue" data-action="click->word-highlighter#toggleHighlight" class="px-1 rounded">semino</span> •
        <span data-word-highlighter-target="word" data-correct-color="blue" data-action="click->word-highlighter#toggleHighlight" class="px-1 rounded">gabbietta</span> •
        <span data-word-highlighter-target="word" data-correct-color="green" data-action="click->word-highlighter#toggleHighlight" class="px-1 rounded">ghiacciaia</span> •
        <span data-word-highlighter-target="word" data-correct-color="green" data-action="click->word-highlighter#toggleHighlight" class="px-1 rounded">braciere</span> •
        <span data-word-highlighter-target="word" data-correct-color="green" data-action="click->word-highlighter#toggleHighlight" class="px-1 rounded">bracciale</span> •
        <span data-word-highlighter-target="word" data-correct-color="red" data-action="click->word-highlighter#toggleHighlight" class="px-1 rounded">bicchiere</span> •
        <span data-word-highlighter-target="word" data-correct-color="green" data-action="click->word-highlighter#toggleHighlight" class="px-1 rounded">rubinetto</span> •
        <span data-word-highlighter-target="word" data-correct-color="green" data-action="click->word-highlighter#toggleHighlight" class="px-1 rounded">fazzoletto</span> •
        <span data-word-highlighter-target="word" data-correct-color="green" data-action="click->word-highlighter#toggleHighlight" class="px-1 rounded">rotaia</span> •
        <span data-word-highlighter-target="word" data-correct-color="red" data-action="click->word-highlighter#toggleHighlight" class="px-1 rounded">piccione</span> •
        <span data-word-highlighter-target="word" data-correct-color="blue" data-action="click->word-highlighter#toggleHighlight" class="px-1 rounded">vermiciattolo</span> •
        <span data-word-highlighter-target="word" data-correct-color="green" data-action="click->word-highlighter#toggleHighlight" class="px-1 rounded">risaia</span> •
        <span data-word-highlighter-target="word" data-correct-color="blue" data-action="click->word-highlighter#toggleHighlight" class="px-1 rounded">muretto</span>
      </p>
    </div>
  </div>

  <!-- Exercise 5: Derived and altered from primitive -->
  <div class="mb-6 bg-<%= @pagina.base_color %>-50 rounded-lg p-4 md:p-6" data-controller="fill-blanks">
    <h2 class="text-lg md:text-xl font-bold text-<%= @pagina.base_color %>-700 mb-4 flex items-center gap-2">
      <span class="bg-<%= @pagina.base_color %>-500 text-white rounded-full w-8 h-8 md:w-10 md:h-10 inline-flex items-center justify-center text-sm font-bold">5</span>
      <span>Per ciascuno di questi nomi scrivi un <span class="text-<%= @pagina.base_color %>-600 font-bold">nome derivato</span> (D) e un <span class="text-<%= @pagina.base_color %>-600 font-bold">nome alterato</span> (A).</span>
    </h2>

    <% noun_pairs = [
      { primitive: "scarpa", derived: "scarpiera", altered: "scarpina" },
      { primitive: "cavallo", derived: "cavalleria", altered: "cavallino" },
      { primitive: "giardino", derived: "giardiniere", altered: "giardinetto" },
      { primitive: "occhio", derived: "occhiali", altered: "occhietto" },
      { primitive: "maglia", derived: "maglieria", altered: "maglietta" },
      { primitive: "dente", derived: "dentista", altered: "dentino" },
      { primitive: "fiore", derived: "fiorista", altered: "fiorellino" },
      { primitive: "pesce", derived: "pescatore", altered: "pesciolino" }
    ] %>

    <div class="grid grid-cols-1 md:grid-cols-2 gap-6 text-base md:text-lg">
      <% noun_pairs.each do |item| %>
        <div class="bg-white rounded-lg p-4">
          <div class="flex items-center gap-3 mb-3">
            <div class="bg-<%= @pagina.base_color %>-500 text-white font-bold px-4 py-2 rounded-lg text-center min-w-[100px]">
              <%= item[:primitive] %>
            </div>
            <div class="flex-1">
              <div class="flex items-center gap-2 mb-2">
                <span class="text-<%= @pagina.base_color %>-500">→</span>
                <span class="bg-<%= @pagina.base_color %>-100 px-2 py-1 rounded font-semibold text-sm">D</span>
                <input type="text"
                       class="border-b-2 border-dotted border-gray-400 bg-transparent px-2 py-1 focus:outline-none focus:border-<%= @pagina.base_color %>-500 flex-1"
                       data-fill-blanks-target="input"
                       data-answer="<%= item[:derived] %>">
              </div>
              <div class="flex items-center gap-2">
                <span class="text-<%= @pagina.base_color %>-500">→</span>
                <span class="bg-<%= @pagina.base_color %>-100 px-2 py-1 rounded font-semibold text-sm">A</span>
                <input type="text"
                       class="border-b-2 border-dotted border-gray-400 bg-transparent px-2 py-1 focus:outline-none focus:border-<%= @pagina.base_color %>-500 flex-1"
                       data-fill-blanks-target="input"
                       data-answer="<%= item[:altered] %>">
              </div>
            </div>
          </div>
        </div>
      <% end %>
    </div>
  </div>

  <%= render 'shared/exercise_controls' %>

</div>
