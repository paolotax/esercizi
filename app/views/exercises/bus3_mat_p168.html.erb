<% content_for :titolo, "#{@pagina.titolo} - #{@pagina.numero}" %>

<div class="max-w-7xl mx-auto p-3 md:p-6 bg-white font-mono"
     data-controller="exercise-checker page-viewer text-toggle font-controls"
     data-page-viewer-image-url-value="<%= asset_path('bus3_mat/p168/page.png') %>"
     data-text-toggle-target="content"
     data-font-controls-target="content">

  <!-- Header -->
  <%= render 'shared/page_header', pagina: @pagina %>

  <!-- Tabella misure di capacità -->
  <div class="overflow-x-auto mb-8">
    <table class="w-full border-collapse border border-gray-400">
      <thead>
        <tr>
          <th colspan="2" class="border border-gray-400 bg-cyan-100 px-2 py-1">MULTIPLI</th>
          <th class="border border-gray-400 bg-cyan-200 px-2 py-1">UNITÀ FONDAMENTALE</th>
          <th colspan="3" class="border border-gray-400 bg-cyan-100 px-2 py-1">SOTTOMULTIPLI</th>
        </tr>
        <tr class="text-cyan-600">
          <th class="border border-gray-400 px-2 py-1">ETTOLITRO<br>hl</th>
          <th class="border border-gray-400 px-2 py-1">DECALITRO<br>dal</th>
          <th class="border border-gray-400 bg-cyan-50 px-2 py-1">LITRO<br>l</th>
          <th class="border border-gray-400 px-2 py-1">DECILITRO<br>dl</th>
          <th class="border border-gray-400 px-2 py-1">CENTILITRO<br>cl</th>
          <th class="border border-gray-400 px-2 py-1">MILLILITRO<br>ml</th>
        </tr>
      </thead>
      <tbody>
        <tr class="text-center">
          <td class="border border-gray-400 px-2 py-1">100 l</td>
          <td class="border border-gray-400 px-2 py-1">10 l</td>
          <td class="border border-gray-400 bg-cyan-50 px-2 py-1">1 l</td>
          <td class="border border-gray-400 px-2 py-1">0,1 l</td>
          <td class="border border-gray-400 px-2 py-1">0,01 l</td>
          <td class="border border-gray-400 px-2 py-1">0,001 l</td>
        </tr>
      </tbody>
    </table>
  </div>

  <!-- Esercizio 1 -->
  <div class="mb-12" data-controller="fill-blanks auto-advance">
    <div class="flex items-start gap-3 mb-6">
      <div class="bg-red-500 text-white rounded-full w-8 h-8 flex items-center justify-center font-bold flex-shrink-0">
        1
      </div>
      <p class="text-gray-700">
        <strong>Esegui le equivalenze.</strong>
      </p>
    </div>

    <div class="grid grid-cols-1 md:grid-cols-3 gap-4">
      <div class="space-y-3">
        <p>300 cl =
          <input type="text" data-fill-blanks-target="input" data-correct-answer="3"
                 class="w-16 px-1 py-1 border-b-2 border-dotted border-gray-400 text-center bg-white" inputmode="numeric"> l
        </p>
        <p>5 dal =
          <input type="text" data-fill-blanks-target="input" data-correct-answer="50"
                 class="w-16 px-1 py-1 border-b-2 border-dotted border-gray-400 text-center bg-white" inputmode="numeric"> l
        </p>
        <p>60 hl =
          <input type="text" data-fill-blanks-target="input" data-correct-answer="6000"
                 class="w-16 px-1 py-1 border-b-2 border-dotted border-gray-400 text-center bg-white" inputmode="numeric"> l
        </p>
        <p>7 hl =
          <input type="text" data-fill-blanks-target="input" data-correct-answer="70"
                 class="w-16 px-1 py-1 border-b-2 border-dotted border-gray-400 text-center bg-white" inputmode="numeric"> dal
        </p>
      </div>
      <div class="space-y-3">
        <p>70 dl =
          <input type="text" data-fill-blanks-target="input" data-correct-answer="7"
                 class="w-16 px-1 py-1 border-b-2 border-dotted border-gray-400 text-center bg-white" inputmode="numeric"> l
        </p>
        <p>8 hl =
          <input type="text" data-fill-blanks-target="input" data-correct-answer="800"
                 class="w-16 px-1 py-1 border-b-2 border-dotted border-gray-400 text-center bg-white" inputmode="numeric"> l
        </p>
        <p>400 ml =
          <input type="text" data-fill-blanks-target="input" data-correct-answer="40"
                 class="w-16 px-1 py-1 border-b-2 border-dotted border-gray-400 text-center bg-white" inputmode="numeric"> dl
        </p>
        <p>23 dal =
          <input type="text" data-fill-blanks-target="input" data-correct-answer="2300"
                 class="w-16 px-1 py-1 border-b-2 border-dotted border-gray-400 text-center bg-white" inputmode="numeric"> dl
        </p>
      </div>
      <div class="space-y-3">
        <p>4000 ml =
          <input type="text" data-fill-blanks-target="input" data-correct-answer="4"
                 class="w-16 px-1 py-1 border-b-2 border-dotted border-gray-400 text-center bg-white" inputmode="numeric"> l
        </p>
        <p>50 cl =
          <input type="text" data-fill-blanks-target="input" data-correct-answer="5"
                 class="w-16 px-1 py-1 border-b-2 border-dotted border-gray-400 text-center bg-white" inputmode="numeric"> dl
        </p>
        <p>20 l =
          <input type="text" data-fill-blanks-target="input" data-correct-answer="2000"
                 class="w-16 px-1 py-1 border-b-2 border-dotted border-gray-400 text-center bg-white" inputmode="numeric"> cl
        </p>
        <p>16 cl =
          <input type="text" data-fill-blanks-target="input" data-correct-answer="160"
                 class="w-16 px-1 py-1 border-b-2 border-dotted border-gray-400 text-center bg-white" inputmode="numeric"> ml
        </p>
      </div>
    </div>
  </div>

  <!-- Esercizio 2 -->
  <div class="mb-12" data-controller="svg-colorable">
    <div class="flex items-start gap-3 mb-6">
      <div class="bg-red-500 text-white rounded-full w-8 h-8 flex items-center justify-center font-bold flex-shrink-0">
        2
      </div>
      <p class="text-gray-700">
        <strong>Colora allo stesso modo le coppie di cartellini che contengono misure equivalenti.</strong>
      </p>
    </div>

    <div class="grid grid-cols-6 gap-4 mb-4">
      <div class="border border-gray-400 px-3 py-2 text-center cursor-pointer hover:bg-yellow-100 transition-colors"
           data-svg-colorable-target="cell" data-cell-id="card-1">3 hl</div>
      <div class="border border-gray-400 px-3 py-2 text-center cursor-pointer hover:bg-yellow-100 transition-colors"
           data-svg-colorable-target="cell" data-cell-id="card-2">30 cl</div>
      <div class="border border-gray-400 px-3 py-2 text-center cursor-pointer hover:bg-yellow-100 transition-colors"
           data-svg-colorable-target="cell" data-cell-id="card-3">3 l</div>
      <div class="border border-gray-400 px-3 py-2 text-center cursor-pointer hover:bg-yellow-100 transition-colors"
           data-svg-colorable-target="cell" data-cell-id="card-4">500 ml</div>
      <div class="border border-gray-400 px-3 py-2 text-center cursor-pointer hover:bg-yellow-100 transition-colors"
           data-svg-colorable-target="cell" data-cell-id="card-5">50 dal</div>
      <div class="border border-gray-400 px-3 py-2 text-center cursor-pointer hover:bg-yellow-100 transition-colors"
           data-svg-colorable-target="cell" data-cell-id="card-6">50 l</div>
    </div>
    <div class="grid grid-cols-6 gap-4">
      <div class="border border-gray-400 px-3 py-2 text-center cursor-pointer hover:bg-yellow-100 transition-colors"
           data-svg-colorable-target="cell" data-cell-id="card-7">3 dl</div>
      <div class="border border-gray-400 px-3 py-2 text-center cursor-pointer hover:bg-yellow-100 transition-colors"
           data-svg-colorable-target="cell" data-cell-id="card-8">30 dl</div>
      <div class="border border-gray-400 px-3 py-2 text-center cursor-pointer hover:bg-yellow-100 transition-colors"
           data-svg-colorable-target="cell" data-cell-id="card-9">300 l</div>
      <div class="border border-gray-400 px-3 py-2 text-center cursor-pointer hover:bg-yellow-100 transition-colors"
           data-svg-colorable-target="cell" data-cell-id="card-10">5 hl</div>
      <div class="border border-gray-400 px-3 py-2 text-center cursor-pointer hover:bg-yellow-100 transition-colors"
           data-svg-colorable-target="cell" data-cell-id="card-11">5 dl</div>
      <div class="border border-gray-400 px-3 py-2 text-center cursor-pointer hover:bg-yellow-100 transition-colors"
           data-svg-colorable-target="cell" data-cell-id="card-12">5 dal</div>
    </div>
    <p  class="text-gray-500 mt-2">Suggerimento: 3 hl = 300 l, 30 cl = 3 dl, 500 ml = 5 dl, 50 dal = 5 hl, 50 l = 5 dal</p>
  </div>

  <!-- Esercizio 3 -->
  <div class="mb-12">
    <div class="flex items-start gap-3 mb-6">
      <div class="bg-red-500 text-white rounded-full w-8 h-8 flex items-center justify-center font-bold flex-shrink-0">
        3
      </div>
      <p class="text-gray-700">
        <strong>Riscrivi sul quaderno la capacità dei contenitori in ordine crescente.</strong>
      </p>
    </div>

    <div class="flex justify-center mb-4">
      <%= image_tag "bus3_mat/p168/output-1743504902168_174_877_751_105.png", alt: "Contenitori", class: "max-w-full rounded" %>
    </div>

    <div class="grid grid-cols-2 md:grid-cols-5 gap-4 text-center">
      <div>
        <p class="font-bold">spray per vetri</p>
        <p>650 ml</p>
      </div>
      <div>
        <p class="font-bold">succo di frutta</p>
        <p>25 cl</p>
      </div>
      <div>
        <p class="font-bold">lattina</p>
        <p>33 cl</p>
      </div>
      <div>
        <p class="font-bold">sciroppo</p>
        <p>50 cl</p>
      </div>
      <div>
        <p class="font-bold">detersivo</p>
        <p>2 l</p>
      </div>
    </div>
    <p  class="text-gray-500 mt-4 text-center">Ordine: 25 cl (250 ml) < 33 cl (330 ml) < 50 cl (500 ml) < 650 ml < 2 l (2000 ml)</p>
  </div>

  <!-- Esercizio 4 - LOGICA -->
  <div class="mb-12" data-controller="fill-blanks">
    <div class="flex items-start gap-3 mb-6">
      <div class="bg-red-500 text-white rounded-full w-8 h-8 flex items-center justify-center font-bold flex-shrink-0">
        4
      </div>
      <div class="flex items-center gap-2">
        <span class="bg-red-500 text-white font-bold px-1">L</span>
        <span class="bg-yellow-400 text-black font-bold px-1">O</span>
        <span class="bg-green-500 text-white font-bold px-1">G</span>
        <span class="bg-cyan-500 text-white font-bold px-1">I</span>
        <span class="bg-blue-500 text-white font-bold px-1">C</span>
        <span class="bg-purple-500 text-white font-bold px-1">A</span>
        <span class="ml-2 text-gray-700"><strong>Rispondi alla domanda.</strong></span>
      </div>
    </div>

    <div class="flex items-center gap-3 flex-wrap">
      <p class="text-gray-700">• Quante bottiglie da 2 l occorrono per riempire una damigiana da 2 dal?</p>
      <input type="text" data-fill-blanks-target="input" data-correct-answer="10"
             class="w-16 px-2 py-1 border-b-2 border-dotted border-gray-400 text-center bg-white" inputmode="numeric">
    </div>
  </div>

  <!-- Footer con controlli -->
  <%= render 'shared/exercise_controls' %>
</div>
