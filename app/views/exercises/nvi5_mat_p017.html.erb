<div class="max-w-6xl mx-auto bg-white p-3 md:p-6"
     data-controller="exercise-checker text-toggle font-controls"
     data-text-toggle-target="content"
     data-font-controls-target="content">

  <!-- Header -->
  <%= render 'shared/page_header', pagina: @pagina %>

  <div class="space-y-6">
    <!-- Teoria: Esempio con 347 502 -->
    <div class="p-4 md:p-6">
      <h3 class="mb-4">Puoi scrivere i numeri anche usando le potenze del 10. Osserva.</h3>
      <p class="text-gray-800 mb-4">Il numero <span class="font-bold text-cyan-500 whitespace-nowrap">347 502</span> si può scrivere:</p>
      <div class="grid grid-cols-[auto_auto_1fr] gap-x-3 gap-y-2 items-center">
        <div><span class="text-pink-600">&#8226;</span> come <span class="font-semibold">somma di addendi</span></div>
        <span class="text-pink-600">→</span>
        <div class="font-mono text-cyan-500"><span class="whitespace-nowrap">300 000</span> + <span class="whitespace-nowrap">40 000</span> + <span class="whitespace-nowrap">7 000</span> + 500 + 2</div>

        <div><span class="text-pink-600">&#8226;</span> come <span class="font-semibold">somma di prodotti</span></div>
        <span class="text-pink-600">→</span>
        <div class="font-mono text-cyan-500">3 × <span class="whitespace-nowrap">100 000</span> + 4 × <span class="whitespace-nowrap">10 000</span> + 7 × <span class="whitespace-nowrap">1 000</span> + 5 × 100 + 2 × 1</div>

        <div><span class="text-pink-600">&#8226;</span> come <span class="font-semibold">polinomio numerico</span></div>
        <span class="text-pink-600">→</span>
        <div class="font-mono text-cyan-500">3 × 10<sup>5</sup> + 4 × 10<sup>4</sup> + 7 × 10<sup>3</sup> + 5 × 10<sup>2</sup> + 2 × 10<sup>0</sup></div>
      </div>
    </div>

    <!-- Prova tu: 25 149 -->
    <div class="p-4 md:p-6">
      <h3 class="font-bold mb-4">Prova tu a scrivere il numero <span class="whitespace-nowrap">25 149</span>:</h3>
      <div class="grid grid-cols-[auto_auto_1fr] gap-x-3 gap-y-3 items-center">
        <label><span class="text-pink-600">&#8226;</span> come <span class="font-semibold">somma di addendi</span></label>
        <span class="text-pink-600">→</span>
        <input type="text" data-correct-answer="20000+5000+100+40+9" class="min-w-0 flex-1 border-b-2 border-dotted border-gray-400 text-center font-bold bg-transparent font-mono">

        <label><span class="text-pink-600">&#8226;</span> come <span class="font-semibold">somma di prodotti</span></label>
        <span class="text-pink-600">→</span>
        <input type="text" data-correct-answer="2×10000+5×1000+1×100+4×10+9×1" class="min-w-0 flex-1 border-b-2 border-dotted border-gray-400 text-center font-bold bg-transparent font-mono">

        <label><span class="text-pink-600">&#8226;</span> come <span class="font-semibold">polinomio numerico</span></label>
        <span class="text-pink-600">→</span>
        <input type="text" data-correct-answer="2×10^4+5×10^3+1×10^2+4×10^1+9×10^0" class="min-w-0 flex-1 border-b-2 border-dotted border-gray-400 text-center font-bold bg-transparent font-mono">
      </div>
      <p class="text-gray-500 mt-2 ml-4">Usa ^ per l'esponente (es: 10^4)</p>
    </div>

    <!-- Sezione ESERCIZI -->
    <div class="p-4 md:p-6 bg-orange-100 rounded-lg">
      <h2 class="font-bold text-pink-600 mb-6">ESERCIZI</h2>

      <div class="space-y-6">
        <!-- Exercise 1: Scrivi il numero corrispondente -->
        <div>
          <div class="mb-4">
            <p class="font-bold text-gray-700">
              <%= numero_esercizio_badge(1) %>
              Scrivi il numero corrispondente come nell'esempio.
            </p>
          </div>
          <div class="space-y-3">
            <!-- Esempio -->
            <div class="flex items-center gap-3 p-3 bg-white rounded-lg">
              <span class="font-mono text-gray-700">8 × 10<sup>5</sup> + 2 × 10<sup>2</sup> =</span>
              <span class="font-bold text-cyan-500 whitespace-nowrap">800 200</span>
            </div>
            <div class="grid grid-cols-1 md:grid-cols-2 gap-3">
              <% [
                { expr: "3 × 10<sup>6</sup> + 3 × 10<sup>5</sup> =", answer: "3300000" },
                { expr: "6 × 10<sup>5</sup> + 7 × 10<sup>4</sup> + 4 × 10<sup>3</sup> + 5 × 10<sup>2</sup> =", answer: "674500" },
                { expr: "5 × 10<sup>8</sup> + 5 × 10<sup>5</sup> + 1 × 10<sup>4</sup> =", answer: "500510000" },
                { expr: "9 × 10<sup>3</sup> + 8 × 10<sup>1</sup> + 6 × 1<sup>0</sup> =", answer: "9086" }
              ].each do |item| %>
                <div class="flex items-center gap-3">
                  <span class="font-mono text-gray-700 flex-shrink-0"><%= item[:expr].html_safe %></span>
                  <input type="text" data-correct-answer="<%= item[:answer] %>" class="flex-1 min-w-0 border-b-2 border-dotted border-gray-400 text-center font-bold bg-transparent">
                </div>
              <% end %>
            </div>
          </div>
        </div>

        <!-- Exercise 2: Sul quaderno -->
        <div>
          <div class="mb-4">
            <p class="font-bold text-gray-700">
              <%= numero_esercizio_badge(2) %>
              Scrivi sul quaderno i seguenti numeri come polinomi numerici come nell'esempio.
            </p>
          </div>
          <div>
            <p class="text-gray-800 mb-3 font-semibold">Esempio:</p>
            <div class="p-3 bg-white rounded-lg mb-4">
              <p class="font-mono text-cyan-500"><span class="whitespace-nowrap">2 345</span> → 2 × 10<sup>3</sup> + 3 × 10<sup>2</sup> + 4 × 10<sup>1</sup> + 5 × 10<sup>0</sup></p>
            </div>
            <p class="text-gray-800 font-semibold mb-3">Numeri da scrivere:</p>
            <div class="flex flex-wrap gap-3">
              <% ["45 567", "143 568 960", "265 200", "300 547", "600 000 000", "986 004", "3 001"].each do |num| %>
                <span class="bg-white px-3 py-1 font-bold text-cyan-500 rounded border-2 border-cyan-300 whitespace-nowrap"><%= num %></span>
                <% unless num == "3 001" %><span class="text-pink-600">&#8226;</span><% end %>
              <% end %>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- AllenaMente -->
    <div class="p-4 md:p-6 bg-white border-3 border-blue-500 rounded-3xl">
      <div class="flex items-center gap-2 mb-6">
        <div class="bg-purple-500 text-white px-4 py-2 rounded-lg font-bold">AllenaMente</div>
      </div>
      <h3 class="font-bold mb-4">Completa la tabella e poi rispondi.</h3>
      <div class="flex flex-col lg:flex-row gap-6">
        <!-- Tabella a sinistra -->
        <div class="overflow-x-auto">
          <table class="border-2 border-gray-300">
            <thead>
              <tr class="bg-blue-500 text-white">
                <th class="border-2 border-white p-3 font-bold"></th>
                <th class="border-2 border-white p-3 font-bold">4</th>
                <th class="border-2 border-white p-3 font-bold">4</th>
                <th class="border-2 border-white p-3 font-bold">4</th>
                <th class="border-2 border-white p-3 font-bold">4</th>
                <th class="border-2 border-white p-3 font-bold">4</th>
              </tr>
            </thead>
            <tbody>
              <tr class="bg-pink-100">
                <td class="border-2 border-pink-300 p-3 font-bold">esponente</td>
                <td class="border-2 border-pink-300 p-3 text-center font-bold">1</td>
                <td class="border-2 border-pink-300 p-3 text-center font-bold">2</td>
                <td class="border-2 border-pink-300 p-3 text-center font-bold">3</td>
                <td class="border-2 border-pink-300 p-3 text-center font-bold">4</td>
                <td class="border-2 border-pink-300 p-3 text-center font-bold">5</td>
              </tr>
              <tr class="bg-blue-50">
                <td class="border-2 border-blue-300 p-3 font-bold">potenza</td>
                <td class="border-2 border-blue-300 p-3 text-center">4<sup>1</sup></td>
                <td class="border-2 border-blue-300 p-3 text-center">4<sup>2</sup></td>
                <td class="border-2 border-blue-300 p-3 text-center">
                  <input type="text" data-correct-answer="4^3" class="w-14 border-b-2 border-dotted border-gray-400 text-center font-bold bg-transparent">
                </td>
                <td class="border-2 border-blue-300 p-3 text-center">4<sup>4</sup></td>
                <td class="border-2 border-blue-300 p-3 text-center">
                  <input type="text" data-correct-answer="4^5" class="w-14 border-b-2 border-dotted border-gray-400 text-center font-bold bg-transparent">
                </td>
              </tr>
              <tr class="bg-green-50">
                <td class="border-2 border-green-300 p-3 font-bold">risultato</td>
                <td class="border-2 border-green-300 p-3 text-center font-bold">4</td>
                <td class="border-2 border-green-300 p-3 text-center">
                  <input type="text" data-correct-answer="16" class="w-14 border-b-2 border-dotted border-gray-400 text-center font-bold bg-transparent">
                </td>
                <td class="border-2 border-green-300 p-3 text-center">
                  <input type="text" data-correct-answer="64" class="w-14 border-b-2 border-dotted border-gray-400 text-center font-bold bg-transparent">
                </td>
                <td class="border-2 border-green-300 p-3 text-center font-bold">256</td>
                <td class="border-2 border-green-300 p-3 text-center font-bold">1024</td>
              </tr>
            </tbody>
          </table>
        </div>
        <!-- Testo a destra -->
        <div class="flex-1 space-y-4">
          <p class="text-gray-800">Osserva la cifra delle unità nella riga dei risultati e immagina di continuare.</p>
          <div class="flex items-center gap-3">
            <span class="text-gray-700"><span class="text-pink-600">&#8226;</span> Quale sarà la cifra delle unità nel risultato di 4<sup>6</sup>?</span>
            <input type="text" data-correct-answer="6" class="w-16 border-b-2 border-dotted border-gray-400 text-center font-bold bg-transparent">
          </div>
          <div class="flex items-center gap-3">
            <span class="text-gray-700"><span class="text-pink-600">&#8226;</span> E quella del risultato di 4<sup>7</sup>?</span>
            <input type="text" data-correct-answer="4" class="w-16 border-b-2 border-dotted border-gray-400 text-center font-bold bg-transparent">
          </div>
          <p class="text-gray-800 mt-4">
            Calcola con la calcolatrice (a pagina 23 puoi imparare come usarla) le potenze di 2 fino a 2<sup>8</sup>.
            Osserva la cifra delle unità. Quale sarà la cifra delle unità nel risultato di 2<sup>10</sup>?
            E quella del risultato di 2<sup>11</sup>?
          </p>
        </div>
      </div>
    </div>

    <!-- Riferimento quaderno -->
    <div class="text-right">
      <span class="text-pink-600 font-bold">Quaderno esercizi</span> pp. 181, 183
    </div>

    <%= render 'shared/exercise_controls' %>
  </div>
</div>
