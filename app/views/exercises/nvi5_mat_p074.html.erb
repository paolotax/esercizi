<div class="max-w-6xl mx-auto bg-white p-3 md:p-6"
     data-controller="exercise-checker text-toggle font-controls"
     data-text-toggle-target="content"
     data-font-controls-target="content">

  <%= render 'shared/page_header', pagina: @pagina %>

  <div class="space-y-6">
    <!-- Introduzione -->
    <div class="p-4 bg-gray-100 rounded-lg">
      <p class="text-gray-800">Per risolvere un problema non basta eseguire un'operazione, bisogna anche <strong>riflettere sui risultati trovati e chiedersi se sono verosimili</strong>.</p>
    </div>

    <!-- Problema taxi -->
    <div class="p-4 bg-cyan-50 rounded-lg">
      <h3 class="font-bold text-cyan-700 mb-3">Viaggio in taxi</h3>
      <div class="flex flex-col md:flex-row gap-4">
        <div class="flex-1">
          <p class="text-gray-800 mb-4">Un gruppo di 53 turisti, al termine del soggiorno in hotel, deve raggiungere la stazione. Il trasporto viene organizzato in taxi da 6 posti. Quanti taxi è necessario prenotare?</p>
        </div>
      </div>
    </div>

    <!-- Osserva le soluzioni -->
    <div class="space-y-3">
      <p class="font-bold text-gray-700">• Osserva le soluzioni proposte da 3 bambini.</p>

      <div class="space-y-2 ml-4">
        <p class="text-gray-700"><strong>Enrico</strong> → <span class="text-cyan-600">53 − 6 = 47</span> È necessario prenotare 47 taxi.</p>
        <p class="text-gray-700"><strong>Giacomo</strong> → <span class="text-cyan-600">53 × 6 = 318</span> È necessario prenotare 318 taxi.</p>
        <p class="text-gray-700"><strong>Laura</strong> → <span class="text-cyan-600">53 : 6 = 8 resto 5</span> È necessario prenotare 9 taxi: 8 da 6 posti pieni e 1 per le 5 persone che restano.</p>
      </div>

      <div class="flex items-center gap-2 flex-wrap">
        <span class="text-gray-700">Chi ha risposto correttamente?</span>
        <input type="text" class="w-24 px-2 py-1 border-b border-dotted border-gray-400 bg-transparent focus:outline-none" data-correct-answer="Laura">
      </div>
    </div>

    <!-- Box viola -->
    <div class="p-4 bg-purple-100 rounded-lg">
      <p class="text-gray-700">A volte può capitare di giudicare non accettabile il risultato di un problema. Allora che cosa fai? Rivedi i calcoli, cerchi l'errore e correggi. Altre volte non trovi errori e pensi: questo risultato è impossibile!</p>
    </div>

    <!-- Osserva le situazioni -->
    <p class="font-bold text-gray-700">• Osserva le situazioni rappresentate e prova a rispondere.</p>

    <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
      <!-- Gelati -->
      <div class="space-y-3">
        <%= image_tag "nvi5_mat/p074/p074_01.jpg", alt: "Offerta gelati", class: "w-[300px] h-[114px]" %>

        <div class="space-y-2">
          <div class="flex items-center gap-2 flex-wrap">
            <span class="text-gray-700">– Quanto paghi ogni confezione se ne acquisti tre?</span>
            <input type="text" class="w-16 px-2 py-1 border-b border-dotted border-gray-400 bg-transparent text-center focus:outline-none" data-correct-answer="6">
            <span class="text-gray-700">€</span>
          </div>
          <div class="flex items-center gap-3 flex-wrap">
            <span class="text-gray-700">– La proposta è conveniente?</span>
            <div class="flex gap-1">
              <button class="px-3 py-1 border border-gray-400 rounded text-sm hover:bg-gray-100">Sì</button>
              <button class="px-3 py-1 border border-gray-400 rounded text-sm hover:bg-gray-100 bg-cyan-100" data-correct="true">No</button>
            </div>
          </div>
          <div class="flex items-center gap-3 flex-wrap">
            <span class="text-gray-700">– Ci sono informazioni impossibili o non accettabili?</span>
            <div class="flex gap-1">
              <button class="px-3 py-1 border border-gray-400 rounded text-sm hover:bg-gray-100 bg-cyan-100" data-correct="true">Sì</button>
              <button class="px-3 py-1 border border-gray-400 rounded text-sm hover:bg-gray-100">No</button>
            </div>
          </div>
        </div>

        <p class="text-gray-600 text-sm">In questa situazione c'è un dato contraddittorio: comprando 3 confezioni, ognuna costa più di 5 euro, quindi non è vero che "paghi 2 prendi 3".</p>
      </div>

      <!-- Treni -->
      <div class="space-y-3">
        <table class="w-full border-collapse border border-gray-400 text-sm">
          <thead>
            <tr class="bg-cyan-200">
              <th colspan="2" class="border border-gray-400 px-3 py-1 font-bold text-center">AI TRENI</th>
            </tr>
            <tr class="bg-cyan-100">
              <th class="border border-gray-400 px-3 py-1 font-bold">Partenza ore</th>
              <th class="border border-gray-400 px-3 py-1 font-bold">Arrivo ore</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td class="border border-gray-400 px-3 py-1">Firenze 10:05</td>
              <td class="border border-gray-400 px-3 py-1 text-red-600 font-bold">Palermo 10:35</td>
            </tr>
            <tr>
              <td class="border border-gray-400 px-3 py-1">Firenze 10:20</td>
              <td class="border border-gray-400 px-3 py-1">Torino 14:00</td>
            </tr>
            <tr>
              <td class="border border-gray-400 px-3 py-1">Firenze 10:40</td>
              <td class="border border-gray-400 px-3 py-1">Milano 13:25</td>
            </tr>
          </tbody>
        </table>

        <div class="space-y-2">
          <p class="text-gray-700">– Quanto durano i tre viaggi?</p>
          <div class="ml-4 space-y-1">
            <div class="flex items-center gap-2">
              <span class="text-gray-700 w-12">FI-PA</span>
              <input type="text" class="w-28 px-2 py-1 border-b border-dotted border-gray-400 bg-transparent focus:outline-none">
            </div>
            <div class="flex items-center gap-2">
              <span class="text-gray-700 w-12">FI-MI</span>
              <input type="text" class="w-28 px-2 py-1 border-b border-dotted border-gray-400 bg-transparent focus:outline-none">
            </div>
            <div class="flex items-center gap-2">
              <span class="text-gray-700 w-12">FI-TO</span>
              <input type="text" class="w-28 px-2 py-1 border-b border-dotted border-gray-400 bg-transparent focus:outline-none">
            </div>
          </div>
          <div class="flex items-center gap-3 flex-wrap">
            <span class="text-gray-700">– Sono tutti tempi possibili?</span>
            <div class="flex gap-1">
              <button class="px-3 py-1 border border-gray-400 rounded text-sm hover:bg-gray-100">Sì</button>
              <button class="px-3 py-1 border border-gray-400 rounded text-sm hover:bg-gray-100 bg-cyan-100" data-correct="true">No</button>
            </div>
            <span class="text-gray-700">Perché?</span>
          </div>
          <div class="flex items-center gap-3 flex-wrap">
            <span class="text-gray-700">– Ci sono informazioni impossibili o non accettabili?</span>
            <div class="flex gap-1">
              <button class="px-3 py-1 border border-gray-400 rounded text-sm hover:bg-gray-100 bg-cyan-100" data-correct="true">Sì</button>
              <button class="px-3 py-1 border border-gray-400 rounded text-sm hover:bg-gray-100">No</button>
            </div>
          </div>
        </div>

        <p class="text-gray-600 text-sm">In questa situazione c'è un'informazione impossibile perché anche il treno più veloce non può impiegare 30 minuti per andare da Firenze a Palermo!</p>
      </div>
    </div>

    <%= render 'shared/exercise_controls' %>
  </div>
</div>
