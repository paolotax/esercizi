<div class="max-w-6xl mx-auto p-3 md:p-8 bg-gradient-to-br from-purple-50 via-white to-purple-50 rounded-3xl shadow-xl" data-controller="exercise-checker">

  <!-- Header -->
  <div class="mb-8">
    <div class="flex items-start sm:items-center justify-between gap-4 mb-4">
      <div class="flex flex-col-reverse sm:flex-row items-start sm:items-center gap-2 sm:gap-4">
        <div class="bg-purple-500 text-white text-md sm:text-xl px-2 sm:px-4 py-1.5 sm:py-2 rounded-lg font-bold">
          NUMERI
        </div>
        <h1 class="text-2xl sm:text-3xl font-bold text-purple-600">LA PROPRIETÀ DELLA SOTTRAZIONE</h1>
      </div>
      <div class="flex-shrink-0 bg-purple-600 text-white rounded-full w-10 h-10 sm:w-12 sm:h-12 flex items-center justify-center font-bold text-lg sm:text-xl">
        31
      </div>
    </div>
  </div>

  <div class="space-y-6">
    <!-- Introduzione -->
    <div class="bg-gradient-to-br from-purple-50 to-purple-100 rounded-lg p-6 text-gray-800 leading-relaxed">
      <p class="text-lg">
        La sottrazione gode della proprietà invariantiva, che è utile per <strong class="text-purple-700">semplificare i calcoli</strong>.
      </p>
    </div>

    <!-- Proprietà Invariantiva -->
    <div class="bg-white rounded-2xl border-4 border-yellow-200 shadow-2xl p-4 md:p-6" data-controller="fill-blanks">
      <h2 class="text-lg md:text-xl font-bold text-purple-700 mb-4">
        • Leggi e completa.
      </h2>

      <div class="bg-pink-100 rounded-xl p-4 md:p-6 mb-6">
        <h3 class="text-lg font-bold text-pink-700 mb-3">Proprietà invariantiva</h3>
        <p class="text-base md:text-lg text-gray-800">
          Se aggiungi o togli uno stesso numero a minuendo e sottraendo, il risultato non cambia.
        </p>
      </div>

      <div class="overflow-x-auto">
        <table class="w-full text-center text-base md:text-lg">
          <tr>
            <td class="px-2 py-3">138</td>
            <td class="px-2 py-3">–</td>
            <td class="px-2 py-3">63</td>
            <td class="px-2 py-3">=</td>
            <td class="px-2 py-3"></td>
            <td class="px-4"></td>
            <td class="px-2 py-3">138</td>
            <td class="px-2 py-3">–</td>
            <td class="px-2 py-3">63</td>
            <td class="px-2 py-3">=</td>
            <td class="px-2 py-3"></td>
          </tr>
          <tr class="text-purple-700 font-bold">
            <td class="px-2 py-3">↓<strong>– 3</strong></td>
            <td class="px-2 py-3"></td>
            <td class="px-2 py-3">↓<strong>– 3</strong></td>
            <td class="px-2 py-3"></td>
            <td class="px-4"></td>
            <td class="px-4"></td>
            <td class="px-2 py-3">(138 <strong>– 3</strong>)</td>
            <td class="px-2 py-3">–</td>
            <td class="px-2 py-3">(63 <strong>–</strong>
              <input type="text" class="border-b-2 border-purple-400 bg-transparent px-1 py-1 focus:outline-none focus:border-purple-600 w-12 text-center font-bold" data-fill-blanks-target="input" data-correct-answer="3">
              )
            </td>
            <td class="px-2 py-3">=</td>
            <td class="px-2 py-3"></td>
          </tr>
          <tr>
            <td class="px-2 py-3">
              <input type="text" class="border-b-2 border-purple-400 bg-transparent px-1 py-1 focus:outline-none focus:border-purple-600 w-16 text-center" data-fill-blanks-target="input" data-correct-answer="135">
            </td>
            <td class="px-2 py-3">–</td>
            <td class="px-2 py-3">
              <input type="text" class="border-b-2 border-purple-400 bg-transparent px-1 py-1 focus:outline-none focus:border-purple-600 w-16 text-center" data-fill-blanks-target="input" data-correct-answer="60">
            </td>
            <td class="px-2 py-3">=</td>
            <td class="px-2 py-3">
              <input type="text" class="border-b-2 border-purple-400 bg-transparent px-1 py-1 focus:outline-none focus:border-purple-600 w-16 text-center" data-fill-blanks-target="input" data-correct-answer="75">
            </td>
            <td class="px-4"></td>
            <td class="px-2 py-3">
              <input type="text" class="border-b-2 border-purple-400 bg-transparent px-1 py-1 focus:outline-none focus:border-purple-600 w-16 text-center" data-fill-blanks-target="input" data-correct-answer="135">
            </td>
            <td class="px-2 py-3">–</td>
            <td class="px-2 py-3">
              <input type="text" class="border-b-2 border-purple-400 bg-transparent px-1 py-1 focus:outline-none focus:border-purple-600 w-16 text-center" data-fill-blanks-target="input" data-correct-answer="60">
            </td>
            <td class="px-2 py-3">=</td>
            <td class="px-2 py-3">
              <input type="text" class="border-b-2 border-purple-400 bg-transparent px-1 py-1 focus:outline-none focus:border-purple-600 w-16 text-center" data-fill-blanks-target="input" data-correct-answer="75">
            </td>
          </tr>
        </table>
      </div>
    </div>

    <!-- La prova della sottrazione -->
    <div class="bg-white rounded-2xl border-4 border-blue-200 shadow-2xl p-4 md:p-6">
      <h2 class="text-xl md:text-2xl font-bold text-purple-700 mb-4">La prova della sottrazione</h2>

      <p class="text-base md:text-lg text-gray-800 mb-4">
        <strong>La sottrazione è l'operazione inversa dell'addizione.</strong><br>
        Per eseguire la prova di una sottrazione aggiungi al <span class="underline font-bold text-red-600">resto</span>
        il <span class="underline font-bold italic text-purple-600">sottraendo</span> e ottieni il <strong>minuendo</strong>.
      </p>

      <div class="flex justify-center">
        <%= image_tag "p031_01.jpg", class: "max-w-md rounded", alt: "Prova della sottrazione" %>
      </div>
    </div>

    <!-- Lo zero e l'uno nella sottrazione -->
    <div class="bg-white rounded-2xl border-4 border-green-200 shadow-2xl p-4 md:p-6" data-controller="fill-blanks">
      <h2 class="text-xl md:text-2xl font-bold text-purple-700 mb-4">Lo zero e l'uno nella sottrazione</h2>

      <h3 class="text-lg md:text-xl font-bold text-gray-700 mb-4">
        • Leggi e completa.
      </h3>

      <div class="space-y-6">
        <!-- Zero -->
        <div class="bg-purple-50 rounded-xl p-4">
          <p class="text-base md:text-lg text-gray-800 mb-4">
            Se da un numero <strong class="text-purple-700">togli 0</strong>, ottieni il <strong class="text-purple-700">numero stesso</strong>.
            La sottrazione con 0 al minuendo fra numeri naturali si può fare solo in un caso: <strong class="text-purple-700">0 – 0 = 0</strong>.
          </p>
          <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
            <div>
              <p class="text-base md:text-lg">
                6,38 – <strong>0</strong> =
                <input type="text" class="border-b-2 border-purple-400 bg-transparent px-2 py-1 focus:outline-none focus:border-purple-600 w-20 text-center" data-fill-blanks-target="input" data-correct-answer="6,38">
              </p>
            </div>
            <div>
              <p class="text-base md:text-lg">
                2 358 – <strong>0</strong> =
                <input type="text" class="border-b-2 border-purple-400 bg-transparent px-2 py-1 focus:outline-none focus:border-purple-600 w-20 text-center" data-fill-blanks-target="input" data-correct-answer="2358">
              </p>
            </div>
          </div>
        </div>

        <!-- Uno -->
        <div class="bg-pink-50 rounded-xl p-4">
          <p class="text-base md:text-lg text-gray-800 mb-4">
            Se togli <strong class="text-pink-700">1</strong> a un <strong class="text-pink-700">numero intero</strong> ottieni il
            <strong class="text-pink-700">numero precedente</strong>. Se continui a togliere 1 arrivi a 0.<br>
            Nei <strong class="text-pink-700">numeri decimali non esiste il precedente</strong> perché
            <strong class="text-pink-700">tra due numeri decimali ci sono infiniti numeri decimali</strong>.
          </p>
          <p class="text-base md:text-lg">
            3 – <strong>1</strong> =
            <input type="text" class="border-b-2 border-pink-400 bg-transparent px-2 py-1 focus:outline-none focus:border-pink-600 w-20 text-center" data-fill-blanks-target="input" data-correct-answer="2">
          </p>
        </div>

        <!-- Numeri relativi -->
        <div class="bg-blue-50 rounded-xl p-4">
          <p class="text-base md:text-lg text-gray-800">
            Quest'anno hai imparato che con i <strong class="text-blue-700">numeri interi relativi</strong> è possibile eseguire sottrazioni
            anche con il sottraendo maggiore del minuendo: <strong class="text-blue-700">8 – 13 = – 5</strong>.
          </p>
        </div>
      </div>
    </div>

    <!-- Esercizi -->
    <div class="bg-gradient-to-br from-purple-100 to-pink-100 rounded-2xl p-4 md:p-6">
      <h2 class="text-xl md:text-2xl font-bold text-purple-700 mb-6">ESERCIZI</h2>

      <!-- Esercizio 1 -->
      <div class="mb-6 bg-white rounded-2xl border-4 border-yellow-200 shadow-2xl p-4 md:p-6">
        <h3 class="text-lg md:text-xl font-bold text-gray-700 mb-4">
          <span class="bg-purple-600 text-white rounded-full w-8 h-8 md:w-10 md:h-10 inline-flex items-center justify-center mr-2">1</span>
          Applica la proprietà invariantiva e calcola sul quaderno.
        </h3>
        <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-3 text-base md:text-lg">
          <p>597 – 164 =</p>
          <p>783 – 659 =</p>
          <p>907 – 703 =</p>
          <p>859 – 236 =</p>
          <p>13,52 – 12,82 =</p>
          <p>82,4 – 22,1 =</p>
          <p>8,59 – 2,36 =</p>
        </div>
      </div>

      <!-- Esercizio 2 -->
      <div class="bg-white rounded-2xl border-4 border-green-200 shadow-2xl p-4 md:p-6" data-controller="fill-blanks">
        <h3 class="text-lg md:text-xl font-bold text-gray-700 mb-4">
          <span class="bg-green-600 text-white rounded-full w-8 h-8 md:w-10 md:h-10 inline-flex items-center justify-center mr-2">2</span>
          Completa le uguaglianze.
        </h3>
        <div class="grid grid-cols-1 md:grid-cols-2 gap-4 text-base md:text-lg">
          <div class="space-y-3">
            <p>5,4 + <input type="text" class="border-b-2 border-green-400 bg-transparent px-2 py-1 focus:outline-none focus:border-green-600 w-20 text-center" data-fill-blanks-target="input" data-correct-answer="0,6"> = 6</p>
            <p>9,009 + <input type="text" class="border-b-2 border-green-400 bg-transparent px-2 py-1 focus:outline-none focus:border-green-600 w-20 text-center" data-fill-blanks-target="input" data-correct-answer="0,991"> = 10</p>
            <p>12,5 + <input type="text" class="border-b-2 border-green-400 bg-transparent px-2 py-1 focus:outline-none focus:border-green-600 w-20 text-center" data-fill-blanks-target="input" data-correct-answer="0,5"> = 13</p>
            <p>8,009 + <input type="text" class="border-b-2 border-green-400 bg-transparent px-2 py-1 focus:outline-none focus:border-green-600 w-20 text-center" data-fill-blanks-target="input" data-correct-answer="1,991"> = 10</p>
          </div>
          <div class="space-y-3">
            <p>10,08 + <input type="text" class="border-b-2 border-green-400 bg-transparent px-2 py-1 focus:outline-none focus:border-green-600 w-20 text-center" data-fill-blanks-target="input" data-correct-answer="0,92"> = 11</p>
            <p>35 – <input type="text" class="border-b-2 border-green-400 bg-transparent px-2 py-1 focus:outline-none focus:border-green-600 w-20 text-center" data-fill-blanks-target="input" data-correct-answer="33,5"> = 1,5</p>
            <p><input type="text" class="border-b-2 border-green-400 bg-transparent px-2 py-1 focus:outline-none focus:border-green-600 w-20 text-center" data-fill-blanks-target="input" data-correct-answer="0,6"> + 15,4 = 16</p>
            <p>46 – <input type="text" class="border-b-2 border-green-400 bg-transparent px-2 py-1 focus:outline-none focus:border-green-600 w-20 text-center" data-fill-blanks-target="input" data-correct-answer="0,5"> = 45,5</p>
          </div>
        </div>
      </div>
    </div>

    <!-- Footer con riferimento -->
    <div class="mt-8 text-center">
      <p class="text-red-600 font-bold text-lg">Quaderno esercizi pp. 187, 200</p>
    </div>
  </div>

  <!-- Exercise controls -->
  <%= render 'shared/exercise_controls', color: 'purple' %>
</div>
