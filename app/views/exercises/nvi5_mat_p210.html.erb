<div class="max-w-6xl mx-auto bg-white p-3 md:p-6"
     data-controller="exercise-checker text-toggle font-controls"
     data-text-toggle-target="content"
     data-font-controls-target="content">

  <%= render 'shared/page_header', pagina: @pagina %>

  <div class="space-y-6">
    <!-- Esercizio 1: IMPARARE TUTTI - Frazioni decimali in percentuale -->
    <div class="p-4 bg-white rounded-2xl border-3 border-yellow-400">
      <div class="flex flex-col md:flex-row md:items-start gap-4">
        <div class="flex-1">
          <p class="font-bold text-gray-700 mb-4">
            <%= imparare_tutti_badge(1) %>
            Scrivi le seguenti frazioni decimali sotto forma di percentuale come nell'esempio.
          </p>

          <div class="grid grid-cols-2 md:grid-cols-4 gap-4">
            <!-- Esempio: 66/100 = 66% -->
            <div class="flex items-center gap-2">
              <%= render 'shared/frazione', num: 66, den: 100, border: nil %>
              <span>=</span>
              <span class="font-bold text-cyan-600">66%</span>
            </div>
            <!-- 45/100 = 45% -->
            <div class="flex items-center gap-2">
              <%= render 'shared/frazione', num: 45, den: 100, border: nil %>
              <span>=</span>
              <input type="text" data-correct-answer="45%" class="w-16 border-b-2 border-dotted border-gray-400 text-center font-bold bg-transparent">
            </div>
            <!-- 5/100 = 5% -->
            <div class="flex items-center gap-2">
              <%= render 'shared/frazione', num: 5, den: 100, border: nil %>
              <span>=</span>
              <input type="text" data-correct-answer="5%" class="w-16 border-b-2 border-dotted border-gray-400 text-center font-bold bg-transparent">
            </div>
            <!-- 23/100 = 23% -->
            <div class="flex items-center gap-2">
              <%= render 'shared/frazione', num: 23, den: 100, border: nil %>
              <span>=</span>
              <input type="text" data-correct-answer="23%" class="w-16 border-b-2 border-dotted border-gray-400 text-center font-bold bg-transparent">
            </div>
          </div>
        </div>
        <div class="shrink-0 p-3 bg-custom-blue-light rounded-2xl">
          <p class="text-gray-700">La <span class="font-bold text-cyan-600">percentuale</span> è una frazione decimale che ha per denominatore <span class="font-bold">100</span>.</p>
        </div>
      </div>
    </div>

    <!-- Esercizio 2: Calcola il valore delle percentuali -->
    <div>
      <p class="font-bold text-gray-700 mb-4">
        <%= numero_esercizio_badge(2) %>
        Calcola il valore delle percentuali come nell'esempio.
      </p>

      <div class="space-y-3">
        <!-- Esempio: 20% di 240 = (240 : 100) × 20 = 2,4 × 20 = 48 -->
        <div class="flex items-center gap-2 flex-wrap">
          <span class="text-gray-700">20% di 240 =</span>
          <span class="text-cyan-500">→</span>
          <span class="font-bold text-cyan-600">(240 : 100) × 20 = 2,4 × 20 = 48</span>
        </div>
        <!-- 65% di 750 -->
        <div class="flex items-center gap-2 flex-wrap">
          <span class="text-gray-700">65% di 750 =</span>
          <span class="text-cyan-500">→</span>
          <span class="text-gray-700">(</span>
          <input type="text" data-correct-answer="750" class="w-14 border-b-2 border-dotted border-gray-400 text-center font-bold bg-transparent">
          <span class="text-gray-700">:</span>
          <input type="text" data-correct-answer="100" class="w-14 border-b-2 border-dotted border-gray-400 text-center font-bold bg-transparent">
          <span class="text-gray-700">) ×</span>
          <input type="text" data-correct-answer="65" class="w-14 border-b-2 border-dotted border-gray-400 text-center font-bold bg-transparent">
          <span class="text-gray-700">=</span>
          <input type="text" data-correct-answer="7,5" class="w-14 border-b-2 border-dotted border-gray-400 text-center font-bold bg-transparent">
          <span class="text-gray-700">×</span>
          <input type="text" data-correct-answer="65" class="w-14 border-b-2 border-dotted border-gray-400 text-center font-bold bg-transparent">
          <span class="text-gray-700">=</span>
          <input type="text" data-correct-answer="487,5" class="w-16 border-b-2 border-dotted border-gray-400 text-center font-bold bg-transparent">
        </div>
        <!-- 90% di 6450 -->
        <div class="flex items-center gap-2 flex-wrap">
          <span class="text-gray-700">90% di <span class="whitespace-nowrap">6 450</span> =</span>
          <span class="text-cyan-500">→</span>
          <span class="text-gray-700">(</span>
          <input type="text" data-correct-answer="6450" class="w-14 border-b-2 border-dotted border-gray-400 text-center font-bold bg-transparent">
          <span class="text-gray-700">:</span>
          <input type="text" data-correct-answer="100" class="w-14 border-b-2 border-dotted border-gray-400 text-center font-bold bg-transparent">
          <span class="text-gray-700">) ×</span>
          <input type="text" data-correct-answer="90" class="w-14 border-b-2 border-dotted border-gray-400 text-center font-bold bg-transparent">
          <span class="text-gray-700">=</span>
          <input type="text" data-correct-answer="64,5" class="w-14 border-b-2 border-dotted border-gray-400 text-center font-bold bg-transparent">
          <span class="text-gray-700">×</span>
          <input type="text" data-correct-answer="90" class="w-14 border-b-2 border-dotted border-gray-400 text-center font-bold bg-transparent">
          <span class="text-gray-700">=</span>
          <input type="text" data-correct-answer="5805" class="w-16 border-b-2 border-dotted border-gray-400 text-center font-bold bg-transparent">
        </div>
        <!-- 35% di 8900 -->
        <div class="flex items-center gap-2 flex-wrap">
          <span class="text-gray-700">35% di <span class="whitespace-nowrap">8 900</span> =</span>
          <span class="text-cyan-500">→</span>
          <span class="text-gray-700">(</span>
          <input type="text" data-correct-answer="8900" class="w-14 border-b-2 border-dotted border-gray-400 text-center font-bold bg-transparent">
          <span class="text-gray-700">:</span>
          <input type="text" data-correct-answer="100" class="w-14 border-b-2 border-dotted border-gray-400 text-center font-bold bg-transparent">
          <span class="text-gray-700">) ×</span>
          <input type="text" data-correct-answer="35" class="w-14 border-b-2 border-dotted border-gray-400 text-center font-bold bg-transparent">
          <span class="text-gray-700">=</span>
          <input type="text" data-correct-answer="89" class="w-14 border-b-2 border-dotted border-gray-400 text-center font-bold bg-transparent">
          <span class="text-gray-700">×</span>
          <input type="text" data-correct-answer="35" class="w-14 border-b-2 border-dotted border-gray-400 text-center font-bold bg-transparent">
          <span class="text-gray-700">=</span>
          <input type="text" data-correct-answer="3115" class="w-16 border-b-2 border-dotted border-gray-400 text-center font-bold bg-transparent">
        </div>
      </div>
    </div>

    <!-- Esercizio 3: Colora l'areogramma -->
    <div>
      <p class="font-bold text-gray-700 mb-4">
        <%= numero_esercizio_badge(3) %>
        Colora l'areogramma secondo le percentuali indicate nel testo. Poi esegui i calcoli.
      </p>

      <div class="flex flex-col md:flex-row gap-6">
        <div class="flex-1">
          <p class="text-gray-700 mb-4">
            Il territorio della regione Toscana ha una superficie di <span class="whitespace-nowrap">22 987</span> km² ed è così suddiviso: il 25% è montuoso, il 66% è collinare e il 9% è pianeggiante.
          </p>
          <%= image_tag "nvi5_mat/p210/output-1715938802210_152_581_401_224.png", class: "max-w-[200px]", alt: "areogramma Toscana" %>
        </div>
        <div class="space-y-3">
          <div class="flex items-center gap-2 flex-wrap">
            <span class="text-gray-700">montagna</span>
            <span class="text-cyan-500">→</span>
            <%= render 'shared/frazione', num: 25, den: 100, border: nil %>
            <span>di <span class="whitespace-nowrap">22 987</span> =</span>
            <input type="text" data-correct-answer="5746,75" class="w-24 border-b-2 border-dotted border-gray-400 text-center font-bold bg-transparent">
          </div>
          <div class="flex items-center gap-2 flex-wrap">
            <span class="text-gray-700">collina</span>
            <span class="text-cyan-500">→</span>
            <%= render 'shared/frazione', num: nil, den: nil, num_answer: "66", den_answer: "100" %>
            <span>di</span>
            <input type="text" data-correct-answer="22987" class="w-16 border-b-2 border-dotted border-gray-400 text-center font-bold bg-transparent">
            <span>=</span>
            <input type="text" data-correct-answer="15171,42" class="w-24 border-b-2 border-dotted border-gray-400 text-center font-bold bg-transparent">
          </div>
          <div class="flex items-center gap-2 flex-wrap">
            <span class="text-gray-700">pianura</span>
            <span class="text-cyan-500">→</span>
            <%= render 'shared/frazione', num: nil, den: nil, num_answer: "9", den_answer: "100" %>
            <span>di</span>
            <input type="text" data-correct-answer="22987" class="w-16 border-b-2 border-dotted border-gray-400 text-center font-bold bg-transparent">
            <span>=</span>
            <input type="text" data-correct-answer="2068,83" class="w-24 border-b-2 border-dotted border-gray-400 text-center font-bold bg-transparent">
          </div>
        </div>
      </div>
    </div>

    <!-- Esercizio 4: Scrivi le frazioni sotto forma di percentuale -->
    <div>
      <p class="font-bold text-gray-700 mb-4">
        <%= numero_esercizio_badge(4) %>
        Scrivi le frazioni sotto forma di percentuale. Segui l'esempio.
      </p>

      <div class="space-y-3">
        <!-- Esempio: 1/4 = 1 : 4 = 0,25 = 25/100 = 25% -->
        <div class="flex items-center gap-2 flex-wrap">
          <%= render 'shared/frazione', num: 1, den: 4, border: nil %>
          <span>= 1 : 4 = 0,25 =</span>
          <span class="font-bold text-cyan-600"><%= render 'shared/frazione', num: 25, den: 100, border: nil %></span>
          <span>=</span>
          <span class="font-bold text-cyan-600">25%</span>
        </div>
        <!-- 3/15 = 3 : 15 = 0,2 = 20/100 = 20% -->
        <div class="flex items-center gap-2 flex-wrap">
          <%= render 'shared/frazione', num: 3, den: 15, border: nil %>
          <span>=</span>
          <input type="text" data-correct-answer="3 : 15" class="w-16 border-b-2 border-dotted border-gray-400 text-center font-bold bg-transparent">
          <span>=</span>
          <input type="text" data-correct-answer="0,2" class="w-14 border-b-2 border-dotted border-gray-400 text-center font-bold bg-transparent">
          <span>=</span>
          <%= render 'shared/frazione', num: nil, den: nil, num_answer: "20", den_answer: "100" %>
          <span>=</span>
          <input type="text" data-correct-answer="20%" class="w-14 border-b-2 border-dotted border-gray-400 text-center font-bold bg-transparent">
        </div>
        <!-- 12/25 = 12 : 25 = 0,48 = 48/100 = 48% -->
        <div class="flex items-center gap-2 flex-wrap">
          <%= render 'shared/frazione', num: 12, den: 25, border: nil %>
          <span>=</span>
          <input type="text" data-correct-answer="12 : 25" class="w-16 border-b-2 border-dotted border-gray-400 text-center font-bold bg-transparent">
          <span>=</span>
          <input type="text" data-correct-answer="0,48" class="w-14 border-b-2 border-dotted border-gray-400 text-center font-bold bg-transparent">
          <span>=</span>
          <%= render 'shared/frazione', num: nil, den: nil, num_answer: "48", den_answer: "100" %>
          <span>=</span>
          <input type="text" data-correct-answer="48%" class="w-14 border-b-2 border-dotted border-gray-400 text-center font-bold bg-transparent">
        </div>
        <!-- 7/50 = 7 : 50 = 0,14 = 14/100 = 14% -->
        <div class="flex items-center gap-2 flex-wrap">
          <%= render 'shared/frazione', num: 7, den: 50, border: nil %>
          <span>=</span>
          <input type="text" data-correct-answer="7 : 50" class="w-16 border-b-2 border-dotted border-gray-400 text-center font-bold bg-transparent">
          <span>=</span>
          <input type="text" data-correct-answer="0,14" class="w-14 border-b-2 border-dotted border-gray-400 text-center font-bold bg-transparent">
          <span>=</span>
          <%= render 'shared/frazione', num: nil, den: nil, num_answer: "14", den_answer: "100" %>
          <span>=</span>
          <input type="text" data-correct-answer="14%" class="w-14 border-b-2 border-dotted border-gray-400 text-center font-bold bg-transparent">
        </div>
      </div>
    </div>

    <!-- Esercizio 5: Dalla percentuale all'intero -->
    <div>
      <p class="font-bold text-gray-700 mb-4">
        <%= numero_esercizio_badge(5) %>
        Conosci il valore della percentuale: calcola l'intero come nell'esempio.
      </p>

      <div class="flex flex-col md:flex-row gap-6">
        <div class="flex-1 space-y-3">
          <!-- Esempio: 54 è il 30% → 54 : 30 = 1,8 → 1,8 × 100 = 180 -->
          <div class="flex items-center gap-2 flex-wrap">
            <span class="text-gray-700">54 è il 30%</span>
            <span class="text-cyan-500">→</span>
            <span class="font-bold text-cyan-600">54 : 30 = 1,8</span>
            <span class="text-cyan-500">→</span>
            <span class="font-bold text-cyan-600">1,8 × 100 = 180</span>
          </div>
          <!-- 69 è il 15% -->
          <div class="flex items-center gap-2 flex-wrap">
            <span class="text-gray-700">69 è il 15%</span>
            <span class="text-cyan-500">→</span>
            <input type="text" data-correct-answer="69 : 15 = 4,6" class="w-32 border-b-2 border-dotted border-gray-400 text-center font-bold bg-transparent">
            <span class="text-cyan-500">→</span>
            <input type="text" data-correct-answer="4,6 × 100 = 460" class="w-36 border-b-2 border-dotted border-gray-400 text-center font-bold bg-transparent">
          </div>
          <!-- 693 è il 99% -->
          <div class="flex items-center gap-2 flex-wrap">
            <span class="text-gray-700">693 è il 99%</span>
            <span class="text-cyan-500">→</span>
            <input type="text" data-correct-answer="693 : 99 = 7" class="w-32 border-b-2 border-dotted border-gray-400 text-center font-bold bg-transparent">
            <span class="text-cyan-500">→</span>
            <input type="text" data-correct-answer="7 × 100 = 700" class="w-36 border-b-2 border-dotted border-gray-400 text-center font-bold bg-transparent">
          </div>
          <!-- 24 è l'8% -->
          <div class="flex items-center gap-2 flex-wrap">
            <span class="text-gray-700">24 è l'8%</span>
            <span class="text-cyan-500">→</span>
            <input type="text" data-correct-answer="24 : 8 = 3" class="w-32 border-b-2 border-dotted border-gray-400 text-center font-bold bg-transparent">
            <span class="text-cyan-500">→</span>
            <input type="text" data-correct-answer="3 × 100 = 300" class="w-36 border-b-2 border-dotted border-gray-400 text-center font-bold bg-transparent">
          </div>
        </div>

        <div class="p-4 bg-custom-blue-light rounded-2xl shrink-0">
          <p class="font-bold text-cyan-600 mb-2">Dalla percentuale all'intero</p>
          <div class="space-y-2">
            <p class="text-gray-700"><span class="font-bold">48</span> è il <span class="font-bold">20%</span> = <%= render 'shared/frazione', num: 20, den: 100, border: nil %> dell'intero</p>
            <p class="text-gray-700">48 : 20 = 2,4 (cioè <%= render 'shared/frazione', num: 1, den: 100, border: nil %>)</p>
            <p class="text-gray-700">2,4 × 100 = <span class="font-bold">240</span> (cioè <%= render 'shared/frazione', num: 100, den: 100, border: nil %>)</p>
          </div>
        </div>
      </div>
    </div>

    <%= render 'shared/exercise_controls' %>
  </div>
</div>
