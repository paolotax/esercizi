<div class="max-w-6xl mx-auto bg-white p-3 md:p-6"
     data-controller="exercise-checker text-toggle font-controls"
     data-text-toggle-target="content"
     data-font-controls-target="content">

  <%= render 'shared/page_header', pagina: @pagina %>

  <div class="space-y-6">

    <!-- Esercizio 1: IMPARARE TUTTI - Collega numero e scomposizione -->
    <div class="p-4 bg-white rounded-2xl border-3 border-yellow-400">
      <p class="font-bold text-gray-700 mb-4">
        <%= imparare_tutti_badge(1) %>
        Colora nello stesso modo il numero e la sua scomposizione.
      </p>

      <div class="grid grid-cols-2 md:grid-cols-4 gap-4 mb-6">
        <div class="p-3 bg-yellow-100 rounded border-2 border-yellow-400 text-center font-bold whitespace-nowrap">563 409</div>
        <div class="p-3 bg-white rounded border border-gray-300 text-center whitespace-nowrap">349 065</div>
        <div class="p-3 bg-white rounded border border-gray-300 text-center whitespace-nowrap">604 593</div>
        <div class="p-3 bg-white rounded border border-gray-300 text-center whitespace-nowrap">64 935</div>
      </div>

      <div class="grid grid-cols-1 md:grid-cols-2 gap-4 mb-6">
        <div class="p-3 bg-yellow-100 rounded border-2 border-yellow-400 text-center font-bold">6 dak 5 hk 9 u 4 h 3 uk</div>
        <div class="p-3 bg-white rounded border border-gray-300 text-center">9 uk 5 u 3 hk 6 da 4 dak</div>
        <div class="p-3 bg-white rounded border border-gray-300 text-center">3 u 9 da 6 hk 4 uk 5 h</div>
        <div class="p-3 bg-white rounded border border-gray-300 text-center">6 dak 9 h 4 uk 3 da 5 u</div>
      </div>

      <!-- Tabella di aiuto -->
      <div class="p-3 bg-cyan-50 rounded border border-cyan-300">
        <p class="text-gray-600 mb-2">La tabella ti aiuta a comprendere il valore di ogni cifra:</p>
        <table class="border-collapse border-2 border-cyan-400">
          <thead>
            <tr>
              <th class="p-2 border-2 border-cyan-400 bg-custom-blue-light text-center">hk</th>
              <th class="p-2 border-2 border-cyan-400 bg-custom-blue-light text-center">dak</th>
              <th class="p-2 border-2 border-cyan-400 bg-custom-blue-light text-center">uk</th>
              <th class="p-2 border-2 border-cyan-400 bg-custom-blue-light text-center">h</th>
              <th class="p-2 border-2 border-cyan-400 bg-custom-blue-light text-center">da</th>
              <th class="p-2 border-2 border-cyan-400 bg-custom-blue-light text-center">u</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td class="p-2 border-2 border-cyan-400 text-center bg-white font-bold">5</td>
              <td class="p-2 border-2 border-cyan-400 text-center bg-white font-bold">6</td>
              <td class="p-2 border-2 border-cyan-400 text-center bg-white font-bold">3</td>
              <td class="p-2 border-2 border-cyan-400 text-center bg-white font-bold">4</td>
              <td class="p-2 border-2 border-cyan-400 text-center bg-white font-bold">0</td>
              <td class="p-2 border-2 border-cyan-400 text-center bg-white font-bold">9</td>
            </tr>
          </tbody>
        </table>
      </div>
    </div>

    <!-- Esercizio 2: Componi i numeri -->
    <div>
      <p class="font-bold text-gray-700 mb-4">
        <%= numero_esercizio_badge(2) %>
        Componi i numeri. Segui l'esempio.
      </p>

      <div class="space-y-3">
        <div class="p-3 bg-cyan-50 rounded">
          <span class="font-bold">5 × 100 000 + 0 × 10 000 + 6 × 1 000 + 9 × 100 + 4 × 10 + 7 × 1</span>
          <span class="text-cyan-500">→</span>
          <span class="font-bold text-cyan-600 whitespace-nowrap">506 947</span>
        </div>
        <% [
          { expr: "3 × 10 000 + 6 × 1 000 + 4 × 100 + 1 × 10 + 2 × 1", answer: "36412" },
          { expr: "2 × 100 000 + 1 × 10 000 + 5 × 1 000 + 0 × 100 + 0 × 10 + 3 × 1", answer: "215003" },
          { expr: "8 × 10 000 + 7 × 1 000 + 0 × 100 + 0 × 10 + 1 × 1", answer: "87001" },
          { expr: "1 × 100 000 + 8 × 10 000 + 0 × 1 000 + 4 × 100 + 7 × 10 + 8 × 1", answer: "180478" },
          { expr: "4 × 100 000 + 2 × 10 000 + 6 × 1 000 + 9 × 100 + 2 × 10 + 4 × 1", answer: "426924" },
          { expr: "1 × 10 000 + 0 × 1 000 + 5 × 100 + 0 × 10 + 5 × 1", answer: "10505" }
        ].each do |item| %>
          <div class="flex flex-wrap items-center gap-2">
            <span><%= item[:expr] %></span>
            <span class="text-cyan-500">→</span>
            <input type="text" data-correct-answer="<%= item[:answer] %>" class="w-24 border-b-2 border-dotted border-gray-400 text-center font-bold bg-transparent">
          </div>
        <% end %>
      </div>
    </div>

    <!-- Esercizio 3: Completa la tabella componendo e scomponendo -->
    <div>
      <p class="font-bold text-gray-700 mb-4">
        <%= numero_esercizio_badge(3) %>
        Completa la tabella componendo e scomponendo i numeri. Segui l'esempio.
      </p>

      <div class="overflow-x-auto">
        <table class="w-full border-collapse border-2 border-cyan-400">
          <thead>
            <tr>
              <th class="p-2 border-2 border-cyan-400 bg-custom-blue-light text-center">Numero</th>
              <th class="p-2 border-2 border-cyan-400 bg-custom-blue-light text-center">Scomposizione in valori</th>
              <th class="p-2 border-2 border-cyan-400 bg-custom-blue-light text-center">Scomposizione in addendi</th>
            </tr>
          </thead>
          <tbody>
            <!-- Esempio -->
            <tr class="bg-cyan-50">
              <td class="p-2 border-2 border-cyan-400 text-center font-bold whitespace-nowrap">23 745</td>
              <td class="p-2 border-2 border-cyan-400 text-center font-bold text-cyan-600">2 dak 3 uk 7 h 4 da 5 u</td>
              <td class="p-2 border-2 border-cyan-400 text-center font-bold text-cyan-600 whitespace-nowrap">20 000 + 3 000 + 700 + 40 + 5</td>
            </tr>
            <tr>
              <td class="p-2 border-2 border-cyan-400 text-center font-bold whitespace-nowrap">69 039</td>
              <td class="p-2 border-2 border-cyan-400 text-center bg-white">
                <input type="text" data-correct-answer="6 dak 9 uk 0 h 3 da 9 u" class="w-full border-b-2 border-dotted border-gray-400 text-center font-bold bg-transparent" placeholder="...">
              </td>
              <td class="p-2 border-2 border-cyan-400 text-center bg-white">
                <input type="text" data-correct-answer="60000+9000+0+30+9" class="w-full border-b-2 border-dotted border-gray-400 text-center font-bold bg-transparent" placeholder="...">
              </td>
            </tr>
            <tr>
              <td class="p-2 border-2 border-cyan-400 text-center bg-white">
                <input type="text" data-correct-answer="890612" class="w-20 border-b-2 border-dotted border-gray-400 text-center font-bold bg-transparent">
              </td>
              <td class="p-2 border-2 border-cyan-400 text-center bg-white">
                <input type="text" class="w-full border-b-2 border-dotted border-gray-400 text-center font-bold bg-transparent" placeholder="...">
              </td>
              <td class="p-2 border-2 border-cyan-400 text-center font-bold whitespace-nowrap">800 000 + 90 000 + 600 + 10 + 2</td>
            </tr>
            <tr>
              <td class="p-2 border-2 border-cyan-400 text-center bg-white">
                <input type="text" data-correct-answer="37560" class="w-20 border-b-2 border-dotted border-gray-400 text-center font-bold bg-transparent">
              </td>
              <td class="p-2 border-2 border-cyan-400 text-center font-bold">3 dak 7 uk 5 h 6 da</td>
              <td class="p-2 border-2 border-cyan-400 text-center bg-white">
                <input type="text" data-correct-answer="30000+7000+500+60+0" class="w-full border-b-2 border-dotted border-gray-400 text-center font-bold bg-transparent" placeholder="...">
              </td>
            </tr>
            <tr>
              <td class="p-2 border-2 border-cyan-400 text-center font-bold whitespace-nowrap">591 240</td>
              <td class="p-2 border-2 border-cyan-400 text-center bg-white">
                <input type="text" data-correct-answer="5 hk 9 dak 1 uk 2 h 4 da 0 u" class="w-full border-b-2 border-dotted border-gray-400 text-center font-bold bg-transparent" placeholder="...">
              </td>
              <td class="p-2 border-2 border-cyan-400 text-center bg-white">
                <input type="text" data-correct-answer="500000+90000+1000+200+40+0" class="w-full border-b-2 border-dotted border-gray-400 text-center font-bold bg-transparent" placeholder="...">
              </td>
            </tr>
            <tr>
              <td class="p-2 border-2 border-cyan-400 text-center bg-white">
                <input type="text" data-correct-answer="15030" class="w-20 border-b-2 border-dotted border-gray-400 text-center font-bold bg-transparent">
              </td>
              <td class="p-2 border-2 border-cyan-400 text-center bg-white">
                <input type="text" class="w-full border-b-2 border-dotted border-gray-400 text-center font-bold bg-transparent" placeholder="...">
              </td>
              <td class="p-2 border-2 border-cyan-400 text-center font-bold whitespace-nowrap">10 000 + 5 000 + 30</td>
            </tr>
            <tr>
              <td class="p-2 border-2 border-cyan-400 text-center bg-white">
                <input type="text" data-correct-answer="249051" class="w-20 border-b-2 border-dotted border-gray-400 text-center font-bold bg-transparent">
              </td>
              <td class="p-2 border-2 border-cyan-400 text-center font-bold">2 hk 4 dak 9 uk 5 da 1 u</td>
              <td class="p-2 border-2 border-cyan-400 text-center bg-white">
                <input type="text" data-correct-answer="200000+40000+9000+0+50+1" class="w-full border-b-2 border-dotted border-gray-400 text-center font-bold bg-transparent" placeholder="...">
              </td>
            </tr>
          </tbody>
        </table>
      </div>
    </div>

    <!-- Esercizio 4: Scomponi sul quaderno -->
    <div>
      <p class="font-bold text-gray-700 mb-4">
        <%= numero_esercizio_badge(4) %>
        Scomponi sul quaderno i seguenti numeri. Segui l'esempio.
      </p>

      <div class="flex flex-wrap gap-3 mb-4">
        <span class="font-bold text-cyan-600 whitespace-nowrap">13 527</span>
        <span class="text-cyan-500">•</span>
        <span class="whitespace-nowrap">4 829</span>
        <span class="text-cyan-500">•</span>
        <span class="whitespace-nowrap">95 813</span>
        <span class="text-cyan-500">•</span>
        <span class="whitespace-nowrap">38 746</span>
        <span class="text-cyan-500">•</span>
        <span>428</span>
        <span class="text-cyan-500">•</span>
        <span class="whitespace-nowrap">258 734</span>
        <span class="text-cyan-500">•</span>
        <span class="whitespace-nowrap">3 318</span>
        <span class="text-cyan-500">•</span>
        <span class="whitespace-nowrap">8 647</span>
        <span class="text-cyan-500">•</span>
        <span class="whitespace-nowrap">46 851</span>
      </div>

      <div class="p-3 bg-cyan-50 rounded border border-cyan-300">
        <p class="font-bold text-cyan-600 whitespace-nowrap">13 527</p>
        <p class="text-gray-700">= 1 × 10 000 + 3 × 1 000 + 5 × 100 + 2 × 10 + 7 × 1 = 10 000 + 3 000 + 500 + 20 + 7</p>
      </div>
    </div>

    <%= render 'shared/exercise_controls' %>
  </div>
</div>
