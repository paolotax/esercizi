<div class="max-w-6xl mx-auto bg-white p-3 md:p-6"
     data-controller="exercise-checker text-toggle font-controls"
     data-text-toggle-target="content"
     data-font-controls-target="content">

  <%= render 'shared/page_header', pagina: @pagina %>

  <div class="space-y-6">

    <!-- IMPARARE TUTTI - Esercizio 1 -->
    <div class="p-4 md:p-6 bg-orange-100 rounded-2xl">

      <div class="p-4 bg-white rounded-2xl -mx-4 md:-mx-6 -mt-4 md:-mt-6 mb-6 border-3 border-blue-500">
        <p class="font-bold text-gray-700 mb-4">
          <%= imparare_tutti_badge(1) %>
          Calcola in riga.
        </p>

        <div class="grid grid-cols-2 md:grid-cols-4 gap-4">
          <!-- Colonna a) -->
          <div class="space-y-2">
            <p class="font-bold text-<%= @pagina.base_color %>-600">a)</p>
            <div class="flex items-center gap-1">
              <span class="text-gray-700">460 + 104 =</span>
              <span class="font-bold text-<%= @pagina.base_color %>-600">564</span>
            </div>
            <div class="flex items-center gap-1">
              <span class="text-gray-700">220 + 109 =</span>
              <input type="text" data-correct-answer="329" class="w-16 border-b-2 border-dotted border-gray-400 text-center font-bold bg-transparent">
            </div>
            <div class="flex items-center gap-1">
              <span class="text-gray-700">26 + 121 =</span>
              <input type="text" data-correct-answer="147" class="w-16 border-b-2 border-dotted border-gray-400 text-center font-bold bg-transparent">
            </div>
          </div>

          <!-- Colonna b) -->
          <div class="space-y-2">
            <p class="font-bold text-<%= @pagina.base_color %>-600">b)</p>
            <div class="flex items-center gap-1">
              <span class="text-gray-700">38 + 52 =</span>
              <input type="text" data-correct-answer="90" class="w-16 border-b-2 border-dotted border-gray-400 text-center font-bold bg-transparent">
            </div>
            <div class="flex items-center gap-1">
              <span class="text-gray-700">56 + 173 =</span>
              <input type="text" data-correct-answer="229" class="w-16 border-b-2 border-dotted border-gray-400 text-center font-bold bg-transparent">
            </div>
            <div class="flex items-center gap-1">
              <span class="text-gray-700">208 + 65 =</span>
              <input type="text" data-correct-answer="273" class="w-16 border-b-2 border-dotted border-gray-400 text-center font-bold bg-transparent">
            </div>
          </div>

          <!-- Colonna c) -->
          <div class="space-y-2">
            <p class="font-bold text-<%= @pagina.base_color %>-600">c)</p>
            <div class="flex items-center gap-1">
              <span class="text-gray-700">95 − 74 =</span>
              <span class="font-bold text-<%= @pagina.base_color %>-600">21</span>
            </div>
            <div class="flex items-center gap-1">
              <span class="text-gray-700">165 − 132 =</span>
              <input type="text" data-correct-answer="33" class="w-16 border-b-2 border-dotted border-gray-400 text-center font-bold bg-transparent">
            </div>
            <div class="flex items-center gap-1">
              <span class="text-gray-700">275 − 190 =</span>
              <input type="text" data-correct-answer="85" class="w-16 border-b-2 border-dotted border-gray-400 text-center font-bold bg-transparent">
            </div>
          </div>

          <!-- Colonna d) -->
          <div class="space-y-2">
            <p class="font-bold text-<%= @pagina.base_color %>-600">d)</p>
            <div class="flex items-center gap-1">
              <span class="text-gray-700">307 − 124 =</span>
              <input type="text" data-correct-answer="183" class="w-16 border-b-2 border-dotted border-gray-400 text-center font-bold bg-transparent">
            </div>
            <div class="flex items-center gap-1">
              <span class="text-gray-700">240 − 170 =</span>
              <input type="text" data-correct-answer="70" class="w-16 border-b-2 border-dotted border-gray-400 text-center font-bold bg-transparent">
            </div>
            <div class="flex items-center gap-1">
              <span class="text-gray-700">165 − 38 =</span>
              <input type="text" data-correct-answer="127" class="w-16 border-b-2 border-dotted border-gray-400 text-center font-bold bg-transparent">
            </div>
          </div>
        </div>
      </div>

      <div class="grid grid-cols-1 md:grid-cols-2 gap-6 md:divide-x-2 md:divide-orange-300">
        <!-- Esercizio 2 -->
        <div class="md:pr-4">
          <p class="font-bold text-gray-700 mb-4">
            <%= numero_esercizio_badge(2) %>
            Traduci in simboli e calcola.
          </p>
          <div class="space-y-3">
            <div>
              <p class="text-gray-700">La differenza fra 124 e 38. <span class="text-<%= @pagina.base_color %>-500">→</span> <span class="font-bold text-<%= @pagina.base_color %>-600">124 − 38 = 86</span></p>
            </div>
            <div class="flex items-center gap-2">
              <span class="text-gray-700">La differenza fra 200 e 72. <span class="text-<%= @pagina.base_color %>-500">→</span></span>
              <input type="text" data-correct-answer="200 - 72 = 128" class="min-w-0 flex-1 border-b-2 border-dotted border-gray-400 text-center font-bold bg-transparent">
            </div>
            <div class="flex items-center gap-2">
              <span class="text-gray-700">La somma di 124 e 89. <span class="text-<%= @pagina.base_color %>-500">→</span></span>
              <input type="text" data-correct-answer="124 + 89 = 213" class="min-w-0 flex-1 border-b-2 border-dotted border-gray-400 text-center font-bold bg-transparent">
            </div>
            <div class="flex items-center gap-2">
              <span class="text-gray-700">La somma di 75 e 207. <span class="text-<%= @pagina.base_color %>-500">→</span></span>
              <input type="text" data-correct-answer="75 + 207 = 282" class="min-w-0 flex-1 border-b-2 border-dotted border-gray-400 text-center font-bold bg-transparent">
            </div>
          </div>
        </div>

        <!-- Esercizio 3 -->
        <div class="md:pl-4">
          <p class="font-bold text-gray-700 mb-4">
            <%= numero_esercizio_badge(3) %>
            Calcola in colonna sul quaderno.
          </p>
          <div class="space-y-2">
            <p class="text-gray-700"><span class="font-bold text-<%= @pagina.base_color %>-600">a)</span> 903 + 450 = <span class="text-<%= @pagina.base_color %>-500">•</span> 704 + 250 = <span class="text-<%= @pagina.base_color %>-500">•</span> 8 004 + 1 543 =</p>
            <p class="text-gray-700 ml-4">3 546 + 2 004 = <span class="text-<%= @pagina.base_color %>-500">•</span> 902 + 1 106 = <span class="text-<%= @pagina.base_color %>-500">•</span> 7 654 + 548 =</p>
            <p class="text-gray-700"><span class="font-bold text-<%= @pagina.base_color %>-600">b)</span> 867 − 402 = <span class="text-<%= @pagina.base_color %>-500">•</span> 980 − 405 = <span class="text-<%= @pagina.base_color %>-500">•</span> 709 − 590 =</p>
            <p class="text-gray-700 ml-4">560 − 382 = <span class="text-<%= @pagina.base_color %>-500">•</span> 3 658 − 2 671 = <span class="text-<%= @pagina.base_color %>-500">•</span> 1 208 − 834 =</p>
          </div>
        </div>
      </div>

      <!-- Esercizio 4 -->
      <div class="mt-6">
        <p class="font-bold text-gray-700 mb-4">
          <%= numero_esercizio_badge(4) %>
          Quali cifre vanno messe al posto delle faccine perch&eacute; ogni operazione risulti corretta? Calcola e riscrivi le operazioni complete.
        </p>

        <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
          <div class="space-y-4">
            <p class="font-bold text-<%= @pagina.base_color %>-600">a)</p>
            <div class="space-y-2">
              <p class="text-gray-700"><span class="text-yellow-500">&#9786;</span>568 + 1 3<span class="text-yellow-500">&#9786;</span>1 = 3 869</p>
              <input type="text" data-correct-answer="2568 + 1301 = 3869" class="w-full border-b-2 border-dotted border-gray-400 text-center font-bold bg-transparent">
            </div>
            <div class="space-y-2">
              <p class="text-gray-700">2 6<span class="text-yellow-500">&#9786;</span>3 + <span class="text-yellow-500">&#9786;</span>147 = 4 750</p>
              <input type="text" data-correct-answer="2603 + 2147 = 4750" class="w-full border-b-2 border-dotted border-gray-400 text-center font-bold bg-transparent">
            </div>
          </div>
          <div class="space-y-4">
            <p class="font-bold text-<%= @pagina.base_color %>-600">b)</p>
            <div class="space-y-2">
              <p class="text-gray-700">5 384 − <span class="text-yellow-500">&#9786;</span>1<span class="text-yellow-500">&#9786;</span>2 = 3 232</p>
              <input type="text" data-correct-answer="5384 - 2152 = 3232" class="w-full border-b-2 border-dotted border-gray-400 text-center font-bold bg-transparent">
            </div>
            <div class="space-y-2">
              <p class="text-gray-700">2 684 − 1<span class="text-yellow-500">&#9786;</span>2<span class="text-yellow-500">&#9786;</span> = 863</p>
              <input type="text" data-correct-answer="2684 - 1821 = 863" class="w-full border-b-2 border-dotted border-gray-400 text-center font-bold bg-transparent">
            </div>
          </div>
        </div>
      </div>

      <!-- Esercizio 5 -->
      <div class="mt-6">
        <p class="font-bold text-gray-700 mb-4">
          <%= numero_esercizio_badge(5) %>
          Segna con una <span class="font-bold">X</span> la risposta corretta.
        </p>

        <div class="space-y-4">
          <div>
            <p class="text-gray-700 mb-2">Dov'&egrave; stata applicata correttamente la propriet&agrave; associativa per calcolare 127 + 13 + 28?</p>
            <div class="grid grid-cols-2 md:grid-cols-4 gap-2">
              <label class="flex items-center gap-2 cursor-pointer hover:bg-gray-50 p-2 rounded border border-gray-200">
                <input type="radio" name="associativa" class="w-5 h-5" data-correct-answer="false">
                <span>127 + 28 + 13 =</span>
              </label>
              <label class="flex items-center gap-2 cursor-pointer hover:bg-gray-50 p-2 rounded border border-gray-200">
                <input type="radio" name="associativa" class="w-5 h-5" data-correct-answer="false">
                <span>28 + 13 + 127 =</span>
              </label>
              <label class="flex items-center gap-2 cursor-pointer hover:bg-gray-50 p-2 rounded border border-gray-200">
                <input type="radio" name="associativa" class="w-5 h-5" data-correct-answer="false">
                <span>(120 + 7) + 13 + 28 =</span>
              </label>
              <label class="flex items-center gap-2 cursor-pointer hover:bg-gray-50 p-2 rounded border border-gray-200">
                <input type="radio" name="associativa" class="w-5 h-5" data-correct-answer="true">
                <span>(127 + 13) + 28 =</span>
              </label>
            </div>
          </div>

          <div>
            <p class="text-gray-700 mb-2">Dov'&egrave; stata applicata correttamente la propriet&agrave; invariantiva per calcolare 294 − 184?</p>
            <div class="grid grid-cols-2 md:grid-cols-4 gap-2">
              <label class="flex items-center gap-2 cursor-pointer hover:bg-gray-50 p-2 rounded border border-gray-200">
                <input type="radio" name="invariantiva" class="w-5 h-5" data-correct-answer="false">
                <span>(294 &times; 6) − (184 &times; 6) =</span>
              </label>
              <label class="flex items-center gap-2 cursor-pointer hover:bg-gray-50 p-2 rounded border border-gray-200">
                <input type="radio" name="invariantiva" class="w-5 h-5" data-correct-answer="true">
                <span>(294 + 6) − (184 + 6) =</span>
              </label>
              <label class="flex items-center gap-2 cursor-pointer hover:bg-gray-50 p-2 rounded border border-gray-200">
                <input type="radio" name="invariantiva" class="w-5 h-5" data-correct-answer="false">
                <span>(294 − 4) − (184 + 4) =</span>
              </label>
              <label class="flex items-center gap-2 cursor-pointer hover:bg-gray-50 p-2 rounded border border-gray-200">
                <input type="radio" name="invariantiva" class="w-5 h-5" data-correct-answer="false">
                <span>(294 : 2) − (184 : 2) =</span>
              </label>
            </div>
          </div>
        </div>
      </div>

      <div class="grid grid-cols-1 md:grid-cols-2 gap-6 md:divide-x-2 md:divide-orange-300 mt-6">
        <!-- Esercizio 6 -->
        <div class="md:pr-4">
          <p class="font-bold text-gray-700 mb-4">
            <%= numero_esercizio_badge(6) %>
            Applica la propriet&agrave; commutativa e calcola sul quaderno.
          </p>
          <p class="text-gray-700">37 + 140 = <span class="text-<%= @pagina.base_color %>-500">•</span> 15 + 199 = <span class="text-<%= @pagina.base_color %>-500">•</span> 230 + 576 =</p>
          <p class="text-gray-700">270 + 2 500 = <span class="text-<%= @pagina.base_color %>-500">•</span> 1 580 + 7 300 =</p>
        </div>

        <!-- Esercizio 7 -->
        <div class="md:pl-4">
          <p class="font-bold text-gray-700 mb-4">
            <%= numero_esercizio_badge(7) %>
            Cerchia i numeri che ti conviene associare per semplificare il calcolo ed esegui sul quaderno.
          </p>
          <div class="space-y-2">
            <p class="text-gray-700"><span class="px-1 border-2 border-<%= @pagina.base_color %>-400 rounded">26</span> + <span class="px-1 border-2 border-<%= @pagina.base_color %>-400 rounded">14</span> + 35 = <span class="font-bold text-<%= @pagina.base_color %>-600">40 + 35 = 75</span></p>
            <p class="text-gray-700">43 + 38 + 12 = <span class="text-<%= @pagina.base_color %>-500">•</span> 45 + 5 + 28 = <span class="text-<%= @pagina.base_color %>-500">•</span> 49 + 11 + 24 =</p>
          </div>
        </div>
      </div>

      <div class="grid grid-cols-1 md:grid-cols-2 gap-6 md:divide-x-2 md:divide-orange-300 mt-6">
        <!-- Esercizio 8 -->
        <div class="md:pr-4">
          <p class="font-bold text-gray-700 mb-4">
            <%= numero_esercizio_badge(8) %>
            Completa le seguenti addizioni. Per trovare i numeri mancanti, usa l'operazione inversa.
          </p>
          <div class="space-y-2">
            <div class="flex items-center gap-2">
              <span class="text-gray-700">48 +</span>
              <input type="text" data-correct-answer="12" class="w-16 border-b-2 border-dotted border-gray-400 text-center font-bold bg-transparent">
              <span class="text-gray-700">= 60</span>
            </div>
            <div class="flex items-center gap-2">
              <span class="text-gray-700">437 +</span>
              <input type="text" data-correct-answer="13" class="w-16 border-b-2 border-dotted border-gray-400 text-center font-bold bg-transparent">
              <span class="text-gray-700">= 450</span>
            </div>
            <div class="flex items-center gap-2">
              <input type="text" data-correct-answer="13" class="w-16 border-b-2 border-dotted border-gray-400 text-center font-bold bg-transparent">
              <span class="text-gray-700">+ 24 = 37</span>
            </div>
            <div class="flex items-center gap-2">
              <input type="text" data-correct-answer="357" class="w-16 border-b-2 border-dotted border-gray-400 text-center font-bold bg-transparent">
              <span class="text-gray-700">+ 203 = 560</span>
            </div>
          </div>
        </div>

        <!-- Esercizio 9 -->
        <div class="md:pl-4">
          <p class="font-bold text-gray-700 mb-4">
            <%= numero_esercizio_badge(9) %>
            Completa le seguenti sottrazioni e trova i numeri mancanti.
          </p>
          <div class="space-y-2">
            <div class="flex items-center gap-2">
              <span class="text-gray-700">945 −</span>
              <input type="text" data-correct-answer="620" class="w-16 border-b-2 border-dotted border-gray-400 text-center font-bold bg-transparent">
              <span class="text-gray-700">= 325</span>
            </div>
            <div class="flex items-center gap-2">
              <input type="text" data-correct-answer="209" class="w-16 border-b-2 border-dotted border-gray-400 text-center font-bold bg-transparent">
              <span class="text-gray-700">− 89 = 120</span>
            </div>
            <div class="flex items-center gap-2">
              <input type="text" data-correct-answer="488" class="w-16 border-b-2 border-dotted border-gray-400 text-center font-bold bg-transparent">
              <span class="text-gray-700">− 184 = 304</span>
            </div>
            <div class="flex items-center gap-2">
              <span class="text-gray-700">856 −</span>
              <input type="text" data-correct-answer="530" class="w-16 border-b-2 border-dotted border-gray-400 text-center font-bold bg-transparent">
              <span class="text-gray-700">= 326</span>
            </div>
          </div>
        </div>
      </div>

    </div>

    <%= render 'shared/exercise_controls' %>
  </div>
</div>
