<div class="max-w-7xl mx-auto p-3 md:p-6 bg-white"
     data-controller="exercise-checker fill-blanks auto-advance"
     data-page-viewer-image-url-value="<%= asset_path('bus3_mat/p044/page.png') %>">

  <!-- Header -->
  <%= render 'shared/page_header', pagina: @pagina %>

  <!-- Esercizio 1 -->
  <div class="bg-transparent p-4 md:p-8 mb-8">
    <div class="flex items-center gap-3 mb-6">
      <div class="bg-red-500 text-white rounded-full w-8 h-8 flex items-center justify-center font-bold flex-shrink-0">
        1
      </div>
      <p class="text-base md:text-lg text-gray-700">
        <strong>Osserva e completa le frasi.</strong>
      </p>
    </div>

    <!-- Proprietà commutativa -->
    <div class="mb-8">
      <div class="flex justify-center mb-4">
        <%= image_tag "bus3_mat/p044/p44_1.jpg",
            alt: "Proprietà commutativa",
            class: "max-w-full" %>
      </div>

      <div class="ml-6 mb-4">
        <p class="text-base text-gray-700 mb-3">
          • Nelle due operazioni hai cambiato l'ordine dei fattori. Il risultato è:
        </p>
        <div class="flex items-center gap-6 ml-6">
          <label class="flex items-center gap-2 cursor-pointer">
            <input type="checkbox" data-correct-answer="true" class="w-5 h-5">
            <span class="font-bold">uguale.</span>
          </label>
          <label class="flex items-center gap-2 cursor-pointer">
            <input type="checkbox" data-correct-answer="false" class="w-5 h-5">
            <span class="font-bold">diverso.</span>
          </label>
        </div>
      </div>

      <p class="text-base text-gray-700 ml-6 mb-6">
        Hai applicato la <span class="underline font-bold">proprietà commutativa</span>.
      </p>
    </div>

    <!-- Proprietà associativa -->
    <div class="mb-8">
      <div class="flex justify-center mb-4">
        <%= image_tag "bus3_mat/p044/p44_2.jpg",
            alt: "Proprietà associativa",
            class: "max-w-full" %>
      </div>

      <div class="ml-6 mb-4">
        <p class="text-base text-gray-700 mb-3">
          • A due fattori hai sostituito il loro prodotto. Il risultato è:
        </p>
        <div class="flex items-center gap-6 ml-6">
          <label class="flex items-center gap-2 cursor-pointer">
            <input type="checkbox" data-correct-answer="true" class="w-5 h-5">
            <span class="font-bold">uguale.</span>
          </label>
          <label class="flex items-center gap-2 cursor-pointer">
            <input type="checkbox" data-correct-answer="false" class="w-5 h-5">
            <span class="font-bold">diverso.</span>
          </label>
        </div>
      </div>

      <p class="text-base text-gray-700 ml-6">
        Hai applicato la <span class="underline font-bold">proprietà associativa</span>.
      </p>
    </div>

    <!-- Box teorico -->
    <div class="bg-green-50 border-3 border-green-400 rounded-lg p-6">
      <ul class="space-y-3">
        <li class="text-base text-gray-700">
          <span class="underline font-bold">Proprietà commutativa</span><strong>: se cambi l'ordine dei fattori, il risultato non cambia. Puoi usare questa proprietà per verificare se il risultato è corretto.</strong>
        </li>
        <li class="text-base text-gray-700">
          <strong><span class="underline">Proprietà associativa</span>: se sostituisci a due fattori il loro prodotto il risultato non cambia.</strong>
        </li>
      </ul>
    </div>
  </div>

  <!-- Esercizio 2 -->
  <div class="bg-transparent p-4 md:p-8 mb-8">
    <div class="flex items-center gap-3 mb-6">
      <div class="bg-red-500 text-white rounded-full w-8 h-8 flex items-center justify-center font-bold flex-shrink-0">
        2
      </div>
      <p class="text-base md:text-lg text-gray-700">
        <strong>Calcola in riga. Poi verifica il risultato con la proprietà commutativa.</strong>
      </p>
    </div>

    <div class="space-y-6">
      <!-- Esempio -->
      <div class="grid grid-cols-1 md:grid-cols-2 gap-4 items-center">
        <div class="text-center p-3 bg-gray-50 rounded">
          <span class="text-lg font-bold">7 × 5 = 35</span>
        </div>
        <div class="text-center p-3 bg-gray-50 rounded">
          <span class="text-lg font-bold">5 × 7 = 35</span>
        </div>
      </div>

      <!-- Problema 1 -->
      <div class="grid grid-cols-1 md:grid-cols-2 gap-4 items-center">
        <div class="flex items-center gap-2 justify-center flex-wrap">
          <span class="font-bold">5 × 9 =</span>
          <input type="text" data-fill-blanks-target="input" data-correct-answer="45"
                 class="w-16 px-2 py-1 border-b-2 border-dotted border-gray-400 text-center font-bold"
                 maxlength="2" inputmode="numeric">
        </div>
        <div class="flex items-center gap-2 justify-center flex-wrap">
          <input type="text" data-fill-blanks-target="input" data-correct-answer="9"
                 class="w-12 px-2 py-1 border-b-2 border-dotted border-gray-400 text-center font-bold"
                 maxlength="1" inputmode="numeric">
          <span>×</span>
          <input type="text" data-fill-blanks-target="input" data-correct-answer="5"
                 class="w-12 px-2 py-1 border-b-2 border-dotted border-gray-400 text-center font-bold"
                 maxlength="1" inputmode="numeric">
          <span>=</span>
          <input type="text" data-fill-blanks-target="input" data-correct-answer="45"
                 class="w-16 px-2 py-1 border-b-2 border-dotted border-gray-400 text-center font-bold"
                 maxlength="2" inputmode="numeric">
        </div>
      </div>

      <!-- Problema 2 -->
      <div class="grid grid-cols-1 md:grid-cols-2 gap-4 items-center">
        <div class="flex items-center gap-2 justify-center flex-wrap">
          <span class="font-bold">8 × 7 =</span>
          <input type="text" data-fill-blanks-target="input" data-correct-answer="56"
                 class="w-16 px-2 py-1 border-b-2 border-dotted border-gray-400 text-center font-bold"
                 maxlength="2" inputmode="numeric">
        </div>
        <div class="flex items-center gap-2 justify-center flex-wrap">
          <input type="text" data-fill-blanks-target="input" data-correct-answer="7"
                 class="w-12 px-2 py-1 border-b-2 border-dotted border-gray-400 text-center font-bold"
                 maxlength="1" inputmode="numeric">
          <span>×</span>
          <input type="text" data-fill-blanks-target="input" data-correct-answer="8"
                 class="w-12 px-2 py-1 border-b-2 border-dotted border-gray-400 text-center font-bold"
                 maxlength="1" inputmode="numeric">
          <span>=</span>
          <input type="text" data-fill-blanks-target="input" data-correct-answer="56"
                 class="w-16 px-2 py-1 border-b-2 border-dotted border-gray-400 text-center font-bold"
                 maxlength="2" inputmode="numeric">
        </div>
      </div>

      <!-- Problema 3 -->
      <div class="grid grid-cols-1 md:grid-cols-2 gap-4 items-center">
        <div class="flex items-center gap-2 justify-center flex-wrap">
          <span class="font-bold">6 × 8 =</span>
          <input type="text" data-fill-blanks-target="input" data-correct-answer="48"
                 class="w-16 px-2 py-1 border-b-2 border-dotted border-gray-400 text-center font-bold"
                 maxlength="2" inputmode="numeric">
        </div>
        <div class="flex items-center gap-2 justify-center flex-wrap">
          <input type="text" data-fill-blanks-target="input" data-correct-answer="8"
                 class="w-12 px-2 py-1 border-b-2 border-dotted border-gray-400 text-center font-bold"
                 maxlength="1" inputmode="numeric">
          <span>×</span>
          <input type="text" data-fill-blanks-target="input" data-correct-answer="6"
                 class="w-12 px-2 py-1 border-b-2 border-dotted border-gray-400 text-center font-bold"
                 maxlength="1" inputmode="numeric">
          <span>=</span>
          <input type="text" data-fill-blanks-target="input" data-correct-answer="48"
                 class="w-16 px-2 py-1 border-b-2 border-dotted border-gray-400 text-center font-bold"
                 maxlength="2" inputmode="numeric">
        </div>
      </div>

      <!-- Problema 4 -->
      <div class="grid grid-cols-1 md:grid-cols-2 gap-4 items-center">
        <div class="flex items-center gap-2 justify-center flex-wrap">
          <span class="font-bold">3 × 2 =</span>
          <input type="text" data-fill-blanks-target="input" data-correct-answer="6"
                 class="w-16 px-2 py-1 border-b-2 border-dotted border-gray-400 text-center font-bold"
                 maxlength="1" inputmode="numeric">
        </div>
        <div class="flex items-center gap-2 justify-center flex-wrap">
          <input type="text" data-fill-blanks-target="input" data-correct-answer="2"
                 class="w-12 px-2 py-1 border-b-2 border-dotted border-gray-400 text-center font-bold"
                 maxlength="1" inputmode="numeric">
          <span>×</span>
          <input type="text" data-fill-blanks-target="input" data-correct-answer="3"
                 class="w-12 px-2 py-1 border-b-2 border-dotted border-gray-400 text-center font-bold"
                 maxlength="1" inputmode="numeric">
          <span>=</span>
          <input type="text" data-fill-blanks-target="input" data-correct-answer="6"
                 class="w-16 px-2 py-1 border-b-2 border-dotted border-gray-400 text-center font-bold"
                 maxlength="1" inputmode="numeric">
        </div>
      </div>

      <!-- Problema 5 -->
      <div class="grid grid-cols-1 md:grid-cols-2 gap-4 items-center">
        <div class="flex items-center gap-2 justify-center flex-wrap">
          <span class="font-bold">9 × 4 =</span>
          <input type="text" data-fill-blanks-target="input" data-correct-answer="36"
                 class="w-16 px-2 py-1 border-b-2 border-dotted border-gray-400 text-center font-bold"
                 maxlength="2" inputmode="numeric">
        </div>
        <div class="flex items-center gap-2 justify-center flex-wrap">
          <input type="text" data-fill-blanks-target="input" data-correct-answer="4"
                 class="w-12 px-2 py-1 border-b-2 border-dotted border-gray-400 text-center font-bold"
                 maxlength="1" inputmode="numeric">
          <span>×</span>
          <input type="text" data-fill-blanks-target="input" data-correct-answer="9"
                 class="w-12 px-2 py-1 border-b-2 border-dotted border-gray-400 text-center font-bold"
                 maxlength="1" inputmode="numeric">
          <span>=</span>
          <input type="text" data-fill-blanks-target="input" data-correct-answer="36"
                 class="w-16 px-2 py-1 border-b-2 border-dotted border-gray-400 text-center font-bold"
                 maxlength="2" inputmode="numeric">
        </div>
      </div>
    </div>
  </div>

  <!-- Esercizio 3 -->
  <div class="bg-transparent p-4 md:p-8 mb-8">
    <div class="flex items-center gap-3 mb-6">
      <div class="bg-red-500 text-white rounded-full w-8 h-8 flex items-center justify-center font-bold flex-shrink-0">
        3
      </div>
      <p class="text-base md:text-lg text-gray-700">
        <strong>Applica la proprietà associativa. Segui l'esempio.</strong>
      </p>
    </div>

    <div class="flex justify-center mb-6">
      <%= image_tag "bus3_mat/p044/p44_3.jpg",
          alt: "Esempio proprietà associativa",
          class: "max-w-full" %>
    </div>

    <div class="space-y-8">
      <!-- Problema 1: 8 × 4 × 2 -->
      <div class="space-y-2">
        <div class="flex items-center justify-center gap-2 text-lg">
          <span class="font-bold">8</span>
          <span>×</span>
          <span class="font-bold">4</span>
          <span>×</span>
          <span class="font-bold">2</span>
          <span>=</span>
        </div>
        <div class="flex items-center justify-center gap-2 flex-wrap">
          <input type="text" data-fill-blanks-target="input" data-correct-answer="32"
                 class="w-16 px-2 py-1 border-b-2 border-dotted border-gray-400 text-center font-bold"
                 maxlength="2" inputmode="numeric">
          <span>×</span>
          <input type="text" data-fill-blanks-target="input" data-correct-answer="2"
                 class="w-16 px-2 py-1 border-b-2 border-dotted border-gray-400 text-center font-bold"
                 maxlength="1" inputmode="numeric">
          <span>=</span>
          <input type="text" data-fill-blanks-target="input" data-correct-answer="64"
                 class="w-16 px-2 py-1 border-b-2 border-dotted border-gray-400 text-center font-bold"
                 maxlength="2" inputmode="numeric">
        </div>
      </div>

      <!-- Problema 2: 3 × 6 × 5 -->
      <div class="space-y-2">
        <div class="flex items-center justify-center gap-2 text-lg">
          <span class="font-bold">3</span>
          <span>×</span>
          <span class="font-bold">6</span>
          <span>×</span>
          <span class="font-bold">5</span>
          <span>=</span>
        </div>
        <div class="flex items-center justify-center gap-2 flex-wrap">
          <input type="text" data-fill-blanks-target="input" data-correct-answer="18"
                 class="w-16 px-2 py-1 border-b-2 border-dotted border-gray-400 text-center font-bold"
                 maxlength="2" inputmode="numeric">
          <span>×</span>
          <input type="text" data-fill-blanks-target="input" data-correct-answer="5"
                 class="w-16 px-2 py-1 border-b-2 border-dotted border-gray-400 text-center font-bold"
                 maxlength="1" inputmode="numeric">
          <span>=</span>
          <input type="text" data-fill-blanks-target="input" data-correct-answer="90"
                 class="w-16 px-2 py-1 border-b-2 border-dotted border-gray-400 text-center font-bold"
                 maxlength="2" inputmode="numeric">
        </div>
      </div>

      <!-- Problema 3: 7 × 2 × 2 -->
      <div class="space-y-2">
        <div class="flex items-center justify-center gap-2 text-lg">
          <span class="font-bold">7</span>
          <span>×</span>
          <span class="font-bold">2</span>
          <span>×</span>
          <span class="font-bold">2</span>
          <span>=</span>
        </div>
        <div class="flex items-center justify-center gap-2 flex-wrap">
          <input type="text" data-fill-blanks-target="input" data-correct-answer="14"
                 class="w-16 px-2 py-1 border-b-2 border-dotted border-gray-400 text-center font-bold"
                 maxlength="2" inputmode="numeric">
          <span>×</span>
          <input type="text" data-fill-blanks-target="input" data-correct-answer="2"
                 class="w-16 px-2 py-1 border-b-2 border-dotted border-gray-400 text-center font-bold"
                 maxlength="1" inputmode="numeric">
          <span>=</span>
          <input type="text" data-fill-blanks-target="input" data-correct-answer="28"
                 class="w-16 px-2 py-1 border-b-2 border-dotted border-gray-400 text-center font-bold"
                 maxlength="2" inputmode="numeric">
        </div>
      </div>
    </div>
  </div>

  <!-- Footer con controlli -->
  <%= render 'shared/exercise_controls' %>
</div>
