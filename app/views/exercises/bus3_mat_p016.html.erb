<% content_for :titolo, "#{@pagina.titolo} - #{@pagina.numero}" %>

<div class="max-w-7xl mx-auto p-3 md:p-6 bg-white" data-controller="exercise-checker page-viewer" data-page-viewer-image-url-value="<%= asset_path('bus3_mat/p016/page.png') %>">
  <!-- Header -->
  <%= render 'shared/page_header', pagina: @pagina %>

  <!-- Esercizio 1: Osserva e leggi il numero a voce alta -->
  <div class="bg-transparent p-4 md:p-8 mb-8">
    <div class="flex items-start gap-3 mb-6">
      <div class="bg-red-500 text-white rounded-full w-8 h-8 flex items-center justify-center font-bold flex-shrink-0">
        1
      </div>
      <p class="text-base md:text-lg text-gray-700">
        Osserva e leggi il numero a voce alta.
      </p>
    </div>

    <div class="bg-gradient-to-r from-cyan-50 to-blue-50 border-3 border-cyan-400 rounded-2xl p-6 mb-6">
      <div class="overflow-x-auto">
        <table class="w-full">
          <thead>
            <tr class="border-b-2 border-cyan-400">
              <th class="px-4 py-3 text-center font-bold text-purple-600">migliaia (k)</th>
              <th class="px-4 py-3 text-center font-bold text-green-600">centinaia (h)</th>
              <th class="px-4 py-3 text-center font-bold text-red-600">decine (da)</th>
              <th class="px-4 py-3 text-center font-bold text-cyan-600">unitÃ  (u)</th>
            </tr>
          </thead>
          <tbody>
            <tr class="border-b-2 border-cyan-300">
              <td class="px-4 py-3 text-center text-3xl font-bold">4</td>
              <td class="px-4 py-3 text-center text-3xl font-bold">3</td>
              <td class="px-4 py-3 text-center text-3xl font-bold">2</td>
              <td class="px-4 py-3 text-center text-3xl font-bold">7</td>
            </tr>
            <tr>
              <td class="px-4 py-3 text-center font-bold">quattromila</td>
              <td class="px-4 py-3 text-center font-bold">trecento</td>
              <td class="px-4 py-3 text-center font-bold">venti</td>
              <td class="px-4 py-3 text-center font-bold">sette</td>
            </tr>
          </tbody>
        </table>
      </div>
    </div>

    <div class="bg-pink-50 border-3 border-pink-400 rounded-2xl p-6 mx-auto max-w-3xl">
      <div class="flex items-start gap-3">
        <div class="text-4xl">ðŸ˜Š</div>
        <div>
          <p class="text-base md:text-lg text-gray-700 mb-2">
            Per leggere un numero di 4 cifre, leggi <strong class="text-purple-600">mila</strong> dopo la cifra delle <strong>k</strong>.
            Se la cifra delle k Ã¨ <strong>1</strong>, leggi <strong class="text-purple-600">mille</strong>.
          </p>
          <p class="text-xl font-bold text-center text-gray-800 mt-4">
            1200 â†’ <span class="text-purple-600">mille</span>duecento
          </p>
        </div>
      </div>
    </div>
  </div>

  <!-- Esercizio 2: Leggi i numeri e completa la tabella -->
  <div class="bg-transparent p-4 md:p-8 mb-8" data-controller="fill-blanks auto-advance">
    <div class="flex items-start gap-3 mb-6">
      <div class="bg-red-500 text-white rounded-full w-8 h-8 flex items-center justify-center font-bold flex-shrink-0">
        2
      </div>
      <p class="text-base md:text-lg text-gray-700">
        Leggi i numeri e completa la tabella come nell'esempio.
      </p>
    </div>

    <div class="overflow-x-auto">
      <div class="border-3 border-cyan-400 rounded-2xl overflow-hidden">
        <table class="w-full">
          <thead>
            <tr class="bg-cyan-100">
              <th class="border-2 border-cyan-400 px-4 py-3 text-center font-bold">Numero</th>
              <th class="border-2 border-cyan-400 px-4 py-3 text-center font-bold">Scomposizione</th>
              <th class="border-2 border-cyan-400 px-4 py-3 text-center font-bold text-purple-600">k</th>
              <th class="border-2 border-cyan-400 px-4 py-3 text-center font-bold text-green-600">h</th>
              <th class="border-2 border-cyan-400 px-4 py-3 text-center font-bold text-red-600">da</th>
              <th class="border-2 border-cyan-400 px-4 py-3 text-center font-bold text-cyan-600">u</th>
            </tr>
          </thead>
          <tbody class="bg-white">
            <!-- Esempio: 2574 -->
            <tr>
              <td class="border-2 border-cyan-400 px-4 py-3 text-center text-xl font-bold">2574</td>
              <td class="border-2 border-cyan-400 px-4 py-3 text-center font-bold">2000 + 500 + 70 + 4</td>
              <td class="border-2 border-cyan-400 px-4 py-3 text-center text-xl font-bold">2</td>
              <td class="border-2 border-cyan-400 px-4 py-3 text-center text-xl font-bold">5</td>
              <td class="border-2 border-cyan-400 px-4 py-3 text-center text-xl font-bold">7</td>
              <td class="border-2 border-cyan-400 px-4 py-3 text-center text-xl font-bold">4</td>
            </tr>
            <!-- 1250 -->
            <tr>
              <td class="border-2 border-cyan-400 px-4 py-3 text-center text-xl font-bold">1250</td>
              <td class="border-2 border-cyan-400 px-4 py-3 text-center">
                <input type="text" data-fill-blanks-target="input" data-correct-answer="1000 + 200 + 50 + 0"
                       class="w-full px-2 py-1 border-b-2 border-dotted border-gray-400 text-center font-bold"
                       maxlength="25">
              </td>
              <td class="border-2 border-cyan-400 px-4 py-3 text-center">
                <input type="text" data-fill-blanks-target="input" data-correct-answer="1"
                       class="w-12 mx-auto px-2 py-1 border-b-2 border-dotted border-gray-400 text-center font-bold text-lg"
                       maxlength="1" inputmode="numeric">
              </td>
              <td class="border-2 border-cyan-400 px-4 py-3 text-center">
                <input type="text" data-fill-blanks-target="input" data-correct-answer="2"
                       class="w-12 mx-auto px-2 py-1 border-b-2 border-dotted border-gray-400 text-center font-bold text-lg"
                       maxlength="1" inputmode="numeric">
              </td>
              <td class="border-2 border-cyan-400 px-4 py-3 text-center">
                <input type="text" data-fill-blanks-target="input" data-correct-answer="5"
                       class="w-12 mx-auto px-2 py-1 border-b-2 border-dotted border-gray-400 text-center font-bold text-lg"
                       maxlength="1" inputmode="numeric">
              </td>
              <td class="border-2 border-cyan-400 px-4 py-3 text-center">
                <input type="text" data-fill-blanks-target="input" data-correct-answer="0"
                       class="w-12 mx-auto px-2 py-1 border-b-2 border-dotted border-gray-400 text-center font-bold text-lg"
                       maxlength="1" inputmode="numeric">
              </td>
            </tr>
            <!-- 4010 -->
            <tr>
              <td class="border-2 border-cyan-400 px-4 py-3 text-center text-xl font-bold">4010</td>
              <td class="border-2 border-cyan-400 px-4 py-3 text-center">
                <input type="text" data-fill-blanks-target="input" data-correct-answer="4000 + 0 + 10 + 0"
                       class="w-full px-2 py-1 border-b-2 border-dotted border-gray-400 text-center font-bold"
                       maxlength="25">
              </td>
              <td class="border-2 border-cyan-400 px-4 py-3 text-center">
                <input type="text" data-fill-blanks-target="input" data-correct-answer="4"
                       class="w-12 mx-auto px-2 py-1 border-b-2 border-dotted border-gray-400 text-center font-bold text-lg"
                       maxlength="1" inputmode="numeric">
              </td>
              <td class="border-2 border-cyan-400 px-4 py-3 text-center">
                <input type="text" data-fill-blanks-target="input" data-correct-answer="0"
                       class="w-12 mx-auto px-2 py-1 border-b-2 border-dotted border-gray-400 text-center font-bold text-lg"
                       maxlength="1" inputmode="numeric">
              </td>
              <td class="border-2 border-cyan-400 px-4 py-3 text-center">
                <input type="text" data-fill-blanks-target="input" data-correct-answer="1"
                       class="w-12 mx-auto px-2 py-1 border-b-2 border-dotted border-gray-400 text-center font-bold text-lg"
                       maxlength="1" inputmode="numeric">
              </td>
              <td class="border-2 border-cyan-400 px-4 py-3 text-center">
                <input type="text" data-fill-blanks-target="input" data-correct-answer="0"
                       class="w-12 mx-auto px-2 py-1 border-b-2 border-dotted border-gray-400 text-center font-bold text-lg"
                       maxlength="1" inputmode="numeric">
              </td>
            </tr>
            <!-- 6358 -->
            <tr>
              <td class="border-2 border-cyan-400 px-4 py-3 text-center text-xl font-bold">6358</td>
              <td class="border-2 border-cyan-400 px-4 py-3 text-center">
                <input type="text" data-fill-blanks-target="input" data-correct-answer="6000 + 300 + 50 + 8"
                       class="w-full px-2 py-1 border-b-2 border-dotted border-gray-400 text-center font-bold"
                       maxlength="25">
              </td>
              <td class="border-2 border-cyan-400 px-4 py-3 text-center">
                <input type="text" data-fill-blanks-target="input" data-correct-answer="6"
                       class="w-12 mx-auto px-2 py-1 border-b-2 border-dotted border-gray-400 text-center font-bold text-lg"
                       maxlength="1" inputmode="numeric">
              </td>
              <td class="border-2 border-cyan-400 px-4 py-3 text-center">
                <input type="text" data-fill-blanks-target="input" data-correct-answer="3"
                       class="w-12 mx-auto px-2 py-1 border-b-2 border-dotted border-gray-400 text-center font-bold text-lg"
                       maxlength="1" inputmode="numeric">
              </td>
              <td class="border-2 border-cyan-400 px-4 py-3 text-center">
                <input type="text" data-fill-blanks-target="input" data-correct-answer="5"
                       class="w-12 mx-auto px-2 py-1 border-b-2 border-dotted border-gray-400 text-center font-bold text-lg"
                       maxlength="1" inputmode="numeric">
              </td>
              <td class="border-2 border-cyan-400 px-4 py-3 text-center">
                <input type="text" data-fill-blanks-target="input" data-correct-answer="8"
                       class="w-12 mx-auto px-2 py-1 border-b-2 border-dotted border-gray-400 text-center font-bold text-lg"
                       maxlength="1" inputmode="numeric">
              </td>
            </tr>
          </tbody>
        </table>
      </div>
    </div>
  </div>

  <!-- Esercizio 3: Completa come nell'esempio -->
  <div class="bg-transparent p-4 md:p-8 mb-8" data-controller="fill-blanks auto-advance">
    <div class="flex items-start gap-3 mb-6">
      <div class="bg-red-500 text-white rounded-full w-8 h-8 flex items-center justify-center font-bold flex-shrink-0">
        3
      </div>
      <p class="text-base md:text-lg text-gray-700">
        Completa come nell'esempio.
      </p>
    </div>

    <div class="space-y-6">
      <!-- Esempio: duemilacentotrentasei -->
      <div class="flex flex-wrap items-center gap-3">
        <span class="text-lg font-bold min-w-[220px]">duemilacentotrentasei</span>
        <span class="text-blue-600 text-xl">â†’</span>
        <span class="text-xl font-bold text-cyan-700">2136</span>
        <span class="text-blue-600 text-xl">â†’</span>
        <span class="text-lg font-bold text-cyan-700">2000 + 100 + 30 + 6</span>
        <span class="text-blue-600 text-xl">â†’</span>
        <span class="text-lg font-bold text-cyan-700">2 k, 1 h, 3 da, 6 u</span>
      </div>

      <!-- tremilacinquecento -->
      <div class="flex flex-wrap items-center gap-3">
        <span class="text-lg font-bold min-w-[220px]">tremilacinquecento</span>
        <span class="text-blue-600 text-xl">â†’</span>
        <input type="text" data-fill-blanks-target="input" data-correct-answer="3500"
               class="w-20 px-2 py-1 border-b-2 border-dotted border-gray-400 text-center font-bold text-lg"
               maxlength="4" inputmode="numeric">
        <span class="text-blue-600 text-xl">â†’</span>
        <input type="text" data-fill-blanks-target="input" data-correct-answer="3000 + 500 + 0 + 0"
               class="w-48 px-2 py-1 border-b-2 border-dotted border-gray-400 text-center font-bold"
               maxlength="25">
        <span class="text-blue-600 text-xl">â†’</span>
        <input type="text" data-fill-blanks-target="input" data-correct-answer="3 k, 5 h, 0 da, 0 u"
               class="flex-1 min-w-[200px] px-2 py-1 border-b-2 border-dotted border-gray-400 text-center font-bold"
               maxlength="25">
      </div>

      <!-- millesette -->
      <div class="flex flex-wrap items-center gap-3">
        <span class="text-lg font-bold min-w-[220px]">millesette</span>
        <span class="text-blue-600 text-xl">â†’</span>
        <input type="text" data-fill-blanks-target="input" data-correct-answer="1007"
               class="w-20 px-2 py-1 border-b-2 border-dotted border-gray-400 text-center font-bold text-lg"
               maxlength="4" inputmode="numeric">
        <span class="text-blue-600 text-xl">â†’</span>
        <input type="text" data-fill-blanks-target="input" data-correct-answer="1000 + 0 + 0 + 7"
               class="w-48 px-2 py-1 border-b-2 border-dotted border-gray-400 text-center font-bold"
               maxlength="25">
        <span class="text-blue-600 text-xl">â†’</span>
        <input type="text" data-fill-blanks-target="input" data-correct-answer="1 k, 0 h, 0 da, 7 u"
               class="flex-1 min-w-[200px] px-2 py-1 border-b-2 border-dotted border-gray-400 text-center font-bold"
               maxlength="25">
      </div>

      <!-- settemilaottanta -->
      <div class="flex flex-wrap items-center gap-3">
        <span class="text-lg font-bold min-w-[220px]">settemilaottanta</span>
        <span class="text-blue-600 text-xl">â†’</span>
        <input type="text" data-fill-blanks-target="input" data-correct-answer="7080"
               class="w-20 px-2 py-1 border-b-2 border-dotted border-gray-400 text-center font-bold text-lg"
               maxlength="4" inputmode="numeric">
        <span class="text-blue-600 text-xl">â†’</span>
        <input type="text" data-fill-blanks-target="input" data-correct-answer="7000 + 0 + 80 + 0"
               class="w-48 px-2 py-1 border-b-2 border-dotted border-gray-400 text-center font-bold"
               maxlength="25">
        <span class="text-blue-600 text-xl">â†’</span>
        <input type="text" data-fill-blanks-target="input" data-correct-answer="7 k, 0 h, 8 da, 0 u"
               class="flex-1 min-w-[200px] px-2 py-1 border-b-2 border-dotted border-gray-400 text-center font-bold"
               maxlength="25">
      </div>
    </div>
  </div>

  <!-- Esercizio 4: Componi i numeri -->
  <div class="bg-transparent p-4 md:p-8 mb-8" data-controller="fill-blanks auto-advance">
    <div class="flex items-start gap-3 mb-6">
      <div class="bg-red-500 text-white rounded-full w-8 h-8 flex items-center justify-center font-bold flex-shrink-0">
        4
      </div>
      <p class="text-base md:text-lg text-gray-700">
        Componi i numeri. Fai attenzione al valore di ogni cifra e inserisci gli zeri segnaposto se necessario. Segui l'esempio.
      </p>
    </div>

    <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
      <%
        compositions = [
          ["4 h, 5 da, 2 k, 0 u", "2450"],
          ["0 da, 2 u, 3 k, 2 h", "3202"],
          ["5 h, 2 k, 3 da, 4 u", "2534"],
          ["1 k, 2 u, 3 h, 9 da", "1392"],
          ["4 k, 0 h, 2 da, 1 u", "4021"],
          ["7 h, 1 k", "1700"],
          ["1 k, 3 u", "1003"],
          ["2 k, 3 h, 1u", "2301"],
          ["7 da, 3 k", "3070"]
        ]

        compositions.each do |parts, answer|
      %>
        <div class="flex items-center gap-3 flex-wrap">
          <span class="text-lg font-bold min-w-[180px]"><%= parts %></span>
          <span class="text-blue-600 text-xl">â†’</span>
          <input type="text" data-fill-blanks-target="input" data-correct-answer="<%= answer %>"
                 class="w-24 px-2 py-1 border-b-2 border-dotted border-gray-400 text-center font-bold text-lg"
                 maxlength="4" inputmode="numeric">
        </div>
      <% end %>
    </div>
  </div>

  <!-- Footer con controlli -->
  <%= render 'shared/exercise_controls', color: 'cyan' %>
</div>
