<div class="max-w-6xl mx-auto bg-white dark:bg-gray-900 text-black dark:text-white p-3 md:p-6 transition-colors duration-300"
     data-controller="exercise-checker text-toggle font-controls"
     data-text-toggle-target="content"
     data-font-controls-target="content">

  <%= render 'shared/page_header', pagina: @pagina %>

  <!-- Esercizio 5 - Sottolinea complementi -->
  <div class="bg-white dark:bg-gray-800 p-4 md:p-6 pb-8 rounded-lg mb-6" data-controller="word-highlighter" data-word-highlighter-multi-color-value="true">
    <h2 class="font-bold mb-4 flex items-center gap-2">
      <span class="flex-shrink-0 bg-<%= @pagina.base_color %>-500 text-white rounded-full w-8 h-8 md:w-10 md:h-10 inline-flex items-center justify-center">5</span>
      Sottolinea di <span class="text-blue-600 dark:text-blue-400 font-bold">blu il complemento oggetto<span class="inline-block w-6 h-6 bg-blue-300 dark:bg-blue-600 rounded ml-1 align-middle cursor-pointer transition transform hover:scale-110" data-word-highlighter-target="colorBox" data-color="blue" data-action="click->word-highlighter#selectColor"></span></span> e di <span class="text-green-600 dark:text-green-400 font-bold">verde il complemento di termine<span class="inline-block w-6 h-6 bg-green-300 dark:bg-green-600 rounded ml-1 align-middle cursor-pointer transition transform hover:scale-110" data-word-highlighter-target="colorBox" data-color="green" data-action="click->word-highlighter#selectColor"></span></span>. Fai attenzione: non tutte le frasi li hanno entrambi.
    </h2>

    <div class="flex justify-end mb-4">
      <div class="w-48 h-40">
        <svg viewBox="0 0 200 150" class="w-full h-full">
          <!-- Busta e penna -->
          <rect x="50" y="60" width="100" height="70" fill="#FFA500" stroke="#FF8C00" stroke-width="2"/>
          <polygon points="50,60 100,90 150,60" fill="#FFD700"/>
          <rect x="160" y="40" width="8" height="80" fill="#4169E1"/>
          <circle cx="164" cy="35" r="5" fill="#4169E1"/>
          <!-- Secchiello e paletta -->
          <rect x="20" y="110" width="30" height="25" fill="#FFD700"/>
          <rect x="10" y="100" width="10" height="40" fill="#FF6347"/>
          <ellipse cx="15" cy="140" rx="8" ry="3" fill="#FF6347"/>
        </svg>
      </div>
    </div>

    <div class="space-y-3 cursor-pointer">
      <div class="bg-<%= @pagina.base_color %>-50 dark:bg-<%= @pagina.base_color %>-900/30 rounded-lg px-4 py-3">
        <span class="text-gray-700 dark:text-gray-200">• Hai telefonato <span data-word-highlighter-target="word" data-correct="green" data-action="click->word-highlighter#toggleHighlight" class="px-1 rounded">al dentista</span> per disdire <span data-word-highlighter-target="word" data-correct="blue" data-action="click->word-highlighter#toggleHighlight" class="px-1 rounded">l'appuntamento</span>?</span>
      </div>

      <div class="bg-<%= @pagina.base_color %>-50 dark:bg-<%= @pagina.base_color %>-900/30 rounded-lg px-4 py-3">
        <span class="text-gray-700 dark:text-gray-200">• A Christian mancano <span data-word-highlighter-target="word" data-correct="blue" data-action="click->word-highlighter#toggleHighlight" class="px-1 rounded">gli amici</span> della vecchia scuola.</span>
      </div>

      <div class="bg-<%= @pagina.base_color %>-50 dark:bg-<%= @pagina.base_color %>-900/30 rounded-lg px-4 py-3">
        <span class="text-gray-700 dark:text-gray-200">• Fate firmare <span data-word-highlighter-target="word" data-correct="blue" data-action="click->word-highlighter#toggleHighlight" class="px-1 rounded">l'avviso</span> <span data-word-highlighter-target="word" data-correct="green" data-action="click->word-highlighter#toggleHighlight" class="px-1 rounded">ai vostri genitori</span>.</span>
      </div>

      <div class="bg-<%= @pagina.base_color %>-50 dark:bg-<%= @pagina.base_color %>-900/30 rounded-lg px-4 py-3">
        <span class="text-gray-700 dark:text-gray-200">• <span data-word-highlighter-target="word" data-correct="green" data-action="click->word-highlighter#toggleHighlight" class="px-1 rounded">Alla mamma</span> ho chiesto in regalo <span data-word-highlighter-target="word" data-correct="blue" data-action="click->word-highlighter#toggleHighlight" class="px-1 rounded">l'ultimo CD di Ghali</span>.</span>
      </div>

      <div class="bg-<%= @pagina.base_color %>-50 dark:bg-<%= @pagina.base_color %>-900/30 rounded-lg px-4 py-3">
        <span class="text-gray-700 dark:text-gray-200">• <span data-word-highlighter-target="word" data-correct="green" data-action="click->word-highlighter#toggleHighlight" class="px-1 rounded">Al cane di Giorgio</span> non piace essere accarezzato.</span>
      </div>

      <div class="bg-<%= @pagina.base_color %>-50 dark:bg-<%= @pagina.base_color %>-900/30 rounded-lg px-4 py-3">
        <span class="text-gray-700 dark:text-gray-200">• Al mare compreremo <span data-word-highlighter-target="word" data-correct="blue" data-action="click->word-highlighter#toggleHighlight" class="px-1 rounded">secchiello e palette</span>.</span>
      </div>
    </div>
  </div>

  <!-- Esercizio 6 - Completa con i complementi -->
  <div class="bg-white dark:bg-gray-800 p-4 md:p-6 pb-8 rounded-lg mb-6" data-controller="fill-blanks">
    <h2 class="font-bold mb-4 flex items-center gap-2">
      <span class="flex-shrink-0 bg-<%= @pagina.base_color %>-500 text-white rounded-full w-8 h-8 md:w-10 md:h-10 inline-flex items-center justify-center">6</span>
      Completa con i <strong class="underline">complementi</strong> indicati.
    </h2>

    <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
      <div class="bg-blue-50 dark:bg-blue-900/30 rounded-lg p-4">
        <p class="font-bold text-blue-700 dark:text-blue-300 mb-3">• Virginia studia...</p>
        <div class="space-y-2">
          <div>
            <span class="font-semibold text-blue-600 dark:text-blue-400">c. oggetto</span> →
            <input type="text"
                   class="ml-2 w-full px-3 py-2 border-b-2 border-dotted border-blue-500 dark:border-blue-400 bg-transparent dark:text-white focus:outline-none"
                   data-fill-blanks-target="input"
                   data-correct-answer="libera">
          </div>
          <div>
            <span class="font-semibold text-blue-600 dark:text-blue-400">c. di tempo</span> →
            <input type="text"
                   class="ml-2 w-full px-3 py-2 border-b-2 border-dotted border-blue-500 dark:border-blue-400 bg-transparent dark:text-white focus:outline-none"
                   data-fill-blanks-target="input"
                   data-correct-answer="libera">
          </div>
          <div>
            <span class="font-semibold text-blue-600 dark:text-blue-400">c. di luogo</span> →
            <input type="text"
                   class="ml-2 w-full px-3 py-2 border-b-2 border-dotted border-blue-500 dark:border-blue-400 bg-transparent dark:text-white focus:outline-none"
                   data-fill-blanks-target="input"
                   data-correct-answer="libera">
          </div>
        </div>
      </div>

      <div class="bg-green-50 dark:bg-green-900/30 rounded-lg p-4">
        <p class="font-bold text-green-700 dark:text-green-300 mb-3">• Enrico ha mandato...</p>
        <div class="space-y-2">
          <div>
            <span class="font-semibold text-green-600 dark:text-green-400">c. di tempo</span> →
            <input type="text"
                   class="ml-2 w-full px-3 py-2 border-b-2 border-dotted border-green-500 dark:border-green-400 bg-transparent dark:text-white focus:outline-none"
                   data-fill-blanks-target="input"
                   data-correct-answer="libera">
          </div>
          <div>
            <span class="font-semibold text-green-600 dark:text-green-400">c. oggetto</span> →
            <input type="text"
                   class="ml-2 w-full px-3 py-2 border-b-2 border-dotted border-green-500 dark:border-green-400 bg-transparent dark:text-white focus:outline-none"
                   data-fill-blanks-target="input"
                   data-correct-answer="libera">
          </div>
          <div>
            <span class="font-semibold text-green-600 dark:text-green-400">c. di termine</span> →
            <input type="text"
                   class="ml-2 w-full px-3 py-2 border-b-2 border-dotted border-green-500 dark:border-green-400 bg-transparent dark:text-white focus:outline-none"
                   data-fill-blanks-target="input"
                   data-correct-answer="libera">
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- Esercizio 7 - Attributo e apposizione -->
  <div class="bg-white dark:bg-gray-800 p-4 md:p-6 pb-8 rounded-lg mb-6" data-controller="multiple-choice">
    <h2 class="font-bold mb-4 flex items-center gap-2">
      <span class="flex-shrink-0 bg-<%= @pagina.base_color %>-500 text-white rounded-full w-8 h-8 md:w-10 md:h-10 inline-flex items-center justify-center">7</span>
      Indica con una <span class="underline">X</span> la frase in cui sono presenti sia un <strong class="underline">attributo</strong> sia un'<strong class="underline">apposizione</strong>.
    </h2>

    <div class="space-y-3">
      <label class="flex items-start gap-3 p-4 bg-<%= @pagina.base_color %>-50 dark:bg-<%= @pagina.base_color %>-900/30 rounded-lg cursor-pointer hover:bg-<%= @pagina.base_color %>-100 dark:hover:bg-<%= @pagina.base_color %>-900/40 transition">
        <input type="checkbox"
               data-multiple-choice-target="answer"
               data-correct-answer="false"
               class="w-5 h-5 mt-1 flex-shrink-0">
        <span class="text-gray-700 dark:text-gray-200">Maria ha comprato una bellissima sciarpa di seta.</span>
      </label>

      <label class="flex items-start gap-3 p-4 bg-<%= @pagina.base_color %>-50 dark:bg-<%= @pagina.base_color %>-900/30 rounded-lg cursor-pointer hover:bg-<%= @pagina.base_color %>-100 dark:hover:bg-<%= @pagina.base_color %>-900/40 transition">
        <input type="checkbox"
               data-multiple-choice-target="answer"
               data-correct-answer="false"
               class="w-5 h-5 mt-1 flex-shrink-0">
        <span class="text-gray-700 dark:text-gray-200">Giulio ha la febbre, quindi abbiamo chiamato la dottoressa Carli.</span>
      </label>

      <label class="flex items-start gap-3 p-4 bg-<%= @pagina.base_color %>-50 dark:bg-<%= @pagina.base_color %>-900/30 rounded-lg cursor-pointer hover:bg-<%= @pagina.base_color %>-100 dark:hover:bg-<%= @pagina.base_color %>-900/40 transition">
        <input type="checkbox"
               data-multiple-choice-target="answer"
               data-correct-answer="false"
               class="w-5 h-5 mt-1 flex-shrink-0">
        <span class="text-gray-700 dark:text-gray-200">Il cane Toby abbaia alle persone che non conosce.</span>
      </label>

      <label class="flex items-start gap-3 p-4 bg-<%= @pagina.base_color %>-50 dark:bg-<%= @pagina.base_color %>-900/30 rounded-lg cursor-pointer hover:bg-<%= @pagina.base_color %>-100 dark:hover:bg-<%= @pagina.base_color %>-900/40 transition">
        <input type="checkbox"
               data-multiple-choice-target="answer"
               data-correct-answer="true"
               class="w-5 h-5 mt-1 flex-shrink-0">
        <span class="text-gray-700 dark:text-gray-200">Pierluigi, esperto archeologo, ha scoperto un'antica tomba etrusca.</span>
      </label>
    </div>
  </div>

  <!-- Le mie competenze -->
  <div class="bg-<%= @pagina.base_color %>-200 dark:bg-<%= @pagina.base_color %>-900/50 rounded-lg p-4 mb-6">
    <h3 class="font-bold text-<%= @pagina.base_color %>-700 dark:text-<%= @pagina.base_color %>-300">Le mie competenze</h3>
  </div>

  <!-- Esercizio 8 - Quale verbo NON può reggere... -->
  <div class="bg-white dark:bg-gray-800 p-4 md:p-6 pb-8 rounded-lg mb-6" data-controller="multiple-choice">
    <h2 class="font-bold mb-4 flex items-center gap-2">
      <span class="flex-shrink-0 bg-<%= @pagina.base_color %>-500 text-white rounded-full w-8 h-8 md:w-10 md:h-10 inline-flex items-center justify-center">8</span>
      Quale fra i seguenti verbi NON può reggere sia un complemento oggetto sia un complemento di termine?
    </h2>

    <div class="grid grid-cols-2 md:grid-cols-4 gap-4">
      <% [
        { verb: "Restituire", correct: false },
        { verb: "Leggere", correct: false },
        { verb: "Regalare", correct: false },
        { verb: "Amare", correct: true }
      ].each do |item| %>
        <label class="flex items-center gap-3 p-4 bg-<%= @pagina.base_color %>-50 dark:bg-<%= @pagina.base_color %>-900/30 rounded-lg cursor-pointer hover:bg-<%= @pagina.base_color %>-100 dark:hover:bg-<%= @pagina.base_color %>-900/40 transition">
          <input type="radio"
                 name="question_8"
                 data-multiple-choice-target="answer"
                 data-correct-answer="<%= item[:correct] %>"
                 class="w-5 h-5">
          <span class="text-gray-700 dark:text-gray-200 font-semibold"><%= item[:verb] %></span>
        </label>
      <% end %>
    </div>
  </div>

  <!-- Esercizio 9 - Quale sintagma con "per" è complemento di luogo -->
  <div class="bg-white dark:bg-gray-800 p-4 md:p-6 pb-8 rounded-lg" data-controller="multiple-choice">
    <h2 class="font-bold mb-4 flex items-center gap-2">
      <span class="flex-shrink-0 bg-<%= @pagina.base_color %>-500 text-white rounded-full w-8 h-8 md:w-10 md:h-10 inline-flex items-center justify-center">9</span>
      Quale fra i seguenti sintagmi introdotti da <strong class="underline">per</strong> è un complemento di luogo?
    </h2>

    <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
      <% [
        { text: "<strong>Per l'ansia</strong> non ho dormito.", correct: false },
        { text: "Passa il filo <strong>per la manica</strong>.", correct: false },
        { text: "<strong>Per anni</strong> ho aspettato questo momento.", correct: false },
        { text: "La rivista mi è arrivata <strong>per posta</strong>.", correct: true }
      ].each do |item| %>
        <label class="flex items-start gap-3 p-4 bg-<%= @pagina.base_color %>-50 dark:bg-<%= @pagina.base_color %>-900/30 rounded-lg cursor-pointer hover:bg-<%= @pagina.base_color %>-100 dark:hover:bg-<%= @pagina.base_color %>-900/40 transition">
          <input type="radio"
                 name="question_9"
                 data-multiple-choice-target="answer"
                 data-correct-answer="<%= item[:correct] %>"
                 class="w-5 h-5 mt-1 flex-shrink-0">
          <span class="text-gray-700 dark:text-gray-200"><%= item[:text].html_safe %></span>
        </label>
      <% end %>
    </div>
  </div>

  <%= render 'shared/exercise_controls' %>
</div>
