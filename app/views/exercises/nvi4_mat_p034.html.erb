<div class="max-w-6xl mx-auto bg-white p-3 md:p-6"
     data-controller="exercise-checker text-toggle font-controls"
     data-text-toggle-target="content"
     data-font-controls-target="content">

  <%= render 'shared/page_header', pagina: @pagina %>

  <div class="space-y-6">

    <!-- Introduzione -->
    <div class="p-4 bg-custom-blue rounded-lg">
      <p class="text-gray-700 mb-4">
        Prima di usare l'<span class="font-bold">addizione</span> e la <span class="font-bold">sottrazione</span> per risolvere problemi, ricorda che sono <span class="font-bold">operazioni inverse</span>.
      </p>
      <p class="text-gray-700 mb-4">
        Osserva: le frecce viola indicano un'addizione, le frecce verdi una sottrazione.
      </p>

      <!-- Diagrammi operazioni inverse -->
      <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
        <!-- +20 / -20 -->
        <div class="flex flex-col items-center">
          <div class="text-center mb-2">
            <span class="font-bold text-purple-600">+ 20</span>
          </div>
          <div class="flex items-center gap-4">
            <div class="w-12 h-12 border-2 border-gray-400 rounded-full flex items-center justify-center font-bold">30</div>
            <div class="flex flex-col items-center">
              <span class="text-purple-600">→</span>
              <span class="text-green-600">←</span>
            </div>
            <div class="w-12 h-12 border-2 border-gray-400 rounded-full flex items-center justify-center font-bold">50</div>
          </div>
          <div class="text-center mt-2">
            <span class="font-bold text-green-600">− 20</span>
          </div>
        </div>

        <!-- -5 / +5 -->
        <div class="flex flex-col items-center">
          <div class="text-center mb-2">
            <span class="font-bold text-green-600">− 5</span>
          </div>
          <div class="flex items-center gap-4">
            <div class="w-12 h-12 border-2 border-gray-400 rounded-full flex items-center justify-center font-bold">17</div>
            <div class="flex flex-col items-center">
              <span class="text-green-600">→</span>
              <span class="text-purple-600">←</span>
            </div>
            <div class="w-12 h-12 border-2 border-gray-400 rounded-full flex items-center justify-center font-bold">12</div>
          </div>
          <div class="text-center mt-2">
            <span class="font-bold text-purple-600">+ 5</span>
          </div>
        </div>
      </div>
    </div>

    <!-- Scrivi quale operazione serve -->
    <div class="p-4 bg-pink-light rounded-lg">
      <p class="font-bold text-<%= @pagina.base_color %>-600 mb-4">
        <span class="text-<%= @pagina.base_color %>-500">•</span> Scrivi quale operazione serve per risolvere i due problemi proposti.
      </p>

      <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
        <!-- Problema 1: Filippo riceve caramelle -->
        <div class="space-y-3">
          <p class="text-gray-700">
            Filippo ha 8 caramelle. Giacomo gliene regala 5.<br>
            Quante caramelle ha ora Filippo?
          </p>
          <div class="flex items-center gap-2">
            <input type="text" data-correct-answer="8 + 5 = 13" class="min-w-0 flex-1 border-b-2 border-dotted border-gray-400 text-center font-bold bg-transparent" placeholder="Operazione e risultato">
          </div>
        </div>

        <!-- Problema 2: Filippo regala caramelle -->
        <div class="space-y-3">
          <p class="text-gray-700">
            Filippo ha 13 caramelle. Ne regala 5 a Giacomo.<br>
            Quante caramelle ha ora Filippo?
          </p>
          <div class="flex items-center gap-2">
            <input type="text" data-correct-answer="13 - 5 = 8" class="min-w-0 flex-1 border-b-2 border-dotted border-gray-400 text-center font-bold bg-transparent" placeholder="Operazione e risultato">
          </div>
        </div>
      </div>
    </div>

    <!-- Tradurre in linguaggio matematico -->
    <div>
      <p class="text-gray-700 mb-4">
        Puoi tradurre un problema in linguaggio matematico indicando con un quadratino vuoto ciò che stai cercando. Facciamolo insieme.
      </p>
    </div>

    <!-- Problema Karima -->
    <div class="p-4 bg-white rounded-lg border-2 border-<%= @pagina.base_color %>-300">
      <p class="text-gray-700 mb-4">
        Karima pensa un numero, aggiunge 8 e ottiene 20.<br>
        Che numero ha pensato Karima?
      </p>

      <div class="grid grid-cols-1 md:grid-cols-2 gap-6 items-center">
        <!-- Diagramma -->
        <div class="flex flex-col items-center">
          <div class="text-center mb-2">
            <span class="font-bold text-purple-600">+ 8</span>
          </div>
          <div class="flex items-center gap-4">
            <div class="w-12 h-12 border-2 border-gray-400 rounded flex items-center justify-center font-bold">□</div>
            <div class="flex flex-col items-center">
              <span class="text-purple-600">→</span>
              <span class="text-green-600">←</span>
            </div>
            <div class="w-12 h-12 border-2 border-gray-400 rounded flex items-center justify-center font-bold">20</div>
          </div>
          <div class="text-center mt-2">
            <span class="font-bold text-green-600">− 8</span>
          </div>
        </div>

        <!-- Soluzione -->
        <div>
          <p class="font-bold text-<%= @pagina.base_color %>-600 mb-2">20 − 8 = 12</p>
          <p class="text-gray-700">Karima ha pensato il numero 12.</p>
        </div>
      </div>
    </div>

    <!-- Problema Alessandro -->
    <div class="p-4 bg-white rounded-lg border-2 border-<%= @pagina.base_color %>-300">
      <p class="text-gray-700 mb-4">
        Alessandro aveva dei cioccolatini. Ne ha mangiati 4.<br>
        Ora i cioccolatini sono 16. Quanti erano all'inizio?
      </p>

      <div class="grid grid-cols-1 md:grid-cols-2 gap-6 items-center">
        <!-- Diagramma -->
        <div class="flex flex-col items-center">
          <div class="text-center mb-2">
            <span class="font-bold text-green-600">− 4</span>
          </div>
          <div class="flex items-center gap-4">
            <div class="w-12 h-12 border-2 border-gray-400 rounded flex items-center justify-center font-bold">□</div>
            <div class="flex flex-col items-center">
              <span class="text-green-600">→</span>
              <span class="text-purple-600">←</span>
            </div>
            <div class="w-12 h-12 border-2 border-gray-400 rounded flex items-center justify-center font-bold">16</div>
          </div>
          <div class="text-center mt-2">
            <span class="font-bold text-purple-600">+ 4</span>
          </div>
        </div>

        <!-- Soluzione -->
        <div>
          <p class="font-bold text-<%= @pagina.base_color %>-600 mb-2">16 + 4 = 20</p>
          <p class="text-gray-700">All'inizio c'erano 20 cioccolatini.</p>
        </div>
      </div>
    </div>

    <%= render 'shared/exercise_controls' %>
  </div>
</div>
