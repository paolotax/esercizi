<div class="max-w-6xl mx-auto bg-white p-3 md:p-6"
     data-controller="exercise-checker text-toggle font-controls"
     data-text-toggle-target="content"
     data-font-controls-target="content">

  <%= render 'shared/page_header', pagina: @pagina %>

  <div class="space-y-6">
    <!-- Esercizio 1: IMPARARE TUTTI - Sottrazioni in colonna -->
    <div class="p-4 bg-white rounded-2xl border-3 border-yellow-400">
      <p class="font-bold text-gray-700 mb-4">
        <%= imparare_tutti_badge(1) %>
        Esegui le sottrazioni in colonna.
      </p>

      <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
        <!-- Colonna sinistra: operazioni -->
        <div class="space-y-2">
          <p class="text-gray-700">57,332 – 36,28 =</p>
          <p class="text-gray-700"><span class="whitespace-nowrap">8 241</span> – 46,305 =</p>
          <p class="text-gray-700"><span class="whitespace-nowrap">6 358,07</span> – 45,339 =</p>
          <p class="text-gray-700"><span class="whitespace-nowrap">562 341</span> – 935,61 =</p>
        </div>

        <!-- Colonna destra: box regola + esempio -->
        <div class="space-y-3">
          <div class="p-3 bg-white border-3 border-cyan-400">
            <p class="text-gray-600 italic">Ricorda di incolonnare correttamente le cifre rispettando il loro valore e di aggiungere gli zeri segnaposto per facilitare il calcolo.</p>
          </div>
          <%= image_tag "nvi5_mat/p186/p186_01.jpg", alt: "Esempio sottrazione in colonna", class: "mx-auto max-w-full h-auto" %>
        </div>
      </div>
    </div>

    <!-- Esercizio 2: Sottrazioni sul quaderno con prova -->
    <div class="grid grid-cols-1 md:grid-cols-2 gap-6 md:divide-x-2 md:divide-cyan-300">
      <!-- Colonna sinistra: operazioni -->
      <div class="md:pr-4">
        <p class="font-bold text-gray-700 mb-4">
          <%= numero_esercizio_badge(2) %>
          Esegui le sottrazioni sul quaderno e fai la prova.
        </p>

        <div class="grid grid-cols-2 gap-x-4 gap-y-2">
          <div class="space-y-2">
            <p class="text-gray-700"><span class="whitespace-nowrap">38 421 765</span> – <span class="whitespace-nowrap">18 561 654</span> =</p>
            <p class="text-gray-700"><span class="whitespace-nowrap">6 900 000</span> – <span class="whitespace-nowrap">1 847 206</span> =</p>
            <p class="text-gray-700"><span class="whitespace-nowrap">109 522 063</span> – <span class="whitespace-nowrap">64 711 090</span> =</p>
            <p class="text-gray-700"><span class="whitespace-nowrap">20 160 200</span> – <span class="whitespace-nowrap">1 243 128</span> =</p>
          </div>
          <div class="space-y-2">
            <p class="text-gray-700">46,34 – 23,167 =</p>
            <p class="text-gray-700">530,2 – 274,15 =</p>
            <p class="text-gray-700">80,832 – 56,14 =</p>
            <p class="text-gray-700">112,66 – 15,67 =</p>
          </div>
        </div>
      </div>

      <!-- Colonna destra: Prova della sottrazione -->
      <div class="md:pl-4">
        <p class="font-bold text-cyan-600 mb-2">Prova della sottrazione</p>
        <%= image_tag "nvi5_mat/p186/p186_02.jpg", alt: "Prova della sottrazione", class: "mx-auto max-w-full h-auto" %>
      </div>
    </div>

    <!-- Esercizio 3: Completa con il numero mancante -->
    <div>
      <p class="font-bold text-gray-700 mb-4">
        <%= numero_esercizio_badge(3) %>
        Completa con il numero mancante.
      </p>

      <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
        <div class="flex items-center gap-2">
          <span class="text-gray-700 shrink-0"><span class="whitespace-nowrap">17 890</span> –</span>
          <input type="text" data-correct-answer="7890" class="w-24 border-b-2 border-dotted border-gray-400 text-center font-bold bg-transparent">
          <span class="text-gray-700 shrink-0">= <span class="whitespace-nowrap">10 000</span></span>
        </div>
        <div class="flex items-center gap-2">
          <span class="text-gray-700 shrink-0"><span class="whitespace-nowrap">560 000</span> –</span>
          <input type="text" data-correct-answer="550000" class="w-24 border-b-2 border-dotted border-gray-400 text-center font-bold bg-transparent">
          <span class="text-gray-700 shrink-0">= <span class="whitespace-nowrap">10 000</span></span>
        </div>
        <div class="flex items-center gap-2">
          <span class="text-gray-700 shrink-0"><span class="whitespace-nowrap">29 145</span> –</span>
          <input type="text" data-correct-answer="19145" class="w-24 border-b-2 border-dotted border-gray-400 text-center font-bold bg-transparent">
          <span class="text-gray-700 shrink-0">= <span class="whitespace-nowrap">10 000</span></span>
        </div>
        <div class="flex items-center gap-2">
          <span class="text-gray-700 shrink-0"><span class="whitespace-nowrap">560 000</span> –</span>
          <input type="text" data-correct-answer="460000" class="w-24 border-b-2 border-dotted border-gray-400 text-center font-bold bg-transparent">
          <span class="text-gray-700 shrink-0">= <span class="whitespace-nowrap">100 000</span></span>
        </div>
      </div>
    </div>

    <!-- Esercizio 4: Completa le sottrazioni con le cifre mancanti -->
    <div>
      <p class="font-bold text-gray-700 mb-4">
        <%= numero_esercizio_badge(4) %>
        Completa le sottrazioni con le cifre mancanti.
      </p>

      <%= image_tag "nvi5_mat/p186/p186_03.jpg", alt: "Sottrazioni con cifre mancanti", class: "mx-auto max-w-full h-auto" %>
    </div>

    <!-- Esercizi 5 e 6 in due colonne -->
    <div class="grid grid-cols-1 md:grid-cols-2 gap-6 md:divide-x-2 md:divide-cyan-300">
      <!-- Esercizio 5: Calcola -->
      <div class="md:pr-4">
        <p class="font-bold text-gray-700 mb-4">
          <%= numero_esercizio_badge(5) %>
          Calcola.
        </p>

        <div class="p-3 bg-white border-3 border-cyan-400 mb-4">
          <p class="text-gray-600"><span class="font-bold">Per togliere 9, 99, 999</span>... da un qualsiasi numero togli 10, 100, <span class="whitespace-nowrap">1 000</span>... e aggiungi 1.</p>
        </div>

        <div class="space-y-3">
          <div class="flex items-center gap-2">
            <span class="text-gray-700 shrink-0"><span class="whitespace-nowrap">17 215</span> – 9 =</span>
            <input type="text" data-correct-answer="17206" class="min-w-0 flex-1 border-b-2 border-dotted border-gray-400 text-center font-bold bg-transparent">
          </div>
          <div class="flex items-center gap-2">
            <span class="text-gray-700 shrink-0"><span class="whitespace-nowrap">5 300</span> – 99 =</span>
            <input type="text" data-correct-answer="5201" class="min-w-0 flex-1 border-b-2 border-dotted border-gray-400 text-center font-bold bg-transparent">
          </div>
          <div class="flex items-center gap-2">
            <span class="text-gray-700 shrink-0"><span class="whitespace-nowrap">26 400</span> – 999 =</span>
            <input type="text" data-correct-answer="25401" class="min-w-0 flex-1 border-b-2 border-dotted border-gray-400 text-center font-bold bg-transparent">
          </div>
        </div>
      </div>

      <!-- Esercizio 6: Calcola velocemente -->
      <div class="md:pl-4">
        <p class="font-bold text-gray-700 mb-4">
          <%= numero_esercizio_badge(6) %>
          Calcola velocemente come negli esempi.
        </p>

        <div class="space-y-3">
          <!-- Esempio 1 -->
          <div class="p-2 bg-cyan-50 rounded">
            <p class="text-gray-700 font-bold">17,8 – 0,9 = <span class="text-cyan-600">(17,8 – 1) + 0,1 = 16,9</span></p>
          </div>
          <div class="flex items-center gap-2">
            <span class="text-gray-700 shrink-0">45,2 – 0,9 =</span>
            <input type="text" data-correct-answer="44,3" class="min-w-0 flex-1 border-b-2 border-dotted border-gray-400 text-center font-bold bg-transparent">
          </div>
          <div class="flex items-center gap-2">
            <span class="text-gray-700 shrink-0">28,7 – 0,9 =</span>
            <input type="text" data-correct-answer="27,8" class="min-w-0 flex-1 border-b-2 border-dotted border-gray-400 text-center font-bold bg-transparent">
          </div>

          <!-- Esempio 2 -->
          <div class="p-2 bg-cyan-50 rounded">
            <p class="text-gray-700 font-bold">50,65 – 0,99 = <span class="text-cyan-600">(50,65 – 1) + 0,01 = 49,66</span></p>
          </div>
          <div class="flex items-center gap-2">
            <span class="text-gray-700 shrink-0">19,37 – 0,99 =</span>
            <input type="text" data-correct-answer="18,38" class="min-w-0 flex-1 border-b-2 border-dotted border-gray-400 text-center font-bold bg-transparent">
          </div>
          <div class="flex items-center gap-2">
            <span class="text-gray-700 shrink-0">340,54 – 0,99 =</span>
            <input type="text" data-correct-answer="339,55" class="min-w-0 flex-1 border-b-2 border-dotted border-gray-400 text-center font-bold bg-transparent">
          </div>
        </div>
      </div>
    </div>

    <%= render 'shared/exercise_controls' %>
  </div>
</div>
