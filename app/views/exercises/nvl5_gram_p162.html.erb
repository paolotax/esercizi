<div class="max-w-6xl mx-auto bg-white dark:bg-gray-900 text-black dark:text-white p-3 md:p-6 transition-colors duration-300"
     data-controller="exercise-checker text-toggle font-controls"
     data-text-toggle-target="content"
     data-font-controls-target="content">

  <%= render 'shared/page_header', pagina: @pagina %>

  <!-- Esercizio 1: Completa con pronomi e preposizioni -->
  <div class="mb-6 bg-white dark:bg-gray-800 rounded-2xl border-4 border-yellow-200 dark:border-yellow-700 shadow-2xl p-4 md:p-6" data-controller="fill-blanks">
    <h2 class="font-bold text-yellow-700 dark:text-yellow-400 mb-3">
      <div class="flex items-center gap-2 flex-wrap">
        <div class="flex items-center gap-2">
          <span class="bg-yellow-600 text-white rounded-full w-8 h-8 md:w-10 md:h-10 inline-flex items-center justify-center flex-shrink-0">1</span>
          <span class="bg-yellow-400 text-blue-800 px-2 py-1 rounded font-bold whitespace-nowrap">IMPARARE TUTTI</span>
        </div>
        <span>Completa con i <span class="text-blue-600 dark:text-blue-400 font-bold underline">pronomi</span> e le <span class="underline">preposizioni</span> adatte. Osserva l'esempio.</span>
      </div>
    </h2>

    <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
      <!-- Colonna sinistra: Stefano -->
      <div>
        <p class="font-bold mb-3 text-gray-700 dark:text-gray-200">Stefano è un amico...</p>

        <div class="space-y-3">
          <div class="bg-yellow-50 dark:bg-yellow-900/30 border-2 border-yellow-200 dark:border-yellow-700 rounded-xl px-3 py-3">
            <div class="flex flex-wrap items-center gap-2">
              <span class="text-gray-700 dark:text-gray-200">•</span>
              <input type="text" class="border-b-2 border-yellow-500 dark:border-yellow-400 bg-transparent dark:text-white px-2 py-1 focus:outline-none focus:border-yellow-700 dark:focus:border-yellow-300 w-32" data-fill-blanks-target="input" data-correct-answer="di cui|del quale" placeholder="">
              <span class="text-gray-700 dark:text-gray-200">mi fido.</span>
            </div>
          </div>

          <div class="bg-yellow-50 dark:bg-yellow-900/30 border-2 border-yellow-200 dark:border-yellow-700 rounded-xl px-3 py-3">
            <div class="flex flex-wrap items-center gap-2">
              <span class="text-gray-700 dark:text-gray-200">•</span>
              <input type="text" class="border-b-2 border-yellow-500 dark:border-yellow-400 bg-transparent dark:text-white px-2 py-1 focus:outline-none focus:border-yellow-700 dark:focus:border-yellow-300 w-32" data-fill-blanks-target="input" data-correct-answer="con cui|con il quale" placeholder="">
              <span class="text-gray-700 dark:text-gray-200">mi confido.</span>
            </div>
          </div>

          <div class="bg-yellow-50 dark:bg-yellow-900/30 border-2 border-yellow-200 dark:border-yellow-700 rounded-xl px-3 py-3">
            <div class="flex flex-wrap items-center gap-2">
              <span class="text-gray-700 dark:text-gray-200">•</span>
              <input type="text" class="border-b-2 border-yellow-500 dark:border-yellow-400 bg-transparent dark:text-white px-2 py-1 focus:outline-none focus:border-yellow-700 dark:focus:border-yellow-300 w-32" data-fill-blanks-target="input" data-correct-answer="per cui|per il quale" placeholder="">
              <span class="text-gray-700 dark:text-gray-200">farei qualunque cosa.</span>
            </div>
          </div>
        </div>
      </div>

      <!-- Colonna destra: Gatto -->
      <div>
        <p class="font-bold mb-3 text-gray-700 dark:text-gray-200">Io ho un gatto...</p>

        <div class="space-y-3">
          <div class="bg-yellow-50 dark:bg-yellow-900/30 border-2 border-yellow-200 dark:border-yellow-700 rounded-xl px-3 py-3">
            <div class="flex flex-wrap items-center gap-2">
              <span class="text-gray-700 dark:text-gray-200">•</span>
              <input type="text" class="border-b-2 border-yellow-500 dark:border-yellow-400 bg-transparent dark:text-white px-2 py-1 focus:outline-none focus:border-yellow-700 dark:focus:border-yellow-300 w-32" data-fill-blanks-target="input" data-correct-answer="che|il quale" placeholder="">
              <span class="text-gray-700 dark:text-gray-200">ha il pelo grigio.</span>
            </div>
          </div>

          <div class="bg-yellow-50 dark:bg-yellow-900/30 border-2 border-yellow-200 dark:border-yellow-700 rounded-xl px-3 py-3">
            <div class="flex flex-wrap items-center gap-2">
              <span class="text-gray-700 dark:text-gray-200">•</span>
              <input type="text" class="border-b-2 border-yellow-500 dark:border-yellow-400 bg-transparent dark:text-white px-2 py-1 focus:outline-none focus:border-yellow-700 dark:focus:border-yellow-300 w-32" data-fill-blanks-target="input" data-correct-answer="a cui|al quale" placeholder="">
              <span class="text-gray-700 dark:text-gray-200">piace la carne.</span>
            </div>
          </div>

          <div class="bg-yellow-50 dark:bg-yellow-900/30 border-2 border-yellow-200 dark:border-yellow-700 rounded-xl px-3 py-3">
            <div class="flex flex-wrap items-center gap-2">
              <span class="text-gray-700 dark:text-gray-200">•</span>
              <input type="text" class="border-b-2 border-yellow-500 dark:border-yellow-400 bg-transparent dark:text-white px-2 py-1 focus:outline-none focus:border-yellow-700 dark:focus:border-yellow-300 w-32" data-fill-blanks-target="input" data-correct-answer="con cui|con il quale" placeholder="">
              <span class="text-gray-700 dark:text-gray-200">gioco.</span>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- Esercizio 2: Unisci frasi con pronome relativo -->
  <div class="mb-6 bg-white dark:bg-gray-800 rounded-2xl border-4 border-blue-200 dark:border-blue-700 shadow-2xl p-4 md:p-6" data-controller="fill-blanks">
    <h2 class="font-bold text-blue-700 dark:text-blue-400 mb-3">
      <div class="flex items-center gap-2 flex-wrap">
        <span class="bg-blue-600 text-white rounded-full w-8 h-8 md:w-10 md:h-10 inline-flex items-center justify-center flex-shrink-0">2</span>
        <span>Sottolinea le parole che si ripetono, poi unisci le frasi con un <span class="text-blue-600 dark:text-blue-400 font-bold underline">pronome relativo</span> adatto. Osserva l'esempio.</span>
      </div>
    </h2>

    <div class="bg-blue-100 dark:bg-blue-900/40 border-2 border-blue-200 dark:border-blue-700 rounded-xl px-4 py-4 mb-4">
      <p class="mb-2">Ti ho portato il <span class="underline">videogioco</span>. Del <span class="underline">videogioco</span> ti avevo parlato.</p>
      <p class="font-bold text-blue-700 dark:text-blue-400">Ti ho portato il videogioco di cui (del quale) ti avevo parlato.</p>
    </div>

    <div class="space-y-4">
      <div class="bg-blue-50 dark:bg-blue-900/30 border-2 border-blue-200 dark:border-blue-700 rounded-xl px-3 py-3">
        <p class="text-gray-700 dark:text-gray-200 mb-2">• Nel giardino della scuola c'è un albero. Sull'albero ha fatto il nido un passerotto.</p>
        <input type="text" class="w-full border-b-2 border-blue-500 dark:border-blue-400 bg-transparent dark:text-white px-2 py-1 focus:outline-none focus:border-blue-700 dark:focus:border-blue-300" data-fill-blanks-target="input" data-correct-answer="Nel giardino della scuola c'è un albero su cui ha fatto il nido un passerotto.|Nel giardino della scuola c'è un albero sul quale ha fatto il nido un passerotto." placeholder="">
      </div>

      <div class="bg-blue-50 dark:bg-blue-900/30 border-2 border-blue-200 dark:border-blue-700 rounded-xl px-3 py-3">
        <p class="text-gray-700 dark:text-gray-200 mb-2">• È una brava maestra. Alla maestra tutti i bambini vogliono bene.</p>
        <input type="text" class="w-full border-b-2 border-blue-500 dark:border-blue-400 bg-transparent dark:text-white px-2 py-1 focus:outline-none focus:border-blue-700 dark:focus:border-blue-300" data-fill-blanks-target="input" data-correct-answer="È una brava maestra a cui tutti i bambini vogliono bene.|È una brava maestra alla quale tutti i bambini vogliono bene." placeholder="">
      </div>

      <div class="bg-blue-50 dark:bg-blue-900/30 border-2 border-blue-200 dark:border-blue-700 rounded-xl px-3 py-3">
        <p class="text-gray-700 dark:text-gray-200 mb-2">• La nonna mi ha regalato dei pattini. Con i pattini domani andrò a correre.</p>
        <input type="text" class="w-full border-b-2 border-blue-500 dark:border-blue-400 bg-transparent dark:text-white px-2 py-1 focus:outline-none focus:border-blue-700 dark:focus:border-blue-300" data-fill-blanks-target="input" data-correct-answer="La nonna mi ha regalato dei pattini con cui domani andrò a correre.|La nonna mi ha regalato dei pattini con i quali domani andrò a correre." placeholder="">
      </div>

      <div class="bg-blue-50 dark:bg-blue-900/30 border-2 border-blue-200 dark:border-blue-700 rounded-xl px-3 py-3">
        <p class="text-gray-700 dark:text-gray-200 mb-2">• Quest'anno frequento una nuova scuola. Nella scuola mi trovo molto bene.</p>
        <input type="text" class="w-full border-b-2 border-blue-500 dark:border-blue-400 bg-transparent dark:text-white px-2 py-1 focus:outline-none focus:border-blue-700 dark:focus:border-blue-300" data-fill-blanks-target="input" data-correct-answer="Quest'anno frequento una nuova scuola in cui mi trovo molto bene.|Quest'anno frequento una nuova scuola nella quale mi trovo molto bene." placeholder="">
      </div>

      <div class="bg-blue-50 dark:bg-blue-900/30 border-2 border-blue-200 dark:border-blue-700 rounded-xl px-3 py-3">
        <p class="text-gray-700 dark:text-gray-200 mb-2">• Ecco le foto degli amici. Dagli amici abbiamo trascorso le vacanze natalizie.</p>
        <input type="text" class="w-full border-b-2 border-blue-500 dark:border-blue-400 bg-transparent dark:text-white px-2 py-1 focus:outline-none focus:border-blue-700 dark:focus:border-blue-300" data-fill-blanks-target="input" data-correct-answer="Ecco le foto degli amici da cui abbiamo trascorso le vacanze natalizie.|Ecco le foto degli amici dai quali abbiamo trascorso le vacanze natalizie." placeholder="">
      </div>
    </div>
  </div>

  <!-- Esercizio 3: Sostituisci cui, chi e che -->
  <div class="mb-6 bg-white dark:bg-gray-800 rounded-2xl border-4 border-green-200 dark:border-green-700 shadow-2xl p-4 md:p-6" data-controller="fill-blanks">
    <h2 class="font-bold text-green-700 dark:text-green-400 mb-3">
      <div class="flex items-center gap-2 flex-wrap">
        <span class="bg-green-600 text-white rounded-full w-8 h-8 md:w-10 md:h-10 inline-flex items-center justify-center flex-shrink-0">3</span>
        <span>Sostituisci <span class="text-green-600 dark:text-green-400 font-bold underline">cui, chi</span> e <span class="underline">che</span> con <span class="underline">il quale, la quale, colui il quale, colei la quale</span>... Non dimenticare di aggiungere le <span class="underline">preposizioni</span> necessarie.</span>
      </div>
    </h2>

    <div class="bg-green-100 dark:bg-green-900/40 border-2 border-green-200 dark:border-green-700 rounded-xl px-4 py-4 mb-4">
      <p>• Si alzi <strong>chi</strong> → <span class="font-bold text-green-700 dark:text-green-400">colui il quale</span> vuol parlare.</p>
    </div>

    <div class="space-y-3">
      <div class="bg-green-50 dark:bg-green-900/30 border-2 border-green-200 dark:border-green-700 rounded-xl px-3 py-3">
        <div class="flex flex-wrap items-center gap-2">
          <span class="text-gray-700 dark:text-gray-200">• Ecco il pupazzo <strong>a cui</strong></span>
          <input type="text" class="border-b-2 border-green-500 dark:border-green-400 bg-transparent dark:text-white px-2 py-1 focus:outline-none focus:border-green-700 dark:focus:border-green-300 w-40" data-fill-blanks-target="input" data-correct-answer="al quale" placeholder="">
          <span class="text-gray-700 dark:text-gray-200">sono più affezionato.</span>
        </div>
      </div>

      <div class="bg-green-50 dark:bg-green-900/30 border-2 border-green-200 dark:border-green-700 rounded-xl px-3 py-3">
        <div class="flex flex-wrap items-center gap-2">
          <span class="text-gray-700 dark:text-gray-200">• Questa è la scala <strong>che</strong></span>
          <input type="text" class="border-b-2 border-green-500 dark:border-green-400 bg-transparent dark:text-white px-2 py-1 focus:outline-none focus:border-green-700 dark:focus:border-green-300 w-40" data-fill-blanks-target="input" data-correct-answer="la quale" placeholder="">
          <span class="text-gray-700 dark:text-gray-200">porta in giardino.</span>
        </div>
      </div>

      <div class="bg-green-50 dark:bg-green-900/30 border-2 border-green-200 dark:border-green-700 rounded-xl px-3 py-3">
        <div class="flex flex-wrap items-center gap-2">
          <span class="text-gray-700 dark:text-gray-200">• Questi sono i fiori fra <strong>cui</strong></span>
          <input type="text" class="border-b-2 border-green-500 dark:border-green-400 bg-transparent dark:text-white px-2 py-1 focus:outline-none focus:border-green-700 dark:focus:border-green-300 w-40" data-fill-blanks-target="input" data-correct-answer="i quali" placeholder="">
          <span class="text-gray-700 dark:text-gray-200">ho scelto quelli per te.</span>
        </div>
      </div>

      <div class="bg-green-50 dark:bg-green-900/30 border-2 border-green-200 dark:border-green-700 rounded-xl px-3 py-3">
        <div class="flex flex-wrap items-center gap-2">
          <span class="text-gray-700 dark:text-gray-200">• È bello giocare con <strong>chi</strong></span>
          <input type="text" class="border-b-2 border-green-500 dark:border-green-400 bg-transparent dark:text-white px-2 py-1 focus:outline-none focus:border-green-700 dark:focus:border-green-300 w-40" data-fill-blanks-target="input" data-correct-answer="colui il quale" placeholder="">
          <span class="text-gray-700 dark:text-gray-200">sa accettare la sconfitta.</span>
        </div>
      </div>
    </div>
  </div>

  <div class="text-right text-gray-500 dark:text-gray-400 mb-6">
    Grammatica pp. <%= link_to "62", pagina_path("nvl5_gram_p062"), class: "text-red-600 dark:text-red-400 hover:text-red-800 dark:hover:text-red-300 underline font-bold" %>, <%= link_to "63", pagina_path("nvl5_gram_p063"), class: "text-red-600 dark:text-red-400 hover:text-red-800 dark:hover:text-red-300 underline font-bold" %>
  </div>

  <!-- Exercise Controls -->
  <div class="mt-6">
    <%= render 'shared/exercise_controls' %>
  </div>
</div>
