<% content_for :titolo, "#{@pagina.titolo} - #{@pagina.numero}" %>

<div class="max-w-7xl mx-auto p-3 md:p-6 bg-white dark:bg-gray-900 text-black dark:text-white font-mono transition-colors duration-300"
     data-controller="exercise-checker page-viewer text-toggle font-controls"
     data-page-viewer-image-url-value="<%= asset_path('bus3_mat/p169/page.png') %>"
     data-text-toggle-target="content"
     data-font-controls-target="content">

  <!-- Header -->
  <%= render 'shared/page_header', pagina: @pagina %>

  <!-- Tabella 1: Misure di peso (kg) -->
  <div class="overflow-x-auto mb-4">
    <table class="w-full border-collapse border border-gray-400 dark:border-gray-500">
      <thead>
        <tr>
          <th class="border border-gray-400 dark:border-gray-500 bg-gray-100 dark:bg-gray-800 px-2 py-1"></th>
          <th colspan="2" class="border border-gray-400 dark:border-gray-500 bg-cyan-100 dark:bg-cyan-900/40 px-2 py-1">MULTIPLI</th>
          <th class="border border-gray-400 dark:border-gray-500 bg-cyan-200 dark:bg-cyan-800 px-2 py-1">UNITÀ FONDAMENTALE</th>
          <th colspan="3" class="border border-gray-400 dark:border-gray-500 bg-cyan-100 dark:bg-cyan-900/40 px-2 py-1">SOTTOMULTIPLI</th>
        </tr>
        <tr class="text-cyan-600">
          <th class="border border-gray-400 dark:border-gray-500 px-2 py-1">MEGAGRAMMO<br>Mg</th>
          <th class="border border-gray-400 dark:border-gray-500 px-2 py-1">CENTINAIO DI KG<br>100 kg</th>
          <th class="border border-gray-400 dark:border-gray-500 px-2 py-1">DECINA DI KG<br>10 kg</th>
          <th class="border border-gray-400 dark:border-gray-500 bg-cyan-50 dark:bg-cyan-900/30 px-2 py-1">CHILOGRAMMO<br>kg</th>
          <th class="border border-gray-400 dark:border-gray-500 px-2 py-1">ETTOGRAMMO<br>hg</th>
          <th class="border border-gray-400 dark:border-gray-500 px-2 py-1">DECAGRAMMO<br>dag</th>
          <th class="border border-gray-400 dark:border-gray-500 px-2 py-1">GRAMMO<br>g</th>
        </tr>
      </thead>
      <tbody>
        <tr class="text-center">
          <td class="border border-gray-400 dark:border-gray-500 px-2 py-1">1000 kg</td>
          <td class="border border-gray-400 dark:border-gray-500 px-2 py-1">100 kg</td>
          <td class="border border-gray-400 dark:border-gray-500 px-2 py-1">10 kg</td>
          <td class="border border-gray-400 dark:border-gray-500 bg-cyan-50 dark:bg-cyan-900/30 px-2 py-1">1 kg</td>
          <td class="border border-gray-400 dark:border-gray-500 px-2 py-1">0,1 kg</td>
          <td class="border border-gray-400 dark:border-gray-500 px-2 py-1">0,01 kg</td>
          <td class="border border-gray-400 dark:border-gray-500 px-2 py-1">0,001 kg</td>
        </tr>
      </tbody>
    </table>
  </div>

  <!-- Tabella 2: Misure di peso (g) -->
  <div class="overflow-x-auto mb-8">
    <table class="w-full border-collapse border border-gray-400 dark:border-gray-500">
      <thead>
        <tr>
          <th class="border border-gray-400 dark:border-gray-500 bg-cyan-200 dark:bg-cyan-800 px-2 py-1">UNITÀ FONDAMENTALE</th>
          <th colspan="3" class="border border-gray-400 dark:border-gray-500 bg-cyan-100 dark:bg-cyan-900/40 px-2 py-1">SOTTOMULTIPLI</th>
        </tr>
        <tr class="text-cyan-600">
          <th class="border border-gray-400 dark:border-gray-500 bg-cyan-50 dark:bg-cyan-900/30 px-2 py-1">GRAMMO<br>g</th>
          <th class="border border-gray-400 dark:border-gray-500 px-2 py-1">DECIGRAMMO<br>dg</th>
          <th class="border border-gray-400 dark:border-gray-500 px-2 py-1">CENTIGRAMMO<br>cg</th>
          <th class="border border-gray-400 dark:border-gray-500 px-2 py-1">MILLIGRAMMO<br>mg</th>
        </tr>
      </thead>
      <tbody>
        <tr class="text-center">
          <td class="border border-gray-400 dark:border-gray-500 bg-cyan-50 dark:bg-cyan-900/30 px-2 py-1">1 g</td>
          <td class="border border-gray-400 dark:border-gray-500 px-2 py-1">0,1 g</td>
          <td class="border border-gray-400 dark:border-gray-500 px-2 py-1">0,01 g</td>
          <td class="border border-gray-400 dark:border-gray-500 px-2 py-1">0,001 g</td>
        </tr>
      </tbody>
    </table>
  </div>

  <!-- Esercizio 1 -->
  <div class="mb-12">
    <div class="flex items-start gap-3 mb-6">
      <div class="bg-red-500 text-white rounded-full w-8 h-8 flex items-center justify-center font-bold flex-shrink-0">
        1
      </div>
      <p class="text-gray-700 dark:text-gray-200">
        <strong>Su ogni bilancia disegna i pesi necessari per ottenere il peso indicato: utilizzane il minor numero possibile.</strong>
      </p>
    </div>

    <div class="flex justify-center mb-4">
      <div class="dark:bg-white dark:rounded-xl dark:p-2 inline-block">
        <%= image_tag "bus3_mat/p169/p169_01.jpg", alt: "Bilance e pesi", class: "max-w-full rounded" %>
      </div>
    </div>
  </div>

  <!-- Esercizio 2 -->
  <div class="mb-12" data-controller="fill-blanks auto-advance">
    <div class="flex items-start gap-3 mb-6">
      <div class="bg-red-500 text-white rounded-full w-8 h-8 flex items-center justify-center font-bold flex-shrink-0">
        2
      </div>
      <p class="text-gray-700 dark:text-gray-200">
        <strong>Rispondi alle domande.</strong>
      </p>
    </div>

    <div class="space-y-4">
      <div>
        <p class="text-gray-700 mb-2">• Quanti ettogrammi sono 2 kg meno 1 hg?</p>
        <input type="text" data-fill-blanks-target="input" data-correct-answer="19"
               class="w-20 px-2 py-1 border-b-2 border-dotted border-gray-400 dark:border-gray-500 text-center bg-white dark:bg-gray-700 dark:text-white" inputmode="numeric">
        <span class="text-gray-500 dark:text-gray-400 ml-2">(2 kg = 20 hg, 20 - 1 = 19 hg)</span>
      </div>
      <div>
        <p class="text-gray-700 mb-2">• Una cassa pesa 15 kg, un'altra pesa 150 hg. Quale cassa pesa di più?</p>
        <input type="text" data-fill-blanks-target="input" data-correct-answer="nessuna|pesano uguale|uguali"
               class="w-40 px-2 py-1 border-b-2 border-dotted border-gray-400 dark:border-gray-500 text-center bg-white dark:bg-gray-700 dark:text-white">
        <span class="text-gray-500 dark:text-gray-400 ml-2">(15 kg = 150 hg, quindi pesano uguale)</span>
      </div>
    </div>
  </div>

  <!-- Esercizio 3 -->
  <div class="mb-12" data-controller="fill-blanks auto-advance">
    <div class="flex items-start gap-3 mb-6">
      <div class="bg-red-500 text-white rounded-full w-8 h-8 flex items-center justify-center font-bold flex-shrink-0">
        3
      </div>
      <p class="text-gray-700 dark:text-gray-200">
        <strong>Componi le misure.</strong>
      </p>
    </div>

    <div class="space-y-3">
      <p>8 kg, 6 hg =
        <input type="text" data-fill-blanks-target="input" data-correct-answer="86"
               class="w-16 px-1 py-1 border-b-2 border-dotted border-gray-400 dark:border-gray-500 text-center bg-white dark:bg-gray-700 dark:text-white" inputmode="numeric"> hg
      </p>
      <p>5 kg, 4 dag =
        <input type="text" data-fill-blanks-target="input" data-correct-answer="504"
               class="w-16 px-1 py-1 border-b-2 border-dotted border-gray-400 dark:border-gray-500 text-center bg-white dark:bg-gray-700 dark:text-white" inputmode="numeric"> dag
      </p>
      <p>3 Mg, 2 kg =
        <input type="text" data-fill-blanks-target="input" data-correct-answer="3002"
               class="w-16 px-1 py-1 border-b-2 border-dotted border-gray-400 dark:border-gray-500 text-center bg-white dark:bg-gray-700 dark:text-white" inputmode="numeric"> kg
      </p>
      <p>2 g, 5 dg, 7 cg =
        <input type="text" data-fill-blanks-target="input" data-correct-answer="2,57"
               class="w-16 px-1 py-1 border-b-2 border-dotted border-gray-400 dark:border-gray-500 text-center bg-white dark:bg-gray-700 dark:text-white"> g
      </p>
    </div>
  </div>

  <!-- Esercizio 4 -->
  <div class="mb-12" data-controller="fill-blanks auto-advance">
    <div class="flex items-start gap-3 mb-6">
      <div class="bg-red-500 text-white rounded-full w-8 h-8 flex items-center justify-center font-bold flex-shrink-0">
        4
      </div>
      <p class="text-gray-700 dark:text-gray-200">
        <strong>Esegui le equivalenze.</strong>
      </p>
    </div>

    <div class="grid grid-cols-1 md:grid-cols-3 gap-4">
      <p>400 g =
        <input type="text" data-fill-blanks-target="input" data-correct-answer="4"
               class="w-16 px-1 py-1 border-b-2 border-dotted border-gray-400 dark:border-gray-500 text-center bg-white dark:bg-gray-700 dark:text-white" inputmode="numeric"> hg
      </p>
      <p>9320 g =
        <input type="text" data-fill-blanks-target="input" data-correct-answer="932"
               class="w-16 px-1 py-1 border-b-2 border-dotted border-gray-400 dark:border-gray-500 text-center bg-white dark:bg-gray-700 dark:text-white" inputmode="numeric"> dag
      </p>
      <p>9000 kg =
        <input type="text" data-fill-blanks-target="input" data-correct-answer="9"
               class="w-16 px-1 py-1 border-b-2 border-dotted border-gray-400 dark:border-gray-500 text-center bg-white dark:bg-gray-700 dark:text-white" inputmode="numeric"> Mg
      </p>
    </div>
  </div>

  <!-- Footer con controlli -->
  <%= render 'shared/exercise_controls' %>
</div>
