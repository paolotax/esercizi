<div class="max-w-6xl mx-auto bg-white dark:bg-gray-900 text-black dark:text-white p-3 md:p-6 transition-colors duration-300"
     data-controller="exercise-checker text-toggle font-controls"
     data-text-toggle-target="content"
     data-font-controls-target="content">

  <%= render 'shared/page_header', pagina: @pagina %>

  <div class="mb-6">
    <p class="text-sm md:text-base text-pink-700 dark:text-pink-400">
      Osserva l'immagine della biblioteca e tocca i cartellini per ascoltare la parola corretta.
    </p>
  </div>

  <!-- Interactive Image -->
  <div class="relative rounded-2xl overflow-hidden border-4 border-pink-200 dark:border-pink-700 shadow-2xl"
       data-controller="hotspot-editor"
       data-hotspot-editor-target="container">
    <%= image_tag "nvl5_gram/p004/p04_01.jpg",
        alt: "Biblioteca con cartellini: finestra, manifesto, scala, scaffale, lampada, quaderno, tavolo, libro, sedia, cuscino, tappeto, poltrona, schermo interattivo e bibliotecaria",
        class: "w-full h-full object-cover select-none pointer-events-none" %>

    <div class="absolute inset-0">
      <% hotspots = [
        { label: "Finestra", top: "12.9943%", left: "8.29499%", width: "10%", height: "3.5%" },
        { label: "Manifesto", top: "12.2655%", left: "34.1465%", width: "10.5%", height: "3.5%" },
        { label: "Scala", top: "41.74%", left: "12.2866%", width: "7%", height: "3.5%" },
        { label: "Scaffale", top: "56.4122%", left: "13.6716%", width: "9.5%", height: "3.5%" },
        { label: "Lampada", top: "64.0478%", left: "2.91003%", width: "9%", height: "3.5%" },
        { label: "Quaderno", top: "57.0253%", left: "37.473%", width: "10.5%", height: "3.5%" },
        { label: "Tavolo", top: "59.675%", left: "53.9582%", width: "8.5%", height: "3.5%" },
        { label: "Libro", top: "62.6976%", left: "35.2596%", width: "7%", height: "3.5%" },
        { label: "Sedia", top: "71.4829%", left: "44.4395%", width: "6.5%", height: "3.5%" },
        { label: "Cuscino", top: "74.5196%", left: "30.2409%", width: "8.5%", height: "3.5%" },
        { label: "Tappeto", top: "90.4715%", left: "15.0565%", width: "9.5%", height: "3.5%" },
        { label: "Poltrona", top: "88.528%", left: "39.5315%", width: "10%", height: "3.5%" },
        { label: "Schermo interattivo", top: "43.7823%", left: "75.6362%", width: "12.4602%", height: "6.05082%" },
        { label: "Bibliotecaria", top: "89.4997%", left: "85.5983%", width: "12.4351%", height: "3.98587%" }
      ] %>

      <% hotspots.each do |hotspot| %>
        <button type="button"
                class="absolute rounded-xl bg-pink-500/10 hover:bg-pink-500/25 border-2 border-transparent hover:border-pink-500 focus:border-pink-600 focus:outline-none transition shadow-sm cursor-move"
                style="top: <%= hotspot[:top] %>; left: <%= hotspot[:left] %>; width: <%= hotspot[:width] %>; height: <%= hotspot[:height] %>;"
                aria-label="Leggi: <%= hotspot[:label] %>"
                data-controller="image-speech"
                data-hotspot-editor-target="hotspot"
                data-image-speech-word-value="<%= hotspot[:label] %>"
                data-image-speech-lang-value="it-IT"
                data-action="mousedown->hotspot-editor#startDrag click->image-speech#speak">
          <span class="sr-only"><%= hotspot[:label] %></span>
        </button>
      <% end %>
    </div>
  </div>

  <%= render 'shared/exercise_controls' %>
</div>
