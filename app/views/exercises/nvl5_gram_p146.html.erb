<div class="max-w-6xl mx-auto p-3 md:p-8 bg-gradient-to-br from-cyan-50 via-white to-blue-50 rounded-3xl shadow-xl" data-controller="exercise-checker">

  <%= render 'shared/page_header', pagina: @pagina %>

  <!-- Exercise 1: Identify and analyze nouns -->
  <div class="mb-6 bg-white rounded-2xl border-4 border-yellow-200 shadow-2xl p-4 md:p-6" data-controller="word-highlighter" data-word-highlighter-multi-color-value="false">
    <h2 class="text-lg md:text-xl font-bold text-yellow-700 mb-3">
      <div class="flex items-center gap-2 flex-wrap">
        <div class="flex items-center gap-2">
          <span class="bg-yellow-600 text-white rounded-full w-8 h-8 md:w-10 md:h-10 inline-flex items-center justify-center flex-shrink-0">1</span>
          <span class="bg-yellow-400 text-blue-800 px-2 py-1 rounded text-sm md:text-base font-bold whitespace-nowrap">IMPARARE TUTTI</span>
        </div>
        <span>Sottolinea tutti i <span class="text-yellow-600 font-bold">nomi<span class="inline-block w-6 h-6 bg-yellow-300 rounded ml-1 align-middle cursor-pointer transition transform hover:scale-110" data-word-highlighter-target="colorBox" data-color="yellow" data-action="click->word-highlighter#selectColor"></span></span> che trovi nella filastrocca. Poi analizzali in tabella, come nell'esempio.</span>
      </div>
    </h2>

    <div class="bg-yellow-50 border-2 border-yellow-200 rounded-xl px-4 py-4 mb-4 text-base md:text-lg text-gray-700 leading-relaxed cursor-pointer">
      <p class="mb-2">
        Questa è la <span data-word-highlighter-target="word" data-correct="true" data-action="click->word-highlighter#toggleHighlight" class="px-1 rounded">storia</span> di <span data-word-highlighter-target="word" data-correct="true" data-action="click->word-highlighter#toggleHighlight" class="px-1 rounded">Lisa</span> <span data-word-highlighter-target="word" data-correct="true" data-action="click->word-highlighter#toggleHighlight" class="px-1 rounded">Cipolla</span><br>
        Che piange a <span data-word-highlighter-target="word" data-correct="true" data-action="click->word-highlighter#toggleHighlight" class="px-1 rounded">fontana</span> per un <span data-word-highlighter-target="word" data-correct="true" data-action="click->word-highlighter#toggleHighlight" class="px-1 rounded">nonnulla</span><br>
        Cadendo si fece un <span data-word-highlighter-target="word" data-correct="true" data-action="click->word-highlighter#toggleHighlight" class="px-1 rounded">graffietto</span> ai <span data-word-highlighter-target="word" data-correct="true" data-action="click->word-highlighter#toggleHighlight" class="px-1 rounded">ginocchi</span><br>
        E un <span data-word-highlighter-target="word" data-correct="true" data-action="click->word-highlighter#toggleHighlight" class="px-1 rounded">fiume</span> di <span data-word-highlighter-target="word" data-correct="true" data-action="click->word-highlighter#toggleHighlight" class="px-1 rounded">lacrime</span> sgorgò dai suoi <span data-word-highlighter-target="word" data-correct="true" data-action="click->word-highlighter#toggleHighlight" class="px-1 rounded">occhi</span><br>
        Un <span data-word-highlighter-target="word" data-correct="true" data-action="click->word-highlighter#toggleHighlight" class="px-1 rounded">fiume</span> in <span data-word-highlighter-target="word" data-correct="true" data-action="click->word-highlighter#toggleHighlight" class="px-1 rounded">piena</span> che andò verso il <span data-word-highlighter-target="word" data-correct="true" data-action="click->word-highlighter#toggleHighlight" class="px-1 rounded">mare</span><br>
        E <span data-word-highlighter-target="word" data-correct="true" data-action="click->word-highlighter#toggleHighlight" class="px-1 rounded">Lisa</span> <span data-word-highlighter-target="word" data-correct="true" data-action="click->word-highlighter#toggleHighlight" class="px-1 rounded">Cipolla</span> rischiò di annegare.
      </p>
      <p class="text-sm italic text-gray-600 mt-2">→ G. Quarzo, <em>Piccole catastrofi</em>, Città Nuova</p>
    </div>

    <div class="overflow-x-auto">
      <table class="w-full border-collapse text-sm md:text-base">
        <thead>
          <tr class="bg-cyan-100">
            <th class="border-2 border-cyan-300 px-2 py-2 text-cyan-700 font-bold">NOME</th>
            <th class="border-2 border-cyan-300 px-2 py-2 text-cyan-700 font-bold">comune</th>
            <th class="border-2 border-cyan-300 px-2 py-2 text-cyan-700 font-bold">proprio</th>
            <th class="border-2 border-cyan-300 px-2 py-2 text-cyan-700 font-bold">maschile</th>
            <th class="border-2 border-cyan-300 px-2 py-2 text-cyan-700 font-bold">femminile</th>
            <th class="border-2 border-cyan-300 px-2 py-2 text-cyan-700 font-bold">singolare</th>
            <th class="border-2 border-cyan-300 px-2 py-2 text-cyan-700 font-bold">plurale</th>
          </tr>
        </thead>
        <tbody>
          <tr class="bg-cyan-50">
            <td class="border-2 border-cyan-200 px-2 py-2 text-center font-semibold">storia</td>
            <td class="border-2 border-cyan-200 px-2 py-2 text-center"><strong>X</strong></td>
            <td class="border-2 border-cyan-200 px-2 py-2 text-center"></td>
            <td class="border-2 border-cyan-200 px-2 py-2 text-center"></td>
            <td class="border-2 border-cyan-200 px-2 py-2 text-center"><strong>X</strong></td>
            <td class="border-2 border-cyan-200 px-2 py-2 text-center"><strong>X</strong></td>
            <td class="border-2 border-cyan-200 px-2 py-2 text-center"></td>
          </tr>
          <% 10.times do |i| %>
            <tr class="<%= i.even? ? 'bg-white' : 'bg-cyan-50' %>">
              <td class="border-2 border-cyan-200 px-2 py-2">
                <input type="text" class="w-full bg-transparent border-b border-gray-300 focus:outline-none focus:border-cyan-500 text-center" placeholder="">
              </td>
              <% 6.times do %>
                <td class="border-2 border-cyan-200 px-2 py-2 text-center">
                  <input type="checkbox" class="w-4 h-4">
                </td>
              <% end %>
            </tr>
          <% end %>
        </tbody>
      </table>
    </div>
  </div>

  <!-- Exercise 2: Abstract nouns -->
  <div class="mb-6 bg-white rounded-2xl border-4 border-purple-200 shadow-2xl p-4 md:p-6" data-controller="fill-blanks">
    <h2 class="text-lg md:text-xl font-bold text-purple-700 mb-3">
      <span class="font-bold">2</span> Scrivi i <span class="text-purple-600 font-bold">nomi astratti</span> corrispondenti ai seguenti nomi concreti, come nell'esempio.
    </h2>

    <% abstract_nouns = [
      { from: "amico", to: "amicizia" },
      { from: "giudice", to: "giustizia" },
      { from: "parente", to: "parentela" },
      { from: "scienziato", to: "scienza" },
      { from: "fratello", to: "fratellanza" },
      { from: "poeta", to: "poesia" }
    ] %>

    <div class="space-y-3 text-base md:text-lg">
      <% abstract_nouns.each do |item| %>
        <div class="bg-purple-50 border-2 border-purple-200 rounded-xl px-3 py-3">
          <div class="flex flex-wrap items-center gap-2">
            <span class="text-gray-700 font-semibold">• <%= item[:from] %></span>
            <span class="text-xl text-purple-500">→</span>
            <% if item[:from] == "amico" %>
              <span class="font-bold text-purple-700"><%= item[:to] %></span>
            <% else %>
              <input type="text"
                     class="border-b-2 border-purple-500 bg-transparent px-2 py-1 focus:outline-none focus:border-purple-700 flex-1 min-w-[150px]"
                     data-fill-blanks-target="input"
                     data-answer="<%= item[:to] %>"
                     data-correct-answer="<%= item[:to] %>"
                     placeholder=".......................">
            <% end %>
          </div>
        </div>
      <% end %>
    </div>
  </div>

  <!-- Exercise 3: Proper nouns -->
  <div class="mb-6 bg-white rounded-2xl border-4 border-green-200 shadow-2xl p-4 md:p-6" data-controller="fill-blanks">
    <h2 class="text-lg md:text-xl font-bold text-green-700 mb-3">
      <span class="font-bold">3</span> Per ogni nome comune scrivi un <span class="text-green-600 font-bold">nome proprio</span>.
    </h2>

    <% proper_nouns = [
      { common: "festività", proper: "Natale" },
      { common: "continente", proper: "Europa" },
      { common: "squadra", proper: "Juventus" },
      { common: "fiume", proper: "Po" },
      { common: "personaggio", proper: "Harry Potter" },
      { common: "monte", proper: "Everest" }
    ] %>

    <div class="space-y-3 text-base md:text-lg">
      <% proper_nouns.each do |item| %>
        <div class="bg-green-50 border-2 border-green-200 rounded-xl px-3 py-3">
          <div class="flex flex-wrap items-center gap-2">
            <span class="text-gray-700 font-semibold">• <%= item[:common] %></span>
            <span class="text-xl text-green-500">→</span>
            <input type="text"
                   class="border-b-2 border-green-500 bg-transparent px-2 py-1 focus:outline-none focus:border-green-700 flex-1 min-w-[150px]"
                   data-fill-blanks-target="input"
                   data-answer="<%= item[:proper] %>"
                   data-correct-answer="<%= item[:proper] %>"
                   placeholder=".......................">
          </div>
        </div>
      <% end %>
    </div>
  </div>

  <div class="text-right text-sm text-gray-500 mb-6">
    Grammatica pp. <%= link_to "42", pagina_path("nvl5_gram_p042"), class: "text-red-600 hover:text-red-800 underline font-bold" %>, <%= link_to "43", pagina_path("nvl5_gram_p043"), class: "text-red-600 hover:text-red-800 underline font-bold" %>, <%= link_to "44", pagina_path("nvl5_gram_p044"), class: "text-red-600 hover:text-red-800 underline font-bold" %>, <%= link_to "45", pagina_path("nvl5_gram_p045"), class: "text-red-600 hover:text-red-800 underline font-bold" %>, <%= link_to "46", pagina_path("nvl5_gram_p046"), class: "text-red-600 hover:text-red-800 underline font-bold" %>
  </div>

  <!-- Exercise Controls -->
  <div class="mt-6">
    <%= render 'shared/exercise_controls', color: 'cyan', current_page: 'nvl5_gram_p146' %>
  </div>
</div>
