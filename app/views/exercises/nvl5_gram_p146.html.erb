<div class="max-w-6xl mx-auto bg-white dark:bg-gray-900 text-black dark:text-white p-3 md:p-6 transition-colors duration-300"
     data-controller="exercise-checker text-toggle font-controls"
     data-text-toggle-target="content"
     data-font-controls-target="content">

  <%= render 'shared/page_header', pagina: @pagina %>

  <!-- Exercise 1: Identify and analyze nouns -->
  <div class="mb-6 bg-<%= @pagina.base_color %>-100 dark:bg-<%= @pagina.base_color %>-900/40 rounded-lg p-4 md:p-6" data-controller="word-highlighter" data-word-highlighter-multi-color-value="false">
    <h2 class="font-bold text-<%= @pagina.base_color %>-700 dark:text-<%= @pagina.base_color %>-300 mb-4 flex items-center flex-wrap gap-2">
      <span class="bg-<%= @pagina.base_color %>-500 text-white rounded-full w-8 h-8 md:w-10 md:h-10 inline-flex items-center justify-center font-bold">1</span>
      <span class="bg-yellow-400 text-<%= @pagina.base_color %>-900 px-3 py-1 rounded-lg font-bold">IMPARARE TUTTI</span>
      <span>Sottolinea tutti i <span class="text-<%= @pagina.base_color %>-600 dark:text-<%= @pagina.base_color %>-400 font-bold">nomi<span class="inline-block w-6 h-6 bg-yellow-300 rounded ml-1 align-middle cursor-pointer" data-word-highlighter-target="colorBox" data-color="yellow" data-action="click->word-highlighter#selectColor"></span></span> che trovi nella filastrocca. Poi analizzali in tabella, come nell'esempio.</span>
    </h2>

    <div class="bg-white dark:bg-gray-800 rounded-lg px-4 py-4 mb-4 text-gray-700 dark:text-gray-200 leading-relaxed cursor-pointer">
      <p class="mb-2">
        Questa Ã¨ la <span data-word-highlighter-target="word" data-correct="true" data-action="click->word-highlighter#toggleHighlight" class="px-1 rounded">storia</span> di <span data-word-highlighter-target="word" data-correct="true" data-action="click->word-highlighter#toggleHighlight" class="px-1 rounded">Lisa</span> <span data-word-highlighter-target="word" data-correct="true" data-action="click->word-highlighter#toggleHighlight" class="px-1 rounded">Cipolla</span><br>
        Che piange a <span data-word-highlighter-target="word" data-correct="true" data-action="click->word-highlighter#toggleHighlight" class="px-1 rounded">fontana</span> per un <span data-word-highlighter-target="word" data-correct="true" data-action="click->word-highlighter#toggleHighlight" class="px-1 rounded">nonnulla</span><br>
        Cadendo si fece un <span data-word-highlighter-target="word" data-correct="true" data-action="click->word-highlighter#toggleHighlight" class="px-1 rounded">graffietto</span> ai <span data-word-highlighter-target="word" data-correct="true" data-action="click->word-highlighter#toggleHighlight" class="px-1 rounded">ginocchi</span><br>
        E un <span data-word-highlighter-target="word" data-correct="true" data-action="click->word-highlighter#toggleHighlight" class="px-1 rounded">fiume</span> di <span data-word-highlighter-target="word" data-correct="true" data-action="click->word-highlighter#toggleHighlight" class="px-1 rounded">lacrime</span> sgorgo dai suoi <span data-word-highlighter-target="word" data-correct="true" data-action="click->word-highlighter#toggleHighlight" class="px-1 rounded">occhi</span><br>
        Un <span data-word-highlighter-target="word" data-correct="true" data-action="click->word-highlighter#toggleHighlight" class="px-1 rounded">fiume</span> in <span data-word-highlighter-target="word" data-correct="true" data-action="click->word-highlighter#toggleHighlight" class="px-1 rounded">piena</span> che ando verso il <span data-word-highlighter-target="word" data-correct="true" data-action="click->word-highlighter#toggleHighlight" class="px-1 rounded">mare</span><br>
        E <span data-word-highlighter-target="word" data-correct="true" data-action="click->word-highlighter#toggleHighlight" class="px-1 rounded">Lisa</span> <span data-word-highlighter-target="word" data-correct="true" data-action="click->word-highlighter#toggleHighlight" class="px-1 rounded">Cipolla</span> rischio di annegare.
      </p>
      <p class="italic text-gray-600 dark:text-gray-400 mt-2">-> G. Quarzo, <em>Piccole catastrofi</em>, Citta Nuova</p>
    </div>

    <div class="overflow-x-auto">
      <table class="w-full">
        <thead>
          <tr class="bg-<%= @pagina.base_color %>-200 dark:bg-<%= @pagina.base_color %>-900/50">
            <th class="border border-gray-300 dark:border-gray-600 px-2 py-2 text-<%= @pagina.base_color %>-700 dark:text-<%= @pagina.base_color %>-300 font-bold">NOME</th>
            <th class="border border-gray-300 dark:border-gray-600 px-2 py-2 text-<%= @pagina.base_color %>-700 dark:text-<%= @pagina.base_color %>-300 font-bold">comune</th>
            <th class="border border-gray-300 dark:border-gray-600 px-2 py-2 text-<%= @pagina.base_color %>-700 dark:text-<%= @pagina.base_color %>-300 font-bold">proprio</th>
            <th class="border border-gray-300 dark:border-gray-600 px-2 py-2 text-<%= @pagina.base_color %>-700 dark:text-<%= @pagina.base_color %>-300 font-bold">maschile</th>
            <th class="border border-gray-300 dark:border-gray-600 px-2 py-2 text-<%= @pagina.base_color %>-700 dark:text-<%= @pagina.base_color %>-300 font-bold">femminile</th>
            <th class="border border-gray-300 dark:border-gray-600 px-2 py-2 text-<%= @pagina.base_color %>-700 dark:text-<%= @pagina.base_color %>-300 font-bold">singolare</th>
            <th class="border border-gray-300 dark:border-gray-600 px-2 py-2 text-<%= @pagina.base_color %>-700 dark:text-<%= @pagina.base_color %>-300 font-bold">plurale</th>
          </tr>
        </thead>
        <tbody class="bg-white dark:bg-gray-800">
          <tr class="bg-<%= @pagina.base_color %>-50 dark:bg-<%= @pagina.base_color %>-900/30">
            <td class="border border-gray-300 dark:border-gray-600 px-2 py-2 text-center font-semibold">storia</td>
            <td class="border border-gray-300 dark:border-gray-600 px-2 py-2 text-center"><strong>X</strong></td>
            <td class="border border-gray-300 dark:border-gray-600 px-2 py-2 text-center"></td>
            <td class="border border-gray-300 dark:border-gray-600 px-2 py-2 text-center"></td>
            <td class="border border-gray-300 dark:border-gray-600 px-2 py-2 text-center"><strong>X</strong></td>
            <td class="border border-gray-300 dark:border-gray-600 px-2 py-2 text-center"><strong>X</strong></td>
            <td class="border border-gray-300 dark:border-gray-600 px-2 py-2 text-center"></td>
          </tr>
          <% 10.times do |i| %>
            <tr class="<%= i.even? ? 'bg-white dark:bg-gray-800' : 'bg-' + @pagina.base_color + '-50 dark:bg-' + @pagina.base_color + '-900/30' %>">
              <td class="border border-gray-300 dark:border-gray-600 px-2 py-2">
                <input type="text" class="w-full bg-transparent dark:text-white border-b border-dotted border-gray-400 dark:border-gray-600 focus:outline-none focus:border-<%= @pagina.base_color %>-500 text-center" placeholder="">
              </td>
              <% 6.times do %>
                <td class="border border-gray-300 dark:border-gray-600 px-2 py-2 text-center">
                  <input type="checkbox" class="w-4 h-4">
                </td>
              <% end %>
            </tr>
          <% end %>
        </tbody>
      </table>
    </div>
  </div>

  <!-- Exercise 2: Abstract nouns -->
  <div class="mb-6 bg-<%= @pagina.base_color %>-50 dark:bg-<%= @pagina.base_color %>-900/30 rounded-lg p-4 md:p-6" data-controller="fill-blanks">
    <h2 class="font-bold text-<%= @pagina.base_color %>-700 dark:text-<%= @pagina.base_color %>-300 mb-4 flex items-center gap-2">
      <span class="bg-<%= @pagina.base_color %>-500 text-white rounded-full w-8 h-8 md:w-10 md:h-10 inline-flex items-center justify-center font-bold">2</span>
      <span>Scrivi i <span class="text-<%= @pagina.base_color %>-600 dark:text-<%= @pagina.base_color %>-400 font-bold">nomi astratti</span> corrispondenti ai seguenti nomi concreti, come nell'esempio.</span>
    </h2>

    <% abstract_nouns = [
      { from: "amico", to: "amicizia" },
      { from: "giudice", to: "giustizia" },
      { from: "parente", to: "parentela" },
      { from: "scienziato", to: "scienza" },
      { from: "fratello", to: "fratellanza" },
      { from: "poeta", to: "poesia" }
    ] %>

    <div class="space-y-3">
      <% abstract_nouns.each do |item| %>
        <div class="flex items-center gap-3">
          <span class="text-<%= @pagina.base_color %>-600 dark:text-<%= @pagina.base_color %>-400 font-bold">*</span>
          <span class="text-gray-700 dark:text-gray-200 font-semibold w-28"><%= item[:from] %></span>
          <span class="text-gray-400">-></span>
          <% if item[:from] == "amico" %>
            <span class="font-bold text-<%= @pagina.base_color %>-700 dark:text-<%= @pagina.base_color %>-300"><%= item[:to] %></span>
          <% else %>
            <input type="text"
                   class="border-b-2 border-dotted border-gray-400 dark:border-gray-600 bg-transparent dark:text-white px-2 py-1 focus:outline-none focus:border-<%= @pagina.base_color %>-500 flex-grow"
                   data-fill-blanks-target="input"
                   data-answer="<%= item[:to] %>"
                   data-correct-answer="<%= item[:to] %>">
          <% end %>
        </div>
      <% end %>
    </div>
  </div>

  <!-- Exercise 3: Proper nouns -->
  <div class="mb-6 bg-<%= @pagina.base_color %>-50 dark:bg-<%= @pagina.base_color %>-900/30 rounded-lg p-4 md:p-6" data-controller="fill-blanks">
    <h2 class="font-bold text-<%= @pagina.base_color %>-700 dark:text-<%= @pagina.base_color %>-300 mb-4 flex items-center gap-2">
      <span class="bg-<%= @pagina.base_color %>-500 text-white rounded-full w-8 h-8 md:w-10 md:h-10 inline-flex items-center justify-center font-bold">3</span>
      <span>Per ogni nome comune scrivi un <span class="text-<%= @pagina.base_color %>-600 dark:text-<%= @pagina.base_color %>-400 font-bold">nome proprio</span>.</span>
    </h2>

    <% proper_nouns = [
      { common: "festivita", proper: "Natale" },
      { common: "continente", proper: "Europa" },
      { common: "squadra", proper: "Juventus" },
      { common: "fiume", proper: "Po" },
      { common: "personaggio", proper: "Harry Potter" },
      { common: "monte", proper: "Everest" }
    ] %>

    <div class="space-y-3">
      <% proper_nouns.each do |item| %>
        <div class="flex items-center gap-3">
          <span class="text-<%= @pagina.base_color %>-600 dark:text-<%= @pagina.base_color %>-400 font-bold">*</span>
          <span class="text-gray-700 dark:text-gray-200 font-semibold w-28"><%= item[:common] %></span>
          <span class="text-gray-400">-></span>
          <input type="text"
                 class="border-b-2 border-dotted border-gray-400 dark:border-gray-600 bg-transparent dark:text-white px-2 py-1 focus:outline-none focus:border-<%= @pagina.base_color %>-500 flex-grow"
                 data-fill-blanks-target="input"
                 data-answer="<%= item[:proper] %>"
                 data-correct-answer="<%= item[:proper] %>">
        </div>
      <% end %>
    </div>
  </div>

  <%= render 'shared/exercise_controls' %>

</div>
