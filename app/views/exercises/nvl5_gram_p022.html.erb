<div class="max-w-6xl mx-auto bg-white dark:bg-gray-900 text-black dark:text-white p-3 md:p-6 transition-colors duration-300"
     data-controller="exercise-checker text-toggle font-controls"
     data-text-toggle-target="content"
     data-font-controls-target="content">

  <%= render 'shared/page_header', pagina: @pagina %>

  <div class="space-y-6">

  <div class="bg-white dark:bg-gray-800 rounded-lg p-4 md:p-6 pb-8">
    <p class="text-gray-600 dark:text-gray-400 mb-4">
      <span class="text-<%= @pagina.base_color %>-500">â€¢</span> Osserva l'immagine del supermercato e tocca i cartellini per ascoltare la parola corretta.
    </p>

    <!-- Interactive Image -->
    <div class="relative rounded-lg overflow-hidden dark:bg-white"
         data-controller="hotspot-editor"
         data-hotspot-editor-target="container">
    <%= image_tag "nvl5_gram/p022/p022_01.jpg",
        alt: "Supermercato con cartellini: frigorifero, cartello del reparto, lampadario, scaffale, flaconi, espositore, caporeparto, cassa, scatole, cliente, cestino, bilancia, cassetta, borse, banco, carrello e corsia",
        class: "w-full h-full object-cover select-none pointer-events-none rounded-lg" %>

    <div class="absolute inset-0">
      <% hotspots = [
        { label: "Frigorifero", top: "22.8%", left: "12.0%", width: "11.0%", height: "3.5%" },
        { label: "Cartello del reparto", top: "12.3%", left: "40.9%", width: "19.0%", height: "3.5%" },
        { label: "Lampadario", top: "8.4%", left: "75.8%", width: "11.0%", height: "3.5%" },
        { label: "Scaffale", top: "35.6%", left: "32.8%", width: "9.1%", height: "3.5%" },
        { label: "Flaconi", top: "33.8%", left: "49.0%", width: "8.6%", height: "3.5%" },
        { label: "Espositore", top: "30.0%", left: "69.0%", width: "10.5%", height: "3.5%" },
        
        { label: "Capo reparto", top: "48.5%", left: "45.9%", width: "11.5%", height: "3.5%" },
        { label: "Cassa", top: "52.0%", left: "78.0%", width: "7.5%", height: "3.5%" },
        { label: "Scatole", top: "61.9%", left: "50.5%", width: "9.0%", height: "3.5%" },
        { label: "Cliente", top: "61.7%", left: "37.4%", width: "7.5%", height: "3.5%" },
        
        { label: "Cestino", top: "78.4%", left: "49.0%", width: "9.0%", height: "3.5%" },
        { label: "Bilancia", top: "63.5%", left: "26.5%", width: "8.5%", height: "3.5%" },
        
        { label: "Cassetta", top: "67.5%", left: "7.7%", width: "8.6%", height: "3.5%" },
        { label: "Borse", top: "62.0%", left: "70.4%", width: "7.0%", height: "3.5%" },
        
        { label: "Banco", top: "77.2%", left: "4.4%", width: "8.5%", height: "3.5%" },
        { label: "Carrello", top: "75.5%", left: "79.2%", width: "9.5%", height: "3.5%" },
        { label: "Corsia", top: "92.4%", left: "18.2%", width: "8.0%", height: "3.5%" }
      ] %>

      <% hotspots.each do |hotspot| %>
        <button type="button"
                class="absolute rounded-xl bg-blue-500/10 hover:bg-blue-500/25 border-2 border-transparent hover:border-blue-500 focus:border-blue-600 focus:outline-none transition shadow-sm cursor-move"
                style="top: <%= hotspot[:top] %>; left: <%= hotspot[:left] %>; width: <%= hotspot[:width] %>; height: <%= hotspot[:height] %>;"
                aria-label="Leggi: <%= hotspot[:label] %>"
                data-controller="image-speech"
                data-hotspot-editor-target="hotspot"
                data-image-speech-word-value="<%= hotspot[:label] %>"
                data-image-speech-lang-value="it-IT"
                data-action="mousedown->hotspot-editor#startDrag click->image-speech#speak">
          <span class="sr-only"><%= hotspot[:label] %></span>
        </button>
      <% end %>
    </div>
  </div>

  <!-- Exercise Controls -->
  <%= render 'shared/exercise_controls' %>
  </div><!-- chiude space-y-6 -->
</div>

