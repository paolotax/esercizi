<div class="max-w-6xl mx-auto bg-white p-3 md:p-6"
     data-controller="exercise-checker text-toggle font-controls fraction-coloring"
     data-text-toggle-target="content"
     data-font-controls-target="content">

  <%= render 'shared/page_header', pagina: @pagina %>

  <div class="space-y-6">

    <!-- Introduzione -->
    <p class="text-gray-700">
      L'<span class="font-bold">intero</span> da frazionare può essere una <span class="font-bold">figura</span>, un <span class="font-bold">segmento</span>, un gruppo di <span class="font-bold">oggetti</span>.
    </p>

    <!-- Sezione 1: Rettangolo -->
    <div class="py-4 border-t border-gray-200">
      <div class="grid grid-cols-1 md:grid-cols-2 gap-6 items-center">
        <div>
          <p class="text-gray-700 mb-3">
            <span class="text-<%= @pagina.base_color %>-500">•</span> Prendiamo un rettangolo e dividiamolo in 4 parti uguali.<br>
            Ciascuna parte rappresenta un quarto (<%= render 'shared/frazione', num: 1, den: 4 %>) del rettangolo, cioè una sola delle quattro parti uguali in cui è stato diviso; ogni parte si chiama <span class="font-bold">unità frazionaria</span>.<br>
            Colora un'unità frazionaria come preferisci.
          </p>
        </div>
        <div class="flex justify-center">
          <div class="w-48 h-32 border-2 border-gray-400 grid grid-cols-2 grid-rows-2">
            <div class="border-r border-b border-gray-400 cursor-pointer hover:bg-gray-100" data-action="click->fraction-coloring#toggleColor"></div>
            <div class="border-b border-gray-400 cursor-pointer hover:bg-gray-100" data-action="click->fraction-coloring#toggleColor"></div>
            <div class="border-r border-gray-400 cursor-pointer hover:bg-gray-100" data-action="click->fraction-coloring#toggleColor"></div>
            <div class="cursor-pointer hover:bg-gray-100" data-action="click->fraction-coloring#toggleColor"></div>
          </div>
        </div>
      </div>
    </div>

    <!-- Sezione 2: Segmento -->
    <div class="py-4 border-t border-gray-200">
      <div class="grid grid-cols-1 md:grid-cols-2 gap-6 items-center">
        <div>
          <p class="text-gray-700 mb-3">
            <span class="text-<%= @pagina.base_color %>-500">•</span> Prendiamo un segmento e dividiamolo in 8 parti uguali.<br>
            L'unità frazionaria che rappresenta ciascuna parte è <%= render 'shared/frazione', num: 1, den: 8 %>.<br>
            Colora un'unità frazionaria come preferisci.
          </p>
        </div>
        <div class="flex justify-center">
          <div class="w-64 h-8 border-2 border-gray-400 grid grid-cols-8">
            <% 8.times do |i| %>
              <div class="<%= i < 7 ? 'border-r border-gray-400' : '' %> cursor-pointer hover:bg-gray-100" data-action="click->fraction-coloring#toggleColor"></div>
            <% end %>
          </div>
        </div>
      </div>
    </div>

    <!-- Sezione 3: Gelati -->
    <div class="py-4 border-t border-gray-200">
      <div class="grid grid-cols-1 md:grid-cols-2 gap-6 items-center">
        <div>
          <p class="text-gray-700 mb-3">
            <span class="text-<%= @pagina.base_color %>-500">•</span> Prendiamo 12 gelati e dividiamo l'intera quantità in 3 parti uguali.<br>
            L'unità frazionaria che rappresenta ciascuna parte è <%= render 'shared/frazione', num: 1, den: 3 %>.<br>
            Colora un'unità frazionaria come preferisci.
          </p>
        </div>
        <div class="flex justify-center">
          <%= image_tag "nvi4_mat/p058/p058_04.jpg", class: "max-w-full h-auto" %>
        </div>
      </div>
    </div>

    <!-- Box regola -->
    <div class="p-3 bg-pink-light rounded-2xl w-fit">
      <p class="text-gray-700">
        L'<span class="font-bold">unità frazionaria</span> indica ognuna delle parti in cui è diviso l'intero. È una frazione con numeratore <span class="font-bold">1</span>.
      </p>
    </div>

    <!-- ESERCIZI -->
    <div class="p-4 md:p-6 bg-orange-100 rounded-2xl">

      <!-- Esercizio 1 -->
      <div class="p-4 bg-white rounded-2xl -mx-4 md:-mx-6 -mt-4 md:-mt-6 mb-6 border-3 border-blue-500">
        <p class="font-bold text-gray-700 mb-4">
          <%= imparare_tutti_badge(1) %>
          Scrivi l'unità frazionaria che rappresenta la parte colorata di ogni figura.
        </p>

        <div class="grid grid-cols-2 md:grid-cols-5 gap-4">
          <!-- Rettangolo diviso in 4 (1 colorato) -->
          <div class="flex flex-col items-center gap-2">
            <div class="w-16 h-16 border-2 border-gray-400 grid grid-cols-2 grid-rows-2">
              <div class="border-r border-b border-gray-400 bg-cyan-400"></div>
              <div class="border-b border-gray-400"></div>
              <div class="border-r border-gray-400"></div>
              <div></div>
            </div>
            <%= render 'shared/frazione', num: nil, den: nil, num_answer: "1", den_answer: "4" %>
          </div>

          <!-- Rettangolo diviso in 6 (1 colorato) -->
          <div class="flex flex-col items-center gap-2">
            <div class="w-20 h-12 border-2 border-gray-400 grid grid-cols-6">
              <div class="border-r border-gray-400 bg-cyan-400"></div>
              <% 5.times do |i| %>
                <div class="<%= i < 4 ? 'border-r border-gray-400' : '' %>"></div>
              <% end %>
            </div>
            <%= render 'shared/frazione', num: nil, den: nil, num_answer: "1", den_answer: "6" %>
          </div>

          <!-- Triangolo diviso in 4 (1 colorato) -->
          <div class="flex flex-col items-center gap-2">
            <div class="flex gap-1">
              <div class="w-0 h-0 border-l-[15px] border-r-[15px] border-b-[26px] border-l-transparent border-r-transparent border-b-cyan-400"></div>
              <div class="w-0 h-0 border-l-[15px] border-r-[15px] border-b-[26px] border-l-transparent border-r-transparent border-b-gray-300"></div>
              <div class="w-0 h-0 border-l-[15px] border-r-[15px] border-b-[26px] border-l-transparent border-r-transparent border-b-gray-300"></div>
              <div class="w-0 h-0 border-l-[15px] border-r-[15px] border-b-[26px] border-l-transparent border-r-transparent border-b-gray-300"></div>
            </div>
            <%= render 'shared/frazione', num: nil, den: nil, num_answer: "1", den_answer: "4" %>
          </div>

          <!-- Rettangolo diviso in 5 (1 colorato) -->
          <div class="flex flex-col items-center gap-2">
            <div class="w-16 h-16 border-2 border-gray-400 grid grid-rows-5">
              <div class="border-b border-gray-400 bg-cyan-400"></div>
              <% 4.times do |i| %>
                <div class="<%= i < 3 ? 'border-b border-gray-400' : '' %>"></div>
              <% end %>
            </div>
            <%= render 'shared/frazione', num: nil, den: nil, num_answer: "1", den_answer: "5" %>
          </div>

          <!-- Rettangolo diviso in 8 (1 colorato) -->
          <div class="flex flex-col items-center gap-2">
            <div class="w-16 h-16 border-2 border-gray-400 grid grid-cols-4 grid-rows-2">
              <div class="border-r border-b border-gray-400 bg-cyan-400"></div>
              <% 7.times do |i| %>
                <div class="border border-gray-300"></div>
              <% end %>
            </div>
            <%= render 'shared/frazione', num: nil, den: nil, num_answer: "1", den_answer: "8" %>
          </div>
        </div>
      </div>

      <!-- Esercizio 2 -->
      <div class="mb-6">
        <p class="font-bold text-gray-700 mb-4">
          <%= numero_esercizio_badge(2) %>
          Scrivi l'unità frazionaria che rappresenta la parte colorata di ogni segmento.
        </p>

        <div class="space-y-4">
          <!-- Segmento 1: diviso in 5 -->
          <div class="flex items-center gap-4">
            <div class="flex-1 max-w-xs h-6 border-2 border-gray-400 grid grid-cols-5">
              <div class="border-r border-gray-400 bg-cyan-400"></div>
              <% 4.times do |i| %>
                <div class="<%= i < 3 ? 'border-r border-gray-400' : '' %>"></div>
              <% end %>
            </div>
            <%= render 'shared/frazione', num: nil, den: nil, num_answer: "1", den_answer: "5" %>
          </div>

          <!-- Segmento 2: diviso in 7 -->
          <div class="flex items-center gap-4">
            <div class="flex-1 max-w-xs h-6 border-2 border-gray-400 grid grid-cols-7">
              <% 7.times do |i| %>
                <div class="<%= i < 6 ? 'border-r border-gray-400' : '' %> <%= i == 2 ? 'bg-cyan-400' : '' %>"></div>
              <% end %>
            </div>
            <%= render 'shared/frazione', num: nil, den: nil, num_answer: "1", den_answer: "7" %>
          </div>

          <!-- Segmento 3: diviso in 10 -->
          <div class="flex items-center gap-4">
            <div class="flex-1 max-w-xs h-6 border-2 border-gray-400 grid grid-cols-10">
              <% 10.times do |i| %>
                <div class="<%= i < 9 ? 'border-r border-gray-400' : '' %> <%= i == 5 ? 'bg-cyan-400' : '' %>"></div>
              <% end %>
            </div>
            <%= render 'shared/frazione', num: nil, den: nil, num_answer: "1", den_answer: "10" %>
          </div>

          <!-- Segmento 4: diviso in 4 -->
          <div class="flex items-center gap-4">
            <div class="flex-1 max-w-xs h-6 border-2 border-gray-400 grid grid-cols-4">
              <% 4.times do |i| %>
                <div class="<%= i < 3 ? 'border-r border-gray-400' : '' %> <%= i == 0 ? 'bg-cyan-400' : '' %>"></div>
              <% end %>
            </div>
            <%= render 'shared/frazione', num: nil, den: nil, num_answer: "1", den_answer: "4" %>
          </div>
        </div>
      </div>

      <!-- Esercizio 3 -->
      <div>
        <p class="font-bold text-gray-700 mb-4">
          <%= numero_esercizio_badge(3) %>
          Scrivi l'unità frazionaria che rappresenta la parte colorata di ogni gruppo di oggetti.
        </p>

        <div class="grid grid-cols-2 md:grid-cols-4 gap-4">
          <!-- Gruppo 1: 4 palloni, 1 colorato -->
          <div class="flex flex-col items-center gap-2">
            <div class="flex gap-1">
              <div class="w-8 h-8 rounded-full bg-cyan-400 border-2 border-cyan-600"></div>
              <div class="w-8 h-8 rounded-full bg-gray-200 border-2 border-gray-400"></div>
              <div class="w-8 h-8 rounded-full bg-gray-200 border-2 border-gray-400"></div>
              <div class="w-8 h-8 rounded-full bg-gray-200 border-2 border-gray-400"></div>
            </div>
            <%= render 'shared/frazione', num: nil, den: nil, num_answer: "1", den_answer: "4" %>
          </div>

          <!-- Gruppo 2: 4 quadrati, 1 colorato -->
          <div class="flex flex-col items-center gap-2">
            <div class="grid grid-cols-2 gap-1">
              <div class="w-8 h-8 bg-cyan-400 border-2 border-cyan-600"></div>
              <div class="w-8 h-8 bg-gray-200 border-2 border-gray-400"></div>
              <div class="w-8 h-8 bg-gray-200 border-2 border-gray-400"></div>
              <div class="w-8 h-8 bg-gray-200 border-2 border-gray-400"></div>
            </div>
            <%= render 'shared/frazione', num: nil, den: nil, num_answer: "1", den_answer: "4" %>
          </div>

          <!-- Gruppo 3: 6 cerchi, 2 colorati (1 unità = 2) -->
          <div class="flex flex-col items-center gap-2">
            <div class="grid grid-cols-3 gap-1">
              <div class="w-6 h-6 rounded-full bg-cyan-400 border-2 border-cyan-600"></div>
              <div class="w-6 h-6 rounded-full bg-cyan-400 border-2 border-cyan-600"></div>
              <div class="w-6 h-6 rounded-full bg-gray-200 border-2 border-gray-400"></div>
              <div class="w-6 h-6 rounded-full bg-gray-200 border-2 border-gray-400"></div>
              <div class="w-6 h-6 rounded-full bg-gray-200 border-2 border-gray-400"></div>
              <div class="w-6 h-6 rounded-full bg-gray-200 border-2 border-gray-400"></div>
            </div>
            <%= render 'shared/frazione', num: nil, den: nil, num_answer: "1", den_answer: "3" %>
          </div>

          <!-- Gruppo 4: 6 ovali, 2 colorati -->
          <div class="flex flex-col items-center gap-2">
            <div class="grid grid-cols-3 gap-1">
              <div class="w-6 h-4 rounded-full bg-blue-400 border-2 border-blue-600"></div>
              <div class="w-6 h-4 rounded-full bg-blue-400 border-2 border-blue-600"></div>
              <div class="w-6 h-4 rounded-full bg-gray-200 border-2 border-gray-400"></div>
              <div class="w-6 h-4 rounded-full bg-gray-200 border-2 border-gray-400"></div>
              <div class="w-6 h-4 rounded-full bg-gray-200 border-2 border-gray-400"></div>
              <div class="w-6 h-4 rounded-full bg-gray-200 border-2 border-gray-400"></div>
            </div>
            <%= render 'shared/frazione', num: nil, den: nil, num_answer: "1", den_answer: "3" %>
          </div>
        </div>
      </div>
    </div>

    <%= render 'shared/quaderno_link', pagine: [201] %>

    <%= render 'shared/exercise_controls' %>
  </div>
</div>
