<% content_for :titolo, "#{@pagina.titolo} - #{@pagina.numero}" %>

<div class="max-w-7xl mx-auto p-3 md:p-6 bg-white font-mono text-base lg:text-lg xl:text-xl"
     data-controller="exercise-checker fill-blanks auto-advance page-viewer text-toggle font-controls"
     data-page-viewer-image-url-value="<%= asset_path('bus3_mat/p071/page.png') %>"
     data-text-toggle-target="content"
     data-font-controls-target="content">

  <!-- Header -->
  <%= render 'shared/page_header', pagina: @pagina %>

  <!-- Introduzione -->
  <div class="bg-[#C7EAFB] p-4 md:p-6 -ml-3 md:-ml-0 -mr-3 md:mr-0 mb-8">
    <p class="text-gray-700 font-bold">
      In alcuni problemi puoi trovare <span class="text-cyan-600 font-bold">più domande</span>. Ricorda di procedere con ordine perché, a volte, il <span class="text-cyan-600 font-bold">risultato della prima operazione</span> ti servirà per calcolare la <span class="text-cyan-600 font-bold">seconda operazione</span>.
    </p>
  </div>

  <!-- Esercizio 1 -->
  <div class="p-4 md:p-6 mb-8" data-controller="word-highlighter" data-word-highlighter-multi-color-value="true">
    <div class="flex items-center gap-3 mb-6">
      <div class="bg-red-500 text-white rounded-full w-8 h-8 flex items-center justify-center font-bold flex-shrink-0">
        1
      </div>
      <p class="text-gray-700"><strong>Leggi con attenzione. Colora di
        <span class="w-5 h-5 bg-blue-300 rounded inline-block align-middle cursor-pointer ring-2 ring-transparent hover:ring-blue-500"
              data-word-highlighter-target="colorBox"
              data-color="blue"
              data-action="click->word-highlighter#selectColor"></span>
        <span class="text-blue-500">blu la prima domanda</span> e di
        <span class="w-5 h-5 bg-pink-300 rounded inline-block align-middle cursor-pointer ring-2 ring-transparent hover:ring-pink-500"
              data-word-highlighter-target="colorBox"
              data-color="pink"
              data-action="click->word-highlighter#selectColor"></span>
        <span class="text-pink-500">rosa la seconda domanda</span>. Poi completa.</strong></p>
    </div>

    <div class="p-4 bg-gray-50 rounded mb-6 text-gray-700 cursor-pointer">
      <p><span data-word-highlighter-target="word" data-correct="" data-action="click->word-highlighter#toggleHighlight">Un fruttivendolo ha comprato 240 fragole, ma si accorge che 24 sono troppo mature e le usa per fare la marmellata.</span> <span data-word-highlighter-target="word" data-correct="blue" data-action="click->word-highlighter#toggleHighlight">Quante fragole restano da vendere?</span></p>
      <p class="mt-2"><span data-word-highlighter-target="word" data-correct="" data-action="click->word-highlighter#toggleHighlight">Distribuisce le fragole da vendere in parti uguali in 9 cestini.</span> <span data-word-highlighter-target="word" data-correct="pink" data-action="click->word-highlighter#toggleHighlight">Quante fragole mette in ogni cestino?</span></p>
    </div>

    <div class="space-y-6 text-gray-700">
      <div class="p-4 bg-gray-50 rounded">
        <p class="font-bold mb-2">Prima domanda:</p>
        <p class="mb-3">
          Quante
          <input type="text" class="w-48 px-2 py-1 border-b-2 border-dotted border-gray-400 font-bold bg-white"
                 placeholder="fragole restano da vendere">
          ?
        </p>
        <p class="font-bold mb-2">Prima operazione:</p>
        <p>
          <input type="text" data-fill-blanks-target="input" data-correct-answer="240"
                 class="w-16 px-2 py-1 border-b-2 border-dotted border-gray-400 text-center font-bold bg-white"
                 maxlength="4" inputmode="numeric">
          <input type="text" data-fill-blanks-target="input" data-correct-answer="-"
                 class="w-12 px-2 py-1 border-b-2 border-dotted border-gray-400 text-center font-bold bg-white"
                 maxlength="1">
          <input type="text" data-fill-blanks-target="input" data-correct-answer="24"
                 class="w-16 px-2 py-1 border-b-2 border-dotted border-gray-400 text-center font-bold bg-white"
                 maxlength="3" inputmode="numeric">
          =
          <input type="text" data-fill-blanks-target="input" data-correct-answer="216"
                 class="w-16 px-2 py-1 border-b-2 border-dotted border-gray-400 text-center font-bold bg-white"
                 maxlength="4" inputmode="numeric">
          fragole che può vendere.
        </p>
      </div>

      <div class="p-4 bg-gray-50 rounded">
        <p class="font-bold mb-2">Seconda domanda:</p>
        <p class="mb-3">
          Quante
          <input type="text" class="w-48 px-2 py-1 border-b-2 border-dotted border-gray-400 font-bold bg-white"
                 placeholder="fragole in ogni cestino">
          ?
        </p>
        <p class="font-bold mb-2">Seconda operazione:</p>
        <p>
          <input type="text" data-fill-blanks-target="input" data-correct-answer="216"
                 class="w-16 px-2 py-1 border-b-2 border-dotted border-gray-400 text-center font-bold bg-white"
                 maxlength="4" inputmode="numeric">
          <input type="text" data-fill-blanks-target="input" data-correct-answer=":"
                 class="w-12 px-2 py-1 border-b-2 border-dotted border-gray-400 text-center font-bold bg-white"
                 maxlength="1">
          <input type="text" data-fill-blanks-target="input" data-correct-answer="9"
                 class="w-16 px-2 py-1 border-b-2 border-dotted border-gray-400 text-center font-bold bg-white"
                 maxlength="2" inputmode="numeric">
          =
          <input type="text" data-fill-blanks-target="input" data-correct-answer="24"
                 class="w-16 px-2 py-1 border-b-2 border-dotted border-gray-400 text-center font-bold bg-white"
                 maxlength="3" inputmode="numeric">
          fragole in ciascun cestino.
        </p>
      </div>
    </div>
  </div>

  <!-- Esercizio 2 -->
  <div class="p-4 md:p-6 mb-8">
    <div class="flex items-center gap-3 mb-6">
      <div class="bg-red-500 text-white rounded-full w-8 h-8 flex items-center justify-center font-bold flex-shrink-0">
        2
      </div>
      <p class="text-gray-700"><strong>Risolvi sul quaderno.</strong></p>
    </div>

    <div class="space-y-4 text-gray-700">
      <div class="p-4 bg-gray-50 rounded">
        <p class="font-bold mb-2">a.</p>
        <p>Per una festa il cuoco prepara 80 pizzette al pomodoro, 59 pizzette al formaggio e 96 pizzette al prosciutto. Quante pizzette prepara? Al termine della festa rimangono 34 pizzette. Quante pizzette sono state mangiate?</p>
      </div>

      <div class="p-4 bg-gray-50 rounded">
        <p class="font-bold mb-2">b.</p>
        <p>Per arrivare nel suo appartamento Luisa deve salire 7 rampe di scale di 9 gradini ciascuna. Quanti sono i gradini in tutto? Se Luisa ha già salito 48 gradini, quanti ne deve ancora salire?</p>
      </div>

      <div class="p-4 bg-gray-50 rounded">
        <p class="font-bold mb-2">c.</p>
        <p>Zia Rita compra per ciascuno dei suoi 3 nipoti un paio di guanti di lana che costano 12 euro l'uno. Quanto spende? Paga alla cassa con una banconota da 50 euro. Quanto riceve di resto?</p>
      </div>

      <div class="p-4 bg-gray-50 rounded">
        <p class="font-bold mb-2">d.</p>
        <p>Sofia acquista 8 confezioni da 16 biscotti ciascuna. Quanti biscotti acquista? Li dispone in sacchettini da 4 biscotti ciascuno per regalarli ai suoi amici. Quanti sacchettini servono a Sofia?</p>
      </div>
    </div>
  </div>

  <!-- Quaderno link -->
  <div class="p-4 mb-8 text-right">
    <span class="text-gray-600">Quaderno →</span> <%= link_to "pp. 157-158", pagina_path("bus3_mat_p157"), class: "text-cyan-600 font-bold hover:underline" %>
  </div>

  <!-- Footer con controlli -->
  <%= render 'shared/exercise_controls', color: 'blue' %>
</div>
