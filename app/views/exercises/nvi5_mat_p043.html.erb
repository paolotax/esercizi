<div class="max-w-6xl mx-auto bg-white p-3 md:p-6"
     data-controller="exercise-checker text-toggle font-controls flower-matcher"
     data-text-toggle-target="content"
     data-font-controls-target="content">

  <%= render 'shared/page_header', pagina: @pagina %>

  <div class="space-y-6">
    <!-- ESERCIZI -->
    <div class="p-4 md:p-6 bg-orange-100 rounded-lg space-y-6">
      <!-- Esercizio 10 -->
      <div>
        <p class="font-bold text-gray-700 mb-4">
          <%= numero_esercizio_badge(10) %>
          Collega ogni operazione al suo risultato.
        </p>
        <div class="relative">
          <svg class="absolute top-0 left-0 w-full h-full pointer-events-none z-30" data-flower-matcher-target="canvas"></svg>
          <div class="flex flex-wrap justify-center gap-2 mb-6 relative z-20">
            <% [
              { id: "op-1", pair: "p959", label: "8,6 + 0,99 =" },
              { id: "op-2", pair: "p761", label: "8,6 – 0,99 =" },
              { id: "op-3", pair: "p086", label: "8,6 × 0,1 =" },
              { id: "op-4", pair: "p86", label: "8,6 : 0,1 =" },
              { id: "op-5", pair: "p43", label: "8,6 × 0,5 =" },
              { id: "op-6", pair: "p215", label: "8,6 × 0,25 =" }
            ].each do |item| %>
              <div class="px-3 py-2 bg-white border-2 border-gray-400 text-center cursor-pointer hover:bg-gray-100 transition"
                   data-action="click->flower-matcher#selectFlower"
                   data-flower-matcher-target="flower"
                   data-flower-id="<%= item[:id] %>"
                   data-pair="<%= item[:pair] %>"><%= item[:label] %></div>
            <% end %>
          </div>
          <div class="flex flex-wrap justify-center gap-2 relative z-20">
            <% [
              { id: "res-1", pair: "p761", label: "7,61" },
              { id: "res-2", pair: "p86", label: "86" },
              { id: "res-3", pair: "p959", label: "9,59" },
              { id: "res-4", pair: "p215", label: "2,15" },
              { id: "res-5", pair: "p086", label: "0,86" },
              { id: "res-6", pair: "p43", label: "4,3" }
            ].each do |item| %>
              <div class="px-4 py-2 bg-white border-2 border-gray-400 text-center cursor-pointer hover:bg-gray-100 transition"
                   data-action="click->flower-matcher#selectFlower"
                   data-flower-matcher-target="flower"
                   data-flower-id="<%= item[:id] %>"
                   data-pair="<%= item[:pair] %>"><%= item[:label] %></div>
            <% end %>
          </div>
          <div class="mt-4 flex gap-3 items-center">
            <button class="bg-blue-500 hover:bg-blue-600 text-white font-bold rounded-full w-8 h-8 transition flex items-center justify-center"
                    data-action="click->flower-matcher#reset" title="Ricomincia">
              <svg xmlns="http://www.w3.org/2000/svg" class="w-4 h-4" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15" />
              </svg>
            </button>
            <button class="bg-green-500 hover:bg-green-600 text-white font-bold rounded-full w-8 h-8 transition flex items-center justify-center"
                    data-action="click->flower-matcher#showSolutions" title="Soluzioni">
              <svg xmlns="http://www.w3.org/2000/svg" class="w-4 h-4" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 12a3 3 0 11-6 0 3 3 0 016 0z" />
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z" />
              </svg>
            </button>
          </div>
        </div>
      </div>

      <!-- Esercizio 11 -->
      <div>
        <p class="font-bold text-gray-700 mb-4">
          <%= numero_esercizio_badge(11) %>
          Completa le tabelle.
        </p>
        <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
          <div class="overflow-x-auto">
            <table class="w-full border-collapse bg-white">
              <thead>
                <tr class="bg-custom-pink text-white">
                  <th class="border border-gray-400 p-2"></th>
                  <th class="border border-gray-400 p-2 font-bold">× 10</th>
                  <th class="border border-gray-400 p-2 font-bold">× 100</th>
                  <th class="border border-gray-400 p-2 font-bold">× <span class="whitespace-nowrap">1 000</span></th>
                </tr>
              </thead>
              <tbody>
                <tr>
                  <td class="border border-gray-400 p-2 font-bold text-center">3,15</td>
                  <td class="border border-gray-400 p-1"><input type="text" data-correct-answer="31,5" class="w-full px-2 py-1 border-b-2 border-dotted text-center"></td>
                  <td class="border border-gray-400 p-1"><input type="text" data-correct-answer="315" class="w-full px-2 py-1 border-b-2 border-dotted text-center"></td>
                  <td class="border border-gray-400 p-1"><input type="text" data-correct-answer="3150" class="w-full px-2 py-1 border-b-2 border-dotted text-center"></td>
                </tr>
                <tr>
                  <td class="border border-gray-400 p-2 font-bold text-center">0,36</td>
                  <td class="border border-gray-400 p-1"><input type="text" data-correct-answer="3,6" class="w-full px-2 py-1 border-b-2 border-dotted text-center"></td>
                  <td class="border border-gray-400 p-1"><input type="text" data-correct-answer="36" class="w-full px-2 py-1 border-b-2 border-dotted text-center"></td>
                  <td class="border border-gray-400 p-1"><input type="text" data-correct-answer="360" class="w-full px-2 py-1 border-b-2 border-dotted text-center"></td>
                </tr>
                <tr>
                  <td class="border border-gray-400 p-2 font-bold text-center">28</td>
                  <td class="border border-gray-400 p-1"><input type="text" data-correct-answer="280" class="w-full px-2 py-1 border-b-2 border-dotted text-center"></td>
                  <td class="border border-gray-400 p-1"><input type="text" data-correct-answer="2800" class="w-full px-2 py-1 border-b-2 border-dotted text-center"></td>
                  <td class="border border-gray-400 p-1"><input type="text" data-correct-answer="28000" class="w-full px-2 py-1 border-b-2 border-dotted text-center"></td>
                </tr>
                <tr>
                  <td class="border border-gray-400 p-2 font-bold text-center">0,07</td>
                  <td class="border border-gray-400 p-1"><input type="text" data-correct-answer="0,7" class="w-full px-2 py-1 border-b-2 border-dotted text-center"></td>
                  <td class="border border-gray-400 p-1"><input type="text" data-correct-answer="7" class="w-full px-2 py-1 border-b-2 border-dotted text-center"></td>
                  <td class="border border-gray-400 p-1"><input type="text" data-correct-answer="70" class="w-full px-2 py-1 border-b-2 border-dotted text-center"></td>
                </tr>
              </tbody>
            </table>
          </div>
          <div class="overflow-x-auto">
            <table class="w-full border-collapse bg-white">
              <thead>
                <tr class="bg-green-500 text-white">
                  <th class="border border-gray-400 p-2"></th>
                  <th class="border border-gray-400 p-2 font-bold">: 10</th>
                  <th class="border border-gray-400 p-2 font-bold">: 100</th>
                  <th class="border border-gray-400 p-2 font-bold">: <span class="whitespace-nowrap">1 000</span></th>
                </tr>
              </thead>
              <tbody>
                <tr>
                  <td class="border border-gray-400 p-2 font-bold text-center">874,5</td>
                  <td class="border border-gray-400 p-1"><input type="text" data-correct-answer="87,45" class="w-full px-2 py-1 border-b-2 border-dotted text-center"></td>
                  <td class="border border-gray-400 p-1"><input type="text" data-correct-answer="8,745" class="w-full px-2 py-1 border-b-2 border-dotted text-center"></td>
                  <td class="border border-gray-400 p-1"><input type="text" data-correct-answer="0,8745" class="w-full px-2 py-1 border-b-2 border-dotted text-center"></td>
                </tr>
                <tr>
                  <td class="border border-gray-400 p-2 font-bold text-center">32</td>
                  <td class="border border-gray-400 p-1"><input type="text" data-correct-answer="3,2" class="w-full px-2 py-1 border-b-2 border-dotted text-center"></td>
                  <td class="border border-gray-400 p-1"><input type="text" data-correct-answer="0,32" class="w-full px-2 py-1 border-b-2 border-dotted text-center"></td>
                  <td class="border border-gray-400 p-1"><input type="text" data-correct-answer="0,032" class="w-full px-2 py-1 border-b-2 border-dotted text-center"></td>
                </tr>
                <tr>
                  <td class="border border-gray-400 p-2 font-bold text-center">96,8</td>
                  <td class="border border-gray-400 p-1"><input type="text" data-correct-answer="9,68" class="w-full px-2 py-1 border-b-2 border-dotted text-center"></td>
                  <td class="border border-gray-400 p-1"><input type="text" data-correct-answer="0,968" class="w-full px-2 py-1 border-b-2 border-dotted text-center"></td>
                  <td class="border border-gray-400 p-1"><input type="text" data-correct-answer="0,0968" class="w-full px-2 py-1 border-b-2 border-dotted text-center"></td>
                </tr>
                <tr>
                  <td class="border border-gray-400 p-2 font-bold text-center"><span class="whitespace-nowrap">15 700</span></td>
                  <td class="border border-gray-400 p-1"><input type="text" data-correct-answer="1570" class="w-full px-2 py-1 border-b-2 border-dotted text-center"></td>
                  <td class="border border-gray-400 p-1"><input type="text" data-correct-answer="157" class="w-full px-2 py-1 border-b-2 border-dotted text-center"></td>
                  <td class="border border-gray-400 p-1"><input type="text" data-correct-answer="15,7" class="w-full px-2 py-1 border-b-2 border-dotted text-center"></td>
                </tr>
              </tbody>
            </table>
          </div>
        </div>
      </div>

      <!-- RISOLVI I PROBLEMI -->
      <div>
        <h2 class="font-bold text-custom-pink italic mb-4">RISOLVI I PROBLEMI</h2>
        <div class="grid grid-cols-1 md:grid-cols-2 gap-x-6 gap-y-4">
          <div>
            <p class="text-gray-800 mb-2">
              <%= numero_esercizio_badge(12) %>
              Al supermercato Tommaso acquista una confezione di formaggio a 5,99 euro, una di prosciutto a 7,50 euro e una confezione di salmone a 6,65 euro. Se paga con una banconota da 50 euro, quanto riceve di resto?
            </p>
            <div class="flex items-center gap-2">
              <span class="shrink-0">Riceve di resto</span>
              <input type="text" data-correct-answer="29,86" class="min-w-0 flex-1 border-b-2 border-dotted border-gray-400 text-center font-bold bg-transparent">
              <span class="shrink-0">euro.</span>
            </div>
          </div>
          <div>
            <p class="text-gray-800 mb-2">
              <%= numero_esercizio_badge(17) %>
              In un'azienda che produce marmellate devono essere confezionati 432 barattoli. 240 barattoli vengono messi in scatole da 16 barattoli ognuna, gli altri vengono messi in scatole che ne contengono 8. Quante scatole servono in tutto?
            </p>
            <div class="flex items-center gap-2">
              <span class="shrink-0">Servono in tutto</span>
              <input type="text" data-correct-answer="39" class="min-w-0 flex-1 border-b-2 border-dotted border-gray-400 text-center font-bold bg-transparent">
              <span class="shrink-0">scatole.</span>
            </div>
          </div>
          <div>
            <p class="text-gray-800 mb-2">
              <%= numero_esercizio_badge(13) %>
              In una pasticceria vengono confezionati <span class="whitespace-nowrap">2 925</span> biscotti in sacchetti, ognuno dei quali ne contiene 45. Quanti sacchetti vengono confezionati? Ogni sacchetto viene venduto a 7,40 euro. Quanto incassa la pasticceria?
            </p>
            <div class="space-y-2">
              <div class="flex items-center gap-2">
                <span class="shrink-0">Sacchetti confezionati:</span>
                <input type="text" data-correct-answer="65" class="min-w-0 flex-1 border-b-2 border-dotted border-gray-400 text-center font-bold bg-transparent">
              </div>
              <div class="flex items-center gap-2">
                <span class="shrink-0">Incasso:</span>
                <input type="text" data-correct-answer="481" class="min-w-0 flex-1 border-b-2 border-dotted border-gray-400 text-center font-bold bg-transparent">
                <span class="shrink-0">euro.</span>
              </div>
            </div>
          </div>
          <div>
            <p class="text-gray-800 mb-2">
              <%= numero_esercizio_badge(18) %>
              In una fabbrica in un anno sono stati prodotti <span class="whitespace-nowrap">522 000</span> bottoni. Il primo quadrimestre se ne vendono <span class="whitespace-nowrap">132 599</span>, il secondo <span class="whitespace-nowrap">19 050</span> più del primo e il terzo quadrimestre <span class="whitespace-nowrap">147 280</span>. Quanti bottoni non sono stati venduti?
            </p>
            <div class="flex items-center gap-2">
              <span class="shrink-0">Non venduti:</span>
              <input type="text" data-correct-answer="90472" class="min-w-0 flex-1 border-b-2 border-dotted border-gray-400 text-center font-bold bg-transparent">
              <span class="shrink-0">bottoni.</span>
            </div>
          </div>
          <div>
            <p class="text-gray-800 mb-2">
              <%= numero_esercizio_badge(14) %>
              Una fioraia compra 15 dozzine di rose rosse e spende in tutto 216 euro. Quanto ha pagato ogni rosa?
            </p>
            <div class="flex items-center gap-2">
              <span class="shrink-0">Ogni rosa costa</span>
              <input type="text" data-correct-answer="1,20" class="min-w-0 flex-1 border-b-2 border-dotted border-gray-400 text-center font-bold bg-transparent">
              <span class="shrink-0">euro.</span>
            </div>
          </div>
          <!-- AllenaMente -->
          <div class="p-4 bg-yellow-100 rounded-2xl row-span-3">
            <p class="font-bold text-red-600 mb-3 italic">AllenaMente!</p>
            <p class="text-gray-800 mb-4">
              Anna, Paolo e Sara collezionano bandiere del mondo. Anna ha 20 bandiere, Paolo ne ha 6 meno di Sara, che ne ha 3 più di Anna. Quante bandiere ha ciascuno di loro?
            </p>
            <div class="space-y-2">
              <div class="flex items-center gap-2">
                <span class="shrink-0">Anna ha</span>
                <input type="text" data-correct-answer="20" class="min-w-0 flex-1 border-b-2 border-dotted border-gray-400 text-center font-bold bg-transparent">
                <span class="shrink-0">bandiere.</span>
              </div>
              <div class="flex items-center gap-2">
                <span class="shrink-0">Paolo ha</span>
                <input type="text" data-correct-answer="17" class="min-w-0 flex-1 border-b-2 border-dotted border-gray-400 text-center font-bold bg-transparent">
                <span class="shrink-0">bandiere.</span>
              </div>
              <div class="flex items-center gap-2">
                <span class="shrink-0">Sara ha</span>
                <input type="text" data-correct-answer="23" class="min-w-0 flex-1 border-b-2 border-dotted border-gray-400 text-center font-bold bg-transparent">
                <span class="shrink-0">bandiere.</span>
              </div>
            </div>
          </div>
          <div>
            <p class="text-gray-800 mb-2">
              <%= numero_esercizio_badge(15) %>
              Il proprietario di un caseificio deve travasare 285 litri di latte in bottiglie che contengono 0,75 litri ciascuna. Quante bottiglie potrà riempire?
            </p>
            <div class="flex items-center gap-2">
              <span class="shrink-0">Bottiglie:</span>
              <input type="text" data-correct-answer="380" class="min-w-0 flex-1 border-b-2 border-dotted border-gray-400 text-center font-bold bg-transparent">
            </div>
          </div>
          <div>
            <p class="text-gray-800 mb-2">
              <%= numero_esercizio_badge(16) %>
              In un anno Francesca ha speso 726 euro per la luce e 581,40 euro per il gas. Quanto ha speso in media ogni mese?
            </p>
            <div class="flex items-center gap-2">
              <span class="shrink-0">Spesa media mensile:</span>
              <input type="text" data-correct-answer="108,95" class="min-w-0 flex-1 border-b-2 border-dotted border-gray-400 text-center font-bold bg-transparent">
              <span class="shrink-0">euro.</span>
            </div>
          </div>
        </div>
      </div>
    </div>

    <%= render 'shared/exercise_controls' %>
  </div>
</div>
