<div class="max-w-6xl mx-auto bg-white p-3 md:p-6"
     data-controller="exercise-checker text-toggle font-controls"
     data-text-toggle-target="content"
     data-font-controls-target="content">

  <%= render 'shared/page_header', pagina: @pagina %>

  <div class="space-y-6">
    <!-- Box introduttivo: Proprietà commutativa e associativa -->
    <div class="p-4 bg-custom-blue-light rounded-2xl">
      <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
        <!-- Proprietà commutativa -->
        <div class="text-center">
          <p class="font-bold text-gray-800 mb-2">Proprietà commutativa</p>
          <%= image_tag "nvi5_mat/p185/p185_01.jpg", alt: "Proprietà commutativa", class: "mx-auto max-w-full h-auto" %>
        </div>

        <!-- Proprietà associativa -->
        <div class="text-center">
          <p class="font-bold text-gray-800 mb-2">Proprietà associativa</p>
          <%= image_tag "nvi5_mat/p185/p185_02.jpg", alt: "Proprietà associativa", class: "mx-auto max-w-full h-auto" %>
        </div>
      </div>
    </div>

    <!-- Esercizio 1: IMPARARE TUTTI - Scomponi e applica proprietà -->
    <div class="p-4 bg-white rounded-2xl border-3 border-yellow-400">
      <p class="font-bold text-gray-700 mb-4">
        <%= imparare_tutti_badge(1) %>
        Scomponi gli addendi in maniera opportuna e poi applica le proprietà commutativa e associativa per semplificare i calcoli. Segui l'esempio.
      </p>

      <div class="space-y-4">
        <!-- Esempio -->
        <div class="p-3 bg-custom-blue-light rounded">
          <p class="text-gray-700"><span class="font-bold">346 + 800 + 54 = 300 + 46 + 800 + 54 = (300 + 800) + (46 + 54) = <span class="whitespace-nowrap">1 100</span> + 100 = <span class="whitespace-nowrap">1 200</span></span></p>
        </div>

        <div class="space-y-3">
          <div class="flex items-center gap-2 flex-wrap">
            <span class="text-gray-700 shrink-0">233 + 680 + 167 =</span>
            <input type="text" data-correct-answer="200 + 33 + 680 + 167 = (200 + 680) + (33 + 167) = 880 + 200 = 1080" class="min-w-0 flex-1 border-b-2 border-dotted border-gray-400 text-center font-bold bg-transparent">
          </div>
          <div class="flex items-center gap-2 flex-wrap">
            <span class="text-gray-700 shrink-0">439 + 500 + 261 =</span>
            <input type="text" data-correct-answer="400 + 39 + 500 + 261 = (400 + 500) + (39 + 261) = 900 + 300 = 1200" class="min-w-0 flex-1 border-b-2 border-dotted border-gray-400 text-center font-bold bg-transparent">
          </div>
          <div class="flex items-center gap-2 flex-wrap">
            <span class="text-gray-700 shrink-0">361 + <span class="whitespace-nowrap">1 039</span> + <span class="whitespace-nowrap">1 120</span> =</span>
            <input type="text" data-correct-answer="360 + 1 + 1039 + 1120 = (360 + 1120) + (1 + 1039) = 1480 + 1040 = 2520" class="min-w-0 flex-1 border-b-2 border-dotted border-gray-400 text-center font-bold bg-transparent">
          </div>
        </div>
      </div>
    </div>

    <!-- Esercizi 2 e 3 in due colonne -->
    <div class="grid grid-cols-1 md:grid-cols-2 gap-6 md:divide-x-2 md:divide-cyan-300">
      <!-- Esercizio 2: Proprietà commutativa -->
      <div class="md:pr-4">
        <p class="font-bold text-gray-700 mb-4">
          <%= numero_esercizio_badge(2) %>
          Applica la proprietà commutativa e calcola.
        </p>

        <div class="space-y-3">
          <div class="flex items-center gap-2">
            <span class="text-gray-700 shrink-0 whitespace-nowrap">1 725 + 1 500 =</span>
            <input type="text" data-correct-answer="3225" class="min-w-0 flex-1 border-b-2 border-dotted border-gray-400 text-center font-bold bg-transparent">
          </div>
          <div class="flex items-center gap-2">
            <span class="text-gray-700 shrink-0 whitespace-nowrap">1 200 + 530 =</span>
            <input type="text" data-correct-answer="1730" class="min-w-0 flex-1 border-b-2 border-dotted border-gray-400 text-center font-bold bg-transparent">
          </div>
          <div class="flex items-center gap-2">
            <span class="text-gray-700 shrink-0 whitespace-nowrap">6 023 + 1 320 =</span>
            <input type="text" data-correct-answer="7343" class="min-w-0 flex-1 border-b-2 border-dotted border-gray-400 text-center font-bold bg-transparent">
          </div>
          <div class="flex items-center gap-2">
            <span class="text-gray-700 shrink-0">26,24 + 12,38 =</span>
            <input type="text" data-correct-answer="38,62" class="min-w-0 flex-1 border-b-2 border-dotted border-gray-400 text-center font-bold bg-transparent">
          </div>
        </div>
      </div>

      <!-- Esercizio 3: Proprietà associativa -->
      <div class="md:pl-4">
        <p class="font-bold text-gray-700 mb-4">
          <%= numero_esercizio_badge(3) %>
          Applica la proprietà associativa e calcola.
        </p>

        <div class="space-y-3">
          <div class="flex items-center gap-2">
            <span class="text-gray-700 shrink-0">160 + 340 + 450 =</span>
            <input type="text" data-correct-answer="950" class="min-w-0 flex-1 border-b-2 border-dotted border-gray-400 text-center font-bold bg-transparent">
          </div>
          <div class="flex items-center gap-2">
            <span class="text-gray-700 shrink-0">230 + 70 + 750 =</span>
            <input type="text" data-correct-answer="1050" class="min-w-0 flex-1 border-b-2 border-dotted border-gray-400 text-center font-bold bg-transparent">
          </div>
          <div class="flex items-center gap-2">
            <span class="text-gray-700 shrink-0 whitespace-nowrap">4 900 + 5 100 + 200 =</span>
            <input type="text" data-correct-answer="10200" class="min-w-0 flex-1 border-b-2 border-dotted border-gray-400 text-center font-bold bg-transparent">
          </div>
          <div class="flex items-center gap-2">
            <span class="text-gray-700 shrink-0 whitespace-nowrap">32,5 + 27,5 + 1 500 =</span>
            <input type="text" data-correct-answer="1560" class="min-w-0 flex-1 border-b-2 border-dotted border-gray-400 text-center font-bold bg-transparent">
          </div>
        </div>
      </div>
    </div>

    <!-- Esercizio 4: Applica proprietà opportune -->
    <div>
      <p class="font-bold text-gray-700 mb-4">
        <%= numero_esercizio_badge(4) %>
        Esegui le addizioni applicando le proprietà opportune, come nell'esempio.
      </p>

      <!-- Esempio -->
      <div class="p-3 bg-custom-blue-light rounded mb-4">
        <div class="flex items-center gap-2 flex-wrap">
          <%= image_tag "nvi5_mat/p185/p185_03.jpg", alt: "14 + 61 + 6 + 19", class: "h-6 shrink-0" %>
          <span class="text-gray-700 font-bold">= 14 + 6 + 61 + 19 = (14 + 6) + (61 + 19) = 20 + 80 = 100</span>
        </div>
      </div>

      <div class="space-y-3">
        <div class="flex items-center gap-2 flex-wrap">
          <span class="text-gray-700 shrink-0">7,3 + 112 + 2,7 + 18 =</span>
          <input type="text" data-correct-answer="140" class="min-w-0 flex-1 border-b-2 border-dotted border-gray-400 text-center font-bold bg-transparent">
        </div>
        <div class="flex items-center gap-2 flex-wrap">
          <span class="text-gray-700 shrink-0">110 + 240 + 90 + 460 =</span>
          <input type="text" data-correct-answer="900" class="min-w-0 flex-1 border-b-2 border-dotted border-gray-400 text-center font-bold bg-transparent">
        </div>
        <div class="flex items-center gap-2 flex-wrap">
          <span class="text-gray-700 shrink-0">11,5 + 22,3 + 3,5 + 32,7 =</span>
          <input type="text" data-correct-answer="70" class="min-w-0 flex-1 border-b-2 border-dotted border-gray-400 text-center font-bold bg-transparent">
        </div>
        <div class="flex items-center gap-2 flex-wrap">
          <span class="text-gray-700 shrink-0">349 + 208 + 312 + 101 =</span>
          <input type="text" data-correct-answer="970" class="min-w-0 flex-1 border-b-2 border-dotted border-gray-400 text-center font-bold bg-transparent">
        </div>
      </div>
    </div>

    <!-- Esercizio 5: Risultato e proprietà -->
    <div>
      <p class="font-bold text-gray-700 mb-4">
        <%= numero_esercizio_badge(5) %>
        Scrivi il risultato di ogni addizione e quale proprietà o quali proprietà sono state applicate.
      </p>

      <div class="space-y-4">
        <div class="flex items-center gap-4 flex-wrap">
          <span class="text-gray-700">850 + 24 + 50 + 16 = 900 + 40 =</span>
          <input type="text" data-correct-answer="940" class="w-24 border-b-2 border-dotted border-gray-400 text-center font-bold bg-transparent">
          <span class="text-gray-700 shrink-0">proprietà:</span>
          <input type="text" data-correct-answer="associativa" class="min-w-0 flex-1 border-b-2 border-dotted border-gray-400 text-center font-bold bg-transparent">
        </div>
        <div class="flex items-center gap-4 flex-wrap">
          <span class="text-gray-700">54,1 + 27,3 + 130,9 = 130,9 + 54,1 + 27,3 =</span>
          <input type="text" data-correct-answer="212,3" class="w-24 border-b-2 border-dotted border-gray-400 text-center font-bold bg-transparent">
          <span class="text-gray-700 shrink-0">proprietà:</span>
          <input type="text" data-correct-answer="commutativa" class="min-w-0 flex-1 border-b-2 border-dotted border-gray-400 text-center font-bold bg-transparent">
        </div>
        <div class="flex items-center gap-4 flex-wrap">
          <span class="text-gray-700 whitespace-nowrap">67 + 2 500 + 500 = 67 + 3 000 =</span>
          <input type="text" data-correct-answer="3067" class="w-24 border-b-2 border-dotted border-gray-400 text-center font-bold bg-transparent">
          <span class="text-gray-700 shrink-0">proprietà:</span>
          <input type="text" data-correct-answer="associativa" class="min-w-0 flex-1 border-b-2 border-dotted border-gray-400 text-center font-bold bg-transparent">
        </div>
      </div>
    </div>

    <!-- Esercizio 6: Addizioni sul quaderno -->
    <div>
      <p class="font-bold text-gray-700 mb-4">
        <%= numero_esercizio_badge(6) %>
        Esegui le addizioni sul quaderno e fai la prova.
      </p>

      <div class="grid grid-cols-1 md:grid-cols-3 gap-4">
        <div class="space-y-2">
          <p class="text-gray-700"><span class="whitespace-nowrap">253 670 + 73 518</span> =</p>
          <p class="text-gray-700"><span class="whitespace-nowrap">48,291 + 409,345</span> =</p>
          <p class="text-gray-700"><span class="whitespace-nowrap">4 583 + 85 149</span> =</p>
        </div>
        <div class="space-y-2">
          <p class="text-gray-700"><span class="whitespace-nowrap">208 951 + 6 797 259</span> =</p>
          <p class="text-gray-700"><span class="whitespace-nowrap">356,08 + 72,082</span> =</p>
          <p class="text-gray-700"><span class="whitespace-nowrap">56 450 + 40 997</span> =</p>
        </div>
      </div>
    </div>

    <%= render 'shared/exercise_controls' %>
  </div>
</div>
