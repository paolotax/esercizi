<div class="max-w-6xl mx-auto bg-white dark:bg-gray-900 p-3 md:p-6 text-black dark:text-white transition-colors duration-300"
     data-controller="exercise-checker text-toggle font-controls"
     data-text-toggle-target="content"
     data-font-controls-target="content">

  <%= render 'shared/page_header', pagina: @pagina %>

  <div class="space-y-6">
    <!-- Box informativo: Ricorda! -->
    <div class="p-4 md:p-6 bg-custom-blue dark:bg-cyan-900 rounded-2xl transition-colors duration-300">
      <div class="flex items-start gap-3 mb-4">
        <span class="text-pink-600 dark:text-pink-400 font-bold italic">Ricorda!</span>
      </div>
      <p class="text-gray-800 dark:text-gray-200 leading-relaxed mb-4">
        Le <span class="font-bold text-custom-sky">cifre</span> di un numero hanno un valore diverso in base al posto che occupano.
      </p>

      <!-- Tabella di riferimento -->
      <div class="overflow-x-auto">
        <table class="text-center border-collapse">
          <thead>
            <tr class="text-gray-800 dark:text-gray-200">
              <th class="py-3 px-2"></th>
              <th class="py-3 px-2 font-bold border-2 border-cyan-400 dark:border-cyan-600 bg-white dark:bg-gray-700">Centinaia<br>di migliaia<br><span class="text-custom-sky dark:text-cyan-400">hk</span></th>
              <th class="py-3 px-2 font-bold border-2 border-cyan-400 dark:border-cyan-600 bg-white dark:bg-gray-700">Decine<br>di migliaia<br><span class="text-custom-sky dark:text-cyan-400">dak</span></th>
              <th class="py-3 px-2 font-bold border-2 border-cyan-400 dark:border-cyan-600 bg-white dark:bg-gray-700">Migliaia<br><span class="text-custom-sky dark:text-cyan-400">uk</span></th>
              <th class="py-3 px-2 font-bold border-2 border-cyan-400 dark:border-cyan-600 bg-white dark:bg-gray-700">Centinaia<br><span class="text-green-600 dark:text-green-400">h</span></th>
              <th class="py-3 px-2 font-bold border-2 border-cyan-400 dark:border-cyan-600 bg-white dark:bg-gray-700">Decine<br><span class="text-red-600 dark:text-red-400">da</span></th>
              <th class="py-3 px-2 font-bold border-2 border-cyan-400 dark:border-cyan-600 bg-white dark:bg-gray-700">Unità<br><span class="text-custom-sky dark:text-cyan-400">u</span></th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td class="py-3 px-3 text-left font-semibold dark:text-gray-200">1 uk = 1 000 u</td>
              <td class="py-3 px-2 border-2 border-cyan-400 dark:border-cyan-600 bg-white dark:bg-gray-700"></td>
              <td class="py-3 px-2 border-2 border-cyan-400 dark:border-cyan-600 bg-white dark:bg-gray-700"></td>
              <td class="py-3 px-2 font-bold text-custom-sky dark:text-cyan-400 border-2 border-cyan-400 dark:border-cyan-600 bg-white dark:bg-gray-700">1</td>
              <td class="py-3 px-2 font-bold border-2 border-cyan-400 dark:border-cyan-600 bg-white dark:bg-gray-700 dark:text-gray-200">0</td>
              <td class="py-3 px-2 font-bold border-2 border-cyan-400 dark:border-cyan-600 bg-white dark:bg-gray-700 dark:text-gray-200">0</td>
              <td class="py-3 px-2 font-bold border-2 border-cyan-400 dark:border-cyan-600 bg-white dark:bg-gray-700 dark:text-gray-200">0</td>
            </tr>
            <tr>
              <td class="py-3 px-3 text-left font-semibold dark:text-gray-200">1 dak = 10 000 u</td>
              <td class="py-3 px-2 border-2 border-cyan-400 dark:border-cyan-600 bg-white dark:bg-gray-700"></td>
              <td class="py-3 px-2 font-bold text-custom-sky dark:text-cyan-400 border-2 border-cyan-400 dark:border-cyan-600 bg-white dark:bg-gray-700">1</td>
              <td class="py-3 px-2 font-bold border-2 border-cyan-400 dark:border-cyan-600 bg-white dark:bg-gray-700 dark:text-gray-200">0</td>
              <td class="py-3 px-2 font-bold border-2 border-cyan-400 dark:border-cyan-600 bg-white dark:bg-gray-700 dark:text-gray-200">0</td>
              <td class="py-3 px-2 font-bold border-2 border-cyan-400 dark:border-cyan-600 bg-white dark:bg-gray-700 dark:text-gray-200">0</td>
              <td class="py-3 px-2 font-bold border-2 border-cyan-400 dark:border-cyan-600 bg-white dark:bg-gray-700 dark:text-gray-200">0</td>
            </tr>
            <tr>
              <td class="py-3 px-3 text-left font-semibold dark:text-gray-200">1 hk = 100 000 u</td>
              <td class="py-3 px-2 font-bold text-custom-sky dark:text-cyan-400 border-2 border-cyan-400 dark:border-cyan-600 bg-white dark:bg-gray-700">1</td>
              <td class="py-3 px-2 font-bold border-2 border-cyan-400 dark:border-cyan-600 bg-white dark:bg-gray-700 dark:text-gray-200">0</td>
              <td class="py-3 px-2 font-bold border-2 border-cyan-400 dark:border-cyan-600 bg-white dark:bg-gray-700 dark:text-gray-200">0</td>
              <td class="py-3 px-2 font-bold border-2 border-cyan-400 dark:border-cyan-600 bg-white dark:bg-gray-700 dark:text-gray-200">0</td>
              <td class="py-3 px-2 font-bold border-2 border-cyan-400 dark:border-cyan-600 bg-white dark:bg-gray-700 dark:text-gray-200">0</td>
              <td class="py-3 px-2 font-bold border-2 border-cyan-400 dark:border-cyan-600 bg-white dark:bg-gray-700 dark:text-gray-200">0</td>
            </tr>
          </tbody>
        </table>
      </div>
    </div>

    <!-- Esercizio 1: Scomponi i numeri -->
    <div class="p-4 md:p-6">
      <p class="font-bold text-gray-700 dark:text-gray-200 mb-4">
        <%= numero_esercizio_badge(1) %>
        Scomponi i numeri. Segui l'esempio.
      </p>

      <div class="overflow-x-auto">
        <table class="w-full text-center border-collapse">
          <thead>
            <tr class="text-gray-800 dark:text-gray-200">
              <th class="py-3 px-2"></th>
              <th class="py-3 px-2 font-bold border-2 border-cyan-400 dark:border-cyan-600 bg-white dark:bg-gray-700">Centinaia<br>di migliaia<br><span class="text-custom-sky dark:text-cyan-400">hk</span></th>
              <th class="py-3 px-2 font-bold border-2 border-cyan-400 dark:border-cyan-600 bg-white dark:bg-gray-700">Decine<br>di migliaia<br><span class="text-custom-sky dark:text-cyan-400">dak</span></th>
              <th class="py-3 px-2 font-bold border-2 border-cyan-400 dark:border-cyan-600 bg-white dark:bg-gray-700">Migliaia<br><span class="text-custom-sky dark:text-cyan-400">uk</span></th>
              <th class="py-3 px-2 font-bold border-2 border-cyan-400 dark:border-cyan-600 bg-white dark:bg-gray-700">Centinaia<br><span class="text-green-600 dark:text-green-400">h</span></th>
              <th class="py-3 px-2 font-bold border-2 border-cyan-400 dark:border-cyan-600 bg-white dark:bg-gray-700">Decine<br><span class="text-red-600 dark:text-red-400">da</span></th>
              <th class="py-3 px-2 font-bold border-2 border-cyan-400 dark:border-cyan-600 bg-white dark:bg-gray-700">Unità<br><span class="text-custom-sky dark:text-cyan-400">u</span></th>
            </tr>
          </thead>
          <tbody>
            <!-- Esempio -->
            <tr>
              <td class="py-3 px-3 font-bold dark:text-white">107 228</td>
              <td class="py-3 px-2 border-2 border-cyan-400 dark:border-cyan-600 bg-white dark:bg-gray-700"><span class="font-bold text-pink-600">1</span></td>
              <td class="py-3 px-2 border-2 border-cyan-400 dark:border-cyan-600 bg-white dark:bg-gray-700"><span class="font-bold text-pink-600">0</span></td>
              <td class="py-3 px-2 border-2 border-cyan-400 dark:border-cyan-600 bg-white dark:bg-gray-700"><span class="font-bold text-pink-600">7</span></td>
              <td class="py-3 px-2 border-2 border-cyan-400 dark:border-cyan-600 bg-white dark:bg-gray-700"><span class="font-bold text-pink-600">2</span></td>
              <td class="py-3 px-2 border-2 border-cyan-400 dark:border-cyan-600 bg-white dark:bg-gray-700"><span class="font-bold text-pink-600">2</span></td>
              <td class="py-3 px-2 border-2 border-cyan-400 dark:border-cyan-600 bg-white dark:bg-gray-700"><span class="font-bold text-pink-600">8</span></td>
            </tr>
            <!-- 97 001 -->
            <tr>
              <td class="py-3 px-3 font-bold dark:text-white">97 001</td>
              <td class="py-3 px-2 border-2 border-cyan-400 dark:border-cyan-600 bg-white dark:bg-gray-700">
                <input type="text" class="w-12 border-b-2 border-dotted border-gray-400 dark:border-gray-500 text-center font-bold bg-transparent dark:text-white" data-correct-answer="">
              </td>
              <td class="py-3 px-2 border-2 border-cyan-400 dark:border-cyan-600 bg-white dark:bg-gray-700">
                <input type="text" class="w-12 border-b-2 border-dotted border-gray-400 dark:border-gray-500 text-center font-bold bg-transparent dark:text-white" data-correct-answer="9">
              </td>
              <td class="py-3 px-2 border-2 border-cyan-400 dark:border-cyan-600 bg-white dark:bg-gray-700">
                <input type="text" class="w-12 border-b-2 border-dotted border-gray-400 dark:border-gray-500 text-center font-bold bg-transparent dark:text-white" data-correct-answer="7">
              </td>
              <td class="py-3 px-2 border-2 border-cyan-400 dark:border-cyan-600 bg-white dark:bg-gray-700">
                <input type="text" class="w-12 border-b-2 border-dotted border-gray-400 dark:border-gray-500 text-center font-bold bg-transparent dark:text-white" data-correct-answer="0">
              </td>
              <td class="py-3 px-2 border-2 border-cyan-400 dark:border-cyan-600 bg-white dark:bg-gray-700">
                <input type="text" class="w-12 border-b-2 border-dotted border-gray-400 dark:border-gray-500 text-center font-bold bg-transparent dark:text-white" data-correct-answer="0">
              </td>
              <td class="py-3 px-2 border-2 border-cyan-400 dark:border-cyan-600 bg-white dark:bg-gray-700">
                <input type="text" class="w-12 border-b-2 border-dotted border-gray-400 dark:border-gray-500 text-center font-bold bg-transparent dark:text-white" data-correct-answer="1">
              </td>
            </tr>
            <!-- 148 669 -->
            <tr>
              <td class="py-3 px-3 font-bold dark:text-white">148 669</td>
              <td class="py-3 px-2 border-2 border-cyan-400 dark:border-cyan-600 bg-white dark:bg-gray-700">
                <input type="text" class="w-12 border-b-2 border-dotted border-gray-400 dark:border-gray-500 text-center font-bold bg-transparent dark:text-white" data-correct-answer="1">
              </td>
              <td class="py-3 px-2 border-2 border-cyan-400 dark:border-cyan-600 bg-white dark:bg-gray-700">
                <input type="text" class="w-12 border-b-2 border-dotted border-gray-400 dark:border-gray-500 text-center font-bold bg-transparent dark:text-white" data-correct-answer="4">
              </td>
              <td class="py-3 px-2 border-2 border-cyan-400 dark:border-cyan-600 bg-white dark:bg-gray-700">
                <input type="text" class="w-12 border-b-2 border-dotted border-gray-400 dark:border-gray-500 text-center font-bold bg-transparent dark:text-white" data-correct-answer="8">
              </td>
              <td class="py-3 px-2 border-2 border-cyan-400 dark:border-cyan-600 bg-white dark:bg-gray-700">
                <input type="text" class="w-12 border-b-2 border-dotted border-gray-400 dark:border-gray-500 text-center font-bold bg-transparent dark:text-white" data-correct-answer="6">
              </td>
              <td class="py-3 px-2 border-2 border-cyan-400 dark:border-cyan-600 bg-white dark:bg-gray-700">
                <input type="text" class="w-12 border-b-2 border-dotted border-gray-400 dark:border-gray-500 text-center font-bold bg-transparent dark:text-white" data-correct-answer="6">
              </td>
              <td class="py-3 px-2 border-2 border-cyan-400 dark:border-cyan-600 bg-white dark:bg-gray-700">
                <input type="text" class="w-12 border-b-2 border-dotted border-gray-400 dark:border-gray-500 text-center font-bold bg-transparent dark:text-white" data-correct-answer="9">
              </td>
            </tr>
            <!-- 196 000 -->
            <tr>
              <td class="py-3 px-3 font-bold dark:text-white">196 000</td>
              <td class="py-3 px-2 border-2 border-cyan-400 dark:border-cyan-600 bg-white dark:bg-gray-700">
                <input type="text" class="w-12 border-b-2 border-dotted border-gray-400 dark:border-gray-500 text-center font-bold bg-transparent dark:text-white" data-correct-answer="1">
              </td>
              <td class="py-3 px-2 border-2 border-cyan-400 dark:border-cyan-600 bg-white dark:bg-gray-700">
                <input type="text" class="w-12 border-b-2 border-dotted border-gray-400 dark:border-gray-500 text-center font-bold bg-transparent dark:text-white" data-correct-answer="9">
              </td>
              <td class="py-3 px-2 border-2 border-cyan-400 dark:border-cyan-600 bg-white dark:bg-gray-700">
                <input type="text" class="w-12 border-b-2 border-dotted border-gray-400 dark:border-gray-500 text-center font-bold bg-transparent dark:text-white" data-correct-answer="6">
              </td>
              <td class="py-3 px-2 border-2 border-cyan-400 dark:border-cyan-600 bg-white dark:bg-gray-700">
                <input type="text" class="w-12 border-b-2 border-dotted border-gray-400 dark:border-gray-500 text-center font-bold bg-transparent dark:text-white" data-correct-answer="0">
              </td>
              <td class="py-3 px-2 border-2 border-cyan-400 dark:border-cyan-600 bg-white dark:bg-gray-700">
                <input type="text" class="w-12 border-b-2 border-dotted border-gray-400 dark:border-gray-500 text-center font-bold bg-transparent dark:text-white" data-correct-answer="0">
              </td>
              <td class="py-3 px-2 border-2 border-cyan-400 dark:border-cyan-600 bg-white dark:bg-gray-700">
                <input type="text" class="w-12 border-b-2 border-dotted border-gray-400 dark:border-gray-500 text-center font-bold bg-transparent dark:text-white" data-correct-answer="0">
              </td>
            </tr>
            <!-- 230 850 -->
            <tr>
              <td class="py-3 px-3 font-bold dark:text-white">230 850</td>
              <td class="py-3 px-2 border-2 border-cyan-400 dark:border-cyan-600 bg-white dark:bg-gray-700">
                <input type="text" class="w-12 border-b-2 border-dotted border-gray-400 dark:border-gray-500 text-center font-bold bg-transparent dark:text-white" data-correct-answer="2">
              </td>
              <td class="py-3 px-2 border-2 border-cyan-400 dark:border-cyan-600 bg-white dark:bg-gray-700">
                <input type="text" class="w-12 border-b-2 border-dotted border-gray-400 dark:border-gray-500 text-center font-bold bg-transparent dark:text-white" data-correct-answer="3">
              </td>
              <td class="py-3 px-2 border-2 border-cyan-400 dark:border-cyan-600 bg-white dark:bg-gray-700">
                <input type="text" class="w-12 border-b-2 border-dotted border-gray-400 dark:border-gray-500 text-center font-bold bg-transparent dark:text-white" data-correct-answer="0">
              </td>
              <td class="py-3 px-2 border-2 border-cyan-400 dark:border-cyan-600 bg-white dark:bg-gray-700">
                <input type="text" class="w-12 border-b-2 border-dotted border-gray-400 dark:border-gray-500 text-center font-bold bg-transparent dark:text-white" data-correct-answer="8">
              </td>
              <td class="py-3 px-2 border-2 border-cyan-400 dark:border-cyan-600 bg-white dark:bg-gray-700">
                <input type="text" class="w-12 border-b-2 border-dotted border-gray-400 dark:border-gray-500 text-center font-bold bg-transparent dark:text-white" data-correct-answer="5">
              </td>
              <td class="py-3 px-2 border-2 border-cyan-400 dark:border-cyan-600 bg-white dark:bg-gray-700">
                <input type="text" class="w-12 border-b-2 border-dotted border-gray-400 dark:border-gray-500 text-center font-bold bg-transparent dark:text-white" data-correct-answer="0">
              </td>
            </tr>
          </tbody>
        </table>
      </div>
    </div>

    <!-- Esercizio 2: Indica quale posto occupa la cifra cerchiata -->
    <div class="p-4 md:p-6">
      <p class="font-bold text-gray-700 dark:text-gray-200 mb-4">
        <%= numero_esercizio_badge(2) %>
        Indica quale posto occupa la cifra cerchiata in ciascun numero. Segui l'esempio.
      </p>

      <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
        <!-- Esempio -->
        <div class="flex flex-wrap items-center gap-2">
          <span class="font-bold dark:text-white">7</span>
          <span class="inline-flex items-center justify-center w-8 h-8 rounded-full border-3 border-pink-500 bg-white">
            <span class="font-bold text-pink-600">8</span>
          </span>
          <span class="font-bold dark:text-white">32</span>
          <span class="text-pink-600 mx-2">→</span>
          <span class="font-bold text-pink-600">h</span>
        </div>

        <div class="flex flex-wrap items-center gap-2">
          <span class="font-bold dark:text-white">21 4</span>
          <span class="inline-flex items-center justify-center w-8 h-8 rounded-full border-3 border-pink-500 bg-white">
            <span class="font-bold text-pink-600">0</span>
          </span>
          <span class="font-bold dark:text-white">3</span>
          <span class="text-pink-600 mx-2">→</span>
          <input type="text" class="w-16 border-b-2 border-dotted border-gray-400 dark:border-gray-500 text-center font-bold bg-transparent dark:text-white" data-correct-answer="h">
        </div>

        <div class="flex flex-wrap items-center gap-2">
          <span class="font-bold dark:text-white">6 6</span>
          <span class="inline-flex items-center justify-center w-8 h-8 rounded-full border-3 border-pink-500 bg-white">
            <span class="font-bold text-pink-600">5</span>
          </span>
          <span class="font-bold dark:text-white">5</span>
          <span class="text-pink-600 mx-2">→</span>
          <input type="text" class="w-16 border-b-2 border-dotted border-gray-400 dark:border-gray-500 text-center font-bold bg-transparent dark:text-white" data-correct-answer="da">
        </div>

        <div class="flex flex-wrap items-center gap-2">
          <span class="font-bold dark:text-white">9</span>
          <span class="inline-flex items-center justify-center w-8 h-8 rounded-full border-3 border-pink-500 bg-white">
            <span class="font-bold text-pink-600">0</span>
          </span>
          <span class="font-bold dark:text-white">6 421</span>
          <span class="text-pink-600 mx-2">→</span>
          <input type="text" class="w-16 border-b-2 border-dotted border-gray-400 dark:border-gray-500 text-center font-bold bg-transparent dark:text-white" data-correct-answer="dak">
        </div>

        <div class="flex flex-wrap items-center gap-2">
          <span class="font-bold dark:text-white">27</span>
          <span class="inline-flex items-center justify-center w-8 h-8 rounded-full border-3 border-pink-500 bg-white">
            <span class="font-bold text-pink-600">0</span>
          </span>
          <span class="font-bold dark:text-white">626</span>
          <span class="text-pink-600 mx-2">→</span>
          <input type="text" class="w-16 border-b-2 border-dotted border-gray-400 dark:border-gray-500 text-center font-bold bg-transparent dark:text-white" data-correct-answer="uk">
        </div>

        <div class="flex flex-wrap items-center gap-2">
          <span class="font-bold dark:text-white">80</span>
          <span class="inline-flex items-center justify-center w-8 h-8 rounded-full border-3 border-pink-500 bg-white">
            <span class="font-bold text-pink-600">6</span>
          </span>
          <span class="font-bold dark:text-white">922</span>
          <span class="text-pink-600 mx-2">→</span>
          <input type="text" class="w-16 border-b-2 border-dotted border-gray-400 dark:border-gray-500 text-center font-bold bg-transparent dark:text-white" data-correct-answer="uk">
        </div>
      </div>
    </div>

    <!-- Esercizio 3: Componi e scomponi -->
    <div class="p-4 md:p-6">
      <p class="font-bold text-gray-700 dark:text-gray-200 mb-4">
        <%= numero_esercizio_badge(3) %>
        Componi e scomponi come negli esempi.
      </p>

      <div class="grid grid-cols-1 lg:grid-cols-2 gap-6">
        <!-- Sezione COMPONI -->
        <div class="space-y-4">
          <h4 class="font-bold text-custom-sky mb-3">Componi</h4>

          <!-- Esempio -->
          <div class="flex flex-wrap items-center gap-2 p-2 bg-pink-50 dark:bg-pink-900/30 rounded-lg">
            <span class="font-semibold dark:text-white">3 dak, 2 h, 6 u</span>
            <span class="text-pink-600 mx-1">=</span>
            <span class="font-bold text-pink-600">30 206</span>
          </div>

          <%= render 'shared/fill_list',
              color: "pink",
              equals: true,
              items: [
                { prefix: "7 uk, 9 h, 0 da, 5 u", answer: "7905", width: "w-24" },
                { prefix: "5 hk, 0 dak, 0 uk, 5 h, 2 da, 1 u", answer: "500521", width: "w-28" }
              ] %>
        </div>

        <!-- Sezione SCOMPONI -->
        <div class="space-y-4">
          <h4 class="font-bold text-custom-sky mb-3">Scomponi</h4>

          <!-- Esempio -->
          <div class="flex flex-wrap items-center gap-2 p-2 bg-pink-50 dark:bg-pink-900/30 rounded-lg">
            <span class="font-bold text-pink-600">7 783</span>
            <span class="text-pink-600 mx-1">=</span>
            <span class="font-semibold text-pink-600">7 uk, 7 h, 8 da, 3 u</span>
          </div>

          <%= render 'shared/fill_list',
              color: "pink",
              equals: true,
              items: [
                { prefix: "906 421", answer: "9 hk, 0 dak, 6 uk, 4 h, 2 da, 1 u", flex: true },
                { prefix: "21 403", answer: "2 dak, 1 uk, 4 h, 0 da, 3 u", flex: true }
              ] %>
        </div>
      </div>
    </div>

    <%= render 'shared/exercise_controls' %>
  </div>
</div>
