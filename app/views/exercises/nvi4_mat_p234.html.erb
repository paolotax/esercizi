<div class="max-w-6xl mx-auto bg-white dark:bg-gray-900 p-3 md:p-6 transition-colors duration-300"
     data-controller="exercise-checker text-toggle font-controls"
     data-text-toggle-target="content"
     data-font-controls-target="content">

  <%= render 'shared/page_header', pagina: @pagina %>

  <div class="space-y-6">

    <!-- Esercizio 1 IMPARARE TUTTI -->
    <div class="p-5 bg-white dark:bg-gray-800 rounded-2xl border-3 border-yellow-400 dark:border-yellow-500 space-y-4">
      <p class="font-bold text-gray-700 dark:text-gray-200">
        <%= imparare_tutti_badge(1) %>
        Indica il valore di ogni cifra. Segui l'esempio.
      </p>

      <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
        <!-- Colonna sinistra -->
        <div class="space-y-3">
          <div class="flex items-center gap-2">
            <span class="text-gray-700 dark:text-gray-200 font-bold">32,54 m =</span>
            <span class="text-cyan-600 dark:text-cyan-400 font-bold underline">3 dam 2 m 5 dm 4 cm</span>
          </div>
          <div class="flex items-center gap-2">
            <span class="text-gray-700 dark:text-gray-200">129 cm =</span>
            <input type="text" data-correct-answer="1 m 2 dm 9 cm" class="w-40 border-b-2 border-dotted border-gray-400 dark:border-gray-500 text-center font-bold bg-transparent dark:text-white">
          </div>
          <div class="flex items-center gap-2">
            <span class="text-gray-700 dark:text-gray-200">0,38 km =</span>
            <input type="text" data-correct-answer="3 hm 8 dam" class="w-40 border-b-2 border-dotted border-gray-400 dark:border-gray-500 text-center font-bold bg-transparent dark:text-white">
          </div>
          <div class="flex items-center gap-2">
            <span class="text-gray-700 dark:text-gray-200">309,63 dℓ =</span>
            <input type="text" data-correct-answer="3 daℓ 0 ℓ 9 dℓ 6 cℓ 3 mℓ" class="w-48 border-b-2 border-dotted border-gray-400 dark:border-gray-500 text-center font-bold bg-transparent dark:text-white">
          </div>
        </div>

        <!-- Colonna destra -->
        <div class="space-y-3">
          <div class="flex items-center gap-2">
            <span class="text-gray-700 dark:text-gray-200">3,63 hℓ =</span>
            <input type="text" data-correct-answer="3 hℓ 6 daℓ 3 ℓ" class="w-40 border-b-2 border-dotted border-gray-400 dark:border-gray-500 text-center font-bold bg-transparent dark:text-white">
          </div>
          <div class="flex items-center gap-2">
            <span class="text-gray-700 dark:text-gray-200">326 mg =</span>
            <input type="text" data-correct-answer="3 dg 2 cg 6 mg" class="w-40 border-b-2 border-dotted border-gray-400 dark:border-gray-500 text-center font-bold bg-transparent dark:text-white">
          </div>
          <div class="flex items-center gap-2">
            <span class="text-gray-700 dark:text-gray-200">1 750 g =</span>
            <input type="text" data-correct-answer="1 kg 7 hg 5 dag" class="w-40 border-b-2 border-dotted border-gray-400 dark:border-gray-500 text-center font-bold bg-transparent dark:text-white">
          </div>
          <div class="flex items-center gap-2">
            <span class="text-gray-700 dark:text-gray-200">12,325 hg =</span>
            <input type="text" data-correct-answer="1 kg 2 hg 3 dag 2 g 5 dg" class="w-48 border-b-2 border-dotted border-gray-400 dark:border-gray-500 text-center font-bold bg-transparent dark:text-white">
          </div>
        </div>
      </div>
    </div>

    <!-- Esercizio 2 -->
    <div class="space-y-4">
      <p class="font-bold text-gray-700 dark:text-gray-200">
        <%= numero_esercizio_badge(2) %> Esegui le equivalenze.
      </p>

      <div class="overflow-x-auto">
        <table class="w-full border-2 border-cyan-400 dark:border-cyan-600">
          <thead>
            <tr class="bg-custom-blue-light dark:bg-cyan-900/50">
              <th class="p-2 border-2 border-cyan-400 dark:border-cyan-600 text-gray-700 dark:text-gray-200 font-bold">Misure di lunghezza</th>
              <th class="p-2 border-2 border-cyan-400 dark:border-cyan-600 text-gray-700 dark:text-gray-200 font-bold">Misure di capacità</th>
              <th class="p-2 border-2 border-cyan-400 dark:border-cyan-600 text-gray-700 dark:text-gray-200 font-bold">Misure di massa</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td class="p-2 border-2 border-cyan-400 dark:border-cyan-600">
                <div class="flex items-center gap-2 justify-center">
                  <span class="text-gray-700 dark:text-gray-200">810 m =</span>
                  <input type="text" data-correct-answer="8,10" class="w-14 border-b-2 border-dotted border-gray-400 dark:border-gray-500 text-center font-bold bg-transparent dark:text-white">
                  <span class="text-gray-700 dark:text-gray-200">hm</span>
                </div>
              </td>
              <td class="p-2 border-2 border-cyan-400 dark:border-cyan-600">
                <div class="flex items-center gap-2 justify-center">
                  <span class="text-gray-700 dark:text-gray-200">75,1 ℓ =</span>
                  <input type="text" data-correct-answer="7,51" class="w-14 border-b-2 border-dotted border-gray-400 dark:border-gray-500 text-center font-bold bg-transparent dark:text-white">
                  <span class="text-gray-700 dark:text-gray-200">daℓ</span>
                </div>
              </td>
              <td class="p-2 border-2 border-cyan-400 dark:border-cyan-600">
                <div class="flex items-center gap-2 justify-center">
                  <span class="text-gray-700 dark:text-gray-200">274,4 g =</span>
                  <input type="text" data-correct-answer="27,44" class="w-14 border-b-2 border-dotted border-gray-400 dark:border-gray-500 text-center font-bold bg-transparent dark:text-white">
                  <span class="text-gray-700 dark:text-gray-200">dag</span>
                </div>
              </td>
            </tr>
            <tr>
              <td class="p-2 border-2 border-cyan-400 dark:border-cyan-600">
                <div class="flex items-center gap-2 justify-center">
                  <span class="text-gray-700 dark:text-gray-200">423,9 dm =</span>
                  <input type="text" data-correct-answer="42,39" class="w-14 border-b-2 border-dotted border-gray-400 dark:border-gray-500 text-center font-bold bg-transparent dark:text-white">
                  <span class="text-gray-700 dark:text-gray-200">m</span>
                </div>
              </td>
              <td class="p-2 border-2 border-cyan-400 dark:border-cyan-600">
                <div class="flex items-center gap-2 justify-center">
                  <span class="text-gray-700 dark:text-gray-200">4,06 hℓ =</span>
                  <input type="text" data-correct-answer="406" class="w-14 border-b-2 border-dotted border-gray-400 dark:border-gray-500 text-center font-bold bg-transparent dark:text-white">
                  <span class="text-gray-700 dark:text-gray-200">ℓ</span>
                </div>
              </td>
              <td class="p-2 border-2 border-cyan-400 dark:border-cyan-600">
                <div class="flex items-center gap-2 justify-center">
                  <span class="text-gray-700 dark:text-gray-200">3,5 dag =</span>
                  <input type="text" data-correct-answer="350" class="w-14 border-b-2 border-dotted border-gray-400 dark:border-gray-500 text-center font-bold bg-transparent dark:text-white">
                  <span class="text-gray-700 dark:text-gray-200">dg</span>
                </div>
              </td>
            </tr>
            <tr>
              <td class="p-2 border-2 border-cyan-400 dark:border-cyan-600">
                <div class="flex items-center gap-2 justify-center">
                  <span class="text-gray-700 dark:text-gray-200">8,5 mm =</span>
                  <input type="text" data-correct-answer="0,85" class="w-14 border-b-2 border-dotted border-gray-400 dark:border-gray-500 text-center font-bold bg-transparent dark:text-white">
                  <span class="text-gray-700 dark:text-gray-200">cm</span>
                </div>
              </td>
              <td class="p-2 border-2 border-cyan-400 dark:border-cyan-600">
                <div class="flex items-center gap-2 justify-center">
                  <span class="text-gray-700 dark:text-gray-200">82,3 dℓ =</span>
                  <input type="text" data-correct-answer="8230" class="w-16 border-b-2 border-dotted border-gray-400 dark:border-gray-500 text-center font-bold bg-transparent dark:text-white">
                  <span class="text-gray-700 dark:text-gray-200">mℓ</span>
                </div>
              </td>
              <td class="p-2 border-2 border-cyan-400 dark:border-cyan-600">
                <div class="flex items-center gap-2 justify-center">
                  <span class="text-gray-700 dark:text-gray-200">76 kg =</span>
                  <input type="text" data-correct-answer="76000" class="w-16 border-b-2 border-dotted border-gray-400 dark:border-gray-500 text-center font-bold bg-transparent dark:text-white">
                  <span class="text-gray-700 dark:text-gray-200">g</span>
                </div>
              </td>
            </tr>
            <tr>
              <td class="p-2 border-2 border-cyan-400 dark:border-cyan-600">
                <div class="flex items-center gap-2 justify-center">
                  <span class="text-gray-700 dark:text-gray-200">6,07 m =</span>
                  <input type="text" data-correct-answer="6070" class="w-16 border-b-2 border-dotted border-gray-400 dark:border-gray-500 text-center font-bold bg-transparent dark:text-white">
                  <span class="text-gray-700 dark:text-gray-200">mm</span>
                </div>
              </td>
              <td class="p-2 border-2 border-cyan-400 dark:border-cyan-600">
                <div class="flex items-center gap-2 justify-center">
                  <span class="text-gray-700 dark:text-gray-200">80130 dℓ =</span>
                  <input type="text" data-correct-answer="8013" class="w-16 border-b-2 border-dotted border-gray-400 dark:border-gray-500 text-center font-bold bg-transparent dark:text-white">
                  <span class="text-gray-700 dark:text-gray-200">daℓ</span>
                </div>
              </td>
              <td class="p-2 border-2 border-cyan-400 dark:border-cyan-600">
                <div class="flex items-center gap-2 justify-center">
                  <span class="text-gray-700 dark:text-gray-200">80 mg =</span>
                  <input type="text" data-correct-answer="0,8" class="w-14 border-b-2 border-dotted border-gray-400 dark:border-gray-500 text-center font-bold bg-transparent dark:text-white">
                  <span class="text-gray-700 dark:text-gray-200">dg</span>
                </div>
              </td>
            </tr>
          </tbody>
        </table>
      </div>
    </div>

    <!-- Esercizi 3 e 4 affiancati -->
    <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
      <!-- Esercizio 3 -->
      <div class="space-y-4">
        <p class="font-bold text-gray-700 dark:text-gray-200">
          <%= numero_esercizio_badge(3) %> Completa.
        </p>

        <div class="overflow-x-auto">
          <table class="w-full border-2 border-cyan-400 dark:border-cyan-600">
            <thead>
              <tr class="bg-custom-blue-light dark:bg-cyan-900/50">
                <th class="p-2 border-2 border-cyan-400 dark:border-cyan-600 text-gray-700 dark:text-gray-200 font-bold">Prodotto</th>
                <th class="p-2 border-2 border-cyan-400 dark:border-cyan-600 text-gray-700 dark:text-gray-200 font-bold">Peso lordo</th>
                <th class="p-2 border-2 border-cyan-400 dark:border-cyan-600 text-gray-700 dark:text-gray-200 font-bold">Peso netto</th>
                <th class="p-2 border-2 border-cyan-400 dark:border-cyan-600 text-gray-700 dark:text-gray-200 font-bold">Tara</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td class="p-2 border-2 border-cyan-400 dark:border-cyan-600 text-center text-gray-700 dark:text-gray-200">cestino di fragole</td>
                <td class="p-2 border-2 border-cyan-400 dark:border-cyan-600 text-center">
                  <input type="text" data-correct-answer="500" class="w-14 border-b-2 border-dotted border-gray-400 dark:border-gray-500 text-center font-bold bg-transparent dark:text-white">
                  <span class="text-gray-700 dark:text-gray-200">g</span>
                </td>
                <td class="p-2 border-2 border-cyan-400 dark:border-cyan-600 text-center text-gray-700 dark:text-gray-200">375 g</td>
                <td class="p-2 border-2 border-cyan-400 dark:border-cyan-600 text-center text-gray-700 dark:text-gray-200">125 g</td>
              </tr>
              <tr>
                <td class="p-2 border-2 border-cyan-400 dark:border-cyan-600 text-center text-gray-700 dark:text-gray-200">pacco di zucchero</td>
                <td class="p-2 border-2 border-cyan-400 dark:border-cyan-600 text-center text-gray-700 dark:text-gray-200">1050 g</td>
                <td class="p-2 border-2 border-cyan-400 dark:border-cyan-600 text-center">
                  <input type="text" data-correct-answer="1000" class="w-14 border-b-2 border-dotted border-gray-400 dark:border-gray-500 text-center font-bold bg-transparent dark:text-white">
                  <span class="text-gray-700 dark:text-gray-200">g</span>
                </td>
                <td class="p-2 border-2 border-cyan-400 dark:border-cyan-600 text-center text-gray-700 dark:text-gray-200">50 g</td>
              </tr>
              <tr>
                <td class="p-2 border-2 border-cyan-400 dark:border-cyan-600 text-center text-gray-700 dark:text-gray-200">vasetto di marmellata</td>
                <td class="p-2 border-2 border-cyan-400 dark:border-cyan-600 text-center text-gray-700 dark:text-gray-200">4,30 hg</td>
                <td class="p-2 border-2 border-cyan-400 dark:border-cyan-600 text-center text-gray-700 dark:text-gray-200">250 g</td>
                <td class="p-2 border-2 border-cyan-400 dark:border-cyan-600 text-center">
                  <input type="text" data-correct-answer="180" class="w-14 border-b-2 border-dotted border-gray-400 dark:border-gray-500 text-center font-bold bg-transparent dark:text-white">
                  <span class="text-gray-700 dark:text-gray-200">g</span>
                </td>
              </tr>
            </tbody>
          </table>
        </div>
      </div>

      <!-- Esercizio 4 -->
      <div class="space-y-4">
        <p class="font-bold text-gray-700 dark:text-gray-200">
          <%= numero_esercizio_badge(4) %> Scrivi l'unità di misura più adatta per:
        </p>

        <div class="space-y-2">
          <div class="flex items-center gap-2">
            <span class="text-cyan-500">•</span>
            <span class="text-gray-700 dark:text-gray-200">la lunghezza di un'autostrada</span>
            <input type="text" data-correct-answer="km" class="w-16 border-b-2 border-dotted border-gray-400 dark:border-gray-500 text-center font-bold bg-transparent dark:text-white">
          </div>
          <div class="flex items-center gap-2">
            <span class="text-cyan-500">•</span>
            <span class="text-gray-700 dark:text-gray-200">il peso di una pillola</span>
            <input type="text" data-correct-answer="mg" class="w-16 border-b-2 border-dotted border-gray-400 dark:border-gray-500 text-center font-bold bg-transparent dark:text-white">
          </div>
          <div class="flex items-center gap-2">
            <span class="text-cyan-500">•</span>
            <span class="text-gray-700 dark:text-gray-200">la capacità di una botte</span>
            <input type="text" data-correct-answer="hℓ" class="w-16 border-b-2 border-dotted border-gray-400 dark:border-gray-500 text-center font-bold bg-transparent dark:text-white">
          </div>
          <div class="flex items-center gap-2">
            <span class="text-cyan-500">•</span>
            <span class="text-gray-700 dark:text-gray-200">lo spessore di un quaderno</span>
            <input type="text" data-correct-answer="mm" class="w-16 border-b-2 border-dotted border-gray-400 dark:border-gray-500 text-center font-bold bg-transparent dark:text-white">
          </div>
          <div class="flex items-center gap-2">
            <span class="text-cyan-500">•</span>
            <span class="text-gray-700 dark:text-gray-200">il peso di uno zaino</span>
            <input type="text" data-correct-answer="kg" class="w-16 border-b-2 border-dotted border-gray-400 dark:border-gray-500 text-center font-bold bg-transparent dark:text-white">
          </div>
          <div class="flex items-center gap-2">
            <span class="text-cyan-500">•</span>
            <span class="text-gray-700 dark:text-gray-200">la capacità di una boccetta di profumo</span>
            <input type="text" data-correct-answer="mℓ" class="w-16 border-b-2 border-dotted border-gray-400 dark:border-gray-500 text-center font-bold bg-transparent dark:text-white">
          </div>
        </div>
      </div>
    </div>

    <!-- Esercizio 5 -->
    <div class="space-y-4">
      <p class="font-bold text-gray-700 dark:text-gray-200">
        <%= numero_esercizio_badge(5) %> Componi inserendo gli zeri necessari.
      </p>

      <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
        <!-- Colonna sinistra - Lunghezza -->
        <div class="space-y-2">
          <div class="flex items-center gap-2">
            <span class="text-gray-700 dark:text-gray-200">8 hm 3 dam 2 m =</span>
            <input type="text" data-correct-answer="832" class="w-16 border-b-2 border-dotted border-gray-400 dark:border-gray-500 text-center font-bold bg-transparent dark:text-white">
            <span class="text-gray-700 dark:text-gray-200">m</span>
          </div>
          <div class="flex items-center gap-2">
            <span class="text-gray-700 dark:text-gray-200">4 dm 5 mm 9 cm =</span>
            <input type="text" data-correct-answer="0,495" class="w-16 border-b-2 border-dotted border-gray-400 dark:border-gray-500 text-center font-bold bg-transparent dark:text-white">
            <span class="text-gray-700 dark:text-gray-200">m</span>
          </div>
          <div class="flex items-center gap-2">
            <span class="text-gray-700 dark:text-gray-200">8 km 1 dam =</span>
            <input type="text" data-correct-answer="801" class="w-16 border-b-2 border-dotted border-gray-400 dark:border-gray-500 text-center font-bold bg-transparent dark:text-white">
            <span class="text-gray-700 dark:text-gray-200">dam</span>
          </div>
          <div class="flex items-center gap-2">
            <span class="text-gray-700 dark:text-gray-200">7 dam 5 dm =</span>
            <input type="text" data-correct-answer="705" class="w-16 border-b-2 border-dotted border-gray-400 dark:border-gray-500 text-center font-bold bg-transparent dark:text-white">
            <span class="text-gray-700 dark:text-gray-200">dm</span>
          </div>
        </div>

        <!-- Colonna destra - Capacità -->
        <div class="space-y-2">
          <div class="flex items-center gap-2">
            <span class="text-gray-700 dark:text-gray-200">4 hℓ 8 daℓ =</span>
            <input type="text" data-correct-answer="480" class="w-16 border-b-2 border-dotted border-gray-400 dark:border-gray-500 text-center font-bold bg-transparent dark:text-white">
            <span class="text-gray-700 dark:text-gray-200">ℓ</span>
          </div>
          <div class="flex items-center gap-2">
            <span class="text-gray-700 dark:text-gray-200">5 ℓ 6 dℓ 1 mℓ =</span>
            <input type="text" data-correct-answer="5,601" class="w-16 border-b-2 border-dotted border-gray-400 dark:border-gray-500 text-center font-bold bg-transparent dark:text-white">
            <span class="text-gray-700 dark:text-gray-200">ℓ</span>
          </div>
          <div class="flex items-center gap-2">
            <span class="text-gray-700 dark:text-gray-200">9 cℓ 2 mℓ =</span>
            <input type="text" data-correct-answer="0,92" class="w-16 border-b-2 border-dotted border-gray-400 dark:border-gray-500 text-center font-bold bg-transparent dark:text-white">
            <span class="text-gray-700 dark:text-gray-200">dℓ</span>
          </div>
          <div class="flex items-center gap-2">
            <span class="text-gray-700 dark:text-gray-200">7 hℓ 3 daℓ 9 ℓ =</span>
            <input type="text" data-correct-answer="73,9" class="w-16 border-b-2 border-dotted border-gray-400 dark:border-gray-500 text-center font-bold bg-transparent dark:text-white">
            <span class="text-gray-700 dark:text-gray-200">daℓ</span>
          </div>
        </div>
      </div>
    </div>

    <!-- Esercizio 6 -->
    <div class="space-y-4">
      <p class="font-bold text-gray-700 dark:text-gray-200">
        <%= numero_esercizio_badge(6) %> Segna con una <span class="underline">X</span> la misura possibile tra quelle proposte.
      </p>

      <div class="grid grid-cols-1 md:grid-cols-3 gap-6">
        <!-- Anguria -->
        <div class="space-y-3">
          <p class="text-gray-700 dark:text-gray-200">
            <span class="text-cyan-500">•</span> Un'anguria può pesare:
          </p>
          <div class="space-y-2 ml-4">
            <label class="flex items-center gap-2 cursor-pointer hover:bg-gray-50 dark:hover:bg-gray-700 p-2 rounded border border-gray-200 dark:border-gray-600 text-gray-700 dark:text-gray-200">
              <input type="radio" name="anguria" class="w-4 h-4">
              <span>7 Megagrammi</span>
            </label>
            <label class="flex items-center gap-2 cursor-pointer hover:bg-gray-50 dark:hover:bg-gray-700 p-2 rounded border border-gray-200 dark:border-gray-600 text-gray-700 dark:text-gray-200">
              <input type="radio" name="anguria" class="w-4 h-4" data-correct-answer="true">
              <span>7 chilogrammi</span>
            </label>
            <label class="flex items-center gap-2 cursor-pointer hover:bg-gray-50 dark:hover:bg-gray-700 p-2 rounded border border-gray-200 dark:border-gray-600 text-gray-700 dark:text-gray-200">
              <input type="radio" name="anguria" class="w-4 h-4">
              <span>7 decigrammi</span>
            </label>
          </div>
        </div>

        <!-- Secchio -->
        <div class="space-y-3">
          <p class="text-gray-700 dark:text-gray-200">
            <span class="text-cyan-500">•</span> Un secchio può contenere:
          </p>
          <div class="space-y-2 ml-4">
            <label class="flex items-center gap-2 cursor-pointer hover:bg-gray-50 dark:hover:bg-gray-700 p-2 rounded border border-gray-200 dark:border-gray-600 text-gray-700 dark:text-gray-200">
              <input type="radio" name="secchio" class="w-4 h-4" data-correct-answer="true">
              <span>15 litri</span>
            </label>
            <label class="flex items-center gap-2 cursor-pointer hover:bg-gray-50 dark:hover:bg-gray-700 p-2 rounded border border-gray-200 dark:border-gray-600 text-gray-700 dark:text-gray-200">
              <input type="radio" name="secchio" class="w-4 h-4">
              <span>15 ettolitri</span>
            </label>
            <label class="flex items-center gap-2 cursor-pointer hover:bg-gray-50 dark:hover:bg-gray-700 p-2 rounded border border-gray-200 dark:border-gray-600 text-gray-700 dark:text-gray-200">
              <input type="radio" name="secchio" class="w-4 h-4">
              <span>15 decalitri</span>
            </label>
          </div>
        </div>

        <!-- Formica -->
        <div class="space-y-3">
          <p class="text-gray-700 dark:text-gray-200">
            <span class="text-cyan-500">•</span> Una formica può essere lunga:
          </p>
          <div class="space-y-2 ml-4">
            <label class="flex items-center gap-2 cursor-pointer hover:bg-gray-50 dark:hover:bg-gray-700 p-2 rounded border border-gray-200 dark:border-gray-600 text-gray-700 dark:text-gray-200">
              <input type="radio" name="formica" class="w-4 h-4">
              <span>9 decimetri</span>
            </label>
            <label class="flex items-center gap-2 cursor-pointer hover:bg-gray-50 dark:hover:bg-gray-700 p-2 rounded border border-gray-200 dark:border-gray-600 text-gray-700 dark:text-gray-200">
              <input type="radio" name="formica" class="w-4 h-4">
              <span>9 centimetri</span>
            </label>
            <label class="flex items-center gap-2 cursor-pointer hover:bg-gray-50 dark:hover:bg-gray-700 p-2 rounded border border-gray-200 dark:border-gray-600 text-gray-700 dark:text-gray-200">
              <input type="radio" name="formica" class="w-4 h-4" data-correct-answer="true">
              <span>9 millimetri</span>
            </label>
          </div>
        </div>
      </div>
    </div>

    <%= render 'shared/exercise_controls' %>
  </div>
</div>
