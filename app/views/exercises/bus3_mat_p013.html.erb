<% content_for :titolo, "#{@pagina.titolo} - #{@pagina.numero}" %>

<div class="max-w-7xl mx-auto p-3 md:p-6 bg-white"
     data-controller="exercise-checker page-viewer text-toggle font-controls"
     data-page-viewer-image-url-value="<%= asset_path('bus3_mat/p013/page.png') %>"
     data-text-toggle-target="content"
     data-font-controls-target="content">
  <!-- Header -->
  <%= render 'shared/page_header', pagina: @pagina %>

  <!-- Esercizio 9: Scrivi il numero in cifre e in lettere -->
  <div class="bg-transparent p-4 md:p-8 mb-8" data-controller="fill-blanks auto-advance">
    <div class="flex items-start gap-3 mb-6">
      <div class="bg-red-500 text-white rounded-full w-8 h-8 flex items-center justify-center font-bold flex-shrink-0">
        9
      </div>
      <p class="text-base md:text-lg text-gray-700">
        Scrivi il numero in cifre e in lettere.
      </p>
    </div>

    <!-- Immagine abachi -->
    <div class="flex justify-center mb-6">
      <%= image_tag "bus3_mat/p013/p13_1.jpg",
          alt: "Abachi con numeri da scrivere",
          class: "max-w-4xl w-full" %>
    </div>

    <div class="grid grid-cols-1 md:grid-cols-3 gap-6">
      <!-- Abaco 1: 170 -->
      <div class="bg-white border-3 border-cyan-400 rounded-lg p-4">
        <div class="space-y-3">
          <div class="flex items-center gap-2">
            <span class="font-bold text-gray-700">In cifre:</span>
            <input type="text" data-fill-blanks-target="input" data-correct-answer="170"
                   class="w-20 px-2 py-1 border-b-2 border-dotted border-gray-400 text-center font-bold text-lg"
                   maxlength="3" inputmode="numeric">
          </div>
          <div class="flex items-center gap-2">
            <span class="font-bold text-gray-700">In lettere:</span>
            <input type="text" data-fill-blanks-target="input" data-correct-answer="centosettanta"
                   class="flex-1 px-2 py-1 border-b-2 border-dotted border-gray-400 text-center font-bold"
                   maxlength="20">
          </div>
        </div>
      </div>

      <!-- Abaco 2: 35 -->
      <div class="bg-white border-3 border-cyan-400 rounded-lg p-4">
        <div class="space-y-3">
          <div class="flex items-center gap-2">
            <span class="font-bold text-gray-700">In cifre:</span>
            <input type="text" data-fill-blanks-target="input" data-correct-answer="35"
                   class="w-20 px-2 py-1 border-b-2 border-dotted border-gray-400 text-center font-bold text-lg"
                   maxlength="2" inputmode="numeric">
          </div>
          <div class="flex items-center gap-2">
            <span class="font-bold text-gray-700">In lettere:</span>
            <input type="text" data-fill-blanks-target="input" data-correct-answer="trentacinque"
                   class="flex-1 px-2 py-1 border-b-2 border-dotted border-gray-400 text-center font-bold"
                   maxlength="20">
          </div>
        </div>
      </div>

      <!-- Abaco 3: 425 -->
      <div class="bg-white border-3 border-cyan-400 rounded-lg p-4">
        <div class="space-y-3">
          <div class="flex items-center gap-2">
            <span class="font-bold text-gray-700">In cifre:</span>
            <input type="text" data-fill-blanks-target="input" data-correct-answer="425"
                   class="w-20 px-2 py-1 border-b-2 border-dotted border-gray-400 text-center font-bold text-lg"
                   maxlength="3" inputmode="numeric">
          </div>
          <div class="flex items-center gap-2">
            <span class="font-bold text-gray-700">In lettere:</span>
            <input type="text" data-fill-blanks-target="input" data-correct-answer="quattrocentoventicinque"
                   class="flex-1 px-2 py-1 border-b-2 border-dotted border-gray-400 text-center font-bold"
                   maxlength="25">
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- Esercizio 10: Indica con una X il numero in cifre -->
  <style>
    .custom-checkbox {
      appearance: none;
      -webkit-appearance: none;
      -moz-appearance: none;
      width: 1.75rem;
      height: 1.75rem;
      border: 2px solid #67e8f9;
      border-radius: 0.25rem;
      position: relative;
      cursor: pointer;
    }
    .custom-checkbox:checked {
      background-color: white;
    }
    .custom-checkbox:checked::after {
      content: '';
      position: absolute;
      left: 50%;
      top: 50%;
      width: 0.875rem;
      height: 0.125rem;
      background-color: #ef4444;
      transform: translate(-50%, -50%) rotate(45deg);
    }
    .custom-checkbox:checked::before {
      content: '';
      position: absolute;
      left: 50%;
      top: 50%;
      width: 0.875rem;
      height: 0.125rem;
      background-color: #ef4444;
      transform: translate(-50%, -50%) rotate(-45deg);
    }
  </style>
  <div class="bg-transparent p-4 md:p-8 mb-8" data-controller="exercise-checker">
    <div class="flex items-start gap-3 mb-6">
      <div class="bg-red-500 text-white rounded-full w-8 h-8 flex items-center justify-center font-bold flex-shrink-0">
        10
      </div>
      <p class="text-base md:text-lg text-gray-700">
        Indica con una <strong class="text-red-600">X</strong> il numero in cifre.
      </p>
    </div>

    <div class="space-y-4">
      <!-- duecentonove -->
      <div class="flex flex-wrap items-center gap-4">
        <span class="font-bold text-lg min-w-[180px]">duecentonove:</span>
        <label class="flex items-center gap-3 cursor-pointer">
          <input type="checkbox" data-correct-answer="false" class="custom-checkbox">
          <span class="text-lg">290</span>
        </label>
        <label class="flex items-center gap-3 cursor-pointer">
          <input type="checkbox" data-correct-answer="false" class="custom-checkbox">
          <span class="text-lg">219</span>
        </label>
        <label class="flex items-center gap-3 cursor-pointer">
          <input type="checkbox" data-correct-answer="true" class="custom-checkbox">
          <span class="text-lg">209</span>
        </label>
      </div>

      <!-- settecentouno -->
      <div class="flex flex-wrap items-center gap-4">
        <span class="font-bold text-lg min-w-[180px]">settecentouno:</span>
        <label class="flex items-center gap-3 cursor-pointer">
          <input type="checkbox" data-correct-answer="false" class="custom-checkbox">
          <span class="text-lg">171</span>
        </label>
        <label class="flex items-center gap-3 cursor-pointer">
          <input type="checkbox" data-correct-answer="true" class="custom-checkbox">
          <span class="text-lg">701</span>
        </label>
        <label class="flex items-center gap-3 cursor-pointer">
          <input type="checkbox" data-correct-answer="false" class="custom-checkbox">
          <span class="text-lg">710</span>
        </label>
      </div>

      <!-- trecentotrenta -->
      <div class="flex flex-wrap items-center gap-4">
        <span class="font-bold text-lg min-w-[180px]">trecentotrenta:</span>
        <label class="flex items-center gap-3 cursor-pointer">
          <input type="checkbox" data-correct-answer="false" class="custom-checkbox">
          <span class="text-lg">303</span>
        </label>
        <label class="flex items-center gap-3 cursor-pointer">
          <input type="checkbox" data-correct-answer="true" class="custom-checkbox">
          <span class="text-lg">330</span>
        </label>
        <label class="flex items-center gap-3 cursor-pointer">
          <input type="checkbox" data-correct-answer="false" class="custom-checkbox">
          <span class="text-lg">230</span>
        </label>
      </div>
    </div>
  </div>

  <!-- Esercizio 11: Completa con un numero adatto -->
  <div class="bg-transparent p-4 md:p-8 mb-8" data-controller="fill-blanks">
    <div class="flex items-start gap-3 mb-6">
      <div class="bg-red-500 text-white rounded-full w-8 h-8 flex items-center justify-center font-bold flex-shrink-0">
        11
      </div>
      <p class="text-base md:text-lg text-gray-700">
        Completa con un numero adatto.
      </p>
    </div>

    <div class="space-y-4">
      <div class="flex flex-wrap items-center gap-3">
        <span class="text-xl font-bold">342</span>
        <span class="text-blue-600 text-xl">></span>
        <input type="text" data-fill-blanks-target="input" data-correct-answer="^(3[0-3][0-9]|[12][0-9]{2}|[1-9]?[0-9])$" data-validation="regex"
               class="w-20 px-2 py-1 border-b-2 border-dotted border-gray-400 text-center font-bold text-lg"
               maxlength="3" inputmode="numeric">
        <input type="text" data-fill-blanks-target="input" data-correct-answer="^(20[2-9]|2[1-9][0-9]|[3-9][0-9]{2})$" data-validation="regex"
               class="w-20 px-2 py-1 border-b-2 border-dotted border-gray-400 text-center font-bold text-lg"
               maxlength="3" inputmode="numeric">
        <span class="text-blue-600 text-xl">></span>
        <span class="text-xl font-bold">201</span>
      </div>

      <div class="flex flex-wrap items-center gap-3">
        <span class="text-xl font-bold">842</span>
        <span class="text-blue-600 text-xl">&lt;</span>
        <input type="text" data-fill-blanks-target="input" data-correct-answer="^(8[5-9][0-9]|[9][0-9]{2})$" data-validation="regex"
               class="w-20 px-2 py-1 border-b-2 border-dotted border-gray-400 text-center font-bold text-lg"
               maxlength="3" inputmode="numeric">
        <span class="text-xl font-bold">549</span>
        <span class="text-blue-600 text-xl">></span>
        <input type="text" data-fill-blanks-target="input" data-correct-answer="^([1-4][0-9]{2}|5[0-3][0-9]|54[0-8])$" data-validation="regex"
               class="w-20 px-2 py-1 border-b-2 border-dotted border-gray-400 text-center font-bold text-lg"
               maxlength="3" inputmode="numeric">
      </div>

      <div class="flex flex-wrap items-center gap-3">
        <input type="text" data-fill-blanks-target="input" data-correct-answer="^(1[4-9][0-9]|[2-9][0-9]{2})$" data-validation="regex"
               class="w-20 px-2 py-1 border-b-2 border-dotted border-gray-400 text-center font-bold text-lg"
               maxlength="3" inputmode="numeric">
        <span class="text-blue-600 text-xl">></span>
        <span class="text-xl font-bold">131</span>
        <span class="text-xl font-bold">723</span>
        <span class="text-blue-600 text-xl">></span>
        <input type="text" data-fill-blanks-target="input" data-correct-answer="^([1-6][0-9]{2}|7[01][0-9]|72[0-2])$" data-validation="regex"
               class="w-20 px-2 py-1 border-b-2 border-dotted border-gray-400 text-center font-bold text-lg"
               maxlength="3" inputmode="numeric">
      </div>
    </div>
  </div>

  <!-- Esercizio 12: Scomponi i numeri -->
  <div class="bg-transparent p-4 md:p-8 mb-8" data-controller="fill-blanks auto-advance">
    <div class="flex items-start gap-3 mb-6">
      <div class="bg-red-500 text-white rounded-full w-8 h-8 flex items-center justify-center font-bold flex-shrink-0">
        12
      </div>
      <p class="text-base md:text-lg text-gray-700">
        Scomponi i numeri. Segui l'esempio.
      </p>
    </div>

    <div class="space-y-6">
      <!-- Esempio: 563 -->
      <div class="flex flex-wrap items-center gap-3">
        <span class="text-2xl font-bold min-w-[60px]">563</span>
        <span class="text-blue-600 text-xl">→</span>
        <span class="text-lg font-bold text-cyan-700">5 h, 6 da, 3 u</span>
        <span class="text-blue-600 text-xl">→</span>
        <span class="text-lg font-bold text-cyan-700">500 + 60 + 3</span>
      </div>

      <!-- 724 -->
      <div class="flex flex-wrap items-center gap-3">
        <span class="text-2xl font-bold min-w-[60px]">724</span>
        <span class="text-blue-600 text-xl">→</span>
        <div class="flex items-center gap-2">
          <input type="text" data-fill-blanks-target="input" data-correct-answer="7"
                 class="w-12 px-2 py-1 border-b-2 border-dotted border-gray-400 text-center font-bold"
                 maxlength="1" inputmode="numeric">
          <span class="font-bold">h,</span>
          <input type="text" data-fill-blanks-target="input" data-correct-answer="2"
                 class="w-12 px-2 py-1 border-b-2 border-dotted border-gray-400 text-center font-bold"
                 maxlength="1" inputmode="numeric">
          <span class="font-bold">da,</span>
          <input type="text" data-fill-blanks-target="input" data-correct-answer="4"
                 class="w-12 px-2 py-1 border-b-2 border-dotted border-gray-400 text-center font-bold"
                 maxlength="1" inputmode="numeric">
          <span class="font-bold">u</span>
        </div>
        <span class="text-blue-600 text-xl">→</span>
        <div class="flex items-center gap-2">
          <input type="text" data-fill-blanks-target="input" data-correct-answer="700"
                 class="w-16 px-2 py-1 border-b-2 border-dotted border-gray-400 text-center font-bold"
                 maxlength="3" inputmode="numeric">
          <span class="font-bold">+</span>
          <input type="text" data-fill-blanks-target="input" data-correct-answer="20"
                 class="w-16 px-2 py-1 border-b-2 border-dotted border-gray-400 text-center font-bold"
                 maxlength="2" inputmode="numeric">
          <span class="font-bold">+</span>
          <input type="text" data-fill-blanks-target="input" data-correct-answer="4"
                 class="w-16 px-2 py-1 border-b-2 border-dotted border-gray-400 text-center font-bold"
                 maxlength="1" inputmode="numeric">
        </div>
      </div>

      <!-- 965 -->
      <div class="flex flex-wrap items-center gap-3">
        <span class="text-2xl font-bold min-w-[60px]">965</span>
        <span class="text-blue-600 text-xl">→</span>
        <div class="flex items-center gap-2">
          <input type="text" data-fill-blanks-target="input" data-correct-answer="9"
                 class="w-12 px-2 py-1 border-b-2 border-dotted border-gray-400 text-center font-bold"
                 maxlength="1" inputmode="numeric">
          <span class="font-bold">h,</span>
          <input type="text" data-fill-blanks-target="input" data-correct-answer="6"
                 class="w-12 px-2 py-1 border-b-2 border-dotted border-gray-400 text-center font-bold"
                 maxlength="1" inputmode="numeric">
          <span class="font-bold">da,</span>
          <input type="text" data-fill-blanks-target="input" data-correct-answer="5"
                 class="w-12 px-2 py-1 border-b-2 border-dotted border-gray-400 text-center font-bold"
                 maxlength="1" inputmode="numeric">
          <span class="font-bold">u</span>
        </div>
        <span class="text-blue-600 text-xl">→</span>
        <div class="flex items-center gap-2">
          <input type="text" data-fill-blanks-target="input" data-correct-answer="900"
                 class="w-16 px-2 py-1 border-b-2 border-dotted border-gray-400 text-center font-bold"
                 maxlength="3" inputmode="numeric">
          <span class="font-bold">+</span>
          <input type="text" data-fill-blanks-target="input" data-correct-answer="60"
                 class="w-16 px-2 py-1 border-b-2 border-dotted border-gray-400 text-center font-bold"
                 maxlength="2" inputmode="numeric">
          <span class="font-bold">+</span>
          <input type="text" data-fill-blanks-target="input" data-correct-answer="5"
                 class="w-16 px-2 py-1 border-b-2 border-dotted border-gray-400 text-center font-bold"
                 maxlength="1" inputmode="numeric">
        </div>
      </div>
    </div>
  </div>

  <!-- Esercizio 13 GIOCO: Completa il crucinumero -->
  <div class="bg-transparent p-4 md:p-8 mb-8" data-controller="fill-blanks auto-advance">
    <div class="flex items-start gap-3 mb-6">
      <div class="bg-gradient-to-r from-cyan-400 to-blue-500 text-white rounded-full w-8 h-8 flex items-center justify-center font-bold flex-shrink-0">
        13
      </div>
      <div class="flex items-center gap-2">
        <span class="bg-gradient-to-r from-cyan-400 to-blue-500 text-white px-4 py-1 rounded-full font-bold text-sm">GIOCO</span>
        <p class="text-base md:text-lg text-gray-700 font-bold">
          Completa il crucinumero.
        </p>
      </div>
    </div>

    <div class="grid grid-cols-1 lg:grid-cols-2 gap-8">
      <!-- Definizioni -->
      <div class="space-y-6">
        <!-- Orizzontali -->
        <div>
          <h3 class="font-bold text-lg text-gray-800 mb-3">Orizzontali</h3>
          <div class="space-y-2">
            <div class="flex gap-2">
              <span class="font-bold text-blue-600 min-w-[20px]">2.</span>
              <p class="text-gray-700">Il numero di giorni in un anno.</p>
            </div>
            <div class="flex gap-2">
              <span class="font-bold text-blue-600 min-w-[20px]">3.</span>
              <p class="text-gray-700">Il successivo di 200.</p>
            </div>
            <div class="flex gap-2">
              <span class="font-bold text-blue-600 min-w-[20px]">4.</span>
              <p class="text-gray-700">Il precedente di 820.</p>
            </div>
          </div>
        </div>

        <!-- Verticali -->
        <div>
          <h3 class="font-bold text-lg text-gray-800 mb-3">Verticali</h3>
          <div class="space-y-2">
            <div class="flex gap-2">
              <span class="font-bold text-red-600 min-w-[20px]">1.</span>
              <p class="text-gray-700">Componi 6 da, 4 h, 1 u.</p>
            </div>
            <div class="flex gap-2">
              <span class="font-bold text-red-600 min-w-[20px]">2.</span>
              <p class="text-gray-700">Il numero 310 è il suo successivo.</p>
            </div>
            <div class="flex gap-2">
              <span class="font-bold text-red-600 min-w-[20px]">3.</span>
              <p class="text-gray-700">Componi 7 u, 2 h, 1 da.</p>
            </div>
          </div>
        </div>
      </div>

      <!-- Griglia crucinumero -->
      <div class="flex justify-center items-start">
        <div class="inline-grid grid-cols-5 gap-0 border-4 border-cyan-400 rounded-lg overflow-hidden" style="grid-template-rows: repeat(5, 1fr);">
          <!-- Riga 1 -->
          <div class="w-16 h-16 bg-blue-200 border border-cyan-300"></div>
          <div class="w-16 h-16 bg-blue-200 border border-cyan-300"></div>
          <div class="w-16 h-16 bg-blue-200 border border-cyan-300"></div>
          <div class="w-16 h-16 bg-white border border-cyan-300 relative">
            <input type="text" data-fill-blanks-target="input" data-correct-answer="4"
                   class="w-full h-full text-center font-bold text-2xl border-0 focus:bg-yellow-50"
                   maxlength="1" inputmode="numeric">
            <span class="absolute top-0 left-0.5 text-[10px] font-bold text-red-600">1</span>
          </div>
          <div class="w-16 h-16 bg-blue-200 border border-cyan-300"></div>

          <!-- Riga 2 -->
          <div class="w-16 h-16 bg-blue-200 border border-cyan-300"></div>
          <div class="w-16 h-16 bg-blue-200 border border-cyan-300"></div>
          <div class="w-16 h-16 bg-blue-200 border border-cyan-300"></div>
          <div class="w-16 h-16 bg-white border border-cyan-300 relative">
            <input type="text" data-fill-blanks-target="input" data-correct-answer="6"
                   class="w-full h-full text-center font-bold text-2xl border-0 focus:bg-yellow-50"
                   maxlength="1" inputmode="numeric">
          </div>
          <div class="w-16 h-16 bg-blue-200 border border-cyan-300"></div>

          <!-- Riga 3 -->
          <div class="w-16 h-16 bg-blue-200 border border-cyan-300"></div>
          <div class="w-16 h-16 bg-white border border-cyan-300 relative">
            <input type="text" data-fill-blanks-target="input" data-correct-answer="3"
                   class="w-full h-full text-center font-bold text-2xl border-0 focus:bg-yellow-50"
                   maxlength="1" inputmode="numeric">
            <span class="absolute top-0 left-0.5 text-[10px] font-bold text-blue-600">2</span>
          </div>
          <div class="w-16 h-16 bg-white border border-cyan-300 relative">
            <input type="text" data-fill-blanks-target="input" data-correct-answer="6"
                   class="w-full h-full text-center font-bold text-2xl border-0 focus:bg-yellow-50"
                   maxlength="1" inputmode="numeric">
            <span class="absolute top-0 left-0.5 text-[10px] font-bold text-red-600">3</span>
          </div>
          <div class="w-16 h-16 bg-white border border-cyan-300 relative">
            <input type="text" data-fill-blanks-target="input" data-correct-answer="1"
                   class="w-full h-full text-center font-bold text-2xl border-0 focus:bg-yellow-50"
                   maxlength="1" inputmode="numeric">
          </div>
          <div class="w-16 h-16 bg-blue-200 border border-cyan-300"></div>

          <!-- Riga 4 -->
          <div class="w-16 h-16 bg-blue-200 border border-cyan-300"></div>
          <div class="w-16 h-16 bg-white border border-cyan-300 relative">
            <input type="text" data-fill-blanks-target="input" data-correct-answer="0"
                   class="w-full h-full text-center font-bold text-2xl border-0 focus:bg-yellow-50"
                   maxlength="1" inputmode="numeric">
          </div>
          <div class="w-16 h-16 bg-white border border-cyan-300 relative">
            <input type="text" data-fill-blanks-target="input" data-correct-answer="1"
                   class="w-full h-full text-center font-bold text-2xl border-0 focus:bg-yellow-50"
                   maxlength="1" inputmode="numeric">
          </div>
          <div class="w-16 h-16 bg-white border border-cyan-300 relative">
            <input type="text" data-fill-blanks-target="input" data-correct-answer="7"
                   class="w-full h-full text-center font-bold text-2xl border-0 focus:bg-yellow-50"
                   maxlength="1" inputmode="numeric">
          </div>
          <div class="w-16 h-16 bg-blue-200 border border-cyan-300"></div>

          <!-- Riga 5 -->
          <div class="w-16 h-16 bg-white border border-cyan-300 relative">
            <input type="text" data-fill-blanks-target="input" data-correct-answer="8"
                   class="w-full h-full text-center font-bold text-2xl border-0 focus:bg-yellow-50"
                   maxlength="1" inputmode="numeric">
            <span class="absolute top-0 left-0.5 text-[10px] font-bold text-blue-600">4</span>
          </div>
          <div class="w-16 h-16 bg-white border border-cyan-300 relative">
            <input type="text" data-fill-blanks-target="input" data-correct-answer="1"
                   class="w-full h-full text-center font-bold text-2xl border-0 focus:bg-yellow-50"
                   maxlength="1" inputmode="numeric">
          </div>
          <div class="w-16 h-16 bg-white border border-cyan-300 relative">
            <input type="text" data-fill-blanks-target="input" data-correct-answer="9"
                   class="w-full h-full text-center font-bold text-2xl border-0 focus:bg-yellow-50"
                   maxlength="1" inputmode="numeric">
          </div>
          <div class="w-16 h-16 bg-blue-200 border border-cyan-300"></div>
          <div class="w-16 h-16 bg-blue-200 border border-cyan-300"></div>
        </div>
      </div>
    </div>
  </div>

  <!-- Quaderno link allineato a destra -->
  <div class="p-4 mb-8 text-right">
    <span class="text-gray-600">Quaderno →</span> <%= link_to "p. 140", pagina_path("bus3_mat_p140"), class: "text-cyan-600 font-bold hover:underline" %>
  </div>

  <!-- Footer con controlli -->
  <%= render 'shared/exercise_controls', color: 'cyan' %>
</div>
