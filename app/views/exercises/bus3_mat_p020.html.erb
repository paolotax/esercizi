<div class="max-w-[1800px] mx-auto p-4 lg:p-8"
     data-controller="exercise-checker fill-blanks hotspot-editor auto-advance text-toggle font-controls"
     data-text-toggle-target="content"
     data-font-controls-target="content">

  <!-- Header (se disponibile) -->
  <% if @pagina.present? %>
    <%= render 'shared/page_header', pagina: @pagina %>
  <% end %>

  <!-- Two-page horizontal layout like an open book -->
  <div class="grid lg:grid-cols-2 gap-3 lg:gap-0">

    <!-- LEFT PAGE - Page 20 -->
    <div class="relative" data-hotspot-editor-target="container">
      <%= image_tag "bus3_mat/p020/page.png",
            alt: "Pagina 20",
            class: "w-full h-auto select-none pointer-events-none" %>

      <!-- Input overlay per gli esercizi di pagina 20 -->
      <div class="absolute inset-0">
        <%
        # Definizione posizioni input per pagina 20
        # TODO: Aggiungere le posizioni degli input
        inputs_p20 = [
          # Esempi da personalizzare:
          { label: "Risposta 1",top: "42.6999%", left: "18.1826%", width: "8.95288%", height: "2.90273%", answer: "1642" },
          { label: "Risposta 2", top: "57.758%", left: "56.9259%", width: "13.4405%", height: "2.65599%", answer: "9815" },
          { label: "Risposta 3", top: "76.2704%", left: "16.2378%", width: "12.543%", height: "2.90273%", answer: "0" },
          { label: "Risposta 4", top: "82.6927%", left: "77.7188%", width: "7.75617%", height: "3.76631%" , answer: "400" },
        ]
        %>

        <% inputs_p20.each do |input| %>
          <div class="absolute"
               style="top: <%= input[:top] %>; left: <%= input[:left] %>; width: <%= input[:width] %>; height: <%= input[:height] %>;"
               data-hotspot-editor-target="hotspot"
               data-auto-advance-target="input"
               data-action="mousedown->hotspot-editor#startDrag">
            <input type="text"
                   data-fill-blanks-target="input"
                   data-correct-answer="<%= input[:answer] %>"
                   class="w-full h-full py-2 bg-white/60 hover:bg-white/80 focus:bg-white border-2 text-black border-transparent hover:border-purple-500 focus:border-purple-600 rounded text-center font-bold transition-colors"
                   maxlength="<%= input[:answer].to_s.length %>"
                   inputmode="<%= input[:answer].to_s.match?(/^\d+$/) ? 'numeric' : 'text' %>"
                   pattern="<%= input[:answer].to_s.match?(/^\d+$/) ? '[0-9]*' : '[A-Za-z ]*' %>"
                   aria-label="<%= input[:label] %>">
          </div>
        <% end %>
      </div>
    </div>


    <!-- RIGHT PAGE - Page 21 -->
    <div class="relative" data-hotspot-editor-target="container">
      <%= image_tag "bus3_mat/p021/page.png",
            alt: "Pagina 21",
            class: "w-full h-auto select-none pointer-events-none" %>

      <!-- Input overlay per gli esercizi di pagina 21 -->
      <div class="absolute inset-0">
        <%
        # Definizione posizioni input per pagina 21
        # TODO: Aggiungere le posizioni degli input
        inputs_p21 = [
          # Esempi da personalizzare:
          
          { label: "Risposta 5", top: "15.0938%", left: "15.6395%", width: "13.8893%", height: "3.27284%", answer: "1738" },
          { label: "Risposta 6", top: "25.4638%", left: "68.8931%", width: "11.0471%", height: "2.40926%", answer: "1000" },
          { label: "Risposta 7", top: "43.1127%", left: "15.9387%", width: "13.2909%", height: "2.65599%", answer: "8530" },
          { label: "Risposta 8", top: "57.4306%", left: "70.0898%", width: "8.6537%", height: "3.0261%", answer: "4023" },

        ]
        %>

        <% inputs_p21.each do |input| %>
          <div class="absolute"
               style="top: <%= input[:top] %>; left: <%= input[:left] %>; width: <%= input[:width] %>; height: <%= input[:height] %>;"
               data-hotspot-editor-target="hotspot"
               data-auto-advance-target="input"
               data-action="mousedown->hotspot-editor#startDrag">
            <input type="text"
                   data-fill-blanks-target="input"
                   data-correct-answer="<%= input[:answer] %>"
                   class="w-full h-full py-2 bg-white/60 hover:bg-white/80 focus:bg-white border-2 text-black border-transparent hover:border-purple-500 focus:border-purple-600 rounded text-center font-bold transition-colors"
                   maxlength="<%= input[:answer].to_s.length %>"
                   inputmode="<%= input[:answer].to_s.match?(/^\d+$/) ? 'numeric' : 'text' %>"
                   pattern="<%= input[:answer].to_s.match?(/^\d+$/) ? '[0-9]*' : '[A-Za-z ]*' %>"
                   aria-label="<%= input[:label] %>">
          </div>
        <% end %>
      </div>
    </div>

  </div>

  <%= render 'shared/exercise_controls' %>
</div>
