<div class="max-w-6xl mx-auto p-3 md:p-8 bg-gradient-to-br from-purple-50 via-white to-pink-50 rounded-3xl shadow-xl" data-controller="exercise-checker">

  <!-- Header -->
  <div class="mb-8">
    <div class="flex items-start sm:items-center justify-between gap-4 mb-4">
      <div class="flex flex-col-reverse sm:flex-row items-start sm:items-center gap-2 sm:gap-4">
        <div class="bg-purple-600 text-white text-md sm:text-xl px-2 sm:px-4 py-1.5 sm:py-2 rounded-lg font-bold">
          VERIFICA
        </div>
        <h1 class="text-2xl sm:text-3xl font-bold text-purple-600">Aggettivi e pronomi</h1>
      </div>
      <div class="flex-shrink-0 bg-red-600 text-white rounded-full w-10 h-10 sm:w-12 sm:h-12 flex items-center justify-center font-bold text-lg sm:text-xl">
        64
      </div>
    </div>
  </div>

  <!-- Nota consulta mappe -->
  <div class="mb-6 bg-blue-50 border-3 border-blue-300 rounded-xl p-4">
    <p class="text-base md:text-lg text-gray-700 font-semibold">
      Consulta le pp. 3-5 del blocco mappe.
    </p>
  </div>

  <!-- Exercise 1 -->
  <div class="mb-6 bg-white rounded-2xl border-4 border-blue-200 shadow-2xl p-4 md:p-6">
    <h2 class="text-lg md:text-xl font-bold text-blue-700 mb-4">
      <span class="bg-blue-600 text-white rounded-full w-8 h-8 md:w-10 md:h-10 inline-flex items-center justify-center mr-2">1</span>
      Sottolinea aggettivi qualificativi nelle quattro frasi.
    </h2>

    <div class="space-y-3 text-base md:text-lg">
      <div class="bg-blue-50 border-2 border-blue-200 rounded-xl px-4 py-3">
        <p class="text-gray-700">• Il <mark class="bg-yellow-200">bel</mark> vestito è in vetrina.</p>
      </div>
      <div class="bg-blue-50 border-2 border-blue-200 rounded-xl px-4 py-3">
        <p class="text-gray-700">• La <mark class="bg-yellow-200">nuova</mark> insegnante è molto <mark class="bg-yellow-200">simpatica</mark>.</p>
      </div>
      <div class="bg-blue-50 border-2 border-blue-200 rounded-xl px-4 py-3">
        <p class="text-gray-700">• Ho comprato dei <mark class="bg-yellow-200">bellissimi</mark> fiori <mark class="bg-yellow-200">profumati</mark>.</p>
      </div>
      <div class="bg-blue-50 border-2 border-blue-200 rounded-xl px-4 py-3">
        <p class="text-gray-700">• La giornata <mark class="bg-yellow-200">piovosa</mark> mi rende <mark class="bg-yellow-200">triste</mark>.</p>
      </div>
    </div>
  </div>

  <!-- Exercise 2 -->
  <div class="mb-6 bg-white rounded-2xl border-4 border-green-200 shadow-2xl p-4 md:p-6">
    <h2 class="text-lg md:text-xl font-bold text-green-700 mb-4">
      <span class="bg-green-600 text-white rounded-full w-8 h-8 md:w-10 md:h-10 inline-flex items-center justify-center mr-2">2</span>
      Sottolinea pronomi personali soggetto e cerchia quelli complemento.
    </h2>

    <div class="space-y-3 text-base md:text-lg">
      <div class="bg-green-50 border-2 border-green-200 rounded-xl px-4 py-3">
        <p class="text-gray-700">• <mark class="bg-yellow-200">Io</mark> <span class="border-2 border-green-600 rounded px-1">ti</span> aspetto domani.</p>
      </div>
      <div class="bg-green-50 border-2 border-green-200 rounded-xl px-4 py-3">
        <p class="text-gray-700">• <mark class="bg-yellow-200">Tu</mark> <span class="border-2 border-green-600 rounded px-1">mi</span> hai chiamato ieri sera.</p>
      </div>
      <div class="bg-green-50 border-2 border-green-200 rounded-xl px-4 py-3">
        <p class="text-gray-700">• <mark class="bg-yellow-200">Lei</mark> <span class="border-2 border-green-600 rounded px-1">ci</span> ha regalato un libro.</p>
      </div>
      <div class="bg-green-50 border-2 border-green-200 rounded-xl px-4 py-3">
        <p class="text-gray-700">• <mark class="bg-yellow-200">Noi</mark> <span class="border-2 border-green-600 rounded px-1">li</span> abbiamo incontrati al parco.</p>
      </div>
    </div>
  </div>

  <!-- Exercise 3 -->
  <div class="mb-6 bg-white rounded-2xl border-4 border-purple-200 shadow-2xl p-4 md:p-6" data-controller="fill-blanks">
    <h2 class="text-lg md:text-xl font-bold text-purple-700 mb-4">
      <span class="bg-purple-600 text-white rounded-full w-8 h-8 md:w-10 md:h-10 inline-flex items-center justify-center mr-2">3</span>
      Completa con aggettivi/pronomi possessivi, poi indica A o P.
    </h2>

    <div class="space-y-3 text-base md:text-lg">
      <% ap_items = [
        { text: "La", answer: "mia", continuation: "casa è grande.", correct: "A" },
        { text: "Il", answer: "tuo", continuation: "libro è interessante.", correct: "A" },
        { text: "Ho perso la penna, ho bisogno della", answer: "tua", continuation: ".", correct: "P" }
      ] %>

      <% ap_items.each_with_index do |item, index| %>
        <div class="bg-purple-50 border-2 border-purple-200 rounded-xl px-4 py-3">
          <div class="flex flex-col md:flex-row md:items-center gap-3">
            <div class="flex-1">
              <p class="text-gray-700">
                • <%= item[:text] %>
                <input type="text"
                       class="border-b-2 border-purple-500 bg-transparent px-2 py-1 w-24 focus:outline-none"
                       data-fill-blanks-target="input"
                       data-answer="<%= item[:answer] %>"
                       data-correct-answer="<%= item[:answer] %>"
                       placeholder=".....">
                <%= item[:continuation] %>
              </p>
            </div>
            <div class="flex gap-2">
              <label class="inline-flex items-center gap-1">
                <input type="radio" name="ap_<%= index %>" value="A" class="w-4 h-4">
                <span class="bg-red-200 text-red-700 font-bold px-3 py-1 rounded">A</span>
              </label>
              <label class="inline-flex items-center gap-1">
                <input type="radio" name="ap_<%= index %>" value="P" class="w-4 h-4">
                <span class="bg-blue-200 text-blue-700 font-bold px-3 py-1 rounded">P</span>
              </label>
            </div>
          </div>
        </div>
      <% end %>
    </div>
  </div>

  <!-- Exercise 4 -->
  <div class="mb-6 bg-white rounded-2xl border-4 border-orange-200 shadow-2xl p-4 md:p-6">
    <h2 class="text-lg md:text-xl font-bold text-orange-700 mb-4">
      <span class="bg-orange-600 text-white rounded-full w-8 h-8 md:w-10 md:h-10 inline-flex items-center justify-center mr-2">4</span>
      Sottolinea una volta aggettivi dimostrativi e due volte i pronomi dimostrativi.
    </h2>

    <div class="space-y-3 text-base md:text-lg">
      <div class="bg-orange-50 border-2 border-orange-200 rounded-xl px-4 py-3">
        <p class="text-gray-700">• <mark class="bg-yellow-200">Questo</mark> libro è bello, ma preferisco <mark class="bg-yellow-200 underline decoration-double">quello</mark>.</p>
      </div>
      <div class="bg-orange-50 border-2 border-orange-200 rounded-xl px-4 py-3">
        <p class="text-gray-700">• <mark class="bg-yellow-200">Questa</mark> matita è <mark class="bg-yellow-200">la stessa</mark> di ieri.</p>
      </div>
      <div class="bg-orange-50 border-2 border-orange-200 rounded-xl px-4 py-3">
        <p class="text-gray-700">• <mark class="bg-yellow-200">Queste</mark> scarpe sono comode, <mark class="bg-yellow-200 underline decoration-double">quelle</mark> no.</p>
      </div>
    </div>
  </div>

  <!-- Exercise 5 -->
  <div class="mb-6 bg-white rounded-2xl border-4 border-pink-200 shadow-2xl p-4 md:p-6">
    <h2 class="text-lg md:text-xl font-bold text-pink-700 mb-4">
      <span class="bg-pink-600 text-white rounded-full w-8 h-8 md:w-10 md:h-10 inline-flex items-center justify-center mr-2">5</span>
      Sottolinea tutti gli indefiniti nel testo sulla spiaggia nascosta.
    </h2>

    <div class="bg-pink-50 border-2 border-pink-200 rounded-xl px-4 py-3">
      <p class="text-base md:text-lg text-gray-700 leading-relaxed">
        Un giorno, <mark class="bg-yellow-200">alcuni</mark> amici decisero di andare alla spiaggia.
        <mark class="bg-yellow-200">Qualcuno</mark> aveva sentito parlare di una spiaggia nascosta dove
        <mark class="bg-yellow-200">nessuno</mark> andava mai. <mark class="bg-yellow-200">Tutti</mark> erano
        entusiasti dell'idea. <mark class="bg-yellow-200">Ciascuno</mark> portò <mark class="bg-yellow-200">qualcosa</mark>
        da mangiare e <mark class="bg-yellow-200">ognuno</mark> si divertì molto. Non c'era
        <mark class="bg-yellow-200">niente</mark> di meglio che trascorrere una giornata così bella insieme.
      </p>
    </div>
  </div>

  <!-- Exercise 6 -->
  <div class="mb-6 bg-white rounded-2xl border-4 border-cyan-200 shadow-2xl p-4 md:p-6">
    <h2 class="text-lg md:text-xl font-bold text-cyan-700 mb-4">
      <span class="bg-cyan-600 text-white rounded-full w-8 h-8 md:w-10 md:h-10 inline-flex items-center justify-center mr-2">6</span>
      Scrivi due frasi per ciascuno: "che" e "quanto" (prima aggettivo, poi pronome).
    </h2>

    <div class="space-y-4">
      <div class="bg-cyan-50 border-2 border-cyan-200 rounded-xl px-4 py-3">
        <p class="font-semibold text-gray-700 mb-2">"che" - aggettivo:</p>
        <textarea class="w-full border-2 border-cyan-300 rounded-lg px-3 py-2 focus:outline-none"
                  rows="2" placeholder="Scrivi qui..."></textarea>
      </div>

      <div class="bg-cyan-50 border-2 border-cyan-200 rounded-xl px-4 py-3">
        <p class="font-semibold text-gray-700 mb-2">"che" - pronome:</p>
        <textarea class="w-full border-2 border-cyan-300 rounded-lg px-3 py-2 focus:outline-none"
                  rows="2" placeholder="Scrivi qui..."></textarea>
      </div>

      <div class="bg-cyan-50 border-2 border-cyan-200 rounded-xl px-4 py-3">
        <p class="font-semibold text-gray-700 mb-2">"quanto" - aggettivo:</p>
        <textarea class="w-full border-2 border-cyan-300 rounded-lg px-3 py-2 focus:outline-none"
                  rows="2" placeholder="Scrivi qui..."></textarea>
      </div>

      <div class="bg-cyan-50 border-2 border-cyan-200 rounded-xl px-4 py-3">
        <p class="font-semibold text-gray-700 mb-2">"quanto" - pronome:</p>
        <textarea class="w-full border-2 border-cyan-300 rounded-lg px-3 py-2 focus:outline-none"
                  rows="2" placeholder="Scrivi qui..."></textarea>
      </div>
    </div>
  </div>

  <!-- Exercise 7 -->
  <div class="mb-6 bg-white rounded-2xl border-4 border-indigo-200 shadow-2xl p-4 md:p-6" data-controller="multiple-choice">
    <h2 class="text-lg md:text-xl font-bold text-indigo-700 mb-4">
      <span class="bg-indigo-600 text-white rounded-full w-8 h-8 md:w-10 md:h-10 inline-flex items-center justify-center mr-2">7</span>
      Completa tre frasi scegliendo il pronome relativo corretto tra che/le quali/cui.
    </h2>

    <div class="space-y-3 text-base md:text-lg">
      <% relative_sentences = [
        { before: "La ragazza", options: ["che", "cui", "la quale"], correct: "che", after: "hai incontrato è mia sorella." },
        { before: "Il libro di", options: ["che", "cui", "il quale"], correct: "cui", after: "ti ho parlato è interessante." },
        { before: "Le amiche", options: ["che", "cui", "le quali"], correct: "le quali", after: "sono venute alla festa si sono divertite." }
      ] %>

      <% relative_sentences.each_with_index do |item, index| %>
        <div class="bg-indigo-50 border-2 border-indigo-200 rounded-xl px-4 py-3">
          <p class="text-gray-700 flex flex-wrap items-center gap-2">
            • <%= item[:before] %>
            <% item[:options].each do |option| %>
              <label class="inline-flex items-center gap-1 cursor-pointer">
                <input type="radio"
                       name="rel_<%= index %>"
                       value="<%= option %>"
                       class="w-4 h-4"
                       data-multiple-choice-target="input"
                       data-answer="<%= item[:correct] %>">
                <span class="font-semibold"><%= option %></span>
              </label>
            <% end %>
            <%= item[:after] %>
          </p>
        </div>
      <% end %>
    </div>
  </div>

  <%= render partial: "shared/exercise_controls" %>

</div>
