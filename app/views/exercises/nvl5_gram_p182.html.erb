<div class="max-w-6xl mx-auto p-3 md:p-8 bg-gradient-to-br from-cyan-50 via-white to-blue-50 rounded-3xl shadow-xl" data-controller="exercise-checker">

  <!-- Header -->
  <div class="mb-8">
    <div class="flex items-start sm:items-center justify-between gap-4 mb-4">
      <div class="flex flex-col-reverse sm:flex-row items-start sm:items-center gap-2 sm:gap-4">
        <div class="bg-cyan-500 text-white text-md sm:text-xl px-2 sm:px-4 py-1.5 sm:py-2 rounded-lg font-bold">
          SINTASSI
        </div>
        <h1 class="text-2xl sm:text-3xl font-bold text-cyan-600">Il soggetto e il predicato</h1>
      </div>
      <div class="flex-shrink-0 bg-cyan-600 text-white rounded-full w-10 h-10 sm:w-12 sm:h-12 flex items-center justify-center font-bold text-lg sm:text-xl">
        182
      </div>
    </div>
  </div>

  <!-- Exercise 1: Circle predicate and underline subject -->
  <div class="mb-6 bg-white rounded-2xl border-4 border-yellow-200 shadow-2xl p-4 md:p-6" data-controller="word-highlighter" data-word-highlighter-multi-color-value="true">
    <h2 class="text-lg md:text-xl font-bold text-yellow-700 mb-3">
      <div class="flex items-center gap-2 flex-wrap">
        <div class="flex items-center gap-2">
          <span class="bg-yellow-600 text-white rounded-full w-8 h-8 md:w-10 md:h-10 inline-flex items-center justify-center flex-shrink-0">1</span>
          <span class="bg-yellow-400 text-blue-800 px-2 py-1 rounded text-sm md:text-base font-bold whitespace-nowrap">IMPARARE TUTTI</span>
        </div>
        <span>Cerchia il <span class="text-pink-600 font-bold">predicato<span class="inline-block w-6 h-6 bg-pink-300 rounded-full ml-1 align-middle cursor-pointer transition transform hover:scale-110" data-word-highlighter-target="colorBox" data-color="pink" data-action="click->word-highlighter#selectColor"></span></span> e sottolinea il <span class="text-blue-600 font-bold">soggetto<span class="inline-block w-6 h-6 bg-blue-300 rounded ml-1 align-middle cursor-pointer transition transform hover:scale-110" data-word-highlighter-target="colorBox" data-color="blue" data-action="click->word-highlighter#selectColor"></span></span>.</span>
      </div>
    </h2>

    <div class="grid grid-cols-1 md:grid-cols-2 gap-3 text-base md:text-lg cursor-pointer">
      <div class="bg-yellow-50 border-2 border-yellow-200 rounded-xl px-4 py-3">
        • <span data-word-highlighter-target="word" data-correct-color="blue" data-action="click->word-highlighter#toggleHighlight" class="px-1 rounded">Giacomo</span> <span data-word-highlighter-target="word" data-correct-color="pink" data-action="click->word-highlighter#toggleHighlight" class="px-1 rounded">mangia</span> una mela.
      </div>
      <div class="bg-yellow-50 border-2 border-yellow-200 rounded-xl px-4 py-3">
        • <span data-word-highlighter-target="word" data-correct-color="blue" data-action="click->word-highlighter#toggleHighlight" class="px-1 rounded">Emma</span> <span data-word-highlighter-target="word" data-correct-color="pink" data-action="click->word-highlighter#toggleHighlight" class="px-1 rounded">è</span> una ballerina di danza classica.
      </div>
      <div class="bg-yellow-50 border-2 border-yellow-200 rounded-xl px-4 py-3">
        • <span data-word-highlighter-target="word" data-correct-color="blue" data-action="click->word-highlighter#toggleHighlight" class="px-1 rounded">Luigi</span> <span data-word-highlighter-target="word" data-correct-color="pink" data-action="click->word-highlighter#toggleHighlight" class="px-1 rounded">gioca</span> a calcio.
      </div>
      <div class="bg-yellow-50 border-2 border-yellow-200 rounded-xl px-4 py-3">
        • <span data-word-highlighter-target="word" data-correct-color="blue" data-action="click->word-highlighter#toggleHighlight" class="px-1 rounded">Samuele</span> <span data-word-highlighter-target="word" data-correct-color="pink" data-action="click->word-highlighter#toggleHighlight" class="px-1 rounded">ama</span> lo sport.
      </div>
      <div class="bg-yellow-50 border-2 border-yellow-200 rounded-xl px-4 py-3">
        • <span data-word-highlighter-target="word" data-correct-color="blue" data-action="click->word-highlighter#toggleHighlight" class="px-1 rounded">Agnese</span> <span data-word-highlighter-target="word" data-correct-color="pink" data-action="click->word-highlighter#toggleHighlight" class="px-1 rounded">legge</span> molti libri.
      </div>
      <div class="bg-yellow-50 border-2 border-yellow-200 rounded-xl px-4 py-3">
        • <span data-word-highlighter-target="word" data-correct-color="blue" data-action="click->word-highlighter#toggleHighlight" class="px-1 rounded">Bianca</span> <span data-word-highlighter-target="word" data-correct-color="pink" data-action="click->word-highlighter#toggleHighlight" class="px-1 rounded">è</span> una farmacista.
      </div>
    </div>
  </div>

  <!-- Exercise 2: Identify implied subject -->
  <div class="mb-6 bg-white rounded-2xl border-4 border-purple-200 shadow-2xl p-4 md:p-6" data-controller="multiple-choice">
    <h2 class="text-lg md:text-xl font-bold text-purple-700 mb-3">
      <span class="bg-purple-600 text-white rounded-full w-8 h-8 md:w-10 md:h-10 inline-flex items-center justify-center flex-shrink-0 mr-2">2</span>
      Quale tra le seguenti frasi ha il <span class="text-purple-600 font-bold">soggetto sottinteso</span>? Indicala con una X.
    </h2>

    <div class="space-y-3 text-base md:text-lg">
      <label class="flex items-start gap-3 bg-purple-50 border-2 border-purple-200 rounded-xl px-4 py-3 cursor-pointer hover:bg-purple-100 transition">
        <input type="checkbox" data-multiple-choice-target="option" data-correct="false" class="mt-1 w-5 h-5">
        <span>In primavera si risveglia la natura.</span>
      </label>
      <label class="flex items-start gap-3 bg-purple-50 border-2 border-purple-200 rounded-xl px-4 py-3 cursor-pointer hover:bg-purple-100 transition">
        <input type="checkbox" data-multiple-choice-target="option" data-correct="true" class="mt-1 w-5 h-5">
        <span>Eravamo in montagna con zio Manlio.</span>
      </label>
      <label class="flex items-start gap-3 bg-purple-50 border-2 border-purple-200 rounded-xl px-4 py-3 cursor-pointer hover:bg-purple-100 transition">
        <input type="checkbox" data-multiple-choice-target="option" data-correct="false" class="mt-1 w-5 h-5">
        <span>I miei cugini comprano delle magliette rosse.</span>
      </label>
      <label class="flex items-start gap-3 bg-purple-50 border-2 border-purple-200 rounded-xl px-4 py-3 cursor-pointer hover:bg-purple-100 transition">
        <input type="checkbox" data-multiple-choice-target="option" data-correct="false" class="mt-1 w-5 h-5">
        <span>Questa torta è stata preparata da Giulia.</span>
      </label>
    </div>
  </div>

  <!-- Exercise 3: Write subjects -->
  <div class="mb-6 bg-white rounded-2xl border-4 border-green-200 shadow-2xl p-4 md:p-6" data-controller="fill-blanks">
    <h2 class="text-lg md:text-xl font-bold text-green-700 mb-3">
      <span class="bg-green-600 text-white rounded-full w-8 h-8 md:w-10 md:h-10 inline-flex items-center justify-center flex-shrink-0 mr-2">3</span>
      Scrivi due <span class="text-green-600 font-bold">soggetti</span> per ogni predicato.
    </h2>

    <div class="grid grid-cols-1 md:grid-cols-2 gap-3 text-base md:text-lg">
      <% ["salta", "è veloce", "è finita"].each do |predicate| %>
        <% 2.times do |i| %>
          <div class="bg-green-50 border-2 border-green-200 rounded-xl px-4 py-3">
            <div class="flex items-center gap-2">
              <span>•</span>
              <input type="text" class="border-b-2 border-green-500 bg-transparent px-2 py-1 focus:outline-none focus:border-green-700 flex-1" data-fill-blanks-target="input" placeholder="">
              <span class="text-gray-700"><%= predicate %>.</span>
            </div>
          </div>
        <% end %>
      <% end %>
    </div>
  </div>

  <!-- Exercise 4: Underline subject, circle predicates -->
  <div class="mb-6 bg-white rounded-2xl border-4 border-red-200 shadow-2xl p-4 md:p-6" data-controller="word-highlighter" data-word-highlighter-multi-color-value="true">
    <h2 class="text-lg md:text-xl font-bold text-red-700 mb-3">
      <span class="bg-red-600 text-white rounded-full w-8 h-8 md:w-10 md:h-10 inline-flex items-center justify-center flex-shrink-0 mr-2">4</span>
      Sottolinea il <span class="text-blue-600 font-bold">soggetto<span class="inline-block w-6 h-6 bg-blue-300 rounded ml-1 align-middle cursor-pointer transition transform hover:scale-110" data-word-highlighter-target="colorBox" data-color="blue" data-action="click->word-highlighter#selectColor"></span></span>, cerchia in rosso i <span class="text-red-600 font-bold">predicati nominali<span class="inline-block w-6 h-6 bg-red-300 rounded-full ml-1 align-middle cursor-pointer transition transform hover:scale-110" data-word-highlighter-target="colorBox" data-color="red" data-action="click->word-highlighter#selectColor"></span></span> e in blu i <span class="text-purple-600 font-bold">predicati verbali<span class="inline-block w-6 h-6 bg-purple-300 rounded-full ml-1 align-middle cursor-pointer transition transform hover:scale-110" data-word-highlighter-target="colorBox" data-color="purple" data-action="click->word-highlighter#selectColor"></span></span>.
    </h2>

    <div class="grid grid-cols-1 md:grid-cols-2 gap-3 text-base md:text-lg cursor-pointer">
      <div class="bg-red-50 border-2 border-red-200 rounded-xl px-4 py-3">
        • Oggi <span data-word-highlighter-target="word" data-correct-color="purple" data-action="click->word-highlighter#toggleHighlight" class="px-1 rounded">arrivano</span> <span data-word-highlighter-target="word" data-correct-color="blue" data-action="click->word-highlighter#toggleHighlight" class="px-1 rounded">i miei cugini</span> da Roma.
      </div>
      <div class="bg-red-50 border-2 border-red-200 rounded-xl px-4 py-3">
        • Sicuramente <span data-word-highlighter-target="word" data-correct-color="blue" data-action="click->word-highlighter#toggleHighlight" class="px-1 rounded">tu</span> <span data-word-highlighter-target="word" data-correct-color="red" data-action="click->word-highlighter#toggleHighlight" class="px-1 rounded">sei</span> un bambino tranquillo.
      </div>
      <div class="bg-red-50 border-2 border-red-200 rounded-xl px-4 py-3">
        • <span data-word-highlighter-target="word" data-correct-color="purple" data-action="click->word-highlighter#toggleHighlight" class="px-1 rounded">Ti telefonerà</span> <span data-word-highlighter-target="word" data-correct-color="blue" data-action="click->word-highlighter#toggleHighlight" class="px-1 rounded">mio padre</span>.
      </div>
      <div class="bg-red-50 border-2 border-red-200 rounded-xl px-4 py-3">
        • <span data-word-highlighter-target="word" data-correct-color="blue" data-action="click->word-highlighter#toggleHighlight" class="px-1 rounded">Camminare</span> <span data-word-highlighter-target="word" data-correct-color="purple" data-action="click->word-highlighter#toggleHighlight" class="px-1 rounded">fa</span> bene.
      </div>
      <div class="bg-red-50 border-2 border-red-200 rounded-xl px-4 py-3">
        • <span data-word-highlighter-target="word" data-correct-color="blue" data-action="click->word-highlighter#toggleHighlight" class="px-1 rounded">Lei</span> <span data-word-highlighter-target="word" data-correct-color="red" data-action="click->word-highlighter#toggleHighlight" class="px-1 rounded">è</span> la fidanzata di mio fratello.
      </div>
      <div class="bg-red-50 border-2 border-red-200 rounded-xl px-4 py-3">
        • <span data-word-highlighter-target="word" data-correct-color="blue" data-action="click->word-highlighter#toggleHighlight" class="px-1 rounded">I Romani</span> <span data-word-highlighter-target="word" data-correct-color="red" data-action="click->word-highlighter#toggleHighlight" class="px-1 rounded">furono</span> un popolo di conquistatori.
      </div>
      <div class="bg-red-50 border-2 border-red-200 rounded-xl px-4 py-3">
        • Alle otto <span data-word-highlighter-target="word" data-correct-color="purple" data-action="click->word-highlighter#toggleHighlight" class="px-1 rounded">iniziano</span> <span data-word-highlighter-target="word" data-correct-color="blue" data-action="click->word-highlighter#toggleHighlight" class="px-1 rounded">le lezioni</span>.
      </div>
      <div class="bg-red-50 border-2 border-red-200 rounded-xl px-4 py-3">
        • Più tardi <span data-word-highlighter-target="word" data-correct-color="blue" data-action="click->word-highlighter#toggleHighlight" class="px-1 rounded">io</span> <span data-word-highlighter-target="word" data-correct-color="purple" data-action="click->word-highlighter#toggleHighlight" class="px-1 rounded">esco</span>.
      </div>
      <div class="bg-red-50 border-2 border-red-200 rounded-xl px-4 py-3">
        • "<span data-word-highlighter-target="word" data-correct-color="blue" data-action="click->word-highlighter#toggleHighlight" class="px-1 rounded">Grande</span>" <span data-word-highlighter-target="word" data-correct-color="red" data-action="click->word-highlighter#toggleHighlight" class="px-1 rounded">è</span> il contrario di "piccolo".
      </div>
      <div class="bg-red-50 border-2 border-red-200 rounded-xl px-4 py-3">
        • A quel tempo <span data-word-highlighter-target="word" data-correct-color="blue" data-action="click->word-highlighter#toggleHighlight" class="px-1 rounded">i miei nonni</span> <span data-word-highlighter-target="word" data-correct-color="red" data-action="click->word-highlighter#toggleHighlight" class="px-1 rounded">erano</span> bambini.
      </div>
    </div>
  </div>

  <!-- Exercise 5: PV or PN -->
  <div class="mb-6 bg-white rounded-2xl border-4 border-orange-200 shadow-2xl p-4 md:p-6" data-controller="word-highlighter multiple-choice" data-word-highlighter-multi-color-value="false">
    <h2 class="text-lg md:text-xl font-bold text-orange-700 mb-3">
      <span class="bg-orange-600 text-white rounded-full w-8 h-8 md:w-10 md:h-10 inline-flex items-center justify-center flex-shrink-0 mr-2">5</span>
      Sottolinea il predicato<span class="inline-block w-6 h-6 bg-orange-300 rounded ml-1 align-middle cursor-pointer transition transform hover:scale-110" data-word-highlighter-target="colorBox" data-color="orange" data-action="click->word-highlighter#selectColor"></span> e indica con una X se si tratta di un <span class="text-orange-600 font-bold">predicato verbale</span> (PV) o di un <span class="text-orange-600 font-bold">predicato nominale</span> (PN).
    </h2>

    <div class="grid grid-cols-1 md:grid-cols-2 gap-3 text-base md:text-lg">
      <% [
        { text: "La mamma è uscita.", predicate: "è uscita", type: "PV" },
        { text: "Il cielo era nuvoloso.", predicate: "era", type: "PN" },
        { text: "La torta è in forno.", predicate: "è", type: "PN" },
        { text: "I libri sono sul tavolo.", predicate: "sono", type: "PN" },
        { text: "Ti sarò sempre amico.", predicate: "sarò", type: "PN" },
        { text: "Quei libri sono molto belli.", predicate: "sono", type: "PN" },
        { text: "Erano arrivati da poco.", predicate: "Erano arrivati", type: "PV" },
        { text: "Ci sono tanti tipi di fiori.", predicate: "Ci sono", type: "PV" },
        { text: "Erano molto stanchi.", predicate: "Erano", type: "PN" },
        { text: "Questi orecchini sono d'oro.", predicate: "sono", type: "PN" },
        { text: "Dove saranno andati?", predicate: "saranno andati", type: "PV" },
        { text: "La festa sarà divertente.", predicate: "sarà", type: "PN" }
      ].each do |item| %>
        <div class="bg-orange-50 border-2 border-orange-200 rounded-xl px-4 py-3">
          <div class="mb-2 cursor-pointer">
            • <%= item[:text].gsub(item[:predicate], "<span data-word-highlighter-target=\"word\" data-correct=\"true\" data-action=\"click->word-highlighter#toggleHighlight\" class=\"px-1 rounded\">#{item[:predicate]}</span>").html_safe %>
          </div>
          <div class="flex gap-4 ml-4">
            <label class="flex items-center gap-2 cursor-pointer">
              <input type="radio" name="q5_<%= item.object_id %>" value="PV" <%= 'data-correct="true"' if item[:type] == 'PV' %> class="w-4 h-4">
              <span class="font-bold">PV</span>
            </label>
            <label class="flex items-center gap-2 cursor-pointer">
              <input type="radio" name="q5_<%= item.object_id %>" value="PN" <%= 'data-correct="true"' if item[:type] == 'PN' %> class="w-4 h-4">
              <span class="font-bold">PN</span>
            </label>
          </div>
        </div>
      <% end %>
    </div>
  </div>

  <div class="text-right text-sm text-gray-500 mb-6">
    Grammatica pp. <%= link_to "104", pagina_path("nvl5_gram_p104"), class: "text-red-600 hover:text-red-800 underline font-bold" %>, <%= link_to "105", pagina_path("nvl5_gram_p105"), class: "text-red-600 hover:text-red-800 underline font-bold" %>
  </div>

  <!-- Exercise Controls -->
  <%= render 'shared/exercise_controls', color: 'cyan', current_page: 'nvl5_gram_p182' %>
</div>
