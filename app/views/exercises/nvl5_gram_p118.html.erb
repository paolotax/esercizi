<div class="max-w-6xl mx-auto p-3 md:p-8 bg-white" data-controller="exercise-checker">

  <%= render 'shared/page_header', pagina: @pagina %>

  <!-- Box teoria -->
  <div class="bg-<%= @pagina.base_color %>-50 p-4 md:p-6 pb-8 rounded-lg">
    <p class="text-gray-700 font-semibold mb-4">
      • Per fare l'analisi logica di una frase, puoi seguire queste indicazioni.
    </p>

    <div class="bg-white rounded-lg p-4 mb-4">
      <p class="text-gray-700 mb-2">
        <span class="bg-<%= @pagina.base_color %>-500 text-white rounded-full w-6 h-6 inline-flex items-center justify-center mr-2 font-bold">1</span>
        <strong>Prima di tutto, dividi la frase nei diversi elementi che la compongono.</strong>
      </p>
      <p class="text-gray-700 ml-8">
        Lorenzo ha telefonato al suo amico Paolo. → <strong class="text-blue-600">Lorenzo</strong> / <strong class="text-red-600 whitespace-nowrap">ha telefonato</strong> / <strong class="text-purple-600">al</strong> <em class="text-orange-600">suo</em> <em class="text-green-600">amico</em> <strong class="text-purple-600">Paolo</strong>.
      </p>
    </div>

    <div class="bg-white rounded-lg p-4 mb-4">
      <p class="text-gray-700 mb-4">
        <span class="bg-<%= @pagina.base_color %>-500 text-white rounded-full w-6 h-6 inline-flex items-center justify-center mr-2 font-bold">2</span>
        <strong>Riconosci la funzione logica di ogni elemento.</strong>
      </p>

      <div class="space-y-4 ml-8">
        <div class="flex items-center gap-4">
          <div class="flex-1 text-gray-700">
            • Individua per primo il <strong class="text-red-600">predicato</strong>: ti permetterà di riconoscere il soggetto e gli altri elementi della frase. Stabilisci se il predicato è verbale o nominale.
          </div>
          <div class="w-32 text-center">
            <span class="text-red-600 font-bold border border-red-300 rounded px-3 py-1 whitespace-nowrap">ha telefonato</span>
          </div>
        </div>

        <div class="flex items-center gap-4">
          <div class="flex-1 text-gray-700">
            • Individua il <strong class="text-blue-600">soggetto</strong>: è l'elemento che compie o subisce l'azione, oppure l'elemento che ha la caratteristica indicata. Ricorda che il soggetto può essere sottinteso.
          </div>
          <div class="w-32 text-center">
            <span class="text-blue-600 font-bold border border-blue-300 rounded px-3 py-1">Lorenzo</span>
          </div>
        </div>

        <div class="flex items-center gap-4">
          <div class="flex-1 text-gray-700">
            • Individua, se c'è, il <em class="text-green-600">complemento oggetto</em>. Ricorda che risponde alle domande: chi? / che cosa?
          </div>
          <div class="w-32 text-center">
            <span class="text-gray-400">—</span>
          </div>
        </div>

        <div class="flex items-center gap-4">
          <div class="flex-1 text-gray-700">
            • Individua, se ci sono, i <span class="text-purple-600">complementi indiretti</span>. Ricorda che rispondono alle domande: di chi? / di che cosa?
            <span class="block mt-1">a chi? / a che cosa? • quando? • dove?...</span>
          </div>
          <div class="w-32 text-center">
            <span class="text-purple-600 font-bold border border-purple-300 rounded px-3 py-1">a Paolo</span>
          </div>
        </div>

        <div class="flex items-center gap-4">
          <div class="flex-1 text-gray-700">
            • Riconosci, se ci sono, gli <strong class="text-orange-600">attributi</strong> e le <em class="text-green-600">apposizioni</em>.
          </div>
          <div class="w-32 text-center">
            <span class="text-orange-600 font-bold">suo</span>, <em class="text-green-600">amico</em>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- PROVA TU! -->
  <div class="bg-<%= @pagina.base_color %>-100 rounded-lg p-4 mb-6">
    <h3 class="font-bold text-<%= @pagina.base_color %>-700">PROVA TU!</h3>
  </div>

  <!-- Esercizio 1 - Analisi logica -->
  <div class="bg-<%= @pagina.base_color %>-50 p-4 md:p-6 pb-8 rounded-lg" data-controller="word-highlighter" data-word-highlighter-multi-color-value="true">
    <h2 class="font-bold mb-4 flex items-center gap-2">
      <span class="flex-shrink-0 bg-<%= @pagina.base_color %>-500 text-white rounded-full w-8 h-8 md:w-10 md:h-10 inline-flex items-center justify-center">1</span>
      Cerchia il <span class="text-red-600 font-bold">predicato<span class="inline-block w-6 h-6 bg-red-300 rounded ml-1 align-middle cursor-pointer transition transform hover:scale-110" data-word-highlighter-target="colorBox" data-color="red" data-action="click->word-highlighter#selectColor"></span></span>, sottolinea il <span class="text-blue-600 font-bold">soggetto<span class="inline-block w-6 h-6 bg-blue-300 rounded ml-1 align-middle cursor-pointer transition transform hover:scale-110" data-word-highlighter-target="colorBox" data-color="blue" data-action="click->word-highlighter#selectColor"></span></span> e fai l'analisi logica delle seguenti frasi.
    </h2>

    <% options = [
      "Scegli...",
      "soggetto",
      "predicato verbale",
      "predicato nominale",
      "compl. oggetto",
      "compl. di specificazione",
      "compl. di termine",
      "compl. di luogo",
      "compl. di tempo",
      "compl. di causa",
      "compl. di modo",
      "compl. di mezzo",
      "attributo",
      "apposizione"
    ] %>

    <div class="grid grid-cols-1 md:grid-cols-2 gap-6 cursor-pointer">
      <!-- Frase 1 -->
      <div class="bg-white rounded-lg p-4">
        <p class="text-gray-700 font-semibold mb-3">
          • <span data-word-highlighter-target="word" data-correct="blue" data-action="click->word-highlighter#toggleHighlight" class="px-1 rounded">Tom</span> <span data-word-highlighter-target="word" data-correct="red" data-action="click->word-highlighter#toggleHighlight" class="px-1 rounded">regala</span> un pacchetto di figurine al cugino.
        </p>
        <div class="space-y-2">
          <div class="flex items-center gap-2">
            <span class="w-32 text-gray-600">Tom:</span>
            <select class="flex-1 px-2 py-1 border-b-2 border-dotted border-<%= @pagina.base_color %>-500 rounded focus:outline-none" data-correct-answer="soggetto">
              <% options.each do |opt| %>
                <option value="<%= opt == 'Scegli...' ? '' : opt %>"><%= opt %></option>
              <% end %>
            </select>
          </div>
          <div class="flex items-center gap-2">
            <span class="w-32 text-gray-600">regala:</span>
            <select class="flex-1 px-2 py-1 border-b-2 border-dotted border-<%= @pagina.base_color %>-500 rounded focus:outline-none" data-correct-answer="predicato verbale">
              <% options.each do |opt| %>
                <option value="<%= opt == 'Scegli...' ? '' : opt %>"><%= opt %></option>
              <% end %>
            </select>
          </div>
          <div class="flex items-center gap-2">
            <span class="w-32 text-gray-600">un pacchetto:</span>
            <select class="flex-1 px-2 py-1 border-b-2 border-dotted border-<%= @pagina.base_color %>-500 rounded focus:outline-none" data-correct-answer="compl. oggetto">
              <% options.each do |opt| %>
                <option value="<%= opt == 'Scegli...' ? '' : opt %>"><%= opt %></option>
              <% end %>
            </select>
          </div>
          <div class="flex items-center gap-2">
            <span class="w-32 text-gray-600">di figurine:</span>
            <select class="flex-1 px-2 py-1 border-b-2 border-dotted border-<%= @pagina.base_color %>-500 rounded focus:outline-none" data-correct-answer="compl. di specificazione">
              <% options.each do |opt| %>
                <option value="<%= opt == 'Scegli...' ? '' : opt %>"><%= opt %></option>
              <% end %>
            </select>
          </div>
          <div class="flex items-center gap-2">
            <span class="w-32 text-gray-600">al cugino:</span>
            <select class="flex-1 px-2 py-1 border-b-2 border-dotted border-<%= @pagina.base_color %>-500 rounded focus:outline-none" data-correct-answer="compl. di termine">
              <% options.each do |opt| %>
                <option value="<%= opt == 'Scegli...' ? '' : opt %>"><%= opt %></option>
              <% end %>
            </select>
          </div>
        </div>
      </div>

      <!-- Frase 2 -->
      <div class="bg-white rounded-lg p-4">
        <p class="text-gray-700 font-semibold mb-3">
          • <span data-word-highlighter-target="word" data-correct="blue" data-action="click->word-highlighter#toggleHighlight" class="px-1 rounded">Luigi</span> <span data-word-highlighter-target="word" data-correct="red" data-action="click->word-highlighter#toggleHighlight" class="px-1 rounded">ripete</span> al nonno la lezione di Storia.
        </p>
        <div class="space-y-2">
          <div class="flex items-center gap-2">
            <span class="w-32 text-gray-600">Luigi:</span>
            <select class="flex-1 px-2 py-1 border-b-2 border-dotted border-<%= @pagina.base_color %>-500 rounded focus:outline-none" data-correct-answer="soggetto">
              <% options.each do |opt| %>
                <option value="<%= opt == 'Scegli...' ? '' : opt %>"><%= opt %></option>
              <% end %>
            </select>
          </div>
          <div class="flex items-center gap-2">
            <span class="w-32 text-gray-600">ripete:</span>
            <select class="flex-1 px-2 py-1 border-b-2 border-dotted border-<%= @pagina.base_color %>-500 rounded focus:outline-none" data-correct-answer="predicato verbale">
              <% options.each do |opt| %>
                <option value="<%= opt == 'Scegli...' ? '' : opt %>"><%= opt %></option>
              <% end %>
            </select>
          </div>
          <div class="flex items-center gap-2">
            <span class="w-32 text-gray-600">al nonno:</span>
            <select class="flex-1 px-2 py-1 border-b-2 border-dotted border-<%= @pagina.base_color %>-500 rounded focus:outline-none" data-correct-answer="compl. di termine">
              <% options.each do |opt| %>
                <option value="<%= opt == 'Scegli...' ? '' : opt %>"><%= opt %></option>
              <% end %>
            </select>
          </div>
          <div class="flex items-center gap-2">
            <span class="w-32 text-gray-600">la lezione:</span>
            <select class="flex-1 px-2 py-1 border-b-2 border-dotted border-<%= @pagina.base_color %>-500 rounded focus:outline-none" data-correct-answer="compl. oggetto">
              <% options.each do |opt| %>
                <option value="<%= opt == 'Scegli...' ? '' : opt %>"><%= opt %></option>
              <% end %>
            </select>
          </div>
          <div class="flex items-center gap-2">
            <span class="w-32 text-gray-600">di Storia:</span>
            <select class="flex-1 px-2 py-1 border-b-2 border-dotted border-<%= @pagina.base_color %>-500 rounded focus:outline-none" data-correct-answer="compl. di specificazione">
              <% options.each do |opt| %>
                <option value="<%= opt == 'Scegli...' ? '' : opt %>"><%= opt %></option>
              <% end %>
            </select>
          </div>
        </div>
      </div>

      <!-- Frase 3 -->
      <div class="bg-white rounded-lg p-4">
        <p class="text-gray-700 font-semibold mb-3">
          • In classe <span data-word-highlighter-target="word" data-correct="blue" data-action="click->word-highlighter#toggleHighlight" class="px-1 rounded">Anya</span> <span data-word-highlighter-target="word" data-correct="red" data-action="click->word-highlighter#toggleHighlight" class="px-1 rounded">usava</span> il tablet di Leo.
        </p>
        <div class="space-y-2">
          <div class="flex items-center gap-2">
            <span class="w-32 text-gray-600">In classe:</span>
            <select class="flex-1 px-2 py-1 border-b-2 border-dotted border-<%= @pagina.base_color %>-500 rounded focus:outline-none" data-correct-answer="compl. di luogo">
              <% options.each do |opt| %>
                <option value="<%= opt == 'Scegli...' ? '' : opt %>"><%= opt %></option>
              <% end %>
            </select>
          </div>
          <div class="flex items-center gap-2">
            <span class="w-32 text-gray-600">Anya:</span>
            <select class="flex-1 px-2 py-1 border-b-2 border-dotted border-<%= @pagina.base_color %>-500 rounded focus:outline-none" data-correct-answer="soggetto">
              <% options.each do |opt| %>
                <option value="<%= opt == 'Scegli...' ? '' : opt %>"><%= opt %></option>
              <% end %>
            </select>
          </div>
          <div class="flex items-center gap-2">
            <span class="w-32 text-gray-600">usava:</span>
            <select class="flex-1 px-2 py-1 border-b-2 border-dotted border-<%= @pagina.base_color %>-500 rounded focus:outline-none" data-correct-answer="predicato verbale">
              <% options.each do |opt| %>
                <option value="<%= opt == 'Scegli...' ? '' : opt %>"><%= opt %></option>
              <% end %>
            </select>
          </div>
          <div class="flex items-center gap-2">
            <span class="w-32 text-gray-600">il tablet:</span>
            <select class="flex-1 px-2 py-1 border-b-2 border-dotted border-<%= @pagina.base_color %>-500 rounded focus:outline-none" data-correct-answer="compl. oggetto">
              <% options.each do |opt| %>
                <option value="<%= opt == 'Scegli...' ? '' : opt %>"><%= opt %></option>
              <% end %>
            </select>
          </div>
          <div class="flex items-center gap-2">
            <span class="w-32 text-gray-600">di Leo:</span>
            <select class="flex-1 px-2 py-1 border-b-2 border-dotted border-<%= @pagina.base_color %>-500 rounded focus:outline-none" data-correct-answer="compl. di specificazione">
              <% options.each do |opt| %>
                <option value="<%= opt == 'Scegli...' ? '' : opt %>"><%= opt %></option>
              <% end %>
            </select>
          </div>
        </div>
      </div>

      <!-- Frase 4 -->
      <div class="bg-white rounded-lg p-4">
        <p class="text-gray-700 font-semibold mb-3">
          • Ieri al cinema <span data-word-highlighter-target="word" data-correct="blue" data-action="click->word-highlighter#toggleHighlight" class="px-1 rounded">Teresa</span> <span data-word-highlighter-target="word" data-correct="red" data-action="click->word-highlighter#toggleHighlight" class="px-1 rounded">sbadigliava</span> per il sonno.
        </p>
        <div class="space-y-2">
          <div class="flex items-center gap-2">
            <span class="w-32 text-gray-600">Ieri:</span>
            <select class="flex-1 px-2 py-1 border-b-2 border-dotted border-<%= @pagina.base_color %>-500 rounded focus:outline-none" data-correct-answer="compl. di tempo">
              <% options.each do |opt| %>
                <option value="<%= opt == 'Scegli...' ? '' : opt %>"><%= opt %></option>
              <% end %>
            </select>
          </div>
          <div class="flex items-center gap-2">
            <span class="w-32 text-gray-600">al cinema:</span>
            <select class="flex-1 px-2 py-1 border-b-2 border-dotted border-<%= @pagina.base_color %>-500 rounded focus:outline-none" data-correct-answer="compl. di luogo">
              <% options.each do |opt| %>
                <option value="<%= opt == 'Scegli...' ? '' : opt %>"><%= opt %></option>
              <% end %>
            </select>
          </div>
          <div class="flex items-center gap-2">
            <span class="w-32 text-gray-600">Teresa:</span>
            <select class="flex-1 px-2 py-1 border-b-2 border-dotted border-<%= @pagina.base_color %>-500 rounded focus:outline-none" data-correct-answer="soggetto">
              <% options.each do |opt| %>
                <option value="<%= opt == 'Scegli...' ? '' : opt %>"><%= opt %></option>
              <% end %>
            </select>
          </div>
          <div class="flex items-center gap-2">
            <span class="w-32 text-gray-600">sbadigliava:</span>
            <select class="flex-1 px-2 py-1 border-b-2 border-dotted border-<%= @pagina.base_color %>-500 rounded focus:outline-none" data-correct-answer="predicato verbale">
              <% options.each do |opt| %>
                <option value="<%= opt == 'Scegli...' ? '' : opt %>"><%= opt %></option>
              <% end %>
            </select>
          </div>
          <div class="flex items-center gap-2">
            <span class="w-32 text-gray-600">per il sonno:</span>
            <select class="flex-1 px-2 py-1 border-b-2 border-dotted border-<%= @pagina.base_color %>-500 rounded focus:outline-none" data-correct-answer="compl. di causa">
              <% options.each do |opt| %>
                <option value="<%= opt == 'Scegli...' ? '' : opt %>"><%= opt %></option>
              <% end %>
            </select>
          </div>
        </div>
      </div>
    </div>
  </div>

  <%= render 'shared/exercise_controls' %>
</div>
