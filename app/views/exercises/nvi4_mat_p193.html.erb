<div class="max-w-6xl mx-auto bg-white dark:bg-gray-900 p-3 md:p-6 transition-colors duration-300"
     data-controller="exercise-checker text-toggle font-controls"
     data-text-toggle-target="content"
     data-font-controls-target="content">

  <%= render 'shared/page_header', pagina: @pagina %>

  <div class="space-y-6">

    <!-- Esercizio 1: IMPARARE TUTTI - Proprietà distributiva -->
    <div class="p-5 bg-white dark:bg-gray-800 rounded-2xl border-3 border-yellow-400 dark:border-yellow-500">
      <p class="font-bold text-gray-700 dark:text-gray-200 mb-4">
        <%= imparare_tutti_badge(1) %>
        Esegui le moltiplicazioni. Poi verifica che applicando la proprietà distributiva il prodotto non cambia. Segui l'esempio.
      </p>

      <div class="space-y-6">
        <!-- Esempio -->
        <div class="p-3 bg-cyan-50 dark:bg-cyan-900 rounded-lg">
          <div class="space-y-2 text-center">
            <p class="font-bold text-gray-700 dark:text-gray-200">11 × 3 = <span class="text-cyan-600 dark:text-cyan-400 bg-cyan-100 dark:bg-cyan-800 px-1 rounded">33</span></p>
            <p class="text-cyan-500">↓</p>
            <p class="font-bold text-gray-700 dark:text-gray-200">(7 + 4) × 3 = (7 × 3) + (4 × 3) = 21 + 12 = <span class="text-cyan-600 dark:text-cyan-400 bg-cyan-100 dark:bg-cyan-800 px-1 rounded">33</span></p>
          </div>
        </div>

        <!-- Esercizio 14 × 6 -->
        <div class="space-y-2">
          <div class="flex items-center justify-center gap-2">
            <span class="text-gray-700 dark:text-gray-200">14 × 6 =</span>
            <input type="text" data-correct-answer="84" class="w-16 border-b-2 border-dotted border-gray-400 dark:border-gray-500 text-center font-bold bg-transparent dark:text-white">
          </div>
          <p class="text-cyan-500 text-center">↓</p>
          <div class="flex items-center justify-center gap-2 flex-wrap">
            <input type="text" data-correct-answer="(10 + 4) × 6" class="w-32 border-b-2 border-dotted border-gray-400 dark:border-gray-500 text-center font-bold bg-transparent dark:text-white">
            <span class="text-gray-700 dark:text-gray-200">=</span>
            <input type="text" data-correct-answer="(10 × 6) + (4 × 6)" class="w-40 border-b-2 border-dotted border-gray-400 dark:border-gray-500 text-center font-bold bg-transparent dark:text-white">
            <span class="text-gray-700 dark:text-gray-200">=</span>
            <input type="text" data-correct-answer="60 + 24" class="w-24 border-b-2 border-dotted border-gray-400 dark:border-gray-500 text-center font-bold bg-transparent dark:text-white">
            <span class="text-gray-700 dark:text-gray-200">=</span>
            <input type="text" data-correct-answer="84" class="w-16 border-b-2 border-dotted border-gray-400 dark:border-gray-500 text-center font-bold bg-transparent dark:text-white">
          </div>
        </div>

        <!-- Esercizio 18 × 7 -->
        <div class="space-y-2">
          <div class="flex items-center justify-center gap-2">
            <span class="text-gray-700 dark:text-gray-200">18 × 7 =</span>
            <input type="text" data-correct-answer="126" class="w-16 border-b-2 border-dotted border-gray-400 dark:border-gray-500 text-center font-bold bg-transparent dark:text-white">
          </div>
          <p class="text-cyan-500 text-center">↓</p>
          <div class="flex items-center justify-center gap-2 flex-wrap">
            <input type="text" data-correct-answer="(10 + 8) × 7" class="w-32 border-b-2 border-dotted border-gray-400 dark:border-gray-500 text-center font-bold bg-transparent dark:text-white">
            <span class="text-gray-700 dark:text-gray-200">=</span>
            <input type="text" data-correct-answer="(10 × 7) + (8 × 7)" class="w-40 border-b-2 border-dotted border-gray-400 dark:border-gray-500 text-center font-bold bg-transparent dark:text-white">
            <span class="text-gray-700 dark:text-gray-200">=</span>
            <input type="text" data-correct-answer="70 + 56" class="w-24 border-b-2 border-dotted border-gray-400 dark:border-gray-500 text-center font-bold bg-transparent dark:text-white">
            <span class="text-gray-700 dark:text-gray-200">=</span>
            <input type="text" data-correct-answer="126" class="w-16 border-b-2 border-dotted border-gray-400 dark:border-gray-500 text-center font-bold bg-transparent dark:text-white">
          </div>
        </div>

        <!-- Esercizio 26 × 9 -->
        <div class="space-y-2">
          <div class="flex items-center justify-center gap-2">
            <span class="text-gray-700 dark:text-gray-200">26 × 9 =</span>
            <input type="text" data-correct-answer="234" class="w-16 border-b-2 border-dotted border-gray-400 dark:border-gray-500 text-center font-bold bg-transparent dark:text-white">
          </div>
          <p class="text-cyan-500 text-center">↓</p>
          <div class="flex items-center justify-center gap-2 flex-wrap">
            <input type="text" data-correct-answer="(20 + 6) × 9" class="w-32 border-b-2 border-dotted border-gray-400 dark:border-gray-500 text-center font-bold bg-transparent dark:text-white">
            <span class="text-gray-700 dark:text-gray-200">=</span>
            <input type="text" data-correct-answer="(20 × 9) + (6 × 9)" class="w-40 border-b-2 border-dotted border-gray-400 dark:border-gray-500 text-center font-bold bg-transparent dark:text-white">
            <span class="text-gray-700 dark:text-gray-200">=</span>
            <input type="text" data-correct-answer="180 + 54" class="w-24 border-b-2 border-dotted border-gray-400 dark:border-gray-500 text-center font-bold bg-transparent dark:text-white">
            <span class="text-gray-700 dark:text-gray-200">=</span>
            <input type="text" data-correct-answer="234" class="w-16 border-b-2 border-dotted border-gray-400 dark:border-gray-500 text-center font-bold bg-transparent dark:text-white">
          </div>
        </div>
      </div>
    </div>

    <!-- Esercizio 2: Completa con il numero mancante -->
    <div>
      <p class="font-bold text-gray-700 dark:text-gray-200 mb-4">
        <%= numero_esercizio_badge(2) %>
        Completa con il numero mancante.
      </p>

      <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
        <div class="space-y-3">
          <div class="flex items-center gap-2 flex-wrap">
            <input type="text" data-correct-answer="4508" class="w-20 border-b-2 border-dotted border-gray-400 dark:border-gray-500 text-center font-bold bg-transparent dark:text-white">
            <span class="text-gray-700 dark:text-gray-200">: 1 = 4 508</span>
          </div>
          <div class="flex items-center gap-2 flex-wrap">
            <input type="text" data-correct-answer="502" class="w-20 border-b-2 border-dotted border-gray-400 dark:border-gray-500 text-center font-bold bg-transparent dark:text-white">
            <span class="text-gray-700 dark:text-gray-200">: 502 = 1</span>
          </div>
          <div class="flex items-center gap-2 flex-wrap">
            <span class="text-gray-700 dark:text-gray-200">69 139 : 1 =</span>
            <input type="text" data-correct-answer="69139" class="w-20 border-b-2 border-dotted border-gray-400 dark:border-gray-500 text-center font-bold bg-transparent dark:text-white">
          </div>
          <div class="flex items-center gap-2 flex-wrap">
            <span class="text-gray-700 dark:text-gray-200">480 :</span>
            <input type="text" data-correct-answer="2" class="w-14 border-b-2 border-dotted border-gray-400 dark:border-gray-500 text-center font-bold bg-transparent dark:text-white">
            <span class="text-gray-700 dark:text-gray-200">= 240</span>
          </div>
        </div>

        <div class="space-y-3">
          <div class="flex items-center gap-2 flex-wrap">
            <input type="text" data-correct-answer="0" class="w-20 border-b-2 border-dotted border-gray-400 dark:border-gray-500 text-center font-bold bg-transparent dark:text-white">
            <span class="text-gray-700 dark:text-gray-200">: 27 = 0</span>
          </div>
          <div class="flex items-center gap-2 flex-wrap">
            <span class="text-gray-700 dark:text-gray-200">0 : 368 =</span>
            <input type="text" data-correct-answer="0" class="w-14 border-b-2 border-dotted border-gray-400 dark:border-gray-500 text-center font-bold bg-transparent dark:text-white">
          </div>
          <div class="flex items-center gap-2 flex-wrap">
            <span class="text-gray-700 dark:text-gray-200">4 000 ×</span>
            <input type="text" data-correct-answer="1" class="w-14 border-b-2 border-dotted border-gray-400 dark:border-gray-500 text-center font-bold bg-transparent dark:text-white">
            <span class="text-gray-700 dark:text-gray-200">= 4 000</span>
          </div>
          <div class="flex items-center gap-2 flex-wrap">
            <input type="text" data-correct-answer="0" class="w-14 border-b-2 border-dotted border-gray-400 dark:border-gray-500 text-center font-bold bg-transparent dark:text-white">
            <span class="text-gray-700 dark:text-gray-200">× 5 409 = 0</span>
          </div>
        </div>
      </div>
    </div>

    <!-- Esercizio 3: Vero o Falso -->
    <div>
      <p class="font-bold text-gray-700 dark:text-gray-200 mb-2">
        <%= numero_esercizio_badge(3) %>
        Indica con una X se le seguenti uguaglianze sono vere (V) o false (F).
      </p>
      <p class="text-gray-700 dark:text-gray-200 mb-4">Correggi sul quaderno quelle false.</p>

      <div class="space-y-3">
        <% [
          { eq: "60 : 4 = (60 : 2) + (4 : 2)", correct: "F" },
          { eq: "72 : 12 = (72 : 3) : (12 × 3)", correct: "F" },
          { eq: "120 : 6 = (120 : 2) : (6 : 2)", correct: "V" }
        ].each_with_index do |item, idx| %>
          <div class="flex items-center justify-between gap-4 flex-wrap">
            <span class="text-gray-700 dark:text-gray-200"><%= item[:eq] %></span>
            <div class="flex gap-2">
              <label class="relative flex items-center justify-center w-8 h-8 bg-white dark:bg-gray-700 border-2 border-cyan-500 rounded cursor-pointer hover:bg-cyan-100 dark:hover:bg-cyan-800 has-[:checked]:bg-cyan-300 dark:has-[:checked]:bg-cyan-600">
                <input type="radio" name="vf<%= idx %>" class="absolute inset-0 opacity-0 cursor-pointer" data-correct-answer="<%= item[:correct] == 'V' %>">
                <span class="text-gray-700 dark:text-gray-200">V</span>
              </label>
              <label class="relative flex items-center justify-center w-8 h-8 bg-white dark:bg-gray-700 border-2 border-cyan-500 rounded cursor-pointer hover:bg-cyan-100 dark:hover:bg-cyan-800 has-[:checked]:bg-cyan-300 dark:has-[:checked]:bg-cyan-600">
                <input type="radio" name="vf<%= idx %>" class="absolute inset-0 opacity-0 cursor-pointer" data-correct-answer="<%= item[:correct] == 'F' %>">
                <span class="text-gray-700 dark:text-gray-200">F</span>
              </label>
            </div>
          </div>
        <% end %>
      </div>
    </div>

    <!-- Esercizio 4: Identifica la proprietà -->
    <div>
      <p class="font-bold text-gray-700 dark:text-gray-200 mb-4">
        <%= numero_esercizio_badge(4) %>
        Osserva come sono state eseguite queste moltiplicazioni. Poi scrivi accanto la proprietà o le proprietà applicate.
      </p>

      <div class="space-y-3">
        <div class="flex items-center gap-2 flex-wrap">
          <span class="text-gray-700 dark:text-gray-200">12 × 5 × 2 = 12 × 10 = 120</span>
          <input type="text" data-correct-answer="associativa" class="flex-1 min-w-32 border-b-2 border-dotted border-gray-400 dark:border-gray-500 text-center font-bold bg-transparent dark:text-white">
        </div>
        <div class="flex items-center gap-2 flex-wrap">
          <span class="text-gray-700 dark:text-gray-200">25 × 11 × 4 = 25 × 4 × 11 = 100 × 11 = 1 100</span>
          <input type="text" data-correct-answer="commutativa e associativa" class="flex-1 min-w-32 border-b-2 border-dotted border-gray-400 dark:border-gray-500 text-center font-bold bg-transparent dark:text-white">
        </div>
        <div class="flex items-center gap-2 flex-wrap">
          <span class="text-gray-700 dark:text-gray-200">(15 + 9) × 11 = (15 × 11) + (9 × 11) = 165 + 99 = 264</span>
          <input type="text" data-correct-answer="distributiva" class="flex-1 min-w-32 border-b-2 border-dotted border-gray-400 dark:border-gray-500 text-center font-bold bg-transparent dark:text-white">
        </div>
      </div>
    </div>

    <!-- Esercizio 5: Calcola in colonna sul quaderno -->
    <div>
      <p class="font-bold text-gray-700 dark:text-gray-200 mb-4">
        <%= numero_esercizio_badge(5) %>
        Calcola in colonna sul quaderno.
      </p>

      <div class="grid grid-cols-1 md:grid-cols-4 gap-4">
        <!-- Colonna a -->
        <div class="space-y-2">
          <p class="font-bold text-gray-700 dark:text-gray-200">a.</p>
          <% [
            { op: "612 × 83", result: "50796" },
            { op: "459 × 71", result: "32589" },
            { op: "628 × 119", result: "74732" }
          ].each do |item| %>
            <div class="flex items-center gap-1 flex-wrap">
              <span class="text-gray-700 dark:text-gray-200"><%= item[:op] %> =</span>
              <input type="text" data-correct-answer="<%= item[:result] %>" class="w-20 border-b-2 border-dotted border-gray-400 dark:border-gray-500 text-center font-bold bg-transparent dark:text-white">
            </div>
          <% end %>
        </div>

        <!-- Colonna b -->
        <div class="space-y-2">
          <p class="font-bold text-gray-700 dark:text-gray-200">b.</p>
          <% [
            { op: "405 × 918", result: "371790" },
            { op: "433 × 606", result: "262398" },
            { op: "3 259 × 68", result: "221612" }
          ].each do |item| %>
            <div class="flex items-center gap-1 flex-wrap">
              <span class="text-gray-700 dark:text-gray-200"><%= item[:op] %> =</span>
              <input type="text" data-correct-answer="<%= item[:result] %>" class="w-20 border-b-2 border-dotted border-gray-400 dark:border-gray-500 text-center font-bold bg-transparent dark:text-white">
            </div>
          <% end %>
        </div>

        <!-- Colonna c -->
        <div class="space-y-2">
          <p class="font-bold text-gray-700 dark:text-gray-200">c.</p>
          <% [
            { op: "5 580 : 45", result: "124" },
            { op: "3 128 : 34", result: "92" },
            { op: "2 177 : 68", result: "32 resto 1" }
          ].each do |item| %>
            <div class="flex items-center gap-1 flex-wrap">
              <span class="text-gray-700 dark:text-gray-200"><%= item[:op] %> =</span>
              <input type="text" data-correct-answer="<%= item[:result] %>" class="w-24 border-b-2 border-dotted border-gray-400 dark:border-gray-500 text-center font-bold bg-transparent dark:text-white">
            </div>
          <% end %>
        </div>

        <!-- Colonna d -->
        <div class="space-y-2">
          <p class="font-bold text-gray-700 dark:text-gray-200">d.</p>
          <% [
            { op: "28 560 : 68", result: "420" },
            { op: "15 328 : 17", result: "901 resto 11" },
            { op: "23 133 : 33", result: "701" }
          ].each do |item| %>
            <div class="flex items-center gap-1 flex-wrap">
              <span class="text-gray-700 dark:text-gray-200"><%= item[:op] %> =</span>
              <input type="text" data-correct-answer="<%= item[:result] %>" class="w-24 border-b-2 border-dotted border-gray-400 dark:border-gray-500 text-center font-bold bg-transparent dark:text-white">
            </div>
          <% end %>
        </div>
      </div>
    </div>

    <%= render 'shared/exercise_controls' %>
  </div>
</div>
