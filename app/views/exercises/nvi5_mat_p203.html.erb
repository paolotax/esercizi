<div class="max-w-6xl mx-auto bg-white p-3 md:p-6"
     data-controller="exercise-checker text-toggle font-controls"
     data-text-toggle-target="content"
     data-font-controls-target="content">

  <%= render 'shared/page_header', pagina: @pagina %>

  <div class="space-y-6">
    <!-- Box teoria -->
    <div class="p-4 bg-custom-blue-light rounded-lg">
      <div class="flex flex-col md:flex-row md:items-center gap-4">
        <div class="flex-1">
          <p class="text-gray-700">
            <span class="font-bold text-cyan-600">Frazioni complementari</span>: sommate formano l'intero.
          </p>
        </div>
        <div class="flex items-center gap-2">
          <%= image_tag "nvi5_mat/p203/p203_01.jpg", class: "max-w-[120px]", alt: "esempio frazioni complementari" %>
          <div class="flex items-center gap-2">
            <%= render 'shared/frazione', num: 2, den: 6, border: nil %>
            <span class="font-bold">+</span>
            <span class="font-bold text-cyan-600"><%= render 'shared/frazione', num: 4, den: 6, border: nil %></span>
            <span class="font-bold">=</span>
            <%= render 'shared/frazione', num: 6, den: 6, border: nil %>
            <span class="font-bold">= 1</span>
          </div>
        </div>
      </div>
    </div>

    <!-- Esercizio 1: IMPARARE TUTTI -->
    <div class="p-4 bg-white rounded-2xl border-3 border-yellow-400">
      <p class="font-bold text-gray-700 mb-4">
        <%= imparare_tutti_badge(1) %>
        Osserva la figura e rispondi.
      </p>

      <div class="flex flex-col md:flex-row gap-6 items-start">
        <div class="shrink-0">
          <%= image_tag "nvi5_mat/p203/output-1715938802203_187_429_139_118.png", class: "max-w-[120px]", alt: "cerchio diviso" %>
        </div>
        <div class="space-y-3 flex-1">
          <div class="flex items-center gap-2 flex-wrap">
            <span class="text-cyan-500">•</span>
            <span class="text-gray-700">In quante parti è stato frazionato l'intero?</span>
            <input type="text" data-correct-answer="6" class="w-12 border-b-2 border-dotted border-gray-400 text-center font-bold bg-transparent">
          </div>
          <div class="flex items-center gap-2 flex-wrap">
            <span class="text-cyan-500">•</span>
            <span class="text-gray-700">Quale frazione rappresenta la parte colorata?</span>
            <%= render 'shared/frazione', num: nil, den: nil, num_answer: "2", den_answer: "6" %>
          </div>
          <div class="flex items-center gap-2 flex-wrap">
            <span class="text-cyan-500">•</span>
            <span class="text-gray-700">Quale frazione corrisponde alla parte non colorata?</span>
            <%= render 'shared/frazione', num: nil, den: nil, num_answer: "4", den_answer: "6" %>
          </div>
          <div class="flex items-center gap-2 flex-wrap">
            <span class="text-cyan-500">•</span>
            <span class="text-gray-700">Come si chiamano queste due frazioni?</span>
            <input type="text" data-correct-answer="complementari" class="flex-1 min-w-[150px] border-b-2 border-dotted border-gray-400 text-center font-bold bg-transparent">
          </div>
        </div>
      </div>
    </div>

    <!-- Esercizio 2: Dividi l'intero in parti uguali -->
    <div>
      <p class="font-bold text-gray-700 mb-4">
        <%= numero_esercizio_badge(2) %>
        Dividi l'intero in parti uguali come indicato dal denominatore, colora di rosso la frazione indicata e di blu quella complementare. Poi completa.
      </p>

      <div class="grid grid-cols-1 md:grid-cols-3 gap-6">
        <!-- 1/2 -->
        <div class="flex flex-col items-center gap-3">
          <%= image_tag "nvi5_mat/p203/p203_03.jpg", class: "max-w-[100px]", alt: "rettangolo" %>
          <div class="flex items-center gap-2">
            <%= render 'shared/frazione', num: 1, den: 2, border: nil %>
            <span>+</span>
            <%= render 'shared/frazione', num: nil, den: nil, num_answer: "1", den_answer: "2" %>
            <span>= 1</span>
          </div>
        </div>
        <!-- .../8 + 2/8 = 1 -->
        <div class="flex flex-col items-center gap-3">
          <div class="w-24 h-16 border border-gray-300 flex items-center justify-center">
            <span class="text-gray-400">[figura]</span>
          </div>
          <div class="flex items-center gap-2">
            <%= render 'shared/frazione', num: nil, den: nil, num_answer: "6", den_answer: "8" %>
            <span>+</span>
            <%= render 'shared/frazione', num: 2, den: 8, border: nil %>
            <span>= 1</span>
          </div>
        </div>
        <!-- 7/12 + .../12 = 1 -->
        <div class="flex flex-col items-center gap-3">
          <div class="w-24 h-16 border border-gray-300 flex items-center justify-center">
            <span class="text-gray-400">[figura]</span>
          </div>
          <div class="flex items-center gap-2">
            <%= render 'shared/frazione', num: 7, den: 12, border: nil %>
            <span>+</span>
            <%= render 'shared/frazione', num: nil, den: nil, num_answer: "5", den_answer: "12" %>
            <span>= 1</span>
          </div>
        </div>
      </div>
    </div>

    <!-- Esercizio 3 e 4 su due colonne -->
    <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
      <!-- Esercizio 3: Collega le frazioni complementari -->
      <div>
        <p class="font-bold text-gray-700 mb-4">
          <%= numero_esercizio_badge(3) %>
          Collega le frazioni complementari.
        </p>

        <div class="grid grid-cols-2 gap-4">
          <div class="space-y-2">
            <div class="p-2 border border-cyan-400 text-center"><%= render 'shared/frazione', num: 8, den: 10, border: nil %></div>
            <div class="p-2 border border-cyan-400 text-center"><%= render 'shared/frazione', num: 1, den: 12, border: nil %></div>
            <div class="p-2 border border-cyan-400 text-center"><%= render 'shared/frazione', num: 4, den: 10, border: nil %></div>
            <div class="p-2 border border-cyan-400 text-center"><%= render 'shared/frazione', num: 5, den: 12, border: nil %></div>
          </div>
          <div class="space-y-2">
            <div class="p-2 border border-cyan-400 text-center"><%= render 'shared/frazione', num: 6, den: 10, border: nil %></div>
            <div class="p-2 border border-cyan-400 text-center"><%= render 'shared/frazione', num: 2, den: 10, border: nil %></div>
            <div class="p-2 border border-cyan-400 text-center"><%= render 'shared/frazione', num: 11, den: 12, border: nil %></div>
            <div class="p-2 border border-cyan-400 text-center"><%= render 'shared/frazione', num: 7, den: 12, border: nil %></div>
          </div>
        </div>
      </div>

      <!-- Esercizio 4: Scrivi la frazione complementare -->
      <div>
        <p class="font-bold text-gray-700 mb-4">
          <%= numero_esercizio_badge(4) %>
          Scrivi la frazione complementare e completa l'uguaglianza.
        </p>

        <div class="space-y-4">
          <!-- 8/13 + .../13 = 13/13 = 1 -->
          <div class="flex items-center gap-2 flex-wrap">
            <%= render 'shared/frazione', num: 8, den: 13, border: nil %>
            <span>+</span>
            <%= render 'shared/frazione', num: nil, den: nil, num_answer: "5", den_answer: "13" %>
            <span>=</span>
            <%= render 'shared/frazione', num: 13, den: 13, border: nil %>
            <span>= 1</span>
          </div>
          <!-- .../80 + 35/80 = 80/80 = 1 -->
          <div class="flex items-center gap-2 flex-wrap">
            <%= render 'shared/frazione', num: nil, den: nil, num_answer: "45", den_answer: "80" %>
            <span>+</span>
            <%= render 'shared/frazione', num: 35, den: 80, border: nil %>
            <span>=</span>
            <%= render 'shared/frazione', num: 80, den: 80, border: nil %>
            <span>= 1</span>
          </div>
          <!-- 15/43 + .../43 = .../43 = 1 -->
          <div class="flex items-center gap-2 flex-wrap">
            <%= render 'shared/frazione', num: 15, den: 43, border: nil %>
            <span>+</span>
            <%= render 'shared/frazione', num: nil, den: nil, num_answer: "28", den_answer: "43" %>
            <span>=</span>
            <%= render 'shared/frazione', num: nil, den: nil, num_answer: "43", den_answer: "43" %>
            <span>= 1</span>
          </div>
          <!-- 76/100 + .../100 = .../100 = 1 -->
          <div class="flex items-center gap-2 flex-wrap">
            <%= render 'shared/frazione', num: 76, den: 100, border: nil %>
            <span>+</span>
            <%= render 'shared/frazione', num: nil, den: nil, num_answer: "24", den_answer: "100" %>
            <span>=</span>
            <%= render 'shared/frazione', num: nil, den: nil, num_answer: "100", den_answer: "100" %>
            <span>= 1</span>
          </div>
        </div>
      </div>
    </div>

    <!-- Esercizio 5: Leggi i problemi -->
    <div>
      <p class="font-bold text-gray-700 mb-4">
        <%= numero_esercizio_badge(5) %>
        Leggi i problemi e rispondi con una frazione.
      </p>

      <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
        <!-- Problema a -->
        <div class="p-4 bg-custom-blue-light rounded-2xl">
          <p class="text-gray-700 mb-3">
            <span class="font-bold">a.</span> Un pizzaiolo ha preparato un vassoio di pizzette: <%= render 'shared/frazione', num: 2, den: 7, border: nil %> sono al prosciutto, quante sono quelle non al prosciutto?
          </p>
          <div class="flex items-center gap-2">
            <%= render 'shared/frazione', num: nil, den: nil, num_answer: "5", den_answer: "7" %>
          </div>
        </div>
        <!-- Problema b -->
        <div class="p-4 bg-custom-blue-light rounded-2xl">
          <p class="text-gray-700 mb-3">
            <span class="font-bold">b.</span> Un pilota automobilistico ha percorso <%= render 'shared/frazione', num: 5, den: 10, border: nil %> del circuito, quanto gli manca per completarlo?
          </p>
          <div class="flex items-center gap-2">
            <%= render 'shared/frazione', num: nil, den: nil, num_answer: "5", den_answer: "10" %>
          </div>
        </div>
      </div>
    </div>

    <%= render 'shared/exercise_controls' %>
  </div>
</div>
