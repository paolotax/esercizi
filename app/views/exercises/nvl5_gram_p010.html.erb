<div class="max-w-6xl mx-auto p-3 md:p-8 bg-white rounded-lg shadow-lg" data-controller="exercise-checker">

  <%= render 'shared/page_header', pagina: @pagina %>

  <!-- Info Box -->
  <div class="mb-6 md:mb-8 bg-yellow-100 rounded-lg p-4 md:p-6">
    <h2 class="text-lg md:text-xl font-bold text-gray-800 mb-3">
      La lettera <span class="font-bold text-cyan-700">H</span> si usa:
    </h2>
    <ul class="space-y-2 text-base md:text-lg">
      <li>‚Ä¢ con i suoni duri <strong class="text-cyan-700">C e G</strong>, davanti alle vocali <strong class="text-cyan-700">E</strong> o <strong class="text-cyan-700">I</strong> (<span class="text-cyan-700">che, chi, ghe, ghi</span>);</li>
      <li>‚Ä¢ in alcune forme del verbo <strong class="text-cyan-700">avere</strong> (<strong class="text-cyan-700">ho, hai, ha, hanno</strong>) per distinguerle da altre parole che si pronunciano nello stesso modo (<span class="text-cyan-700">o, ai, a, anno</span>);</li>
      <li>‚Ä¢ nelle <strong class="text-cyan-700">esclamazioni</strong>, l'h segue la vocale (<strong class="text-cyan-700">oh, ah</strong>) o sta tra due vocali (<strong class="text-cyan-700">ahi, ahim√®</strong>);</li>
      <li>‚Ä¢ in alcune <strong class="text-cyan-700">parole di origine straniera</strong>: <span class="text-cyan-700">hamburger, hotel, hobby</span>...</li>
    </ul>
  </div>

  <!-- Exercise 1: IMPARARE TUTTI - Underline text -->
  <div class="mb-6 md:mb-8 bg-white rounded-lg p-4 md:p-6 border-4 border-yellow-400" data-controller="word-highlighter">
    <h2 class="text-lg md:text-xl font-bold text-gray-800">
      <span class="bg-blue-800 text-white rounded-full w-8 h-8 md:w-10 md:h-10 inline-flex items-center justify-center mr-2">1</span>
      <span class="bg-yellow-400 text-blue-800 px-2 py-1 rounded text-sm md:text-base font-bold">IMPARARE TUTTI</span>
      Clicca un colore, poi clicca le parole per evidenziarle.
    </h2>

    <div class="p-4 md:p-6">
      <p class="text-base md:text-lg leading-relaxed text-gray-800">
        <span class="cursor-pointer hover:underline transition" data-word-highlighter-target="word" data-correct-color="green" data-action="click->word-highlighter#highlightWord">Ai</span> "Giochi della scienza" un mio amico
        <span class="cursor-pointer hover:underline transition" data-word-highlighter-target="word" data-correct-color="red" data-action="click->word-highlighter#highlightWord">ha</span> presentato un videogioco che
        <span class="cursor-pointer hover:underline transition" data-word-highlighter-target="word" data-correct-color="red" data-action="click->word-highlighter#highlightWord">ha</span> inventato lui stesso. Lo
        <span class="cursor-pointer hover:underline transition" data-word-highlighter-target="word" data-correct-color="red" data-action="click->word-highlighter#highlightWord">ha</span> chiamato "Esploratori delle stelle": bisogna fare finta di essere astronauti e di esplorare lo spazio
        <span class="cursor-pointer hover:underline transition" data-word-highlighter-target="word" data-correct-color="green" data-action="click->word-highlighter#highlightWord">a</span> caccia di stelle
        <span class="cursor-pointer hover:underline transition" data-word-highlighter-target="word" data-correct-color="green" data-action="click->word-highlighter#highlightWord">o</span> di comete rare. Ogni volta che tocchi una stella,
        <span class="cursor-pointer hover:underline transition" data-word-highlighter-target="word" data-correct-color="red" data-action="click->word-highlighter#highlightWord">hai</span> un punto in pi√π. Quando l'<span class="cursor-pointer hover:underline transition" data-word-highlighter-target="word" data-correct-color="red" data-action="click->word-highlighter#highlightWord">ho</span> provato,
        <span class="cursor-pointer hover:underline transition" data-word-highlighter-target="word" data-correct-color="red" data-action="click->word-highlighter#highlightWord">ho</span> subito pensato: "<span class="cursor-pointer hover:underline transition" data-word-highlighter-target="word" data-correct-color="yellow" data-action="click->word-highlighter#highlightWord">Ah</span>, che meraviglia, come vorrei andare veramente
        <span class="cursor-pointer hover:underline transition" data-word-highlighter-target="word" data-correct-color="green" data-action="click->word-highlighter#highlightWord">a</span> esplorare le galassie
        <span class="cursor-pointer hover:underline transition" data-word-highlighter-target="word" data-correct-color="green" data-action="click->word-highlighter#highlightWord">o</span>
        <span class="cursor-pointer hover:underline transition" data-word-highlighter-target="word" data-correct-color="green" data-action="click->word-highlighter#highlightWord">a</span> toccare le stelle!".
      </p>

      <div class="mt-6 flex flex-wrap gap-4 items-center justify-between">
        <div class="flex flex-wrap gap-4 text-sm md:text-base">
          <div class="flex items-center gap-2">
            <div class="w-6 h-6 bg-red-600 rounded cursor-pointer transition transform hover:scale-110 ring-2 ring-gray-300"
                 data-word-highlighter-target="colorBox"
                 data-color="red"
                 data-action="click->word-highlighter#selectColor"
                 title="Clicca per selezionare">
            </div>
            <span>Verbo avere (ho, hai, ha)</span>
          </div>
          <div class="flex items-center gap-2">
            <div class="w-6 h-6 bg-green-600 rounded cursor-pointer transition transform hover:scale-110 ring-2 ring-gray-300"
                 data-word-highlighter-target="colorBox"
                 data-color="green"
                 data-action="click->word-highlighter#selectColor"
                 title="Clicca per selezionare">
            </div>
            <span>Preposizioni e congiunzione (a, ai, o)</span>
          </div>
          <div class="flex items-center gap-2">
            <div class="w-6 h-6 bg-yellow-500 rounded cursor-pointer transition transform hover:scale-110 ring-2 ring-gray-300"
                 data-word-highlighter-target="colorBox"
                 data-color="yellow"
                 data-action="click->word-highlighter#selectColor"
                 title="Clicca per selezionare">
            </div>
            <span>Esclamazione (ah)</span>
          </div>
        </div>
        <button class="text-sm bg-gray-200 hover:bg-gray-300 px-4 py-2 rounded-lg transition font-semibold"
                data-action="click->word-highlighter#clearHighlights">
          Cancella
        </button>
      </div>
    </div>
  </div>

  <!-- Exercise 2: Complete with HO, HA, O, A, OH, AH -->
  <div class="mb-6 md:mb-8 bg-white rounded-lg p-4 md:p-6">
    <h2 class="text-lg md:text-xl font-bold text-gray-800 mb-4">
      <span class="bg-pink-600 text-white rounded-full w-8 h-8 md:w-10 md:h-10 inline-flex items-center justify-center mr-2">2</span>
      Completa con <span class="font-bold text-cyan-700">HO</span>, <span class="font-bold text-cyan-700">HA</span>, <span class="font-bold text-cyan-700">O</span>, <span class="font-bold text-cyan-700">A</span>, <span class="font-bold text-cyan-700">OH</span>, <span class="font-bold text-cyan-700">AH</span>.
    </h2>

    <div class="space-y-4" data-controller="fill-blanks">
      <% completions = [
        {text: 'Tra due giorni andr√≤', answer: 'a', suffix: 'Bologna con la mamma.'},
        {text: 'Preferisci un panino', answer: 'o', suffix: 'una mela?'},
        {text: 'Andrea mi', answer: 'ha', suffix: 'regalato un libro molto bello.'},
        {text: '', answer: 'Oh', suffix: '! Che meraviglia i colori dell\'autunno!'},
        {text: 'Non posso venire al cinema:', answer: 'ho', suffix: 'molte cose da fare.'},
        {text: '', answer: 'Ah', suffix: ', che bellezza! Marta', answer2: 'ha', suffix2: 'ritrovato la penna a cui teneva tanto.'}
      ] %>

      <div class="px-2 py-0 rounded-lg flex flex-wrap items-center gap-2 text-base md:text-lg">
        <span>‚Ä¢ Tra due giorni andr√≤</span>
        <input type="text"
               class="border-b-3 border-pink-500 bg-white w-12 md:w-16 text-center focus:outline-none focus:border-pink-700"
               data-fill-blanks-target="input"
               data-answer="a"
               data-correct-answer="a"
               maxlength="2">
        <span>Bologna con la mamma.</span>
      </div>

      <div class="px-2 py-0 rounded-lg flex flex-wrap items-center gap-2 text-base md:text-lg">
        <span>‚Ä¢ Preferisci un panino</span>
        <input type="text"
               class="border-b-3 border-pink-500 bg-white w-12 md:w-16 text-center focus:outline-none focus:border-pink-700"
               data-fill-blanks-target="input"
               data-answer="o"
               data-correct-answer="o"
               maxlength="2">
        <span>una mela?</span>
      </div>

      <div class="px-2 py-0 rounded-lg flex flex-wrap items-center gap-2 text-base md:text-lg">
        <span>‚Ä¢ Andrea mi</span>
        <input type="text"
               class="border-b-3 border-pink-500 bg-white w-12 md:w-16 text-center focus:outline-none focus:border-pink-700"
               data-fill-blanks-target="input"
               data-answer="ha"
               data-correct-answer="ha"
               maxlength="2">
        <span>regalato un libro molto bello.</span>
      </div>

      <div class="px-2 py-0 rounded-lg flex flex-wrap items-center gap-2 text-base md:text-lg">
        <span>‚Ä¢</span>
        <input type="text"
               class="border-b-3 border-pink-500 bg-white w-12 md:w-16 text-center focus:outline-none focus:border-pink-700"
               data-fill-blanks-target="input"
               data-answer="oh"
               data-correct-answer="oh"
               maxlength="2">
        <span>! Che meraviglia i colori dell'autunno!</span>
      </div>

      <div class="px-2 py-0 rounded-lg flex flex-wrap items-center gap-2 text-base md:text-lg">
        <span>‚Ä¢ Non posso venire al cinema:</span>
        <input type="text"
               class="border-b-3 border-pink-500 bg-white w-12 md:w-16 text-center focus:outline-none focus:border-pink-700"
               data-fill-blanks-target="input"
               data-answer="ho"
               data-correct-answer="ho"
               maxlength="2">
        <span>molte cose da fare.</span>
      </div>

      <div class="px-2 py-0 rounded-lg flex flex-wrap items-center gap-2 text-base md:text-lg">
        <span>‚Ä¢</span>
        <input type="text"
               class="border-b-3 border-pink-500 bg-white w-12 md:w-16 text-center focus:outline-none focus:border-pink-700"
               data-fill-blanks-target="input"
               data-answer="ah"
               data-correct-answer="ah"
               maxlength="2">
        <span>, che bellezza! Marta</span>
        <input type="text"
               class="border-b-3 border-pink-500 bg-white w-12 md:w-16 text-center focus:outline-none focus:border-pink-700"
               data-fill-blanks-target="input"
               data-answer="ha"
               data-correct-answer="ha"
               maxlength="2">
        <span>ritrovato la penna a cui teneva tanto.</span>
      </div>
    </div>
  </div>

  <!-- Exercise 3: Write sentences on notebook -->
  <div class="mb-6 md:mb-8 bg-white rounded-lg p-4 md:p-6">
    <h2 class="text-lg md:text-xl font-bold text-gray-800 mb-4">
      <span class="bg-pink-600 text-white rounded-full w-8 h-8 md:w-10 md:h-10 inline-flex items-center justify-center mr-2">3</span>
      Scrivi sul quaderno una frase con ognuna delle seguenti espressioni.
    </h2>

    <div class="grid grid-cols-2 sm:grid-cols-3 gap-3 md:gap-4">
      <% expressions = [
        {text: 'Ahi, che male!', color: 'blue'},
        {text: 'Hai male?', color: 'orange'},
        {text: 'Ah, che caldo insopportabile!', color: 'green'},
        {text: 'Thomas ha caldo', color: 'pink'},
        {text: 'Non ce l\'hanno fatta', color: 'cyan'},
        {text: 'L\'anno passato', color: 'purple'}
      ] %>

      <% expressions.each do |expr| %>
        <div class="border-3 rounded-lg px-3 py-3 text-center font-bold text-sm md:text-base"
             style="border-color: <%= case expr[:color]
               when 'blue' then '#3b82f6'
               when 'orange' then '#f97316'
               when 'green' then '#22c55e'
               when 'pink' then '#ec4899'
               when 'cyan' then '#06b6d4'
               when 'purple' then '#a855f7'
               end %>;">
          <%= expr[:text] %>
        </div>
      <% end %>
    </div>

    <div class="mt-4">
      <textarea class="w-full border-2 border-dotted border-gray-400 rounded-lg p-3 focus:outline-none text-base md:text-lg"
                rows="4"
                placeholder="üìì Scrivi le tue frasi sul quaderno o usa quest'area per annotarle."></textarea>
    </div>
  </div>

  <!-- Reference note -->
  <%
    base_color = @pagina&.base_color || "blue"
    color_map = {
      "purple" => "text-purple-700 hover:text-purple-900",
      "blue" => "text-blue-700 hover:text-blue-900",
      "cyan" => "text-cyan-700 hover:text-cyan-900",
      "green" => "text-green-700 hover:text-green-900",
      "orange" => "text-orange-700 hover:text-orange-900",
      "red" => "text-red-700 hover:text-red-900",
      "pink" => "text-pink-700 hover:text-pink-900"
    }
    link_color = color_map[base_color] || "text-blue-700 hover:text-blue-900"
  %>
  <div class="mb-6 text-right font-bold">
    <p class="text-lg md:text-xl <%= link_color %>">
      Esercizi pp. <%= link_to "136", pagina_path("nvl5_gram_p136"), class: "#{link_color} underline" %>-<%= link_to "137", pagina_path("nvl5_gram_p137"), class: "#{link_color} underline" %>
    </p>
  </div>

  <!-- Exercise Controls -->
  <%= render 'shared/exercise_controls', color: 'pink', current_page: 'nvl5_gr_p010' %>
</div>
