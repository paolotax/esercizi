<div class="max-w-6xl mx-auto bg-white p-3 md:p-6"
     data-controller="exercise-checker text-toggle font-controls"
     data-text-toggle-target="content"
     data-font-controls-target="content">

  <%= render 'shared/page_header', pagina: @pagina %>

  <div class="space-y-6">
    <!-- Box teoria -->
    <div class="p-4 bg-custom-blue-light rounded-2xl">
      <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
        <div>
          <div class="p-3 bg-white border-2 border-cyan-400 rounded mb-3">
            <p class="font-bold text-cyan-600 mb-2">Calcolare la percentuale</p>
            <p class="text-gray-700">
              <span class="font-bold">15%</span> di <span class="font-bold">300</span> <span class="text-cyan-500">→</span> (300 : 100) × 15 = <span class="font-bold">45</span>
            </p>
          </div>
          <div class="p-3 bg-white border-2 border-cyan-400 rounded">
            <p class="font-bold text-cyan-600 mb-2">Dalla percentuale all'intero</p>
            <p class="text-gray-700">
              <span class="font-bold">45</span> è il <span class="font-bold">15%</span> <span class="text-cyan-500">→</span> (45 : 15) × 100 = <span class="font-bold">300</span>
            </p>
          </div>
        </div>
        <div class="p-3 bg-white border-2 border-cyan-400 rounded">
          <p class="font-bold text-cyan-600 mb-2">Dalla frazione alla percentuale</p>
          <p class="text-gray-700 flex items-center gap-2 flex-wrap">
            <%= render 'shared/frazione', num: 1, den: 4 %> = 1 : 4 = 0,25 = <%= render 'shared/frazione', num: 25, den: 100 %> = <span class="font-bold">25%</span>
          </p>
        </div>
      </div>
    </div>

    <!-- Grid due colonne per esercizi 1 e 2 -->
    <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
      <!-- Esercizio 1: IMPARARE TUTTI -->
      <div class="p-4 bg-white rounded-2xl border-3 border-yellow-400">
        <p class="font-bold text-gray-700 mb-4">
          <%= imparare_tutti_badge(1) %>
          Scrivi le seguenti frazioni decimali sotto forma di percentuale. Segui l'esempio.
        </p>

        <div class="space-y-3">
          <div class="flex items-center gap-2 bg-custom-blue-light p-2 rounded">
            <%= render 'shared/frazione', num: 45, den: 100 %> = <span class="font-bold text-cyan-600">45%</span>
          </div>
          <div class="flex items-center gap-2">
            <%= render 'shared/frazione', num: 3, den: 100 %> =
            <input type="text" data-correct-answer="3%" class="w-16 border-b-2 border-dotted border-gray-400 text-center font-bold bg-transparent">
          </div>
          <div class="flex items-center gap-2">
            <%= render 'shared/frazione', num: 99, den: 100 %> =
            <input type="text" data-correct-answer="99%" class="w-16 border-b-2 border-dotted border-gray-400 text-center font-bold bg-transparent">
          </div>
          <div class="flex items-center gap-2">
            <%= render 'shared/frazione', num: 16, den: 100 %> =
            <input type="text" data-correct-answer="16%" class="w-16 border-b-2 border-dotted border-gray-400 text-center font-bold bg-transparent">
          </div>
          <div class="flex items-center gap-2">
            <%= render 'shared/frazione', num: 72, den: 100 %> =
            <input type="text" data-correct-answer="72%" class="w-16 border-b-2 border-dotted border-gray-400 text-center font-bold bg-transparent">
          </div>
          <div class="flex items-center gap-2">
            <%= render 'shared/frazione', num: 20, den: 100 %> =
            <input type="text" data-correct-answer="20%" class="w-16 border-b-2 border-dotted border-gray-400 text-center font-bold bg-transparent">
          </div>
        </div>
      </div>

      <!-- Esercizio 2: IMPARARE TUTTI -->
      <div class="p-4 bg-white rounded-2xl border-3 border-yellow-400">
        <p class="font-bold text-gray-700 mb-4">
          <%= imparare_tutti_badge(2) %>
          Scrivi le seguenti frazioni sotto forma di percentuale. Segui l'esempio.
        </p>

        <div class="space-y-3">
          <div class="flex items-center gap-2 flex-wrap bg-custom-blue-light p-2 rounded">
            <%= render 'shared/frazione', num: 7, den: 14 %> =
            <span class="font-bold text-cyan-600">7</span> :
            <span class="font-bold text-cyan-600">14</span> =
            <span class="font-bold text-cyan-600">0,5</span> =
            <%= render 'shared/frazione', num: 50, den: 100 %> =
            <span class="font-bold text-cyan-600">50%</span>
          </div>
          <div class="flex items-center gap-2 flex-wrap">
            <%= render 'shared/frazione', num: 20, den: 40 %> =
            <input type="text" data-correct-answer="20" class="w-10 border-b-2 border-dotted border-gray-400 text-center font-bold bg-transparent"> :
            <input type="text" data-correct-answer="40" class="w-10 border-b-2 border-dotted border-gray-400 text-center font-bold bg-transparent"> =
            <input type="text" data-correct-answer="0,5" class="w-12 border-b-2 border-dotted border-gray-400 text-center font-bold bg-transparent"> =
            <%= render 'shared/frazione', num: nil, den: 100, num_answer: "50" %> =
            <input type="text" data-correct-answer="50%" class="w-14 border-b-2 border-dotted border-gray-400 text-center font-bold bg-transparent">
          </div>
          <div class="flex items-center gap-2 flex-wrap">
            <%= render 'shared/frazione', num: 9, den: 12 %> =
            <input type="text" data-correct-answer="9" class="w-10 border-b-2 border-dotted border-gray-400 text-center font-bold bg-transparent"> :
            <input type="text" data-correct-answer="12" class="w-10 border-b-2 border-dotted border-gray-400 text-center font-bold bg-transparent"> =
            <input type="text" data-correct-answer="0,75" class="w-12 border-b-2 border-dotted border-gray-400 text-center font-bold bg-transparent"> =
            <%= render 'shared/frazione', num: nil, den: 100, num_answer: "75" %> =
            <input type="text" data-correct-answer="75%" class="w-14 border-b-2 border-dotted border-gray-400 text-center font-bold bg-transparent">
          </div>
        </div>
      </div>
    </div>

    <!-- Esercizio 3 -->
    <div>
      <p class="font-bold text-gray-700 mb-4">
        <%= numero_esercizio_badge(3) %>
        Calcola il valore della percentuale.
      </p>

      <div class="space-y-3">
        <div class="flex items-center gap-2 flex-wrap">
          <span class="text-gray-700">20% di 94</span>
          <span class="text-cyan-500">→</span>
          <input type="text" data-correct-answer="(94 : 100) × 20 = 18,8" class="flex-1 min-w-48 border-b-2 border-dotted border-gray-400 text-center font-bold bg-transparent" placeholder="operazione">
          =
          <input type="text" data-correct-answer="18,8" class="w-20 border-b-2 border-dotted border-gray-400 text-center font-bold bg-transparent">
        </div>
        <div class="flex items-center gap-2 flex-wrap">
          <span class="text-gray-700">50% di 370</span>
          <span class="text-cyan-500">→</span>
          <input type="text" data-correct-answer="(370 : 100) × 50 = 185" class="flex-1 min-w-48 border-b-2 border-dotted border-gray-400 text-center font-bold bg-transparent" placeholder="operazione">
          =
          <input type="text" data-correct-answer="185" class="w-20 border-b-2 border-dotted border-gray-400 text-center font-bold bg-transparent">
        </div>
        <div class="flex items-center gap-2 flex-wrap">
          <span class="text-gray-700">12% di <span class="whitespace-nowrap">1 260</span></span>
          <span class="text-cyan-500">→</span>
          <input type="text" data-correct-answer="(1260 : 100) × 12 = 151,2" class="flex-1 min-w-48 border-b-2 border-dotted border-gray-400 text-center font-bold bg-transparent" placeholder="operazione">
          =
          <input type="text" data-correct-answer="151,2" class="w-20 border-b-2 border-dotted border-gray-400 text-center font-bold bg-transparent">
        </div>
      </div>
    </div>

    <!-- Esercizio 4 -->
    <div>
      <p class="font-bold text-gray-700 mb-4">
        <%= numero_esercizio_badge(4) %>
        Conosci il valore della percentuale: calcola l'intero.
      </p>

      <div class="space-y-3">
        <div class="flex items-center gap-2 flex-wrap">
          <span class="text-gray-700">124 è il 62%</span>
          <span class="text-cyan-500">→</span>
          <input type="text" data-correct-answer="(124 : 62) × 100 = 200" class="flex-1 min-w-48 border-b-2 border-dotted border-gray-400 text-center font-bold bg-transparent" placeholder="operazione">
          =
          <input type="text" data-correct-answer="200" class="w-20 border-b-2 border-dotted border-gray-400 text-center font-bold bg-transparent">
        </div>
        <div class="flex items-center gap-2 flex-wrap">
          <span class="text-gray-700">765 è il 9%</span>
          <span class="text-cyan-500">→</span>
          <input type="text" data-correct-answer="(765 : 9) × 100 = 8500" class="flex-1 min-w-48 border-b-2 border-dotted border-gray-400 text-center font-bold bg-transparent" placeholder="operazione">
          =
          <input type="text" data-correct-answer="8500" class="w-20 border-b-2 border-dotted border-gray-400 text-center font-bold bg-transparent">
        </div>
        <div class="flex items-center gap-2 flex-wrap">
          <span class="text-gray-700"><span class="whitespace-nowrap">2 403</span> è il 27%</span>
          <span class="text-cyan-500">→</span>
          <input type="text" data-correct-answer="(2403 : 27) × 100 = 8900" class="flex-1 min-w-48 border-b-2 border-dotted border-gray-400 text-center font-bold bg-transparent" placeholder="operazione">
          =
          <input type="text" data-correct-answer="8900" class="w-20 border-b-2 border-dotted border-gray-400 text-center font-bold bg-transparent">
        </div>
      </div>
    </div>

    <!-- Esercizio 5: Problemi -->
    <div>
      <p class="font-bold text-gray-700 mb-4">
        <%= numero_esercizio_badge(5) %>
        Risolvi i problemi sul quaderno.
      </p>

      <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
        <div class="space-y-2">
          <p class="text-gray-700">
            <span class="font-bold text-cyan-600">a.</span> In una scuola di 320 alunni vengono raccolti i seguenti dati: il 5% pratica tennis, il 15% basket, il 20% pallavolo e il rimanente pratica il calcio. Calcola quanti alunni praticano ciascuno sport.
          </p>
        </div>
        <div class="space-y-2">
          <p class="text-gray-700">
            <span class="font-bold text-cyan-600">b.</span> Un gruppo di 22 persone decide di fare un viaggio a Londra. Il biglietto aereo costa € 127,50 a persona. La compagnia aerea fa uno sconto sulla cifra complessiva del 12%. Quanto spende in totale il gruppo?
          </p>
        </div>
      </div>
    </div>

    <%= render 'shared/exercise_controls' %>
  </div>
</div>
