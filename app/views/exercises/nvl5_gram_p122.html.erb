<div class="max-w-6xl mx-auto bg-white dark:bg-gray-900 text-black dark:text-white p-3 md:p-6 transition-colors duration-300"
     data-controller="exercise-checker text-toggle font-controls"
     data-text-toggle-target="content"
     data-font-controls-target="content">

  <%= render 'shared/page_header', pagina: @pagina %>

  <!-- Introduzione teorica -->
  <div class="bg-<%= @pagina.base_color %>-50 dark:bg-<%= @pagina.base_color %>-900/30 p-4 md:p-6 pb-8 rounded-lg">
    <p class="text-gray-700 dark:text-gray-200 mb-4">Ogni frase ha bisogno di un verbo.</p>
    <ul class="space-y-2 text-gray-700 dark:text-gray-200">
      <li><span class="text-<%= @pagina.base_color %>-500">•</span> La <strong class="underline text-orange-600">frase semplice</strong> contiene un solo verbo → <strong>Esco</strong> con Luigi.</li>
      <li><span class="text-<%= @pagina.base_color %>-500">•</span> La <strong class="underline text-green-600">frase complessa</strong> o <strong class="underline text-green-600">periodo</strong> contiene più verbi, cioè più frasi collegate tra loro da congiunzioni, da preposizioni o dalla punteggiatura. Osserva lo schema.</li>
    </ul>

    <div class="mt-6 bg-white dark:bg-gray-800 rounded-lg p-6 flex items-center justify-center gap-8 flex-wrap">
      <div class="text-center">
        <div class="font-bold text-gray-600 dark:text-gray-400 mb-2">1ª frase</div>
        <div class="">↓</div>
        <div class="border border-orange-400 dark:border-orange-500 rounded-lg px-6 py-3 bg-orange-50 dark:bg-orange-900/30">
          <strong>Sistema</strong> la tua cameretta
        </div>
      </div>
      <div class="text-center">
        <div class="font-bold text-gray-600 dark:text-gray-400 mb-2">2ª frase</div>
        <div class="">↓</div>
        <div class="border border-blue-400 dark:border-blue-500 rounded-lg px-6 py-3 bg-blue-50 dark:bg-blue-900/30">
          e <strong>uscirai</strong>!
        </div>
      </div>
    </div>
  </div>

  <!-- Esercizio 1 - IMPARARE TUTTI: Collega frasi semplici -->
  <div class="bg-<%= @pagina.base_color %>-100 dark:bg-<%= @pagina.base_color %>-900/40 p-4 md:p-6 pb-8 rounded-lg">
    <h2 class="font-bold mb-4 flex items-center gap-2">
      <span class="flex-shrink-0 bg-<%= @pagina.base_color %>-500 text-white rounded-full w-8 h-8 md:w-10 md:h-10 inline-flex items-center justify-center">1</span>
      <span class="bg-yellow-400 text-blue-900 px-3 py-1 rounded-lg font-bold">IMPARARE TUTTI</span>
      Collega tra loro le <em class="underline text-orange-600">frasi semplici</em> e forma <strong class="underline text-green-600">frasi complesse</strong>.
    </h2>

    <div class="grid grid-cols-1 md:grid-cols-2 gap-4 mb-6">
      <div class="border border-orange-400 dark:border-orange-500 rounded-lg px-4 py-3 bg-orange-50 dark:bg-orange-900/30 text-center">
        Entra in casa
      </div>
      <div class="border border-blue-400 dark:border-blue-500 rounded-lg px-4 py-3 bg-blue-50 dark:bg-blue-900/30 text-center">
        ma lo spettacolo era già finito.
      </div>

      <div class="border border-orange-400 dark:border-orange-500 rounded-lg px-4 py-3 bg-orange-50 dark:bg-orange-900/30 text-center">
        Siamo venuti qui
      </div>
      <div class="border border-blue-400 dark:border-blue-500 rounded-lg px-4 py-3 bg-blue-50 dark:bg-blue-900/30 text-center">
        così potrai scaldarti.
      </div>

      <div class="border border-orange-400 dark:border-orange-500 rounded-lg px-4 py-3 bg-orange-50 dark:bg-orange-900/30 text-center">
        Arrivammo presto
      </div>
      <div class="border border-blue-400 dark:border-blue-500 rounded-lg px-4 py-3 bg-blue-50 dark:bg-blue-900/30 text-center">
        perché Chiara ci ha invitato.
      </div>
    </div>

    <div class="bg-white dark:bg-gray-800 rounded-lg p-4">
      <p class="text-gray-600 dark:text-gray-400 italic">
        Traccia delle linee per collegare le frasi semplici a sinistra con le loro continuazioni a destra, formando frasi complesse complete.
      </p>
    </div>
  </div>

  <!-- Esercizio 2 - Leggi il testo -->
  <div class="bg-<%= @pagina.base_color %>-50 dark:bg-<%= @pagina.base_color %>-900/30 p-4 md:p-6 pb-8 rounded-lg" data-controller="multiple-choice">
    <h2 class="font-bold mb-4 flex items-center gap-2">
      <span class="flex-shrink-0 bg-<%= @pagina.base_color %>-500 text-white rounded-full w-8 h-8 md:w-10 md:h-10 inline-flex items-center justify-center">2</span>
      Leggi il testo e scrivi in fondo a ogni frase se si tratta di una <em class="underline text-orange-600">frase semplice</em> <strong>(S)</strong> o di una <strong class="underline text-green-600">frase complessa</strong> <strong>(C)</strong>.
    </h2>

    <div class="bg-white dark:bg-gray-800 rounded-lg p-6 space-y-4">
      <div class="flex items-center gap-3">
        <p class="flex-1 text-gray-700 dark:text-gray-200">Ieri sono stata dalla mia amica Luisa</p>
        <label class="flex items-center gap-2">
          <input type="checkbox" data-multiple-choice-target="answer" data-correct-answer="true" class="w-5 h-5">
          <span class="font-bold">S</span>
        </label>
        <label class="flex items-center gap-2">
          <input type="checkbox" data-multiple-choice-target="answer" data-correct-answer="false" class="w-5 h-5">
          <span class="font-bold">C</span>
        </label>
      </div>

      <div class="flex items-center gap-3">
        <p class="flex-1 text-gray-700 dark:text-gray-200">Io e Luisa trascorriamo spesso il pomeriggio insieme</p>
        <label class="flex items-center gap-2">
          <input type="checkbox" data-multiple-choice-target="answer" data-correct-answer="true" class="w-5 h-5">
          <span class="font-bold">S</span>
        </label>
        <label class="flex items-center gap-2">
          <input type="checkbox" data-multiple-choice-target="answer" data-correct-answer="false" class="w-5 h-5">
          <span class="font-bold">C</span>
        </label>
      </div>

      <div class="flex items-center gap-3">
        <p class="flex-1 text-gray-700 dark:text-gray-200">Di solito facciamo i compiti e poi giochiamo in cortile</p>
        <label class="flex items-center gap-2">
          <input type="checkbox" data-multiple-choice-target="answer" data-correct-answer="false" class="w-5 h-5">
          <span class="font-bold">S</span>
        </label>
        <label class="flex items-center gap-2">
          <input type="checkbox" data-multiple-choice-target="answer" data-correct-answer="true" class="w-5 h-5">
          <span class="font-bold">C</span>
        </label>
      </div>

      <div class="flex items-center gap-3">
        <p class="flex-1 text-gray-700 dark:text-gray-200">Se piove, leggiamo un libro o dei fumetti</p>
        <label class="flex items-center gap-2">
          <input type="checkbox" data-multiple-choice-target="answer" data-correct-answer="false" class="w-5 h-5">
          <span class="font-bold">S</span>
        </label>
        <label class="flex items-center gap-2">
          <input type="checkbox" data-multiple-choice-target="answer" data-correct-answer="true" class="w-5 h-5">
          <span class="font-bold">C</span>
        </label>
      </div>

      <div class="flex items-center gap-3">
        <p class="flex-1 text-gray-700 dark:text-gray-200">Alcune volte mi fermo a cena da Luisa</p>
        <label class="flex items-center gap-2">
          <input type="checkbox" data-multiple-choice-target="answer" data-correct-answer="true" class="w-5 h-5">
          <span class="font-bold">S</span>
        </label>
        <label class="flex items-center gap-2">
          <input type="checkbox" data-multiple-choice-target="answer" data-correct-answer="false" class="w-5 h-5">
          <span class="font-bold">C</span>
        </label>
      </div>
    </div>
  </div>

  <!-- Esercizio 3 - Sottolinea i predicati -->
  <div class="bg-white dark:bg-gray-800 p-4 md:p-6 pb-8" data-controller="word-highlighter multiple-choice" data-word-highlighter-multi-color-value="false">
    <h2 class="font-bold mb-4 flex items-center gap-2">
      <span class="flex-shrink-0 bg-<%= @pagina.base_color %>-500 text-white rounded-full w-8 h-8 md:w-10 md:h-10 inline-flex items-center justify-center">3</span>
      Sottolinea i predicati<span class="inline-block w-6 h-6 bg-yellow-300 rounded ml-2 align-middle cursor-pointer" data-word-highlighter-target="colorBox" data-color="yellow" data-action="click->word-highlighter#selectColor"></span> e indica con una <strong>X</strong> se la frase è <em class="underline text-orange-600">semplice</em> <strong>(S)</strong> o <strong class="underline text-green-600">complessa</strong> <strong>(C)</strong>.
    </h2>

    <!-- Hidden color selector for monocolor mode -->
    <div class="hidden">
      <span data-word-highlighter-target="colorBox" data-color="yellow"></span>
    </div>

    <div class="space-y-4 cursor-pointer">
      <div class="bg-<%= @pagina.base_color %>-50 dark:bg-<%= @pagina.base_color %>-900/30 rounded-lg p-4">
        <p class="text-gray-700 dark:text-gray-200 mb-3">
          <span class="text-<%= @pagina.base_color %>-500">•</span> Jacopo <span data-word-highlighter-target="word" data-correct="yellow" data-action="click->word-highlighter#toggleHighlight" class="px-1 rounded">canta</span> molto bene ed <span data-word-highlighter-target="word" data-correct="yellow" data-action="click->word-highlighter#toggleHighlight" class="px-1 rounded">è</span> anche un bravo musicista.
        </p>
        <div class="flex gap-6">
          <label class="flex items-center gap-2">
            <input type="radio" name="q3_1" data-multiple-choice-target="answer" data-correct-answer="false">
            <span class="font-bold">S</span>
          </label>
          <label class="flex items-center gap-2">
            <input type="radio" name="q3_1" data-multiple-choice-target="answer" data-correct-answer="true">
            <span class="font-bold">C</span>
          </label>
        </div>
      </div>

      <div class="bg-<%= @pagina.base_color %>-50 dark:bg-<%= @pagina.base_color %>-900/30 rounded-lg p-4">
        <p class="text-gray-700 dark:text-gray-200 mb-3">
          <span class="text-<%= @pagina.base_color %>-500">•</span> Chi non <span data-word-highlighter-target="word" data-correct="yellow" data-action="click->word-highlighter#toggleHighlight" class="px-1 rounded">gradirebbe</span> una proposta del genere?
        </p>
        <div class="flex gap-6">
          <label class="flex items-center gap-2">
            <input type="radio" name="q3_2" data-multiple-choice-target="answer" data-correct-answer="true">
            <span class="font-bold">S</span>
          </label>
          <label class="flex items-center gap-2">
            <input type="radio" name="q3_2" data-multiple-choice-target="answer" data-correct-answer="false">
            <span class="font-bold">C</span>
          </label>
        </div>
      </div>

      <div class="bg-<%= @pagina.base_color %>-50 dark:bg-<%= @pagina.base_color %>-900/30 rounded-lg p-4">
        <p class="text-gray-700 dark:text-gray-200 mb-3">
          <span class="text-<%= @pagina.base_color %>-500">•</span> <span data-word-highlighter-target="word" data-correct="yellow" data-action="click->word-highlighter#toggleHighlight" class="px-1 rounded">Passa</span> di qui quando <span data-word-highlighter-target="word" data-correct="yellow" data-action="click->word-highlighter#toggleHighlight" class="px-1 rounded">finisci</span> quel lavoro.
        </p>
        <div class="flex gap-6">
          <label class="flex items-center gap-2">
            <input type="radio" name="q3_3" data-multiple-choice-target="answer" data-correct-answer="false">
            <span class="font-bold">S</span>
          </label>
          <label class="flex items-center gap-2">
            <input type="radio" name="q3_3" data-multiple-choice-target="answer" data-correct-answer="true">
            <span class="font-bold">C</span>
          </label>
        </div>
      </div>

      <div class="bg-<%= @pagina.base_color %>-50 dark:bg-<%= @pagina.base_color %>-900/30 rounded-lg p-4">
        <p class="text-gray-700 dark:text-gray-200 mb-3">
          <span class="text-<%= @pagina.base_color %>-500">•</span> <span data-word-highlighter-target="word" data-correct="yellow" data-action="click->word-highlighter#toggleHighlight" class="px-1 rounded">Chiameremo</span> nostro zio Sergio e gli <span data-word-highlighter-target="word" data-correct="yellow" data-action="click->word-highlighter#toggleHighlight" class="px-1 rounded">diremo</span> tutto.
        </p>
        <div class="flex gap-6">
          <label class="flex items-center gap-2">
            <input type="radio" name="q3_4" data-multiple-choice-target="answer" data-correct-answer="false">
            <span class="font-bold">S</span>
          </label>
          <label class="flex items-center gap-2">
            <input type="radio" name="q3_4" data-multiple-choice-target="answer" data-correct-answer="true">
            <span class="font-bold">C</span>
          </label>
        </div>
      </div>
    </div>
  </div>

  <!-- Nota esercizi supplementari -->
  <div class="text-right text-gray-500 dark:text-gray-400 mb-6">
    Esercizi p. <%= link_to "189", pagina_path("nvl5_gram_p189"), class: "text-gray-600 dark:text-gray-400 hover:text-gray-800 dark:hover:text-gray-200 underline" %>
  </div>

  <%= render 'shared/exercise_controls' %>
</div>
