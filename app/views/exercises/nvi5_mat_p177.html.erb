<div class="max-w-6xl mx-auto bg-white p-3 md:p-6"
     data-controller="exercise-checker text-toggle font-controls"
     data-text-toggle-target="content"
     data-font-controls-target="content">

  <%= render 'shared/page_header', pagina: @pagina %>

  <div class="space-y-6">
    <!-- Esercizio 1: IMPARARE TUTTI -->
    <div class="p-4 bg-white rounded-2xl border-3 border-yellow-400">
      <p class="font-bold text-gray-700 mb-4">
        <%= imparare_tutti_badge(1) %>
        Scrivi i numeri in parola, come somma di addendi e come somma di prodotti. Segui l'esempio.
      </p>

      <!-- Esempio -->
      <div class="p-4 bg-custom-blue-light rounded-2xl mb-6">
        <div class="flex items-start gap-4">
          <span class="font-bold text-cyan-700 whitespace-nowrap"><span class="whitespace-nowrap">1 492 068</span></span>
          <div class="space-y-2 flex-1">
            <div class="flex items-center gap-2">
              <span class="text-cyan-500">→</span>
              <span class="font-bold text-cyan-700">unmilionequattrocentonovantaduemilasessantotto</span>
            </div>
            <div class="flex items-center gap-2">
              <span class="text-cyan-500">→</span>
              <span class="font-bold text-cyan-700"><span class="whitespace-nowrap">1 000 000</span> + <span class="whitespace-nowrap">400 000</span> + <span class="whitespace-nowrap">90 000</span> + <span class="whitespace-nowrap">2 000</span> + 60 + 8</span>
            </div>
            <div class="flex items-center gap-2">
              <span class="text-cyan-500">→</span>
              <span class="font-bold text-cyan-700">1 × <span class="whitespace-nowrap">1 000 000</span> + 4 × <span class="whitespace-nowrap">100 000</span> + 9 × <span class="whitespace-nowrap">10 000</span> + 2 × <span class="whitespace-nowrap">1 000</span> + 6 × 10 + 8 × 1</span>
            </div>
          </div>
        </div>
      </div>

      <!-- Numeri da completare -->
      <div class="space-y-6">
        <% ["3 010 754", "65 902 030", "8 930 050 001"].each do |num| %>
          <div class="p-4 bg-gray-50 rounded-lg">
            <div class="flex items-start gap-4">
              <span class="font-bold text-gray-700 whitespace-nowrap"><%= num %></span>
              <div class="space-y-2 flex-1">
                <div class="flex items-center gap-2">
                  <span class="text-cyan-500">→</span>
                  <input type="text" class="min-w-0 flex-1 border-b-2 border-dotted border-gray-400 bg-transparent">
                </div>
                <div class="flex items-center gap-2">
                  <span class="text-cyan-500">→</span>
                  <input type="text" class="min-w-0 flex-1 border-b-2 border-dotted border-gray-400 bg-transparent">
                </div>
                <div class="flex items-center gap-2">
                  <span class="text-cyan-500">→</span>
                  <input type="text" class="min-w-0 flex-1 border-b-2 border-dotted border-gray-400 bg-transparent">
                </div>
              </div>
            </div>
          </div>
        <% end %>
      </div>
    </div>

    <!-- Esercizio 2 -->
    <div class="mb-6">
      <p class="font-bold text-gray-700 mb-4">
        <%= numero_esercizio_badge(2) %>
        Completa come negli esempi.
      </p>

      <div class="overflow-x-auto">
        <table class="w-full border-collapse border border-cyan-400">
          <tbody>
            <!-- Esempio 1 -->
            <tr>
              <td class="p-2 border border-cyan-400 bg-custom-blue-light text-gray-800">
                <span class="whitespace-nowrap">70 000 000</span> + <span class="whitespace-nowrap">300 000</span> + <span class="whitespace-nowrap">60 000</span> + 800 + 90
              </td>
              <td class="p-2 border border-cyan-400 bg-custom-blue-light text-gray-800 text-center whitespace-nowrap font-bold">
                <span class="whitespace-nowrap">70 360 890</span>
              </td>
            </tr>
            <!-- Esempio 2 -->
            <tr>
              <td class="p-2 border border-cyan-400 bg-custom-blue-light text-gray-800">
                6 × <span class="whitespace-nowrap">1 000 000 000</span> + 5 × <span class="whitespace-nowrap">100 000 000</span> + 2 × <span class="whitespace-nowrap">1 000 000</span> + 9 × <span class="whitespace-nowrap">10 000</span> + 4 × <span class="whitespace-nowrap">1 000</span> + 6 × 10
              </td>
              <td class="p-2 border border-cyan-400 bg-custom-blue-light text-gray-800 text-center whitespace-nowrap font-bold">
                <span class="whitespace-nowrap">6 502 094 060</span>
              </td>
            </tr>
            <!-- Da completare -->
            <% [
              ["2 × 10 000 000 000 + 8 × 1 000 000 000 + 1 × 10 000 000 + 5 × 1 000 000 + 9 × 100 000 + 1 × 1 000 + 1 × 100 + 3 × 1", "28015901103"],
              ["50 000 000 000 + 400 000 000 + 5 000 000 + 70 000 + 100 + 8", "50405070108"],
              ["4 × 1 000 000 000 + 3 × 100 000 000 + 6 × 10 000 000 + 5 × 100 000 + 2 × 10 000 + 1 × 100 + 8 × 10", "4360520180"],
              ["90 000 000 000 + 7 000 000 000 + 60 000 000 + 7 000 + 700 + 30", "97060007730"]
            ].each do |expr, answer| %>
              <tr>
                <td class="p-2 border border-cyan-400 bg-white text-gray-700"><%= expr %></td>
                <td class="p-2 border border-cyan-400 bg-white text-center">
                  <input type="text" data-correct-answer="<%= answer %>" class="w-40 border-b-2 border-dotted border-gray-400 text-center font-bold bg-transparent">
                </td>
              </tr>
            <% end %>
          </tbody>
        </table>
      </div>
    </div>

    <!-- Esercizio 3 -->
    <div>
      <p class="font-bold text-gray-700 mb-4">
        <%= numero_esercizio_badge(3) %>
        Scegli con una <span class="text-custom-sky">X</span> quale tra le seguenti uguaglianze <span class="font-bold">NON</span> è corretta.
      </p>

      <div class="space-y-2">
        <label class="flex items-center gap-2 cursor-pointer hover:bg-gray-50 p-2 rounded border border-gray-200 bg-white">
          <input type="checkbox" name="es3" class="w-5 h-5" data-correct-answer="false">
          <span><span class="whitespace-nowrap">15 890 406</span> = <span class="whitespace-nowrap">10 000 000</span> + <span class="whitespace-nowrap">5 000 000</span> + <span class="whitespace-nowrap">800 000</span> + <span class="whitespace-nowrap">90 000</span> + 400 + 6</span>
        </label>
        <label class="flex items-center gap-2 cursor-pointer hover:bg-gray-50 p-2 rounded border border-gray-200 bg-white">
          <input type="checkbox" name="es3" class="w-5 h-5" data-correct-answer="false">
          <span><span class="whitespace-nowrap">15 890 406</span> = quindicimilioniottocentonovantamilaquattrocentosei</span>
        </label>
        <label class="flex items-center gap-2 cursor-pointer hover:bg-gray-50 p-2 rounded border border-gray-200 bg-white">
          <input type="checkbox" name="es3" class="w-5 h-5" data-correct-answer="true">
          <span><span class="whitespace-nowrap">15 890 406</span> = 15 dak + 8 hk + 9 dak + 4 h + 6 u</span>
        </label>
        <label class="flex items-center gap-2 cursor-pointer hover:bg-gray-50 p-2 rounded border border-gray-200 bg-white">
          <input type="checkbox" name="es3" class="w-5 h-5" data-correct-answer="false">
          <span><span class="whitespace-nowrap">15 890 406</span> = 1 × <span class="whitespace-nowrap">10 000 000</span> + 5 × <span class="whitespace-nowrap">1 000 000</span> + 8 × <span class="whitespace-nowrap">100 000</span> + 9 × <span class="whitespace-nowrap">10 000</span> + 4 × 100 + 6 × 1</span>
        </label>
      </div>
    </div>

    <%= render 'shared/exercise_controls' %>
  </div>
</div>
