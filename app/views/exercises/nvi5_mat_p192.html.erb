<div class="max-w-6xl mx-auto bg-white p-3 md:p-6"
     data-controller="exercise-checker text-toggle font-controls"
     data-text-toggle-target="content"
     data-font-controls-target="content">

  <%= render 'shared/page_header', pagina: @pagina %>

  <div class="space-y-6">
    <!-- Box teoria: Proprietà invariantiva -->
    <div class="p-4 bg-custom-blue-light rounded-2xl">
      <p class="font-bold text-gray-800 mb-4">Proprietà invariantiva</p>
      <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
        <!-- Esempio 1: divisione per 2 -->
        <div class="flex flex-col items-center">
          <div class="flex items-center gap-2">
            <span>20</span>
            <span>:</span>
            <span>4</span>
            <span>=</span>
            <span>5</span>
          </div>
          <div class="flex items-center gap-2 text-cyan-600 font-bold">
            <span>↓:2</span>
            <span class="mx-4"></span>
            <span>↓:2</span>
          </div>
          <div class="flex items-center gap-2">
            <span>10</span>
            <span>:</span>
            <span>2</span>
            <span>=</span>
            <span>5</span>
          </div>
        </div>

        <!-- Esempio 2: moltiplicazione per 4 -->
        <div class="flex flex-col items-center">
          <div class="flex items-center gap-2">
            <span>20</span>
            <span>:</span>
            <span>4</span>
            <span>=</span>
            <span>5</span>
          </div>
          <div class="flex items-center gap-2 text-cyan-600 font-bold">
            <span>↓×4</span>
            <span class="mx-4"></span>
            <span>↓×4</span>
          </div>
          <div class="flex items-center gap-2">
            <span>80</span>
            <span>:</span>
            <span>16</span>
            <span>=</span>
            <span>5</span>
          </div>
        </div>
      </div>
    </div>

    <!-- Esercizio 1: IMPARARE TUTTI - Proprietà invariantiva dividi per 5 -->
    <div class="p-4 bg-white rounded-2xl border-3 border-yellow-400">
      <p class="font-bold text-gray-700 mb-4">
        <%= imparare_tutti_badge(1) %>
        Applica la proprietà invariantiva: dividi per 5 entrambi i termini della divisione e calcola. Segui l'esempio.
      </p>

      <div class="space-y-3">
        <!-- Esempio -->
        <div class="p-2 bg-custom-blue-light rounded">
          <p class="text-gray-700">175 : 25 = <span class="font-bold text-cyan-600">(175 : 5) : (25 : 5) = 35 : 5 = 7</span></p>
        </div>

        <!-- Esercizi -->
        <div class="flex items-center gap-2">
          <span class="text-gray-700 shrink-0">340 : 85 =</span>
          <input type="text" data-correct-answer="(340 : 5) : (85 : 5) = 68 : 17 = 4" class="min-w-0 flex-1 border-b-2 border-dotted border-gray-400 text-center font-bold bg-transparent">
        </div>
        <div class="flex items-center gap-2">
          <span class="text-gray-700 shrink-0">280 : 35 =</span>
          <input type="text" data-correct-answer="(280 : 5) : (35 : 5) = 56 : 7 = 8" class="min-w-0 flex-1 border-b-2 border-dotted border-gray-400 text-center font-bold bg-transparent">
        </div>
        <div class="flex items-center gap-2">
          <span class="text-gray-700 shrink-0">375 : 15 =</span>
          <input type="text" data-correct-answer="(375 : 5) : (15 : 5) = 75 : 3 = 25" class="min-w-0 flex-1 border-b-2 border-dotted border-gray-400 text-center font-bold bg-transparent">
        </div>
        <div class="flex items-center gap-2">
          <span class="text-gray-700 shrink-0">495 : 45 =</span>
          <input type="text" data-correct-answer="(495 : 5) : (45 : 5) = 99 : 9 = 11" class="min-w-0 flex-1 border-b-2 border-dotted border-gray-400 text-center font-bold bg-transparent">
        </div>
        <div class="flex items-center gap-2">
          <span class="text-gray-700 shrink-0"><span class="whitespace-nowrap">2 585</span> : 55 =</span>
          <input type="text" data-correct-answer="(2 585 : 5) : (55 : 5) = 517 : 11 = 47" class="min-w-0 flex-1 border-b-2 border-dotted border-gray-400 text-center font-bold bg-transparent">
        </div>
      </div>
    </div>

    <!-- Esercizio 2: Proprietà invariantiva dividi per 10, 100, 1000 -->
    <div>
      <p class="font-bold text-gray-700 mb-4">
        <%= numero_esercizio_badge(2) %>
        Applica la proprietà invariantiva: dividi per 10, 100, <span class="whitespace-nowrap">1 000</span> entrambi i termini della divisione e calcola. Segui l'esempio.
      </p>

      <div class="space-y-3">
        <!-- Esempio -->
        <div class="p-2 bg-custom-blue-light rounded">
          <p class="text-gray-700"><span class="whitespace-nowrap">3 600</span> : 600 = <span class="font-bold text-cyan-600">(3 600 : 100) : (600 : 100) = 36 : 6 = 6</span></p>
        </div>

        <!-- Esercizi -->
        <div class="flex items-center gap-2">
          <span class="text-gray-700 shrink-0"><span class="whitespace-nowrap">3 900</span> : <span class="whitespace-nowrap">1 300</span> =</span>
          <input type="text" data-correct-answer="(3 900 : 100) : (1 300 : 100) = 39 : 13 = 3" class="min-w-0 flex-1 border-b-2 border-dotted border-gray-400 text-center font-bold bg-transparent">
        </div>
        <div class="flex items-center gap-2">
          <span class="text-gray-700 shrink-0"><span class="whitespace-nowrap">8 400</span> : <span class="whitespace-nowrap">2 100</span> =</span>
          <input type="text" data-correct-answer="(8 400 : 100) : (2 100 : 100) = 84 : 21 = 4" class="min-w-0 flex-1 border-b-2 border-dotted border-gray-400 text-center font-bold bg-transparent">
        </div>
        <div class="flex items-center gap-2">
          <span class="text-gray-700 shrink-0"><span class="whitespace-nowrap">75 900</span> : 300 =</span>
          <input type="text" data-correct-answer="(75 900 : 100) : (300 : 100) = 759 : 3 = 253" class="min-w-0 flex-1 border-b-2 border-dotted border-gray-400 text-center font-bold bg-transparent">
        </div>
        <div class="flex items-center gap-2">
          <span class="text-gray-700 shrink-0"><span class="whitespace-nowrap">28 000</span> : <span class="whitespace-nowrap">7 000</span> =</span>
          <input type="text" data-correct-answer="(28 000 : 1 000) : (7 000 : 1 000) = 28 : 7 = 4" class="min-w-0 flex-1 border-b-2 border-dotted border-gray-400 text-center font-bold bg-transparent">
        </div>
        <div class="flex items-center gap-2">
          <span class="text-gray-700 shrink-0">750 : 250 =</span>
          <input type="text" data-correct-answer="(750 : 10) : (250 : 10) = 75 : 25 = 3" class="min-w-0 flex-1 border-b-2 border-dotted border-gray-400 text-center font-bold bg-transparent">
        </div>
        <div class="flex items-center gap-2">
          <span class="text-gray-700 shrink-0"><span class="whitespace-nowrap">3 500</span> : 50 =</span>
          <input type="text" data-correct-answer="(3 500 : 10) : (50 : 10) = 350 : 5 = 70" class="min-w-0 flex-1 border-b-2 border-dotted border-gray-400 text-center font-bold bg-transparent">
        </div>
        <div class="flex items-center gap-2">
          <span class="text-gray-700 shrink-0"><span class="whitespace-nowrap">4 800</span> : <span class="whitespace-nowrap">2 400</span> =</span>
          <input type="text" data-correct-answer="(4 800 : 100) : (2 400 : 100) = 48 : 24 = 2" class="min-w-0 flex-1 border-b-2 border-dotted border-gray-400 text-center font-bold bg-transparent">
        </div>
      </div>
    </div>

    <!-- Esercizio 3: Proprietà invariantiva sul quaderno -->
    <div>
      <p class="font-bold text-gray-700 mb-4">
        <%= numero_esercizio_badge(3) %>
        Applica la proprietà invariantiva ed esegui i calcoli sul quaderno.
      </p>

      <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
        <!-- Colonna a -->
        <div class="space-y-2">
          <p class="font-bold text-cyan-600">a.</p>
          <p class="text-gray-700">7,2 : 2,4 =</p>
          <p class="text-gray-700">180 : 45 =</p>
          <p class="text-gray-700">250 : 25 =</p>
          <p class="text-gray-700">43,2 : 2,4 =</p>
          <p class="text-gray-700">540 : 36 =</p>
          <p class="text-gray-700">210 : 35 =</p>
        </div>

        <!-- Colonna b -->
        <div class="space-y-2">
          <p class="font-bold text-cyan-600">b.</p>
          <p class="text-gray-700">740 : 20 =</p>
          <p class="text-gray-700"><span class="whitespace-nowrap">4 260</span> : 60 =</p>
          <p class="text-gray-700"><span class="whitespace-nowrap">3 500</span> : 500 =</p>
          <p class="text-gray-700">962,5 : 2,5 =</p>
          <p class="text-gray-700"><span class="whitespace-nowrap">1 800</span> : 90 =</p>
          <p class="text-gray-700"><span class="whitespace-nowrap">2 400</span> : 300 =</p>
        </div>
      </div>
    </div>

    <!-- Esercizio 4: Quiz scelta multipla -->
    <div>
      <p class="font-bold text-gray-700 mb-4">
        <%= numero_esercizio_badge(4) %>
        Osserva la divisione e scegli con una <span class="font-bold">X</span> la scrittura in cui è stata applicata correttamente la proprietà invariantiva.
      </p>

      <div class="grid grid-cols-1 md:grid-cols-2 gap-6 items-start">
        <!-- Divisione da analizzare -->
        <div class="p-4 bg-custom-blue-light rounded-2xl">
          <p class="font-bold text-gray-800">112 : 16 =</p>
        </div>

        <!-- Opzioni di risposta -->
        <div class="space-y-3">
          <label class="flex items-center gap-3 cursor-pointer hover:bg-gray-50 p-2 rounded border border-gray-200">
            <input type="checkbox" class="w-5 h-5" data-correct-answer="false">
            <span class="text-gray-700">(112 × 4) : (16 : 4)</span>
          </label>
          <label class="flex items-center gap-3 cursor-pointer hover:bg-gray-50 p-2 rounded border border-gray-200">
            <input type="checkbox" class="w-5 h-5" data-correct-answer="false">
            <span class="text-gray-700">(112 × 4) × (16 × 4)</span>
          </label>
          <label class="flex items-center gap-3 cursor-pointer hover:bg-gray-50 p-2 rounded border border-gray-200">
            <input type="checkbox" class="w-5 h-5" data-correct-answer="true">
            <span class="text-gray-700">(112 : 4) : (16 : 4)</span>
          </label>
          <label class="flex items-center gap-3 cursor-pointer hover:bg-gray-50 p-2 rounded border border-gray-200">
            <input type="checkbox" class="w-5 h-5" data-correct-answer="false">
            <span class="text-gray-700">(112 : 4) × (16 : 4)</span>
          </label>
        </div>
      </div>
    </div>

    <%= render 'shared/exercise_controls' %>
  </div>
</div>
