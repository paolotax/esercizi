<div class="max-w-6xl mx-auto bg-white dark:bg-gray-900 text-black dark:text-white p-3 md:p-6 transition-colors duration-300"
     data-controller="exercise-checker text-toggle font-controls"
     data-text-toggle-target="content"
     data-font-controls-target="content">

  <%= render 'shared/page_header', pagina: @pagina %>

  <!-- Explanation Box: Sillaba CE -->
  <div class="bg-yellow-50 dark:bg-yellow-900/30 border-4 border-yellow-400 dark:border-yellow-600 rounded-lg p-6 mb-8">
    <h2 class="text-xl font-bold text-gray-800 dark:text-gray-100 mb-4">La sillaba <span class="text-pink-600">CE</span> di solito non vuole la <span class="text-pink-600">I</span>. Fanno eccezione:</h2>
    <ul class="space-y-2 text-lg ml-6">
      <li>‚Ä¢ il plurale delle parole che terminano in <span class="font-bold text-pink-600">CIA</span> se la sillaba √® preceduta da <span class="font-bold">vocale</span> ‚Üí farma<span class="text-pink-600">cia</span> / farma<span class="text-pink-600">cie</span></li>
      <li>‚Ä¢ alcune parole ‚Üí pasti<span class="text-pink-600">cciere</span>, socie<span class="text-pink-600">t√†</span>, suffi<span class="text-pink-600">ciente</span>, <span class="text-pink-600">cielo</span>, gratta<span class="text-pink-600">cielo</span>, <span class="text-pink-600">cieco</span>...</li>
    </ul>
    <div class="mt-4 flex justify-end">
      <div class="text-8xl">üë®‚Äçüç≥</div>
    </div>
  </div>

  <!-- Exercise 4: Complete with CE or CIE -->
  <div class="mb-12 bg-white dark:bg-gray-800 rounded-lg p-6 shadow-md">
    <h2 class="text-2xl font-bold text-pink-600 dark:text-pink-400 mb-6">
      <span class="bg-pink-600 text-white rounded-full w-10 h-10 inline-flex items-center justify-center mr-2">4</span>
      Completa con <span class="font-bold">CE</span> o <span class="font-bold">CIE</span>.
    </h2>

    <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4 md:gap-6" data-controller="fill-blanks">
      <% completions = [
        {prefix: 'gratta', suffix: 'lo', answer: 'cie'},
        {prefix: '', suffix: 'lo', answer: 'cie'},
        {prefix: 'can', suffix: 'llo', answer: 'ce'},
        {prefix: 'vin', suffix: 're', answer: 'ce'},
        {prefix: 'insuffi', suffix: 'nte', answer: 'cie'},
        {prefix: 'no', suffix: '', answer: 'ce'},
        {prefix: 'a', suffix: 'to', answer: 'ce'},
        {prefix: 'dol', suffix: 'zza', answer: 'ce'},
        {prefix: 'pastic', suffix: 're', answer: 'cie'},
        {prefix: '', suffix: 'rvello', answer: 'ce'},
        {prefix: '', suffix: 'mento', answer: 'ci'},
        {prefix: 'dol', suffix: '', answer: 'ce'},
        {prefix: '', suffix: 'rtificato', answer: 'ce'},
        {prefix: 'so', suffix: 'et√†', answer: 'ce'},
        {prefix: '', suffix: 'triolo', answer: 'ce'},
        {prefix: 'corni', suffix: '', answer: 'ce'}
      ] %>

      <% completions.each_with_index do |item, idx| %>
        <div class="flex flex-wrap items-center gap-1 md:gap-2 text-base md:text-xl font-bold">
          <span class="whitespace-nowrap">‚Ä¢ <%= item[:prefix] %></span>
          <input type="text"
                 class="border-b-4 border-pink-500 bg-transparent dark:text-white w-12 md:w-16 text-center focus:outline-none focus:border-pink-700 flex-shrink-0"
                 data-fill-blanks-target="input"
                 data-answer="<%= item[:answer] %>"
                 data-correct-answer="<%= item[:answer] %>"
                 maxlength="3">
          <span class="whitespace-nowrap"><%= item[:suffix] %></span>
        </div>
      <% end %>
    </div>

    <button class="mt-6 bg-pink-500 hover:bg-pink-600 text-white font-bold py-3 px-6 rounded-full transition"
            data-action="click->fill-blanks#checkAnswers">
      Controlla
    </button>
  </div>

  <!-- Exercise 5: Volgi al plurale (single words) -->
  <div class="mb-12 bg-white dark:bg-gray-800 rounded-lg p-6 shadow-md">
    <h2 class="text-2xl font-bold text-pink-600 dark:text-pink-400 mb-6">
      <span class="bg-pink-600 text-white rounded-full w-10 h-10 inline-flex items-center justify-center mr-2">5</span>
      Volgi al <span class="text-blue-600 font-bold">plurale</span>.
    </h2>

    <div class="grid md:grid-cols-3 gap-6" data-controller="fill-blanks">
      <% plurals = [
        {singular: 'treccia', plural: 'trecce'},
        {singular: 'lancia', plural: 'lance'},
        {singular: 'farmacia', plural: 'farmacie'},
        {singular: 'goccia', plural: 'gocce'},
        {singular: 'bilancia', plural: 'bilance'},
        {singular: 'fradicia', plural: 'fradice'}
      ] %>

      <% plurals.each do |item| %>
        <div class="flex flex-wrap items-center gap-2 md:gap-3">
          <span class="text-base md:text-xl font-bold whitespace-nowrap">‚Ä¢ <%= item[:singular] %></span>
          <span class="text-xl md:text-2xl text-pink-500 flex-shrink-0">‚Üí</span>
          <input type="text"
                 class="border-b-4 border-pink-500 bg-transparent dark:text-white flex-1 min-w-[120px] text-base md:text-xl font-bold focus:outline-none focus:border-pink-700"
                 data-fill-blanks-target="input"
                 data-answer="<%= item[:plural] %>"
                 data-correct-answer="<%= item[:plural] %>"
                 placeholder="...">
        </div>
      <% end %>
    </div>

    <button class="mt-6 bg-pink-500 hover:bg-pink-600 text-white font-bold py-3 px-6 rounded-full transition"
            data-action="click->fill-blanks#checkAnswers">
      Controlla
    </button>
  </div>

  <!-- Exercise 6: Volgi al plurale (phrases) -->
  <div class="mb-12 bg-white dark:bg-gray-800 rounded-lg p-6 shadow-md">
    <h2 class="text-2xl font-bold text-pink-600 dark:text-pink-400 mb-6">
      <span class="bg-pink-600 text-white rounded-full w-10 h-10 inline-flex items-center justify-center mr-2">6</span>
      Volgi al <span class="text-blue-600 font-bold">plurale</span> le seguenti espressioni.
    </h2>

    <div class="space-y-4">
      <% phrases = [
        {singular: 'La camicia sudicia', plural: 'Le camicie sudicie'},
        {singular: "L'arancia succosa", plural: 'Le arance succose'},
        {singular: 'La micia bianca', plural: 'Le micie bianche'},
        {singular: 'La focaccia salata', plural: 'Le focacce salate'},
        {singular: 'La freccia appuntita', plural: 'Le frecce appuntite'},
        {singular: 'La doccia calda', plural: 'Le docce calde'}
      ] %>

      <% phrases.each do |item| %>
        <div class="flex flex-wrap items-center gap-2 md:gap-3 border-l-4 border-pink-500 pl-3 md:pl-4">
          <span class="text-base md:text-lg font-semibold text-gray-600 dark:text-gray-400 whitespace-nowrap">‚Ä¢ <%= item[:singular] %></span>
          <span class="text-xl md:text-2xl text-pink-500 flex-shrink-0">‚Üí</span>
          <input type="text"
                 class="flex-1 min-w-[150px] border-b-2 border-gray-300 dark:border-gray-600 focus:border-pink-500 bg-transparent dark:text-white text-base md:text-lg font-bold focus:outline-none py-2"
                 data-fill-blanks-target="input"
                 data-answer="<%= item[:plural] %>"
                 data-correct-answer="<%= item[:plural] %>"
                 placeholder="Scrivi il plurale...">
        </div>
      <% end %>
    </div>

    <button class="mt-6 bg-pink-500 hover:bg-pink-600 text-white font-bold py-3 px-6 rounded-full transition"
            data-action="click->fill-blanks#checkAnswers">
      Controlla
    </button>
  </div>

  <!-- Exercise 7: Write sentences -->
  <div class="mb-12 bg-white dark:bg-gray-800 rounded-lg p-6 shadow-md">
    <h2 class="text-2xl font-bold text-pink-600 dark:text-pink-400 mb-6">
      <span class="bg-pink-600 text-white rounded-full w-10 h-10 inline-flex items-center justify-center mr-2">7</span>
      Scrivi sul quaderno una frase con ciascuna parola.
    </h2>

    <div class="grid md:grid-cols-2 gap-4 mb-6">
      <div class="bg-yellow-50 dark:bg-yellow-900/30 border-2 border-yellow-400 dark:border-yellow-600 rounded-lg p-4 text-center">
        <span class="text-2xl font-bold dark:text-gray-100">pasticciere</span>
      </div>
      <div class="bg-blue-50 dark:bg-blue-900/30 border-2 border-blue-400 dark:border-blue-600 rounded-lg p-4 text-center">
        <span class="text-2xl font-bold dark:text-gray-100">cervo</span>
      </div>
      <div class="bg-purple-50 dark:bg-purple-900/30 border-2 border-purple-400 dark:border-purple-600 rounded-lg p-4 text-center">
        <span class="text-2xl font-bold dark:text-gray-100">crociera</span>
      </div>
      <div class="bg-green-50 dark:bg-green-900/30 border-2 border-green-400 dark:border-green-600 rounded-lg p-4 text-center">
        <span class="text-2xl font-bold dark:text-gray-100">voce</span>
      </div>
    </div>

    <div class="bg-gradient-to-r from-green-100 to-green-200 dark:from-green-900/30 dark:to-green-800/30 rounded-lg p-6">
      <div class="flex items-start gap-4">
        <div class="text-8xl">ü¶å</div>
        <div class="flex-1">
          <div class="text-sm font-bold text-gray-600 dark:text-gray-400 mb-2">Esempio:</div>
          <textarea class="w-full border-2 border-green-400 dark:border-green-600 rounded-lg p-4 text-lg focus:outline-none focus:border-green-600 bg-white dark:bg-gray-800 dark:text-white"
                    rows="3"
                    placeholder="Scrivi le tue frasi qui..."></textarea>
        </div>
      </div>
    </div>
  </div>

  <!-- GIOCO: Riddle -->
  <div class="mb-12 bg-gradient-to-r from-yellow-100 via-orange-100 to-red-100 dark:from-yellow-900/30 dark:via-orange-900/30 dark:to-red-900/30 rounded-lg p-6 shadow-lg border-4 border-yellow-400 dark:border-yellow-600">
    <div class="flex items-center gap-3 mb-4">
      <span class="text-4xl">üéÆ</span>
      <h2 class="text-3xl font-bold" style="color: #ff6b35;">GIOCO</h2>
    </div>

    <h3 class="text-xl font-bold text-gray-800 dark:text-gray-100 mb-4">Rispondi all'indovinello.</h3>

    <div class="bg-white dark:bg-gray-800 rounded-lg p-6 mb-4">
      <p class="text-lg font-semibold text-gray-700 dark:text-gray-300">
        ‚Ä¢ √à azzurro, grande ed √® il lenzuolo su cui dormono le nuvole. Che cos'√®?
      </p>

      <div class="mt-6">
        <input type="text"
               class="w-full border-b-4 border-yellow-500 bg-transparent dark:text-white text-2xl font-bold focus:outline-none focus:border-yellow-700 py-3"
               placeholder="Scrivi la tua risposta..."
               data-answer="cielo">
      </div>
    </div>

    <button class="bg-yellow-500 hover:bg-yellow-600 text-white font-bold py-3 px-8 rounded-full transition"
            onclick="this.previousElementSibling.querySelector('input').value.toLowerCase() === 'cielo' || this.previousElementSibling.querySelector('input').value.toLowerCase() === 'il cielo' ? alert('‚úÖ Corretto! √à il CIELO!') : alert('‚ùå Riprova!')">
      Controlla risposta
    </button>
  </div>

  <!-- Exercise Controls -->
  <%= render 'shared/exercise_controls', color: 'pink' %>
</div>
