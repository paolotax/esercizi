<div class="max-w-6xl mx-auto p-3 md:p-8 bg-gradient-to-br from-blue-50 via-pink-50 to-blue-50 rounded-3xl shadow-xl relative overflow-hidden" data-controller="exercise-checker page-viewer number-line" data-page-viewer-image-url-value="<%= asset_path('nvi5_mat/p009/page.png') %>">

  <!-- Background watermark pattern -->
  <div class="absolute inset-0 opacity-5 pointer-events-none text-6xl font-bold text-gray-400 select-none" style="line-height: 1.5; overflow: hidden;">
    <div class="grid grid-cols-8 gap-4 p-4">
      <% 50.times do %>
        <span>+1 -2 0 +3 -5</span>
      <% end %>
    </div>
  </div>

  <!-- Header -->
  <div class="mb-8 relative z-10">
    <div class="flex items-start sm:items-center justify-between gap-4 mb-4">
      <div class="flex flex-col-reverse sm:flex-row items-start sm:items-center gap-2 sm:gap-4">
        <div class="flex items-center gap-2">
          <div class="w-12 h-12 sm:w-16 sm:h-16 rounded-full bg-gradient-to-br from-pink-400 to-pink-600 flex items-center justify-center">
            <span class="text-white font-bold text-xs sm:text-sm">PAROLE</span>
          </div>
          <div class="text-xs sm:text-sm font-medium text-gray-600">al centro</div>
        </div>
        <h1 class="text-2xl sm:text-3xl font-bold text-pink-600">NUMERI RELATIVI</h1>
      </div>
      <div class="cursor-pointer hover:bg-blue-700 transition-colors flex-shrink-0 bg-blue-600 text-white rounded-full w-10 h-10 sm:w-12 sm:h-12 flex items-center justify-center font-bold text-lg sm:text-xl"
           data-action="click->page-viewer#openOriginal" title="Clicca per vedere la pagina originale">
        9
      </div>
    </div>
  </div>

  <div class="space-y-8 relative z-10">
    <!-- Mappa concettuale -->
    <div class="bg-white rounded-3xl border-4 border-pink-300 shadow-2xl p-6 md:p-8">
      <!-- Titolo centrale -->
      <div class="flex justify-center mb-8">
        <div class="bg-gradient-to-r from-pink-400 to-pink-600 text-white text-xl md:text-2xl px-8 py-4 rounded-full font-bold shadow-lg">
          NUMERI RELATIVI
        </div>
      </div>

      <!-- Due rami -->
      <div class="grid grid-cols-1 md:grid-cols-2 gap-8 mt-8">
        <!-- NUMERI POSITIVI -->
        <div class="flex flex-col items-center">
          <!-- Connettore -->
          <div class="w-px h-8 bg-pink-400 hidden md:block"></div>

          <!-- Box titolo -->
          <div class="bg-gradient-to-r from-pink-400 to-pink-500 text-white text-lg md:text-xl px-6 py-3 rounded-full font-bold shadow-md mb-4">
            NUMERI POSITIVI
          </div>

          <!-- Connettore -->
          <div class="w-px h-12 bg-pink-300"></div>

          <!-- Box numero -->
          <div class="bg-white border-4 border-pink-400 rounded-2xl w-48 h-32 flex items-center justify-center shadow-lg mb-4">
            <span class="text-6xl font-bold text-blue-600">+4</span>
          </div>

          <!-- Connettore -->
          <div class="w-px h-12 bg-pink-300"></div>

          <!-- Come si legge -->
          <div class="bg-pink-100 border-2 border-pink-300 rounded-full px-6 py-2 font-medium text-pink-600 mb-3">
            COME SI LEGGE
          </div>

          <!-- Connettore -->
          <div class="w-px h-8 bg-pink-300"></div>

          <!-- Lettura -->
          <div class="bg-white border-4 border-pink-400 rounded-2xl px-8 py-4 shadow-lg">
            <span class="text-2xl font-bold text-pink-600">PIÃ™ QUATTRO</span>
          </div>
        </div>

        <!-- NUMERI NEGATIVI -->
        <div class="flex flex-col items-center">
          <!-- Connettore -->
          <div class="w-px h-8 bg-pink-400 hidden md:block"></div>

          <!-- Box titolo -->
          <div class="bg-gradient-to-r from-pink-400 to-pink-500 text-white text-lg md:text-xl px-6 py-3 rounded-full font-bold shadow-md mb-4">
            NUMERI NEGATIVI
          </div>

          <!-- Connettore -->
          <div class="w-px h-12 bg-pink-300"></div>

          <!-- Box numero -->
          <div class="bg-white border-4 border-pink-400 rounded-2xl w-48 h-32 flex items-center justify-center shadow-lg mb-4">
            <span class="text-6xl font-bold text-blue-600">-4</span>
          </div>

          <!-- Connettore -->
          <div class="w-px h-12 bg-pink-300"></div>

          <!-- Come si legge -->
          <div class="bg-pink-100 border-2 border-pink-300 rounded-full px-6 py-2 font-medium text-pink-600 mb-3">
            COME SI LEGGE
          </div>

          <!-- Connettore -->
          <div class="w-px h-8 bg-pink-300"></div>

          <!-- Lettura -->
          <div class="bg-white border-4 border-pink-400 rounded-2xl px-8 py-4 shadow-lg">
            <span class="text-2xl font-bold text-pink-600">MENO QUATTRO</span>
          </div>
        </div>
      </div>
    </div>

    <!-- Esercizio Completa -->
    <div class="bg-white rounded-2xl border-4 border-pink-300 shadow-2xl p-6 md:p-8">
      <div class="flex items-center gap-3 mb-6">
        <div class="w-8 h-8 bg-pink-500 rounded-full flex items-center justify-center">
          <svg class="w-5 h-5 text-white" fill="currentColor" viewBox="0 0 20 20">
            <path d="M9 2a1 1 0 000 2h2a1 1 0 100-2H9z"/>
            <path fill-rule="evenodd" d="M4 5a2 2 0 012-2 3 3 0 003 3h2a3 3 0 003-3 2 2 0 012 2v11a2 2 0 01-2 2H6a2 2 0 01-2-2V5zm3 4a1 1 0 000 2h.01a1 1 0 100-2H7zm3 0a1 1 0 000 2h3a1 1 0 100-2h-3zm-3 4a1 1 0 100 2h.01a1 1 0 100-2H7zm3 0a1 1 0 100 2h3a1 1 0 100-2h-3z" clip-rule="evenodd"/>
          </svg>
        </div>
        <h3 class="text-xl font-bold text-pink-600">Completa.</h3>
      </div>

      <div class="space-y-4 text-lg">
        <div class="flex flex-wrap items-center gap-2">
          <span>I</span>
          <span class="font-bold text-pink-600">NUMERI POSITIVI</span>
          <span>e i</span>
          <input type="text"
                 class="w-48 px-4 py-2 border-b-4 border-pink-300 focus:border-pink-500 focus:outline-none font-bold text-pink-700 bg-pink-50 rounded-lg transition-colors"
                 data-correct-answer="NUMERI NEGATIVI"
                 placeholder="...........................">
          <span>sono</span>
          <span class="font-bold text-pink-600">NUMERI RELATIVI</span><span>.</span>
        </div>

        <div class="flex flex-wrap items-center gap-2">
          <span>I</span>
          <span class="font-bold text-pink-600">NUMERI</span>
          <input type="text"
                 class="w-48 px-4 py-2 border-b-4 border-pink-300 focus:border-pink-500 focus:outline-none font-bold text-pink-700 bg-pink-50 rounded-lg transition-colors"
                 data-correct-answer="POSITIVI"
                 placeholder="...........................">
          <span>sono preceduti dal segno</span>
          <span class="font-bold text-blue-600 text-2xl">+</span><span>.</span>
        </div>

        <div class="flex flex-wrap items-center gap-2">
          <span>I</span>
          <span class="font-bold text-pink-600">NUMERI</span>
          <input type="text"
                 class="w-48 px-4 py-2 border-b-4 border-pink-300 focus:border-pink-500 focus:outline-none font-bold text-pink-700 bg-pink-50 rounded-lg transition-colors"
                 data-correct-answer="NEGATIVI"
                 placeholder="...........................">
          <span>sono preceduti dal segno</span>
          <span class="font-bold text-blue-600 text-2xl">-</span><span>.</span>
        </div>
      </div>
    </div>

    <!-- Esercizio Linea dei numeri -->
    <div class="bg-white rounded-2xl border-4 border-blue-300 shadow-2xl p-6 md:p-8">
      <div class="flex items-center gap-3 mb-6">
        <div class="w-8 h-8 bg-blue-500 rounded-full flex items-center justify-center">
          <svg class="w-5 h-5 text-white" fill="currentColor" viewBox="0 0 20 20">
            <path d="M9 2a1 1 0 000 2h2a1 1 0 100-2H9z"/>
            <path fill-rule="evenodd" d="M4 5a2 2 0 012-2 3 3 0 003 3h2a3 3 0 003-3 2 2 0 012 2v11a2 2 0 01-2 2H6a2 2 0 01-2-2V5zm3 4a1 1 0 000 2h.01a1 1 0 100-2H7zm3 0a1 1 0 000 2h3a1 1 0 100-2h-3zm-3 4a1 1 0 100 2h.01a1 1 0 100-2H7zm3 0a1 1 0 100 2h3a1 1 0 100-2h-3z" clip-rule="evenodd"/>
          </svg>
        </div>
        <h3 class="text-xl font-bold text-blue-600">
          Osserva la linea dei numeri e cerchia
          <span class="text-blue-700">-7</span> e
          <span class="text-blue-700">+5</span>.
        </h3>
      </div>

      <!-- Number Line -->
      <div class="overflow-x-auto pb-4">
        <div class="min-w-max px-4">
          <!-- Arrow left and line -->
          <div class="flex items-center justify-center mb-4">
            <svg class="w-6 h-6 text-blue-600 flex-shrink-0" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="3" d="M15 19l-7-7 7-7"/>
            </svg>
            <div class="flex-1 h-1 bg-blue-600 mx-2"></div>
          </div>

          <!-- Numbers -->
          <div class="flex items-center justify-between gap-4 md:gap-6">
            <% [-9, -8, -7, -6, -5, -4, -3, -2, -1, 0, 1, 2, 3, 4, 5, 6, 7, 8, 9].each do |num| %>
              <div class="flex flex-col items-center gap-2">
                <!-- Dot -->
                <div class="w-3 h-3 rounded-full bg-blue-600"></div>

                <!-- Number button -->
                <button type="button"
                        class="number-circle w-12 h-12 md:w-14 md:h-14 rounded-full border-3 flex items-center justify-center font-bold text-base md:text-lg transition-all duration-300 hover:scale-110 focus:outline-none"
                        data-number="<%= num %>"
                        data-number-line-target="numberButton"
                        data-action="click->number-line#toggleNumber"
                        data-correct="<%= num == -7 || num == 5 %>">
                  <% if num >= 0 && num > 0 %>
                    <span class="text-blue-700">+<%= num %></span>
                  <% elsif num == 0 %>
                    <span class="text-gray-700"><%= num %></span>
                  <% else %>
                    <span class="text-blue-700"><%= num %></span>
                  <% end %>
                </button>
              </div>
            <% end %>
          </div>

          <!-- Arrow right -->
          <div class="flex items-center justify-center mt-4">
            <div class="flex-1 h-1 bg-blue-600 mx-2"></div>
            <svg class="w-6 h-6 text-blue-600 flex-shrink-0" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="3" d="M9 5l7 7-7 7"/>
            </svg>
          </div>
        </div>
      </div>

      <!-- Feedback message -->
      <div class="mt-6 text-center">
        <div data-number-line-target="feedback" class="hidden text-lg font-semibold"></div>
      </div>
    </div>

    <!-- Exercise Controls -->
    <%= render 'shared/exercise_controls', color: 'pink', current_page: 'nvi5_mat_p009' %>

  </div>
</div>

<style>
  .number-circle {
    border-color: #3b82f6;
    background-color: white;
    color: #1e40af;
  }

  .number-circle.selected {
    background-color: #3b82f6;
    color: white;
    border-color: #1e40af;
    border-width: 4px;
    transform: scale(1.15);
    box-shadow: 0 4px 12px rgba(59, 130, 246, 0.4);
  }

  .number-circle:hover {
    border-color: #2563eb;
    box-shadow: 0 2px 8px rgba(59, 130, 246, 0.3);
  }
</style>
