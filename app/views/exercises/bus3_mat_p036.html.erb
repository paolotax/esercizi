<div class="max-w-7xl mx-auto p-3 md:p-6 bg-white dark:bg-gray-900 text-black dark:text-white transition-colors duration-300"
     data-controller="exercise-checker fill-blanks auto-advance text-toggle font-controls"
     data-text-toggle-target="content"
     data-font-controls-target="content">

  <!-- Header -->
  <%= render 'shared/page_header', pagina: @pagina %>

  <!-- Esercizio 1 -->
  <div class="bg-transparent p-4 md:p-8 mb-8">
    <div class="flex items-center gap-3 mb-6">
      <div class="bg-red-500 text-white rounded-full w-8 h-8 flex items-center justify-center font-bold flex-shrink-0">
        1
      </div>
      <p class="text-gray-700 dark:text-gray-200">
        <strong>Completa gli schemi.</strong>
      </p>
    </div>

    <div class="grid grid-cols-1 md:grid-cols-[1fr_auto] gap-6 items-center">
      <div class="flex justify-center">
        <div class="bg-transparent dark:bg-white rounded-xl p-2 inline-block">
          <%= image_tag "bus3_mat/p036/p36_1.jpg",
              alt: "Schemi operazioni inverse",
              class: "max-w-full" %>
        </div>
      </div>

      <!-- Box teorico -->
      <div class="bg-pink-50 dark:bg-pink-900/30 border-3 border-pink-400 dark:border-pink-500 rounded-lg p-6 my-auto">
        <div class="flex items-start gap-3">
          <div class="flex-shrink-0">ðŸ˜Š</div>
          <p class="text-gray-700 dark:text-gray-200">
            <strong>L'<span class="text-cyan-600 dark:text-cyan-400">addizione</span> e la <span class="text-cyan-600 dark:text-cyan-400">sottrazione</span> sono <span class="text-cyan-600 dark:text-cyan-400">operazioni inverse</span>.</strong>
          </p>
        </div>
      </div>
    </div>
  </div>

  <!-- Esercizio 2 -->
  <div class="bg-transparent p-4 md:p-8 mb-8">
    <div class="flex items-center gap-3 mb-6">
      <div class="bg-red-500 text-white rounded-full w-8 h-8 flex items-center justify-center font-bold flex-shrink-0">
        2
      </div>
      <p class="text-gray-700 dark:text-gray-200">
        <strong>Completa gli schemi.</strong>
      </p>
    </div>

    <div class="flex justify-center">
      <div class="bg-transparent dark:bg-white rounded-xl p-2 inline-block">
        <%= image_tag "bus3_mat/p036/p36_8.jpg",
            alt: "Schemi operazioni",
            class: "max-w-full" %>
      </div>
    </div>
  </div>

  <!-- Esercizio 3 -->
  <div class="bg-transparent p-4 md:p-8 mb-8">
    <div class="flex items-center gap-3 mb-6">
      <div class="bg-red-500 text-white rounded-full w-8 h-8 flex items-center justify-center font-bold flex-shrink-0">
        3
      </div>
      <p class="text-gray-700 dark:text-gray-200">
        <strong>Trova il numero mancante: prima svolgi l'operazione inversa che ti permette di calcolarlo, poi completa. Osserva gli esempi.</strong>
      </p>
    </div>

    <div class="grid grid-cols-1 md:grid-cols-2 gap-x-8 gap-y-6">
      <!-- Colonna sinistra: Addizioni -->
      <div class="space-y-4">
        <!-- Esempio -->
        <div class="flex items-center justify-between gap-4">
          <span class="text-gray-700 dark:text-gray-200"><strong>45</strong> + 8 = 53</span>
          <div class="bg-white dark:bg-gray-800 border-2 border-cyan-400 dark:border-cyan-500 rounded-lg px-4 py-2">
            <span class="font-bold dark:text-white">53 - <strong>8</strong> = <strong>45</strong></span>
          </div>
        </div>

        <div class="flex items-center justify-between gap-4">
          <div class="flex items-center gap-2">
            <input type="text" data-fill-blanks-target="input" data-correct-answer="20"
                   class="w-16 px-2 py-1 border-b-2 border-dotted border-gray-400 dark:border-gray-500 bg-transparent dark:text-white text-center font-bold"
                   maxlength="2" inputmode="numeric">
            <span class="text-gray-700 dark:text-gray-200">+ 20 = 40</span>
          </div>
          <div class="bg-white dark:bg-gray-800 border-2 border-cyan-400 dark:border-cyan-500 rounded-lg px-4 py-2 flex items-center gap-2">
            <span class="dark:text-white">40 -</span>
            <input type="text" data-fill-blanks-target="input" data-correct-answer="20"
                   class="w-12 px-2 py-1 border-b-2 border-dotted border-gray-400 dark:border-gray-500 bg-transparent dark:text-white text-center font-bold"
                   maxlength="2" inputmode="numeric">
            <span class="dark:text-white">=</span>
            <input type="text" data-fill-blanks-target="input" data-correct-answer="20"
                   class="w-12 px-2 py-1 border-b-2 border-dotted border-gray-400 dark:border-gray-500 bg-transparent dark:text-white text-center font-bold"
                   maxlength="2" inputmode="numeric">
          </div>
        </div>

        <div class="flex items-center justify-between gap-4">
          <div class="flex items-center gap-2">
            <span class="text-gray-700 dark:text-gray-200">11 +</span>
            <input type="text" data-fill-blanks-target="input" data-correct-answer="36"
                   class="w-16 px-2 py-1 border-b-2 border-dotted border-gray-400 dark:border-gray-500 bg-transparent dark:text-white text-center font-bold"
                   maxlength="2" inputmode="numeric">
            <span class="dark:text-white">= 47</span>
          </div>
          <div class="bg-white dark:bg-gray-800 border-2 border-cyan-400 dark:border-cyan-500 rounded-lg px-4 py-2 flex items-center gap-2">
            <span class="dark:text-white">47 -</span>
            <input type="text" data-fill-blanks-target="input" data-correct-answer="11"
                   class="w-12 px-2 py-1 border-b-2 border-dotted border-gray-400 dark:border-gray-500 bg-transparent dark:text-white text-center font-bold"
                   maxlength="2" inputmode="numeric">
            <span class="dark:text-white">=</span>
            <input type="text" data-fill-blanks-target="input" data-correct-answer="36"
                   class="w-12 px-2 py-1 border-b-2 border-dotted border-gray-400 dark:border-gray-500 bg-transparent dark:text-white text-center font-bold"
                   maxlength="2" inputmode="numeric">
          </div>
        </div>

        <div class="flex items-center justify-between gap-4">
          <div class="flex items-center gap-2">
            <input type="text" data-fill-blanks-target="input" data-correct-answer="64"
                   class="w-16 px-2 py-1 border-b-2 border-dotted border-gray-400 dark:border-gray-500 bg-transparent dark:text-white text-center font-bold"
                   maxlength="2" inputmode="numeric">
            <span class="text-gray-700 dark:text-gray-200">+ 12 = 76</span>
          </div>
          <div class="bg-white dark:bg-gray-800 border-2 border-cyan-400 dark:border-cyan-500 rounded-lg px-4 py-2 flex items-center gap-2">
            <span class="dark:text-white">76 -</span>
            <input type="text" data-fill-blanks-target="input" data-correct-answer="12"
                   class="w-12 px-2 py-1 border-b-2 border-dotted border-gray-400 dark:border-gray-500 bg-transparent dark:text-white text-center font-bold"
                   maxlength="2" inputmode="numeric">
            <span class="dark:text-white">=</span>
            <input type="text" data-fill-blanks-target="input" data-correct-answer="64"
                   class="w-12 px-2 py-1 border-b-2 border-dotted border-gray-400 dark:border-gray-500 bg-transparent dark:text-white text-center font-bold"
                   maxlength="2" inputmode="numeric">
          </div>
        </div>
      </div>

      <!-- Colonna destra: Sottrazioni -->
      <div class="space-y-4">
        <!-- Esempio -->
        <div class="flex items-center justify-between gap-4">
          <span class="text-gray-700 dark:text-gray-200"><strong>88</strong> - 20 = 68</span>
          <div class="bg-white dark:bg-gray-800 border-2 border-cyan-400 dark:border-cyan-500 rounded-lg px-4 py-2">
            <span class="font-bold dark:text-white">68 + <strong>20</strong> = <strong>88</strong></span>
          </div>
        </div>

        <div class="flex items-center justify-between gap-4">
          <div class="flex items-center gap-2">
            <input type="text" data-fill-blanks-target="input" data-correct-answer="50"
                   class="w-16 px-2 py-1 border-b-2 border-dotted border-gray-400 dark:border-gray-500 bg-transparent dark:text-white text-center font-bold"
                   maxlength="2" inputmode="numeric">
            <span class="text-gray-700 dark:text-gray-200">- 9 = 41</span>
          </div>
          <div class="bg-white dark:bg-gray-800 border-2 border-cyan-400 dark:border-cyan-500 rounded-lg px-4 py-2 flex items-center gap-2">
            <span class="dark:text-white">41 +</span>
            <input type="text" data-fill-blanks-target="input" data-correct-answer="9"
                   class="w-12 px-2 py-1 border-b-2 border-dotted border-gray-400 dark:border-gray-500 bg-transparent dark:text-white text-center font-bold"
                   maxlength="1" inputmode="numeric">
            <span class="dark:text-white">=</span>
            <input type="text" data-fill-blanks-target="input" data-correct-answer="50"
                   class="w-12 px-2 py-1 border-b-2 border-dotted border-gray-400 dark:border-gray-500 bg-transparent dark:text-white text-center font-bold"
                   maxlength="2" inputmode="numeric">
          </div>
        </div>

        <div class="flex items-center justify-between gap-4">
          <div class="flex items-center gap-2">
            <input type="text" data-fill-blanks-target="input" data-correct-answer="65"
                   class="w-16 px-2 py-1 border-b-2 border-dotted border-gray-400 dark:border-gray-500 bg-transparent dark:text-white text-center font-bold"
                   maxlength="2" inputmode="numeric">
            <span class="text-gray-700 dark:text-gray-200">- 15 = 50</span>
          </div>
          <div class="bg-white dark:bg-gray-800 border-2 border-cyan-400 dark:border-cyan-500 rounded-lg px-4 py-2 flex items-center gap-2">
            <span class="dark:text-white">50 +</span>
            <input type="text" data-fill-blanks-target="input" data-correct-answer="15"
                   class="w-12 px-2 py-1 border-b-2 border-dotted border-gray-400 dark:border-gray-500 bg-transparent dark:text-white text-center font-bold"
                   maxlength="2" inputmode="numeric">
            <span class="dark:text-white">=</span>
            <input type="text" data-fill-blanks-target="input" data-correct-answer="65"
                   class="w-12 px-2 py-1 border-b-2 border-dotted border-gray-400 dark:border-gray-500 bg-transparent dark:text-white text-center font-bold"
                   maxlength="2" inputmode="numeric">
          </div>
        </div>

        <div class="flex items-center justify-between gap-4">
          <div class="flex items-center gap-2">
            <input type="text" data-fill-blanks-target="input" data-correct-answer="450"
                   class="w-16 px-2 py-1 border-b-2 border-dotted border-gray-400 dark:border-gray-500 bg-transparent dark:text-white text-center font-bold"
                   maxlength="3" inputmode="numeric">
            <span class="text-gray-700 dark:text-gray-200">- 200 = 250</span>
          </div>
          <div class="bg-white dark:bg-gray-800 border-2 border-cyan-400 dark:border-cyan-500 rounded-lg px-4 py-2 flex items-center gap-2">
            <span class="dark:text-white">250 +</span>
            <input type="text" data-fill-blanks-target="input" data-correct-answer="200"
                   class="w-12 px-2 py-1 border-b-2 border-dotted border-gray-400 dark:border-gray-500 bg-transparent dark:text-white text-center font-bold"
                   maxlength="3" inputmode="numeric">
            <span class="dark:text-white">=</span>
            <input type="text" data-fill-blanks-target="input" data-correct-answer="450"
                   class="w-16 px-2 py-1 border-b-2 border-dotted border-gray-400 dark:border-gray-500 bg-transparent dark:text-white text-center font-bold"
                   maxlength="3" inputmode="numeric">
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- Esercizio 4 -->
  <div class="bg-transparent p-4 md:p-8 mb-8">
    <div class="flex items-center gap-3 mb-6">
      <div class="bg-red-500 text-white rounded-full w-8 h-8 flex items-center justify-center font-bold flex-shrink-0">
        4
      </div>
      <p class="text-gray-700 dark:text-gray-200">
        <strong>Scrivi il numero mancante: usa l'operazione inversa.</strong>
      </p>
    </div>

    <div class="grid grid-cols-2 md:grid-cols-5 gap-4">
      <div class="flex items-center gap-2">
        <input type="text" data-fill-blanks-target="input" data-correct-answer="58"
               class="w-16 px-2 py-1 border-b-2 border-dotted border-gray-400 dark:border-gray-500 bg-transparent dark:text-white text-center font-bold"
               maxlength="2" inputmode="numeric">
        <span class="font-bold dark:text-white">+ 7 = 65</span>
      </div>

      <div class="flex items-center gap-2">
        <span class="font-bold dark:text-white">9 +</span>
        <input type="text" data-fill-blanks-target="input" data-correct-answer="77"
               class="w-16 px-2 py-1 border-b-2 border-dotted border-gray-400 dark:border-gray-500 bg-transparent dark:text-white text-center font-bold"
               maxlength="2" inputmode="numeric">
        <span class="font-bold dark:text-white">= 86</span>
      </div>

      <div class="flex items-center gap-2">
        <input type="text" data-fill-blanks-target="input" data-correct-answer="45"
               class="w-16 px-2 py-1 border-b-2 border-dotted border-gray-400 dark:border-gray-500 bg-transparent dark:text-white text-center font-bold"
               maxlength="2" inputmode="numeric">
        <span class="font-bold dark:text-white">- 20 = 25</span>
      </div>

      <div class="flex items-center gap-2">
        <span class="font-bold dark:text-white">127 -</span>
        <input type="text" data-fill-blanks-target="input" data-correct-answer="28"
               class="w-16 px-2 py-1 border-b-2 border-dotted border-gray-400 dark:border-gray-500 bg-transparent dark:text-white text-center font-bold"
               maxlength="2" inputmode="numeric">
        <span class="font-bold dark:text-white">= 99</span>
      </div>

      <div class="flex items-center gap-2">
        <input type="text" data-fill-blanks-target="input" data-correct-answer="120"
               class="w-16 px-2 py-1 border-b-2 border-dotted border-gray-400 dark:border-gray-500 bg-transparent dark:text-white text-center font-bold"
               maxlength="3" inputmode="numeric">
        <span class="font-bold dark:text-white">- 70 = 50</span>
      </div>
    </div>
  </div>

  <!-- Quaderno link allineato a destra -->
  <div class="p-4 mb-8 text-right">
    <span class="text-gray-600 dark:text-gray-400">Quaderno â†’</span> <%= link_to "p. 147", pagina_path("bus3_mat_p147"), class: "text-cyan-600 dark:text-cyan-400 font-bold hover:underline" %>
  </div>

  <!-- Footer con controlli -->
  <%= render 'shared/exercise_controls'%>
</div>
