<div class="max-w-6xl mx-auto bg-white p-3 md:p-6"
     data-controller="exercise-checker text-toggle font-controls"
     data-text-toggle-target="content"
     data-font-controls-target="content">

  <%= render 'shared/page_header', pagina: @pagina %>

  <div class="space-y-6">
    <!-- Problema iniziale -->
    <div class="p-4 bg-custom-blue rounded-lg">
      <p class="text-gray-800">
        Elena ha comprato una scatola di cioccolatini e li ha offerti ai suoi compagni di classe.<br>
        Ora nella scatola sono rimasti 16 cioccolatini, che corrispondono a
        <%= render 'shared/frazione', num: 2, den: 5, bold: true %>
        di tutti quelli che c'erano all'inizio.<br>
        Quanti cioccolatini c'erano nella scatola?
      </p>
    </div>

    <div class="p-4">
      <p class="text-gray-700 mb-4">
        Per rispondere devi calcolare l'intero. Sai che
        <%= render 'shared/frazione', num: 2, den: 5, bold: true %>
        dell'intero corrispondono a <strong class="text-<%= @pagina.base_color %>-600">16</strong> cioccolatini.
      </p>

      <!-- Primo passo -->
      <p class="mb-4">
        <strong><span class="text-pink-600">•</span></strong> Innanzitutto calcola il valore dell'<strong>unità frazionaria</strong>: <strong class="text-pink-600">dividi</strong> il numero dei cioccolatini rimasti per il <strong>numeratore</strong>.
      </p>

      <div class="flex flex-col md:flex-row gap-6 items-start mb-6">
        <div class="flex-1">
          <div class="p-4 bg-gray-50 rounded-lg">
            <div class="flex items-center justify-center gap-4 mb-2">
              <div class="text-center">
                <span class="font-bold">16</span>
                <div class="text-gray-500">↑</div>
                <div class="text-gray-500">n. cioccolatini<br>rimasti</div>
              </div>
              <span class="font-bold">:</span>
              <div class="text-center">
                <span class="font-bold text-pink-600">2</span>
                <div class="text-gray-500">↑</div>
                <div class="text-gray-500">n. gruppi<br>considerati</div>
              </div>
              <span class="font-bold">=</span>
              <div class="text-center">
                <span class="font-bold">8</span>
                <div class="text-gray-500">↑</div>
                <div class="text-gray-500">n. cioccolatini<br>in ogni gruppo</div>
              </div>
              <span class="text-gray-400">←</span>
              <span class="text-<%= @pagina.base_color %>-600 font-bold">valore dell'unità<br>frazionaria</span>
            </div>
          </div>
        </div>
        <div class="flex-shrink-0">
          <%= image_tag "nvi5_mat/p064/p064_03.jpg", alt: "Cioccolatini 2/5", class: "max-w-[150px]" %>
        </div>
      </div>

      <!-- Secondo passo -->
      <p class="mb-4">
        <strong><span class="text-pink-600">•</span></strong> Poi moltiplica il <strong>risultato</strong> per il <strong class="text-pink-600">denominatore</strong> in modo da ricostruire l'<strong>intero</strong>, poiché sai che l'intero è stato diviso in 5 parti.
      </p>

      <div class="flex flex-col md:flex-row gap-6 items-start mb-6">
        <div class="flex-1">
          <div class="p-4 bg-gray-50 rounded-lg">
            <div class="flex items-center justify-center gap-4 mb-2">
              <div class="text-center">
                <span class="font-bold">8</span>
                <div class="text-gray-500">↑</div>
                <div class="text-gray-500">n. cioccolatini<br>in ogni gruppo</div>
              </div>
              <span class="font-bold">×</span>
              <div class="text-center">
                <span class="font-bold text-pink-600">5</span>
                <div class="text-gray-500">↑</div>
                <div class="text-gray-500">n. gruppi in cui è<br>stato diviso l'intero</div>
              </div>
              <span class="font-bold">=</span>
              <div class="text-center">
                <span class="font-bold">40</span>
              </div>
              <span class="text-gray-400">←</span>
              <span class="text-<%= @pagina.base_color %>-600 font-bold">valore dell'intero</span>
            </div>
          </div>
        </div>
        <div class="flex-shrink-0">
          <%= image_tag "nvi5_mat/p064/p064_04.jpg", alt: "Cioccolatini intero", class: "max-w-[200px]" %>
        </div>
      </div>

        <p class="text-gray-800 mb-4">
          Ora puoi rispondere: 
          <span class="bg-custom-blue p-2">Nella scatola c'erano
          <input type="text" data-correct-answer="40" class="w-16 px-2 border-b-2 border-dotted text-center font-bold">
          cioccolatini.
        </span>
      </p>

      <p class="text-gray-700 mb-4">
        Puoi anche "riassumere" i due passaggi in un'unica <strong>espressione</strong>:
      </p>
      <p class="text-center font-bold text-<%= @pagina.base_color %>-600 mb-4">
        (16 : <span class="text-pink-600">2</span>) × <span class="text-pink-600">5</span> = 8 × 5 = 40
      </p>
    </div>

    <!-- Box regola rosa -->
    <div class="p-4 bg-pink-light rounded-2xl">
      <p class="text-gray-800">
        Per calcolare l'intero conoscendo il valore di una frazione <strong>dividi</strong> il numero <strong>per il numeratore</strong> (ottieni l'unità frazionaria) e poi <strong>moltiplica</strong> il risultato <strong>per il denominatore</strong>.
      </p>
    </div>

    <!-- ESERCIZI -->
    <div class="p-3 bg-orange-100 rounded-lg">
      <!-- Esercizio 1 -->
      <div class="p-4">
        <div class="mb-4">
          <p class="font-bold text-gray-700">
            <%= numero_esercizio_badge(1) %>
            Calcola l'intero conoscendo il valore della frazione. Segui l'esempio.
          </p>
        </div>

        <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
          <!-- Colonna 1 -->
          <div class="space-y-3 min-w-0">
            <div class="flex items-center gap-2">
              <%= render 'shared/frazione', num: 3, den: 5 %>
              <span class="text-gray-700 whitespace-nowrap">corrisponde a 21</span>
              <span class="text-pink-600 font-bold">→</span>
              <span class="text-<%= @pagina.base_color %>-700">(21 : 3) × 5 = 7 × 5 = <strong>35</strong></span>
            </div>
            <div class="flex items-center gap-2 min-w-0">
              <%= render 'shared/frazione', num: 2, den: 3 %>
              <span class="text-gray-700 whitespace-nowrap">corrisponde a 18</span>
              <span class="text-pink-600 font-bold">→</span>
              <input type="text" data-correct-answer="27" class="flex-1 min-w-0 px-2 py-1 border-b-2 border-dashed border-gray-400 font-bold bg-transparent">
            </div>
          </div>

          <!-- Colonna 2 -->
          <div class="space-y-3 min-w-0">
            <div class="flex items-center gap-2 min-w-0">
              <%= render 'shared/frazione', num: 4, den: 5 %>
              <span class="text-gray-700 whitespace-nowrap">corrisponde a 36</span>
              <span class="text-pink-600 font-bold">→</span>
              <input type="text" data-correct-answer="45" class="flex-1 min-w-0 px-2 py-1 border-b-2 border-dashed border-gray-400 font-bold bg-transparent">
            </div>
            <div class="flex items-center gap-2 min-w-0">
              <%= render 'shared/frazione', num: 2, den: 7 %>
              <span class="text-gray-700 whitespace-nowrap">corrisponde a 14</span>
              <span class="text-pink-600 font-bold">→</span>
              <input type="text" data-correct-answer="49" class="flex-1 min-w-0 px-2 py-1 border-b-2 border-dashed border-gray-400 font-bold bg-transparent">
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- Riferimento quaderno -->
    <div class="text-right">
      <span class="text-pink-600 font-bold">Quaderno esercizi</span> pp. 206-207
    </div>

    <%= render 'shared/exercise_controls' %>
  </div>
</div>
