<div class="max-w-6xl mx-auto bg-white p-3 md:p-6"
     data-controller="exercise-checker text-toggle font-controls"
     data-text-toggle-target="content"
     data-font-controls-target="content">

  <%= render 'shared/page_header', pagina: @pagina %>

  <div class="space-y-6">
    <!-- Problema iniziale -->
    <div class="p-4 bg-blue-100 rounded-lg">
      <p class="text-gray-800">
        Elena ha comprato una scatola di cioccolatini e li ha offerti ai suoi compagni di classe.<br>
        Ora nella scatola sono rimasti 16 cioccolatini, che corrispondono a
        <%= render 'shared/frazione', num: 2, den: 5, bold: true %>
        di tutti quelli che c'erano all'inizio.<br>
        Quanti cioccolatini c'erano nella scatola?
      </p>
    </div>

    <div class="p-4">
      <p class="text-gray-700 mb-4">
        Per rispondere devi calcolare l'intero. Sai che
        <%= render 'shared/frazione', num: 2, den: 5, bold: true %>
        dell'intero corrispondono a <strong class="text-<%= @pagina.base_color %>-600">16</strong> cioccolatini.
      </p>

      <!-- Primo passo -->
      <p class="mb-4">
        <strong><span class="text-pink-600">•</span></strong> Innanzitutto calcola il valore dell'<strong>unità frazionaria</strong>: <strong class="text-pink-600">dividi</strong> il numero dei cioccolatini rimasti per il <strong>numeratore</strong>.
      </p>

      <div class="flex flex-col md:flex-row gap-6 items-start mb-6">
        <div class="flex-1">
          <div class="p-4 bg-gray-50 rounded-lg">
            <div class="flex items-center justify-center gap-4 text-xl mb-2">
              <div class="text-center">
                <span class="font-bold">16</span>
                <div class="text-xs text-gray-500">↑</div>
                <div class="text-xs text-gray-500">n. cioccolatini<br>rimasti</div>
              </div>
              <span class="font-bold">:</span>
              <div class="text-center">
                <span class="font-bold text-pink-600">2</span>
                <div class="text-xs text-gray-500">↑</div>
                <div class="text-xs text-gray-500">n. gruppi<br>considerati</div>
              </div>
              <span class="font-bold">=</span>
              <div class="text-center">
                <span class="font-bold">8</span>
                <div class="text-xs text-gray-500">↑</div>
                <div class="text-xs text-gray-500">n. cioccolatini<br>in ogni gruppo</div>
              </div>
              <span class="text-gray-400">←</span>
              <span class="text-<%= @pagina.base_color %>-600 font-bold text-sm">valore dell'unità<br>frazionaria</span>
            </div>
          </div>
        </div>
        <div class="flex-shrink-0">
          <%= image_tag "nvi5_mat/p064/p064_03.jpg", alt: "Cioccolatini 2/5", class: "max-w-[150px]" %>
        </div>
      </div>

      <!-- Secondo passo -->
      <p class="mb-4">
        <strong><span class="text-pink-600">•</span></strong> Poi moltiplica il <strong>risultato</strong> per il <strong class="text-pink-600">denominatore</strong> in modo da ricostruire l'<strong>intero</strong>, poiché sai che l'intero è stato diviso in 5 parti.
      </p>

      <div class="flex flex-col md:flex-row gap-6 items-start mb-6">
        <div class="flex-1">
          <div class="p-4 bg-gray-50 rounded-lg">
            <div class="flex items-center justify-center gap-4 text-xl mb-2">
              <div class="text-center">
                <span class="font-bold">8</span>
                <div class="text-xs text-gray-500">↑</div>
                <div class="text-xs text-gray-500">n. cioccolatini<br>in ogni gruppo</div>
              </div>
              <span class="font-bold">×</span>
              <div class="text-center">
                <span class="font-bold text-pink-600">5</span>
                <div class="text-xs text-gray-500">↑</div>
                <div class="text-xs text-gray-500">n. gruppi in cui è<br>stato diviso l'intero</div>
              </div>
              <span class="font-bold">=</span>
              <div class="text-center">
                <span class="font-bold">40</span>
              </div>
              <span class="text-gray-400">←</span>
              <span class="text-<%= @pagina.base_color %>-600 font-bold text-sm">valore dell'intero</span>
            </div>
          </div>
        </div>
        <div class="flex-shrink-0">
          <%= image_tag "nvi5_mat/p064/p064_04.jpg", alt: "Cioccolatini intero", class: "max-w-[200px]" %>
        </div>
      </div>

      <div class="p-3 bg-cyan-100 rounded-lg mb-4">
        <p class="text-gray-800">
          Ora puoi rispondere: Nella scatola c'erano
          <input type="text" data-correct-answer="40" class="w-16 px-2 py-1 border-2 border-pink-400 rounded text-center font-bold bg-white mx-1">
          cioccolatini.
        </p>
      </div>

      <p class="text-gray-700 mb-4">
        Puoi anche "riassumere" i due passaggi in un'unica <strong>espressione</strong>:
      </p>
      <p class="text-center text-xl font-bold text-<%= @pagina.base_color %>-600 mb-4">
        (16 : <span class="text-pink-600">2</span>) × <span class="text-pink-600">5</span> = 8 × 5 = 40
      </p>
    </div>

    <!-- Box regola rosa -->
    <div class="p-4 bg-white border-3 border-pink-700 rounded-2xl">
      <p class="text-gray-800">
        Per calcolare l'intero conoscendo il valore di una frazione <strong class="text-pink-600">dividi</strong> il numero <strong class="text-pink-600">per il numeratore</strong> (ottieni l'unità frazionaria) e poi <strong class="text-pink-600">moltiplica</strong> il risultato <strong class="text-pink-600">per il denominatore</strong>.
      </p>
    </div>

    <!-- ESERCIZI -->
    <div class="p-4 md:p-6 bg-orange-100 rounded-lg">
      <h2 class="inline-block px-3 py-1 bg-pink-600 text-white font-bold rounded mb-4">ESERCIZI</h2>

      <!-- Esercizio 1 -->
      <div class="p-4">
        <div class="flex items-start gap-3 mb-4">
          <%= numero_esercizio_badge(1, colore: "cyan-700") %>
          <p class="font-bold text-gray-700">Calcola l'intero conoscendo il valore della frazione. Segui l'esempio.</p>
        </div>

        <div class="space-y-4">
          <!-- Esempio -->
          <div class="p-3 bg-green-100 rounded-lg">
            <div class="flex items-center gap-3 flex-wrap">
              <%= render 'shared/frazione', num: 3, den: 5 %>
              <span class="text-gray-700">corrisponde a 21</span>
              <span class="text-pink-600 font-bold">→</span>
              <span class="text-<%= @pagina.base_color %>-700">(21 : 3) × 5 = 7 × 5 = <strong>35</strong></span>
            </div>
          </div>

          <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
            <div class="flex items-center gap-3">
              <%= render 'shared/frazione', num: 4, den: 5 %>
              <span class="text-gray-700">corrisponde a 36</span>
              <span class="text-pink-600 font-bold">→</span>
              <input type="text" data-correct-answer="45" class="w-32 px-2 py-1 border-2 border-pink-400 rounded text-center font-bold bg-white">
            </div>

            <div class="flex items-center gap-3">
              <%= render 'shared/frazione', num: 2, den: 3 %>
              <span class="text-gray-700">corrisponde a 18</span>
              <span class="text-pink-600 font-bold">→</span>
              <input type="text" data-correct-answer="27" class="w-32 px-2 py-1 border-2 border-pink-400 rounded text-center font-bold bg-white">
            </div>

            <div class="flex items-center gap-3">
              <%= render 'shared/frazione', num: 2, den: 7 %>
              <span class="text-gray-700">corrisponde a 14</span>
              <span class="text-pink-600 font-bold">→</span>
              <input type="text" data-correct-answer="49" class="w-32 px-2 py-1 border-2 border-pink-400 rounded text-center font-bold bg-white">
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- Riferimento quaderno -->
    <div class="text-right text-sm">
      <span class="text-pink-600 font-bold">Quaderno esercizi</span> pp. 206-207
    </div>

    <%= render 'shared/exercise_controls' %>
  </div>
</div>
