<div class="max-w-6xl mx-auto bg-white p-3 md:p-6"
     data-controller="exercise-checker text-toggle font-controls"
     data-text-toggle-target="content"
     data-font-controls-target="content">

  <%= render 'shared/page_header', pagina: @pagina %>

  <div class="space-y-6">
    <!-- Esercizio 1: IMPARARE TUTTI - Proprietà associativa -->
    <div class="p-4 bg-white rounded-2xl border-3 border-yellow-400">
      <p class="font-bold text-gray-700 mb-4">
        <%= imparare_tutti_badge(1) %>
        Applica la proprietà associativa e calcola in riga. Segui l'esempio.
      </p>

      <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
        <!-- Colonna sinistra: esercizi -->
        <div class="space-y-3">
          <!-- Esempio -->
          <div class="p-2 bg-custom-blue-light-light rounded">
            <p class="text-gray-700">
              25 × 4 × 8 = <span class="font-bold text-cyan-600">100 × 8 = 800</span>
            </p>
          </div>

          <div class="flex items-center gap-2">
            <span class="text-gray-700 shrink-0">4 × 15 × 60 =</span>
            <input type="text" data-correct-answer="60 × 60 = 3600" class="min-w-0 flex-1 border-b-2 border-dotted border-gray-400 text-center font-bold bg-transparent">
          </div>
          <div class="flex items-center gap-2">
            <span class="text-gray-700 shrink-0">22 × 5 × 6 =</span>
            <input type="text" data-correct-answer="110 × 6 = 660" class="min-w-0 flex-1 border-b-2 border-dotted border-gray-400 text-center font-bold bg-transparent">
          </div>
          <div class="flex items-center gap-2">
            <span class="text-gray-700 shrink-0">5 × 2 × 14 × 4 =</span>
            <input type="text" data-correct-answer="10 × 56 = 560" class="min-w-0 flex-1 border-b-2 border-dotted border-gray-400 text-center font-bold bg-transparent">
          </div>
          <div class="flex items-center gap-2">
            <span class="text-gray-700 shrink-0">10 × 6 × 8 × 5 =</span>
            <input type="text" data-correct-answer="60 × 40 = 2400" class="min-w-0 flex-1 border-b-2 border-dotted border-gray-400 text-center font-bold bg-transparent">
          </div>
          <div class="flex items-center gap-2">
            <span class="text-gray-700 shrink-0">6 × 5 × 4 × 20 =</span>
            <input type="text" data-correct-answer="30 × 80 = 2400" class="min-w-0 flex-1 border-b-2 border-dotted border-gray-400 text-center font-bold bg-transparent">
          </div>
        </div>

        <!-- Colonna destra: box regola -->
        <div class="p-3 bg-white border-3 border-cyan-400 rounded-lg">
          <p class="font-bold text-cyan-600 mb-2">Proprietà associativa</p>
          <%= image_tag "nvi5_mat/p190/p190_01.jpg", alt: "Proprietà associativa", class: "max-w-full h-auto" %>
        </div>
      </div>
    </div>

    <!-- Esercizio 2: Proprietà commutativa -->
    <div>
      <p class="font-bold text-gray-700 mb-4">
        <%= numero_esercizio_badge(2) %>
        Calcola sul quaderno. Poi applica la proprietà commutativa per fare la prova.
      </p>

      <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
        <div class="space-y-3">
          <div class="flex items-center gap-2">
            <span class="text-gray-700 shrink-0">38 × 59 =</span>
            <input type="text" data-correct-answer="2242" class="min-w-0 flex-1 border-b-2 border-dotted border-gray-400 text-center font-bold bg-transparent">
          </div>
          <div class="flex items-center gap-2">
            <span class="text-gray-700 shrink-0">81 × 25 =</span>
            <input type="text" data-correct-answer="2025" class="min-w-0 flex-1 border-b-2 border-dotted border-gray-400 text-center font-bold bg-transparent">
          </div>
          <div class="flex items-center gap-2">
            <span class="text-gray-700 shrink-0">63 × 98 =</span>
            <input type="text" data-correct-answer="6174" class="min-w-0 flex-1 border-b-2 border-dotted border-gray-400 text-center font-bold bg-transparent">
          </div>
          <div class="flex items-center gap-2">
            <span class="text-gray-700 shrink-0">90,4 × 72 =</span>
            <input type="text" data-correct-answer="6508,8" class="min-w-0 flex-1 border-b-2 border-dotted border-gray-400 text-center font-bold bg-transparent">
          </div>
          <div class="flex items-center gap-2">
            <span class="text-gray-700 shrink-0">345 × 87 =</span>
            <input type="text" data-correct-answer="30015" class="min-w-0 flex-1 border-b-2 border-dotted border-gray-400 text-center font-bold bg-transparent">
          </div>
          <div class="flex items-center gap-2">
            <span class="text-gray-700 shrink-0">821 × 6,6 =</span>
            <input type="text" data-correct-answer="5418,6" class="min-w-0 flex-1 border-b-2 border-dotted border-gray-400 text-center font-bold bg-transparent">
          </div>
        </div>

        <!-- Box regola -->
        <div class="p-3 bg-white border-3 border-cyan-400 rounded-lg">
          <p class="font-bold text-cyan-600 mb-2">Proprietà commutativa</p>
          <%= image_tag "nvi5_mat/p190/p190_02.jpg", alt: "Proprietà commutativa", class: "max-w-full h-auto" %>
        </div>
      </div>
    </div>

    <!-- Esercizio 3: Proprietà distributiva -->
    <div>
      <p class="font-bold text-gray-700 mb-4">
        <%= numero_esercizio_badge(3) %>
        Applica la proprietà distributiva e verifica che il prodotto non cambia. Segui l'esempio.
      </p>

      <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
        <div class="space-y-4">
          <!-- Esempio -->
          <div class="p-3 bg-custom-blue-light-light rounded space-y-1">
            <p class="text-gray-700">(8 + 9) × 3 = <span class="font-bold text-cyan-600">17 × 3 = 51</span></p>
            <p class="text-gray-700">(8 + 9) × 3 = <span class="font-bold text-cyan-600">(8 × 3) + (9 × 3) = 24 + 27 = 51</span></p>
          </div>

          <div class="space-y-2">
            <div class="flex items-center gap-2">
              <span class="text-gray-700 shrink-0">(10 + 3) × 9 =</span>
              <input type="text" data-correct-answer="13 × 9 = 117" class="min-w-0 flex-1 border-b-2 border-dotted border-gray-400 text-center font-bold bg-transparent">
            </div>
            <div class="flex items-center gap-2">
              <span class="text-gray-700 shrink-0">(10 + 3) × 9 =</span>
              <input type="text" data-correct-answer="(10 × 9) + (3 × 9) = 90 + 27 = 117" class="min-w-0 flex-1 border-b-2 border-dotted border-gray-400 text-center font-bold bg-transparent">
            </div>
          </div>

          <div class="space-y-2">
            <div class="flex items-center gap-2">
              <span class="text-gray-700 shrink-0">(36 + 5) × 2 =</span>
              <input type="text" data-correct-answer="41 × 2 = 82" class="min-w-0 flex-1 border-b-2 border-dotted border-gray-400 text-center font-bold bg-transparent">
            </div>
            <div class="flex items-center gap-2">
              <span class="text-gray-700 shrink-0">(36 + 5) × 2 =</span>
              <input type="text" data-correct-answer="(36 × 2) + (5 × 2) = 72 + 10 = 82" class="min-w-0 flex-1 border-b-2 border-dotted border-gray-400 text-center font-bold bg-transparent">
            </div>
          </div>

          <div class="space-y-2">
            <div class="flex items-center gap-2">
              <span class="text-gray-700 shrink-0">(20 + 8) × 7 =</span>
              <input type="text" data-correct-answer="28 × 7 = 196" class="min-w-0 flex-1 border-b-2 border-dotted border-gray-400 text-center font-bold bg-transparent">
            </div>
            <div class="flex items-center gap-2">
              <span class="text-gray-700 shrink-0">(20 + 8) × 7 =</span>
              <input type="text" data-correct-answer="(20 × 7) + (8 × 7) = 140 + 56 = 196" class="min-w-0 flex-1 border-b-2 border-dotted border-gray-400 text-center font-bold bg-transparent">
            </div>
          </div>
        </div>

        <!-- Box regola -->
        <div class="p-3 bg-white border-3 border-cyan-400 rounded-lg h-fit">
          <p class="font-bold text-cyan-600 mb-2">Proprietà distributiva</p>
          <div class="space-y-1 text-gray-700">
            <p><span class="font-bold text-cyan-600">15</span> × 3 = 45</p>
            <p>(<span class="font-bold text-cyan-600">10</span> + <span class="font-bold text-cyan-600">5</span>) × 3 = 45</p>
            <p>(<span class="font-bold text-cyan-600">10</span> × 3) + (<span class="font-bold text-cyan-600">5</span> × 3) = 30 + 15 = 45</p>
          </div>
        </div>
      </div>
    </div>

    <!-- Esercizio 4: Scomporre e applicare distributiva -->
    <div>
      <p class="font-bold text-gray-700 mb-4">
        <%= numero_esercizio_badge(4) %>
        Dopo aver scomposto i fattori in maniera opportuna, applica la proprietà distributiva e calcola sul quaderno. Segui l'esempio.
      </p>

      <!-- Esempio -->
      <div class="p-3 bg-custom-blue-light-light rounded mb-4">
        <p class="text-gray-700">
          25 × 4 = <span class="font-bold text-cyan-600">(20 + 5) × 4 = (20 × 4) + (5 × 4) = 80 + 20 = 100</span>
        </p>
      </div>

      <div class="grid grid-cols-2 md:grid-cols-3 gap-4">
        <div class="flex items-center gap-2">
          <span class="text-gray-700 shrink-0">74 × 6 =</span>
          <input type="text" data-correct-answer="444" class="min-w-0 flex-1 border-b-2 border-dotted border-gray-400 text-center font-bold bg-transparent">
        </div>
        <div class="flex items-center gap-2">
          <span class="text-gray-700 shrink-0">25 × 7 =</span>
          <input type="text" data-correct-answer="175" class="min-w-0 flex-1 border-b-2 border-dotted border-gray-400 text-center font-bold bg-transparent">
        </div>
        <div class="flex items-center gap-2">
          <span class="text-gray-700 shrink-0">236 × 8 =</span>
          <input type="text" data-correct-answer="1888" class="min-w-0 flex-1 border-b-2 border-dotted border-gray-400 text-center font-bold bg-transparent">
        </div>
        <div class="flex items-center gap-2">
          <span class="text-gray-700 shrink-0">525 × 5 =</span>
          <input type="text" data-correct-answer="2625" class="min-w-0 flex-1 border-b-2 border-dotted border-gray-400 text-center font-bold bg-transparent">
        </div>
        <div class="flex items-center gap-2">
          <span class="text-gray-700 shrink-0">678 × 9 =</span>
          <input type="text" data-correct-answer="6102" class="min-w-0 flex-1 border-b-2 border-dotted border-gray-400 text-center font-bold bg-transparent">
        </div>
      </div>
    </div>

    <%= render 'shared/exercise_controls' %>
  </div>
</div>
