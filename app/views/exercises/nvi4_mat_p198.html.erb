<div class="max-w-6xl mx-auto bg-white dark:bg-gray-900 p-3 md:p-6 transition-colors duration-300"
     data-controller="exercise-checker text-toggle font-controls"
     data-text-toggle-target="content"
     data-font-controls-target="content">

  <%= render 'shared/page_header', pagina: @pagina %>

  <div class="space-y-6">

    <!-- Esercizi IMPARARE TUTTI -->
    <div class="p-5 bg-white dark:bg-gray-800 rounded-2xl border-3 border-yellow-400 dark:border-yellow-500 space-y-6">
      <!-- Esercizio 1 -->
      <div>
        <p class="font-bold text-gray-700 dark:text-gray-200 mb-4">
          <%= imparare_tutti_badge(1) %>
          Completa con il segno di operazione corretto. Segui gli esempi.
        </p>

        <div class="grid grid-cols-1 md:grid-cols-3 gap-4">
          <!-- Colonna 1 -->
          <div class="space-y-3">
            <div class="flex items-center gap-1 flex-wrap">
              <span class="text-gray-700 dark:text-gray-200">670</span>
              <span class="font-bold text-cyan-600 dark:text-cyan-400">:</span>
              <span class="text-gray-700 dark:text-gray-200">670 = 1</span>
            </div>
            <div class="flex items-center gap-1 flex-wrap">
              <span class="text-gray-700 dark:text-gray-200">56 079</span>
              <select data-correct-answer="+" class="w-10 border-2 border-gray-300 dark:border-gray-600 rounded text-center bg-white dark:bg-gray-700 text-gray-700 dark:text-gray-200">
                <option value="">?</option>
                <option value="+">+</option>
                <option value="-">−</option>
                <option value="×">×</option>
                <option value=":">:</option>
              </select>
              <span class="text-gray-700 dark:text-gray-200">0 = 56 079</span>
            </div>
            <div class="flex items-center gap-1 flex-wrap">
              <span class="text-gray-700 dark:text-gray-200">125</span>
              <select data-correct-answer="+" class="w-10 border-2 border-gray-300 dark:border-gray-600 rounded text-center bg-white dark:bg-gray-700 text-gray-700 dark:text-gray-200">
                <option value="">?</option>
                <option value="+">+</option>
                <option value="-">−</option>
                <option value="×">×</option>
                <option value=":">:</option>
              </select>
              <span class="text-gray-700 dark:text-gray-200">3 = 128</span>
            </div>
            <div class="flex items-center gap-1 flex-wrap">
              <span class="text-gray-700 dark:text-gray-200">75</span>
              <select data-correct-answer=":" class="w-10 border-2 border-gray-300 dark:border-gray-600 rounded text-center bg-white dark:bg-gray-700 text-gray-700 dark:text-gray-200">
                <option value="">?</option>
                <option value="+">+</option>
                <option value="-">−</option>
                <option value="×">×</option>
                <option value=":">:</option>
              </select>
              <span class="text-gray-700 dark:text-gray-200">3 = 25</span>
            </div>
            <div class="flex items-center gap-1 flex-wrap">
              <span class="text-gray-700 dark:text-gray-200">362</span>
              <select data-correct-answer="-" class="w-10 border-2 border-gray-300 dark:border-gray-600 rounded text-center bg-white dark:bg-gray-700 text-gray-700 dark:text-gray-200">
                <option value="">?</option>
                <option value="+">+</option>
                <option value="-">−</option>
                <option value="×">×</option>
                <option value=":">:</option>
              </select>
              <span class="text-gray-700 dark:text-gray-200">320 = 42</span>
            </div>
          </div>

          <!-- Colonna 2 -->
          <div class="space-y-3">
            <div class="flex items-center gap-1 flex-wrap">
              <span class="font-bold text-gray-700 dark:text-gray-200">99 999</span>
              <span class="font-bold text-cyan-600 dark:text-cyan-400">+</span>
              <span class="font-bold text-gray-700 dark:text-gray-200">1 = 100 000</span>
            </div>
            <div class="flex items-center gap-1 flex-wrap">
              <span class="text-gray-700 dark:text-gray-200">8 210</span>
              <select data-correct-answer="×" class="w-10 border-2 border-gray-300 dark:border-gray-600 rounded text-center bg-white dark:bg-gray-700 text-gray-700 dark:text-gray-200">
                <option value="">?</option>
                <option value="+">+</option>
                <option value="-">−</option>
                <option value="×">×</option>
                <option value=":">:</option>
              </select>
              <span class="text-gray-700 dark:text-gray-200">0 = 0</span>
            </div>
            <div class="flex items-center gap-1 flex-wrap">
              <span class="text-gray-700 dark:text-gray-200">34</span>
              <select data-correct-answer="×" class="w-10 border-2 border-gray-300 dark:border-gray-600 rounded text-center bg-white dark:bg-gray-700 text-gray-700 dark:text-gray-200">
                <option value="">?</option>
                <option value="+">+</option>
                <option value="-">−</option>
                <option value="×">×</option>
                <option value=":">:</option>
              </select>
              <span class="text-gray-700 dark:text-gray-200">20 = 680</span>
            </div>
            <div class="flex items-center gap-1 flex-wrap">
              <span class="text-gray-700 dark:text-gray-200">47</span>
              <select data-correct-answer="+" class="w-10 border-2 border-gray-300 dark:border-gray-600 rounded text-center bg-white dark:bg-gray-700 text-gray-700 dark:text-gray-200">
                <option value="">?</option>
                <option value="+">+</option>
                <option value="-">−</option>
                <option value="×">×</option>
                <option value=":">:</option>
              </select>
              <span class="text-gray-700 dark:text-gray-200">56 = 103</span>
            </div>
            <div class="flex items-center gap-1 flex-wrap">
              <span class="text-gray-700 dark:text-gray-200">101</span>
              <select data-correct-answer="×" class="w-10 border-2 border-gray-300 dark:border-gray-600 rounded text-center bg-white dark:bg-gray-700 text-gray-700 dark:text-gray-200">
                <option value="">?</option>
                <option value="+">+</option>
                <option value="-">−</option>
                <option value="×">×</option>
                <option value=":">:</option>
              </select>
              <span class="text-gray-700 dark:text-gray-200">8 = 808</span>
            </div>
          </div>

          <!-- Colonna 3 -->
          <div class="space-y-3">
            <div class="flex items-center gap-1 flex-wrap">
              <span class="text-gray-700 dark:text-gray-200">69 000</span>
              <select data-correct-answer="-" class="w-10 border-2 border-gray-300 dark:border-gray-600 rounded text-center bg-white dark:bg-gray-700 text-gray-700 dark:text-gray-200">
                <option value="">?</option>
                <option value="+">+</option>
                <option value="-">−</option>
                <option value="×">×</option>
                <option value=":">:</option>
              </select>
              <span class="text-gray-700 dark:text-gray-200">1 = 68 999</span>
            </div>
            <div class="flex items-center gap-1 flex-wrap">
              <span class="text-gray-700 dark:text-gray-200">76 031</span>
              <select data-correct-answer=":" class="w-10 border-2 border-gray-300 dark:border-gray-600 rounded text-center bg-white dark:bg-gray-700 text-gray-700 dark:text-gray-200">
                <option value="">?</option>
                <option value="+">+</option>
                <option value="-">−</option>
                <option value="×">×</option>
                <option value=":">:</option>
              </select>
              <span class="text-gray-700 dark:text-gray-200">76 031 = 1</span>
            </div>
            <div class="flex items-center gap-1 flex-wrap">
              <span class="text-gray-700 dark:text-gray-200">146</span>
              <select data-correct-answer="+" class="w-10 border-2 border-gray-300 dark:border-gray-600 rounded text-center bg-white dark:bg-gray-700 text-gray-700 dark:text-gray-200">
                <option value="">?</option>
                <option value="+">+</option>
                <option value="-">−</option>
                <option value="×">×</option>
                <option value=":">:</option>
              </select>
              <span class="text-gray-700 dark:text-gray-200">45 = 191</span>
            </div>
            <div class="flex items-center gap-1 flex-wrap">
              <span class="text-gray-700 dark:text-gray-200">101</span>
              <select data-correct-answer="-" class="w-10 border-2 border-gray-300 dark:border-gray-600 rounded text-center bg-white dark:bg-gray-700 text-gray-700 dark:text-gray-200">
                <option value="">?</option>
                <option value="+">+</option>
                <option value="-">−</option>
                <option value="×">×</option>
                <option value=":">:</option>
              </select>
              <span class="text-gray-700 dark:text-gray-200">21 = 80</span>
            </div>
            <div class="flex items-center gap-1 flex-wrap">
              <span class="text-gray-700 dark:text-gray-200">759</span>
              <select data-correct-answer=":" class="w-10 border-2 border-gray-300 dark:border-gray-600 rounded text-center bg-white dark:bg-gray-700 text-gray-700 dark:text-gray-200">
                <option value="">?</option>
                <option value="+">+</option>
                <option value="-">−</option>
                <option value="×">×</option>
                <option value=":">:</option>
              </select>
              <span class="text-gray-700 dark:text-gray-200">11 = 69</span>
            </div>
          </div>
        </div>
      </div>

      <!-- Esercizio 2 -->
      <div>
        <p class="font-bold text-gray-700 dark:text-gray-200 mb-4">
          <%= imparare_tutti_badge(2) %>
          Esegui le operazioni in riga.
        </p>

        <div class="grid grid-cols-1 md:grid-cols-4 gap-4">
          <div class="space-y-3">
            <div class="flex items-center gap-2 flex-wrap">
              <span class="text-gray-700 dark:text-gray-200">12 + 87 =</span>
              <input type="text" data-correct-answer="99" class="w-20 border-b-2 border-dotted border-gray-400 dark:border-gray-500 text-center font-bold bg-transparent dark:text-white">
            </div>
            <div class="flex items-center gap-2 flex-wrap">
              <span class="text-gray-700 dark:text-gray-200">68 − 14 =</span>
              <input type="text" data-correct-answer="54" class="w-20 border-b-2 border-dotted border-gray-400 dark:border-gray-500 text-center font-bold bg-transparent dark:text-white">
            </div>
            <div class="flex items-center gap-2 flex-wrap">
              <span class="text-gray-700 dark:text-gray-200">3 × 9 =</span>
              <input type="text" data-correct-answer="27" class="w-20 border-b-2 border-dotted border-gray-400 dark:border-gray-500 text-center font-bold bg-transparent dark:text-white">
            </div>
            <div class="flex items-center gap-2 flex-wrap">
              <span class="text-gray-700 dark:text-gray-200">35 : 35 =</span>
              <input type="text" data-correct-answer="1" class="w-20 border-b-2 border-dotted border-gray-400 dark:border-gray-500 text-center font-bold bg-transparent dark:text-white">
            </div>
          </div>

          <div class="space-y-3">
            <div class="flex items-center gap-2 flex-wrap">
              <span class="text-gray-700 dark:text-gray-200">213 + 26 =</span>
              <input type="text" data-correct-answer="239" class="w-20 border-b-2 border-dotted border-gray-400 dark:border-gray-500 text-center font-bold bg-transparent dark:text-white">
            </div>
            <div class="flex items-center gap-2 flex-wrap">
              <span class="text-gray-700 dark:text-gray-200">362 − 320 =</span>
              <input type="text" data-correct-answer="42" class="w-20 border-b-2 border-dotted border-gray-400 dark:border-gray-500 text-center font-bold bg-transparent dark:text-white">
            </div>
            <div class="flex items-center gap-2 flex-wrap">
              <span class="text-gray-700 dark:text-gray-200">4 × 12 =</span>
              <input type="text" data-correct-answer="48" class="w-20 border-b-2 border-dotted border-gray-400 dark:border-gray-500 text-center font-bold bg-transparent dark:text-white">
            </div>
            <div class="flex items-center gap-2 flex-wrap">
              <span class="text-gray-700 dark:text-gray-200">100 : 4 =</span>
              <input type="text" data-correct-answer="25" class="w-20 border-b-2 border-dotted border-gray-400 dark:border-gray-500 text-center font-bold bg-transparent dark:text-white">
            </div>
          </div>

          <div class="space-y-3">
            <div class="flex items-center gap-2 flex-wrap">
              <span class="text-gray-700 dark:text-gray-200">1 002 + 111 =</span>
              <input type="text" data-correct-answer="1113" class="w-20 border-b-2 border-dotted border-gray-400 dark:border-gray-500 text-center font-bold bg-transparent dark:text-white">
            </div>
            <div class="flex items-center gap-2 flex-wrap">
              <span class="text-gray-700 dark:text-gray-200">1 025 − 925 =</span>
              <input type="text" data-correct-answer="100" class="w-20 border-b-2 border-dotted border-gray-400 dark:border-gray-500 text-center font-bold bg-transparent dark:text-white">
            </div>
            <div class="flex items-center gap-2 flex-wrap">
              <span class="text-gray-700 dark:text-gray-200">30 × 30 =</span>
              <input type="text" data-correct-answer="900" class="w-20 border-b-2 border-dotted border-gray-400 dark:border-gray-500 text-center font-bold bg-transparent dark:text-white">
            </div>
            <div class="flex items-center gap-2 flex-wrap">
              <span class="text-gray-700 dark:text-gray-200">963 : 3 =</span>
              <input type="text" data-correct-answer="321" class="w-20 border-b-2 border-dotted border-gray-400 dark:border-gray-500 text-center font-bold bg-transparent dark:text-white">
            </div>
          </div>

          <div class="space-y-3">
            <div class="flex items-center gap-2 flex-wrap">
              <span class="text-gray-700 dark:text-gray-200">3 006 + 122 =</span>
              <input type="text" data-correct-answer="3128" class="w-20 border-b-2 border-dotted border-gray-400 dark:border-gray-500 text-center font-bold bg-transparent dark:text-white">
            </div>
            <div class="flex items-center gap-2 flex-wrap">
              <span class="text-gray-700 dark:text-gray-200">4 379 − 154 =</span>
              <input type="text" data-correct-answer="4225" class="w-20 border-b-2 border-dotted border-gray-400 dark:border-gray-500 text-center font-bold bg-transparent dark:text-white">
            </div>
            <div class="flex items-center gap-2 flex-wrap">
              <span class="text-gray-700 dark:text-gray-200">100 × 16 =</span>
              <input type="text" data-correct-answer="1600" class="w-20 border-b-2 border-dotted border-gray-400 dark:border-gray-500 text-center font-bold bg-transparent dark:text-white">
            </div>
            <div class="flex items-center gap-2 flex-wrap">
              <span class="text-gray-700 dark:text-gray-200">1 750 : 10 =</span>
              <input type="text" data-correct-answer="175" class="w-20 border-b-2 border-dotted border-gray-400 dark:border-gray-500 text-center font-bold bg-transparent dark:text-white">
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- Esercizio 3 -->
    <div>
      <p class="font-bold text-gray-700 dark:text-gray-200 mb-4">
        <%= numero_esercizio_badge(3) %>
        Trova l'operatore e completa ogni sequenza. Segui l'esempio.
      </p>

      <!-- Sequenza 1: -300 -->
      <div class="mb-6">
        <div class="flex items-center gap-2 flex-wrap mb-2">
          <span class="text-gray-700 dark:text-gray-200 font-bold">− 300</span>
        </div>
        <div class="flex items-center gap-2 flex-wrap">
          <span class="text-gray-700 dark:text-gray-200 font-bold">600 700</span>
          <span class="text-cyan-500">→</span>
          <span class="text-gray-700 dark:text-gray-200">600 400</span>
          <span class="text-cyan-500">→</span>
          <input type="text" data-correct-answer="600100" class="w-24 border-b-2 border-dotted border-gray-400 dark:border-gray-500 text-center font-bold bg-transparent dark:text-white">
          <span class="text-cyan-500">→</span>
          <input type="text" data-correct-answer="599800" class="w-24 border-b-2 border-dotted border-gray-400 dark:border-gray-500 text-center font-bold bg-transparent dark:text-white">
          <span class="text-cyan-500">→</span>
          <input type="text" data-correct-answer="599500" class="w-24 border-b-2 border-dotted border-gray-400 dark:border-gray-500 text-center font-bold bg-transparent dark:text-white">
        </div>
      </div>

      <!-- Sequenza 2: da trovare -->
      <div class="mb-6">
        <div class="flex items-center gap-2 flex-wrap mb-2">
          <input type="text" data-correct-answer="-5000" class="w-20 border-b-2 border-dotted border-gray-400 dark:border-gray-500 text-center font-bold bg-transparent dark:text-white">
        </div>
        <div class="flex items-center gap-2 flex-wrap">
          <span class="text-gray-700 dark:text-gray-200">90 965</span>
          <span class="text-cyan-500">→</span>
          <span class="text-gray-700 dark:text-gray-200">85 965</span>
          <span class="text-cyan-500">→</span>
          <input type="text" data-correct-answer="80965" class="w-24 border-b-2 border-dotted border-gray-400 dark:border-gray-500 text-center font-bold bg-transparent dark:text-white">
          <span class="text-cyan-500">→</span>
          <input type="text" data-correct-answer="75965" class="w-24 border-b-2 border-dotted border-gray-400 dark:border-gray-500 text-center font-bold bg-transparent dark:text-white">
          <span class="text-cyan-500">→</span>
          <input type="text" data-correct-answer="70965" class="w-24 border-b-2 border-dotted border-gray-400 dark:border-gray-500 text-center font-bold bg-transparent dark:text-white">
        </div>
      </div>

      <!-- Sequenza 3: da trovare -->
      <div class="mb-6">
        <div class="flex items-center gap-2 flex-wrap mb-2">
          <input type="text" data-correct-answer="+1100" class="w-20 border-b-2 border-dotted border-gray-400 dark:border-gray-500 text-center font-bold bg-transparent dark:text-white">
        </div>
        <div class="flex items-center gap-2 flex-wrap">
          <span class="text-gray-700 dark:text-gray-200">82 134</span>
          <span class="text-cyan-500">→</span>
          <span class="text-gray-700 dark:text-gray-200">83 234</span>
          <span class="text-cyan-500">→</span>
          <input type="text" data-correct-answer="84334" class="w-24 border-b-2 border-dotted border-gray-400 dark:border-gray-500 text-center font-bold bg-transparent dark:text-white">
          <span class="text-cyan-500">→</span>
          <input type="text" data-correct-answer="85434" class="w-24 border-b-2 border-dotted border-gray-400 dark:border-gray-500 text-center font-bold bg-transparent dark:text-white">
          <span class="text-cyan-500">→</span>
          <input type="text" data-correct-answer="86534" class="w-24 border-b-2 border-dotted border-gray-400 dark:border-gray-500 text-center font-bold bg-transparent dark:text-white">
        </div>
      </div>
    </div>

    <!-- Esercizio 4 -->
    <div>
      <p class="font-bold text-gray-700 dark:text-gray-200 mb-4">
        <%= numero_esercizio_badge(4) %>
        Risolvi sul quaderno. Attenzione! Dove vedi <span class="bg-cyan-100 dark:bg-cyan-800 px-1 rounded font-bold">*</span> devi formulare una <span class="bg-cyan-100 dark:bg-cyan-800 px-1 rounded">domanda nascosta</span>.
      </p>

      <div class="space-y-4">
        <!-- Problema a -->
        <div class="p-4 bg-gray-50 dark:bg-gray-800 rounded-lg">
          <p class="font-bold text-gray-700 dark:text-gray-200 mb-2">a.</p>
          <p class="text-gray-700 dark:text-gray-200 mb-3">
            Un pasticciere prepara 60 bignè alla crema, 70 al cioccolato e 50 alla panna. <span class="font-bold">*</span> Mette i bignè in vassoi che ne contengono 15 ciascuno. Quanti vassoi gli servono?
          </p>
          <div class="flex items-center gap-2 flex-wrap">
            <span class="text-gray-700 dark:text-gray-200">Risposta:</span>
            <input type="text" data-correct-answer="12" class="w-20 border-b-2 border-dotted border-gray-400 dark:border-gray-500 text-center font-bold bg-transparent dark:text-white">
            <span class="text-gray-700 dark:text-gray-200">vassoi</span>
          </div>
        </div>

        <!-- Problema b -->
        <div class="p-4 bg-gray-50 dark:bg-gray-800 rounded-lg">
          <p class="font-bold text-gray-700 dark:text-gray-200 mb-2">b.</p>
          <p class="text-gray-700 dark:text-gray-200 mb-3">
            Una classe è composta da 25 alunni. Oggi ci sono 3 assenti. <span class="font-bold">*</span> I bambini presenti vanno a vedere uno spettacolo a teatro. Il costo del biglietto è € 5. Quanto pagano in tutto?
          </p>
          <div class="flex items-center gap-2 flex-wrap">
            <span class="text-gray-700 dark:text-gray-200">Risposta: €</span>
            <input type="text" data-correct-answer="110" class="w-20 border-b-2 border-dotted border-gray-400 dark:border-gray-500 text-center font-bold bg-transparent dark:text-white">
          </div>
        </div>
      </div>
    </div>

    <%= render 'shared/exercise_controls' %>
  </div>
</div>
