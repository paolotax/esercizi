<% content_for :titolo, "#{@pagina.titolo} - #{@pagina.numero}" %>

<div class="max-w-7xl mx-auto p-3 md:p-6 bg-white font-mono"
     data-controller="exercise-checker page-viewer text-toggle font-controls"
     data-page-viewer-image-url-value="<%= asset_path('bus3_mat/p161/page.png') %>"
     data-text-toggle-target="content"
     data-font-controls-target="content">

  <!-- Header -->
  <%= render 'shared/page_header', pagina: @pagina %>

  <!-- Esercizio 1 - IMPARARE TUTTI -->
  <div class="mb-12">
    <div class="flex items-start gap-3 mb-6">
      <div class="flex items-center">
        <div class="bg-cyan-700 text-white rounded-full w-8 h-8 flex items-center justify-center font-bold flex-shrink-0 z-10 relative">
          1
        </div>
        <span class="bg-yellow-300 text-cyan-700 font-bold pl-5 pr-4 py-1 rounded-r-full -ml-3">IMPARARE TUTTI</span>
      </div>
      <p class="text-gray-700"><strong>Cerchia di rosso le <span class="text-cyan-600 underline">frazioni decimali</span>.</strong></p>
    </div>

    <div class="flex flex-wrap gap-4 justify-center">
      <!-- 3/4 - NON decimale -->
      <div data-controller="card-selector">
        <div class="border-2 border-gray-300 rounded px-4 py-2 cursor-pointer hover:border-cyan-500"
             data-card-selector-target="card" data-correct="false"
             data-action="click->card-selector#select">
          <div class="text-center"><span class="font-bold">3</span><hr class="border-black"><span class="font-bold">4</span></div>
        </div>
      </div>

      <!-- 9/10 - decimale -->
      <div data-controller="card-selector">
        <div class="border-2 border-gray-300 rounded px-4 py-2 cursor-pointer hover:border-cyan-500"
             data-card-selector-target="card" data-correct="true"
             data-action="click->card-selector#select">
          <div class="text-center"><span class="font-bold">9</span><hr class="border-black"><span class="font-bold">10</span></div>
        </div>
      </div>

      <!-- 7/12 - NON decimale -->
      <div data-controller="card-selector">
        <div class="border-2 border-gray-300 rounded px-4 py-2 cursor-pointer hover:border-cyan-500"
             data-card-selector-target="card" data-correct="false"
             data-action="click->card-selector#select">
          <div class="text-center"><span class="font-bold">7</span><hr class="border-black"><span class="font-bold">12</span></div>
        </div>
      </div>

      <!-- 8/100 - decimale -->
      <div data-controller="card-selector">
        <div class="border-2 border-gray-300 rounded px-4 py-2 cursor-pointer hover:border-cyan-500"
             data-card-selector-target="card" data-correct="true"
             data-action="click->card-selector#select">
          <div class="text-center"><span class="font-bold">8</span><hr class="border-black"><span class="font-bold">100</span></div>
        </div>
      </div>

      <!-- 10/5 - NON decimale -->
      <div data-controller="card-selector">
        <div class="border-2 border-gray-300 rounded px-4 py-2 cursor-pointer hover:border-cyan-500"
             data-card-selector-target="card" data-correct="false"
             data-action="click->card-selector#select">
          <div class="text-center"><span class="font-bold">10</span><hr class="border-black"><span class="font-bold">5</span></div>
        </div>
      </div>

      <!-- 5/13 - NON decimale -->
      <div data-controller="card-selector">
        <div class="border-2 border-gray-300 rounded px-4 py-2 cursor-pointer hover:border-cyan-500"
             data-card-selector-target="card" data-correct="false"
             data-action="click->card-selector#select">
          <div class="text-center"><span class="font-bold">5</span><hr class="border-black"><span class="font-bold">13</span></div>
        </div>
      </div>

      <!-- 7/100 - decimale -->
      <div data-controller="card-selector">
        <div class="border-2 border-gray-300 rounded px-4 py-2 cursor-pointer hover:border-cyan-500"
             data-card-selector-target="card" data-correct="true"
             data-action="click->card-selector#select">
          <div class="text-center"><span class="font-bold">7</span><hr class="border-black"><span class="font-bold">100</span></div>
        </div>
      </div>

      <!-- 12/1000 - decimale -->
      <div data-controller="card-selector">
        <div class="border-2 border-gray-300 rounded px-4 py-2 cursor-pointer hover:border-cyan-500"
             data-card-selector-target="card" data-correct="true"
             data-action="click->card-selector#select">
          <div class="text-center"><span class="font-bold">12</span><hr class="border-black"><span class="font-bold">1000</span></div>
        </div>
      </div>

      <!-- 4/11 - NON decimale -->
      <div data-controller="card-selector">
        <div class="border-2 border-gray-300 rounded px-4 py-2 cursor-pointer hover:border-cyan-500"
             data-card-selector-target="card" data-correct="false"
             data-action="click->card-selector#select">
          <div class="text-center"><span class="font-bold">4</span><hr class="border-black"><span class="font-bold">11</span></div>
        </div>
      </div>

      <!-- 16/100 - decimale -->
      <div data-controller="card-selector">
        <div class="border-2 border-gray-300 rounded px-4 py-2 cursor-pointer hover:border-cyan-500"
             data-card-selector-target="card" data-correct="true"
             data-action="click->card-selector#select">
          <div class="text-center"><span class="font-bold">16</span><hr class="border-black"><span class="font-bold">100</span></div>
        </div>
      </div>
    </div>
  </div>

  <!-- Esercizio 2 -->
  <div class="mb-12" data-controller="fill-blanks auto-advance">
    <div class="flex items-start gap-3 mb-6">
      <div class="bg-red-500 text-white rounded-full w-8 h-8 flex items-center justify-center font-bold flex-shrink-0">
        2
      </div>
      <p class="text-gray-700">
        <strong>Quante sono le figure colorate? Contale e completa la frazione.</strong>
      </p>
    </div>

    <div class="grid grid-cols-1 sm:grid-cols-3 gap-6">
      <!-- Stelle: 3 colorate su 10 -->
      <div class="bg-cyan-50 border border-cyan-200 rounded p-4 text-center">
        <div class="flex flex-wrap justify-center gap-1 mb-3">
          <span class="text-yellow-400">★</span>
          <span class="text-yellow-400">★</span>
          <span class="text-yellow-400">★</span>
          <span class="text-gray-300">☆</span>
        </div>
        <div class="flex flex-wrap justify-center gap-1 mb-3">
          <span class="text-gray-300">☆</span>
          <span class="text-gray-300">☆</span>
        </div>
        <div class="flex flex-wrap justify-center gap-1 mb-4">
          <span class="text-gray-300">☆</span>
          <span class="text-gray-300">☆</span>
          <span class="text-gray-300">☆</span>
          <span class="text-gray-300">☆</span>
        </div>
        <div class="flex flex-col items-center">
          <input type="text" data-fill-blanks-target="input" data-correct-answer="3"
                 class="w-10 px-1 py-1 border-b-2 border-dotted border-gray-400 text-center bg-white" inputmode="numeric">
          <div class="border-t border-black w-8"></div>
          <span class="font-bold">10</span>
        </div>
      </div>

      <!-- Fiori: 6 colorati su 10 -->
      <div class="bg-cyan-50 border border-cyan-200 rounded p-4 text-center">
        <div class="flex flex-wrap justify-center gap-1 mb-3">
          <span class="text-pink-400">✿</span>
          <span class="text-pink-400">✿</span>
          <span class="text-pink-400">✿</span>
          <span class="text-pink-400">✿</span>
        </div>
        <div class="flex flex-wrap justify-center gap-1 mb-3">
          <span class="text-pink-400">✿</span>
          <span class="text-pink-400">✿</span>
        </div>
        <div class="flex flex-wrap justify-center gap-1 mb-4">
          <span class="text-gray-300">✿</span>
          <span class="text-gray-300">✿</span>
          <span class="text-gray-300">✿</span>
          <span class="text-gray-300">✿</span>
        </div>
        <div class="flex flex-col items-center">
          <input type="text" data-fill-blanks-target="input" data-correct-answer="6"
                 class="w-10 px-1 py-1 border-b-2 border-dotted border-gray-400 text-center bg-white" inputmode="numeric">
          <div class="border-t border-black w-8"></div>
          <span class="font-bold">10</span>
        </div>
      </div>

      <!-- Soli: 4 colorati su 10 -->
      <div class="bg-cyan-50 border border-cyan-200 rounded p-4 text-center">
        <div class="flex flex-wrap justify-center gap-1 mb-3">
          <span class="text-yellow-500">☀</span>
          <span class="text-yellow-500">☀</span>
          <span class="text-yellow-500">☀</span>
          <span class="text-yellow-500">☀</span>
        </div>
        <div class="flex flex-wrap justify-center gap-1 mb-4">
          <span class="text-gray-300">☀</span>
          <span class="text-gray-300">☀</span>
          <span class="text-gray-300">☀</span>
          <span class="text-gray-300">☀</span>
          <span class="text-gray-300">☀</span>
          <span class="text-gray-300">☀</span>
        </div>
        <div class="flex flex-col items-center">
          <input type="text" data-fill-blanks-target="input" data-correct-answer="4"
                 class="w-10 px-1 py-1 border-b-2 border-dotted border-gray-400 text-center bg-white" inputmode="numeric">
          <div class="border-t border-black w-8"></div>
          <span class="font-bold">10</span>
        </div>
      </div>
    </div>
  </div>

  <!-- Esercizio 3 -->
  <div class="mb-12" data-controller="fill-blanks auto-advance">
    <div class="flex items-start gap-3 mb-6">
      <div class="bg-red-500 text-white rounded-full w-8 h-8 flex items-center justify-center font-bold flex-shrink-0">
        3
      </div>
      <p class="text-gray-700">
        <strong>Scrivi la frazione che indica la parte colorata.</strong>
      </p>
    </div>

    <div class="grid grid-cols-1 sm:grid-cols-3 gap-6">
      <!-- Barra 10 parti, 4 colorate -->
      <div class="text-center">
        <div class="flex justify-center mb-3">
          <div class="w-6 h-12 bg-purple-400 border border-gray-400"></div>
          <div class="w-6 h-12 bg-purple-400 border border-gray-400"></div>
          <div class="w-6 h-12 bg-purple-400 border border-gray-400"></div>
          <div class="w-6 h-12 bg-purple-400 border border-gray-400"></div>
          <div class="w-6 h-12 bg-white border border-gray-400"></div>
          <div class="w-6 h-12 bg-white border border-gray-400"></div>
          <div class="w-6 h-12 bg-white border border-gray-400"></div>
          <div class="w-6 h-12 bg-white border border-gray-400"></div>
          <div class="w-6 h-12 bg-white border border-gray-400"></div>
          <div class="w-6 h-12 bg-white border border-gray-400"></div>
        </div>
        <div class="flex flex-col items-center">
          <input type="text" data-fill-blanks-target="input" data-correct-answer="4"
                 class="w-10 px-1 py-1 border-b-2 border-dotted border-gray-400 text-center bg-white" inputmode="numeric">
          <div class="border-t border-black w-8"></div>
          <input type="text" data-fill-blanks-target="input" data-correct-answer="10"
                 class="w-10 px-1 py-1 border-b-2 border-dotted border-gray-400 text-center bg-white" inputmode="numeric">
        </div>
      </div>

      <!-- Barra 10 parti, 5 colorate blu -->
      <div class="text-center">
        <div class="flex justify-center mb-3">
          <div class="w-6 h-12 bg-blue-400 border border-gray-400"></div>
          <div class="w-6 h-12 bg-blue-400 border border-gray-400"></div>
          <div class="w-6 h-12 bg-blue-400 border border-gray-400"></div>
          <div class="w-6 h-12 bg-blue-400 border border-gray-400"></div>
          <div class="w-6 h-12 bg-blue-400 border border-gray-400"></div>
          <div class="w-6 h-12 bg-white border border-gray-400"></div>
          <div class="w-6 h-12 bg-white border border-gray-400"></div>
          <div class="w-6 h-12 bg-white border border-gray-400"></div>
          <div class="w-6 h-12 bg-white border border-gray-400"></div>
          <div class="w-6 h-12 bg-white border border-gray-400"></div>
        </div>
        <div class="flex flex-col items-center">
          <input type="text" data-fill-blanks-target="input" data-correct-answer="5"
                 class="w-10 px-1 py-1 border-b-2 border-dotted border-gray-400 text-center bg-white" inputmode="numeric">
          <div class="border-t border-black w-8"></div>
          <input type="text" data-fill-blanks-target="input" data-correct-answer="10"
                 class="w-10 px-1 py-1 border-b-2 border-dotted border-gray-400 text-center bg-white" inputmode="numeric">
        </div>
      </div>

      <!-- Griglia 100 (10x10), 36 colorate -->
      <div class="text-center">
        <div class="grid grid-cols-10 gap-0 mx-auto w-fit mb-3">
          <% 100.times do |i| %>
            <div class="w-3 h-3 border border-gray-300 <%= i < 36 ? 'bg-cyan-300' : 'bg-white' %>"></div>
          <% end %>
        </div>
        <div class="flex flex-col items-center">
          <input type="text" data-fill-blanks-target="input" data-correct-answer="36"
                 class="w-12 px-1 py-1 border-b-2 border-dotted border-gray-400 text-center bg-white" inputmode="numeric">
          <div class="border-t border-black w-10"></div>
          <input type="text" data-fill-blanks-target="input" data-correct-answer="100"
                 class="w-12 px-1 py-1 border-b-2 border-dotted border-gray-400 text-center bg-white" inputmode="numeric">
        </div>
      </div>
    </div>
  </div>

  <!-- Esercizio 4 - LOGICA -->
  <div class="mb-12" data-controller="fill-blanks auto-advance">
    <div class="flex items-start gap-3 mb-6">
      <div class="bg-red-500 text-white rounded-full w-8 h-8 flex items-center justify-center font-bold flex-shrink-0">
        4
      </div>
      <div class="flex items-center gap-2 flex-wrap">
        <span class="bg-gradient-to-r from-red-500 via-yellow-500 to-green-500 text-white px-3 py-1 rounded font-bold">L O G I C A</span>
        <p class="text-gray-700"><strong>Osserva il disegno e completa.</strong></p>
      </div>
    </div>

    <!-- Barra con 50 parti: 20 viola, 15 gialle, 15 bianche -->
    <div class="flex flex-wrap justify-center gap-0 mb-6">
      <% 20.times do %>
        <div class="w-4 h-8 bg-purple-400 border border-purple-500"></div>
      <% end %>
      <% 15.times do %>
        <div class="w-4 h-8 bg-yellow-300 border border-yellow-400"></div>
      <% end %>
      <% 15.times do %>
        <div class="w-4 h-8 bg-white border border-gray-400"></div>
      <% end %>
    </div>

    <div class="space-y-4">
      <p>
        <span class="text-red-500">•</span> L'intero è stato diviso in
        <input type="text" data-fill-blanks-target="input" data-correct-answer="50"
               class="w-12 px-1 py-1 border-b-2 border-dotted border-gray-400 text-center bg-white" inputmode="numeric">
        parti uguali.
      </p>

      <p>
        <span class="text-red-500">•</span> Sono state colorate in viola e in giallo
        <input type="text" data-fill-blanks-target="input" data-correct-answer="35"
               class="w-12 px-1 py-1 border-b-2 border-dotted border-gray-400 text-center bg-white" inputmode="numeric">
        parti su
        <input type="text" data-fill-blanks-target="input" data-correct-answer="50"
               class="w-12 px-1 py-1 border-b-2 border-dotted border-gray-400 text-center bg-white" inputmode="numeric">,
        in frazione:
        <span class="inline-flex flex-col items-center mx-1">
          <input type="text" data-fill-blanks-target="input" data-correct-answer="35"
                 class="w-10 px-1 border-b-2 border-dotted border-gray-400 text-center bg-white" inputmode="numeric">
          <div class="border-t border-black w-8"></div>
          <input type="text" data-fill-blanks-target="input" data-correct-answer="50"
                 class="w-10 px-1 border-b-2 border-dotted border-gray-400 text-center bg-white" inputmode="numeric">
        </span>.
      </p>

      <p>
        <span class="text-red-500">•</span> Le parti viola sono i
        <span class="inline-flex flex-col items-center mx-1">
          <input type="text" data-fill-blanks-target="input" data-correct-answer="20"
                 class="w-10 px-1 border-b-2 border-dotted border-gray-400 text-center bg-white" inputmode="numeric">
          <div class="border-t border-black w-8"></div>
          <input type="text" data-fill-blanks-target="input" data-correct-answer="50"
                 class="w-10 px-1 border-b-2 border-dotted border-gray-400 text-center bg-white" inputmode="numeric">
        </span>.
        Le parti gialle sono i
        <span class="inline-flex flex-col items-center mx-1">
          <input type="text" data-fill-blanks-target="input" data-correct-answer="15"
                 class="w-10 px-1 border-b-2 border-dotted border-gray-400 text-center bg-white" inputmode="numeric">
          <div class="border-t border-black w-8"></div>
          <input type="text" data-fill-blanks-target="input" data-correct-answer="50"
                 class="w-10 px-1 border-b-2 border-dotted border-gray-400 text-center bg-white" inputmode="numeric">
        </span>.
        Le parti bianche sono i
        <span class="inline-flex flex-col items-center mx-1">
          <input type="text" data-fill-blanks-target="input" data-correct-answer="15"
                 class="w-10 px-1 border-b-2 border-dotted border-gray-400 text-center bg-white" inputmode="numeric">
          <div class="border-t border-black w-8"></div>
          <input type="text" data-fill-blanks-target="input" data-correct-answer="50"
                 class="w-10 px-1 border-b-2 border-dotted border-gray-400 text-center bg-white" inputmode="numeric">
        </span>.
      </p>
    </div>
  </div>

  <!-- Footer con controlli -->
  <%= render 'shared/exercise_controls' %>
</div>
