<div class="max-w-7xl mx-auto p-3 md:p-6 bg-white dark:bg-gray-900 text-black dark:text-white transition-colors duration-300"
     data-controller="exercise-checker fill-blanks auto-advance text-toggle font-controls"
     data-text-toggle-target="content"
     data-font-controls-target="content">
  
  <!-- Header -->
  <%= render 'shared/page_header', pagina: @pagina %>

  <!-- Esercizio 1: Osserva e completa le frasi -->
  <div class="bg-[#C7EAFB] dark:bg-cyan-900/40 -ml-3 md:-ml-0 -mr-3 md:mr-0 p-4 md:p-8 mb-8" >
    <div class="flex items-start gap-3 mb-6">
      <div class="bg-red-500 text-white rounded-full w-8 h-8 flex items-center justify-center font-bold flex-shrink-0">
        1
      </div>
      <p class="text-gray-700 dark:text-gray-200">
        <strong>Osserva e completa le frasi.</strong>
      </p>
    </div>

    <div class="grid grid-cols-1 md:grid-cols-2 gap-6 mb-6">
      <!-- Propriet√† Commutativa -->
      <div class="border-3 border-cyan-400 dark:border-cyan-500 rounded-lg p-6 bg-white dark:bg-gray-800">
        <div class="mb-4 bg-white rounded-xl p-2">
          <%= image_tag "bus3_mat/p024/p24_1.jpg",
              alt: "Propriet√† commutativa",
              class: "max-w-full w-full" %>
        </div>

        <p class="text-gray-700 dark:text-gray-200 mb-3">
          ‚Ä¢ Nelle due operazioni hai cambiato l'ordine degli addendi. Il risultato √®:
        </p>

        <div class="flex gap-6 mb-4">
          <label class="flex items-center gap-2 cursor-pointer">
            <input type="radio" name="prop_comm" data-correct-answer="true" class="w-5 h-5">
            <span class="dark:text-white">uguale.</span>
          </label>
          <label class="flex items-center gap-2 cursor-pointer">
            <input type="radio" name="prop_comm" data-correct-answer="false" class="w-5 h-5">
            <span class="dark:text-white">diverso.</span>
          </label>
        </div>

        <p class="text-gray-700 dark:text-gray-200">
          Hai applicato la <strong class="text-pink-600 dark:text-pink-400">propriet√† commutativa.</strong>
        </p>
      </div>

      <!-- Propriet√† Associativa -->
      <div class="border-3 border-cyan-400 dark:border-cyan-500 rounded-lg p-6 bg-white dark:bg-gray-800">
        <div class="mb-4 bg-white rounded-xl p-2">
          <%= image_tag "bus3_mat/p024/p24_2.jpg",
              alt: "Propriet√† associativa",
              class: "max-w-full w-full" %>
        </div>

        <p class="text-gray-700 dark:text-gray-200 mb-3">
          ‚Ä¢ A due addendi hai sostituito la loro somma. Il risultato √®:
        </p>

        <div class="flex gap-6 mb-4">
          <label class="flex items-center gap-2 cursor-pointer">
            <input type="radio" name="prop_assoc" data-correct-answer="true" class="w-5 h-5">
            <span class="dark:text-white">uguale.</span>
          </label>
          <label class="flex items-center gap-2 cursor-pointer">
            <input type="radio" name="prop_assoc" data-correct-answer="false" class="w-5 h-5">
            <span class="dark:text-white">diverso.</span>
          </label>
        </div>

        <p class="text-gray-700 dark:text-gray-200">
          Hai applicato la <strong class="text-cyan-700 dark:text-cyan-400">propriet√† associativa.</strong>
        </p>
      </div>
    </div>

    <!-- Box riassuntivo -->
    <div class="bg-pink-50 dark:bg-pink-900/30 border-3 border-pink-400 dark:border-pink-500 rounded-2xl p-6 mx-auto max-w-4xl">
      <div class="flex items-start gap-3">
        <div class="text-4xl">üòä</div>
        <div class="space-y-3">
          <p class="text-gray-700 dark:text-gray-200">
            <strong class="text-pink-600 dark:text-pink-400">‚Ä¢ Propriet√† commutativa:</strong> se cambi l'ordine degli addendi, il risultato non cambia.
          </p>
          <p class="text-gray-700 dark:text-gray-200">
            <strong class="text-cyan-700 dark:text-cyan-400">‚Ä¢ Propriet√† associativa:</strong> se sostituisci a due addendi la loro somma, il risultato non cambia.
          </p>
        </div>
      </div>
    </div>
  </div>

  <!-- Esercizi 2 e 3: Grid responsive -->
  <div class="bg-transparent p-4 md:p-8 mb-8">
    <div class="grid grid-cols-1 md:grid-cols-2 gap-10">

      <!-- Esercizio 2: Applica la propriet√† commutativa -->
      <div>
        <div class="flex items-start gap-3 mb-6">
          <div class="bg-red-500 text-white rounded-full w-8 h-8 flex items-center justify-center font-bold flex-shrink-0">
            2
          </div>
          <p class="text-gray-700 dark:text-gray-200">
            <strong>Applica la propriet√† commutativa e calcola. Segui l'esempio.</strong>
          </p>
        </div>

        <div class="grid grid-cols-[auto_auto_auto_auto_auto] gap-x-3 gap-y-4 items-center">
          <!-- Esempio -->
          <span class="font-bold text-left dark:text-white">4 + 75</span>
          <span class="text-center dark:text-white">=</span>
          <span class="w-32 font-bold text-cyan-700 dark:text-cyan-400 text-center">75 + 4</span>
          <span class="text-center dark:text-white">=</span>
          <span class="w-20 font-bold text-cyan-700 dark:text-cyan-400 text-center">79</span>

          <!-- Es. 1 -->
          <span class="font-bold text-left dark:text-white">16 + 121</span>
          <span class="text-center dark:text-white">=</span>
          <input type="text" data-fill-blanks-target="input" data-correct-answer="121 + 16"
                 class="w-32 px-2 py-1 border-b-2 border-dotted border-gray-400 dark:border-gray-500 text-center font-bold bg-transparent dark:text-white"
                 maxlength="10">
          <span class="text-center dark:text-white">=</span>
          <input type="text" data-fill-blanks-target="input" data-correct-answer="137"
                 class="w-20 px-2 py-1 border-b-2 border-dotted border-gray-400 dark:border-gray-500 text-center font-bold bg-transparent dark:text-white"
                 maxlength="3" inputmode="numeric">

          <!-- Es. 2 -->
          <span class="font-bold text-left dark:text-white">12 + 87</span>
          <span class="text-center dark:text-white">=</span>
          <input type="text" data-fill-blanks-target="input" data-correct-answer="87 + 12"
                 class="w-32 px-2 py-1 border-b-2 border-dotted border-gray-400 dark:border-gray-500 text-center font-bold bg-transparent dark:text-white"
                 maxlength="10">
          <span class="text-center dark:text-white">=</span>
          <input type="text" data-fill-blanks-target="input" data-correct-answer="99"
                 class="w-20 px-2 py-1 border-b-2 border-dotted border-gray-400 dark:border-gray-500 text-center font-bold bg-transparent dark:text-white"
                 maxlength="2" inputmode="numeric">

          <!-- Es. 3 -->
          <span class="font-bold text-left dark:text-white">15 + 116</span>
          <span class="text-center dark:text-white">=</span>
          <input type="text" data-fill-blanks-target="input" data-correct-answer="116 + 15"
                 class="w-32 px-2 py-1 border-b-2 border-dotted border-gray-400 dark:border-gray-500 text-center font-bold bg-transparent dark:text-white"
                 maxlength="10">
          <span class="text-center dark:text-white">=</span>
          <input type="text" data-fill-blanks-target="input" data-correct-answer="131"
                 class="w-20 px-2 py-1 border-b-2 border-dotted border-gray-400 dark:border-gray-500 text-center font-bold bg-transparent dark:text-white"
                 maxlength="3" inputmode="numeric">
        </div>
      </div>

      <!-- Esercizio 3: Applica la propriet√† associativa -->
      <div>
        <div class="flex items-start gap-3 mb-6">
          <div class="bg-red-500 text-white rounded-full w-8 h-8 flex items-center justify-center font-bold flex-shrink-0">
            3
          </div>
          <p class="text-gray-700 dark:text-gray-200">
            <strong>Applica la propriet√† associativa e calcola.</strong>
          </p>
        </div>

        <div class="grid grid-cols-[auto_auto_auto] gap-x-3 gap-y-4 items-center">
          <!-- Es. 1 - prima riga -->
          <span class="font-bold text-left dark:text-white">23 + 5 + 25</span>
          <span class="text-center dark:text-white">=</span>
          <input type="text" data-fill-blanks-target="input" data-correct-answer="53"
                 class="w-20 px-2 py-1 border-b-2 border-dotted border-gray-400 dark:border-gray-500 text-center font-bold bg-transparent dark:text-white"
                 maxlength="2" inputmode="numeric">

          <!-- Es. 1 - seconda riga -->
          <div class="flex items-center gap-2 dark:text-white">
            <span class="font-bold">23 +</span>
            <input type="text" data-fill-blanks-target="input" data-correct-answer="30"
                   class="w-20 px-2 py-1 border-b-2 border-dotted border-gray-400 dark:border-gray-500 text-center font-bold bg-transparent dark:text-white"
                   maxlength="2" inputmode="numeric">
          </div>
          <span class="text-center dark:text-white">=</span>
          <input type="text" data-fill-blanks-target="input" data-correct-answer="53"
                 class="w-20 px-2 py-1 border-b-2 border-dotted border-gray-400 dark:border-gray-500 text-center font-bold bg-transparent dark:text-white"
                 maxlength="2" inputmode="numeric">

          <!-- Es. 2 - prima riga -->
          <span class="font-bold text-left dark:text-white">48 + 8 + 13</span>
          <span class="text-center dark:text-white">=</span>
          <input type="text" data-fill-blanks-target="input" data-correct-answer="69"
                 class="w-20 px-2 py-1 border-b-2 border-dotted border-gray-400 dark:border-gray-500 text-center font-bold bg-transparent dark:text-white"
                 maxlength="2" inputmode="numeric">

          <!-- Es. 2 - seconda riga -->
          <div class="flex items-center gap-2 dark:text-white">
            <input type="text" data-fill-blanks-target="input" data-correct-answer="56"
                   class="w-20 px-2 py-1 border-b-2 border-dotted border-gray-400 dark:border-gray-500 text-center font-bold bg-transparent dark:text-white"
                   maxlength="2" inputmode="numeric">
            <span class="font-bold">+ 13</span>
          </div>
          <span class="text-center dark:text-white">=</span>
          <input type="text" data-fill-blanks-target="input" data-correct-answer="69"
                 class="w-20 px-2 py-1 border-b-2 border-dotted border-gray-400 dark:border-gray-500 text-center font-bold bg-transparent dark:text-white"
                 maxlength="2" inputmode="numeric">
        </div>
      </div>

    </div>
  </div>

  <!-- Esercizio 4: Leggi e completa. Poi calcola -->
  <div class="bg-transparent p-4 md:p-8 mb-8">
    <div class="flex items-start gap-3 mb-6">
      <div class="bg-red-500 text-white rounded-full w-8 h-8 flex items-center justify-center font-bold flex-shrink-0">
        4
      </div>
      <p class="text-gray-700 dark:text-gray-200">
        <strong>Leggi e completa. Poi calcola.</strong>
      </p>
    </div>

    <div class="grid grid-cols-1 md:grid-cols-3 gap-6">
      <!-- L'1 nell'addizione -->
      <div class="border-3 border-cyan-400 dark:border-cyan-500 rounded-lg p-6 bg-white dark:bg-gray-800">
        <h3 class="font-bold mb-4 dark:text-white">L'<span class="text-cyan-700 dark:text-cyan-400">1</span> nell'addizione</h3>

        <div class="space-y-3 mb-6">
          <div class="flex items-center gap-3 dark:text-white">
            <span class="font-bold">34 + 1 =</span>
            <span class="font-bold text-cyan-700 dark:text-cyan-400">35</span>
          </div>
          <div class="flex items-center gap-3 dark:text-white">
            <span class="font-bold">1 + 106 =</span>
            <span class="font-bold text-cyan-700 dark:text-cyan-400">107</span>
          </div>
        </div>

        <p class="text-gray-700 dark:text-gray-200 mb-6">
          Se aggiungi
          <input type="text" data-fill-blanks-target="input" data-correct-answer="1"
                 class="w-12 px-2 py-1 border-b-2 border-dotted border-gray-400 dark:border-gray-500 text-center font-bold bg-transparent dark:text-white"
                 maxlength="1" inputmode="numeric">
          a un numero, trovi il suo successivo.
        </p>
      </div>

      <!-- Lo 0 nell'addizione -->
      <div class="border-3 border-cyan-400 dark:border-cyan-500 rounded-lg p-6 bg-white dark:bg-gray-800">
        <h3 class="font-bold mb-4 dark:text-white">Lo <span class="text-cyan-700 dark:text-cyan-400">0</span> nell'addizione</h3>

        <div class="space-y-3 mb-6">
          <div class="flex items-center gap-3 dark:text-white">
            <span class="font-bold">92 + 0 =</span>
            <span class="font-bold text-cyan-700 dark:text-cyan-400">92</span>
          </div>
          <div class="flex items-center gap-3 dark:text-white">
            <span class="font-bold">0 + 115 =</span>
            <span class="font-bold text-cyan-700 dark:text-cyan-400">115</span>
          </div>
        </div>

        <p class="text-gray-700 dark:text-gray-200 mb-6">
          Se uno dei due addendi √®
          <input type="text" data-fill-blanks-target="input" data-correct-answer="0"
                 class="w-12 px-2 py-1 border-b-2 border-dotted border-gray-400 dark:border-gray-500 text-center font-bold bg-transparent dark:text-white"
                 maxlength="1" inputmode="numeric">,
          il risultato √® l'altro addendo.
        </p>
      </div>

      <!-- Esercizi finali -->
      <div class="mt-6 grid grid-cols-2 md:grid-cols-1 gap-4">
        <div class="flex items-center gap-3 dark:text-white">
          <span class="font-bold">104 +</span>
          <span class="font-bold"> 1 =</span>
          <input type="text" data-fill-blanks-target="input" data-correct-answer="105"
                class="w-20 px-2 py-1 border-b-2 border-dotted border-gray-400 dark:border-gray-500 text-center font-bold bg-transparent dark:text-white"
                maxlength="3" inputmode="numeric">
        </div>

        <div class="flex items-center gap-3 dark:text-white">
          <span class="font-bold">172 +</span>
          <input type="text" data-fill-blanks-target="input" data-correct-answer="1"
                class="w-16 px-2 py-1 border-b-2 border-dotted border-gray-400 dark:border-gray-500 text-center font-bold bg-transparent dark:text-white"
                maxlength="1" inputmode="numeric">
          <span class="font-bold">= 173</span>
        </div>

        <div class="flex items-center gap-3 dark:text-white">
          <span class="font-bold">27 +  </span>
          <span class="font-bold">0 =</span>
          <input type="text" data-fill-blanks-target="input" data-correct-answer="27"
                class="w-20 px-2 py-1 border-b-2 border-dotted border-gray-400 dark:border-gray-500 text-center font-bold bg-transparent dark:text-white"
                maxlength="2" inputmode="numeric">
        </div>

        <div class="flex items-center gap-3 dark:text-white">
          <span class="font-bold">203 +</span>
          <input type="text" data-fill-blanks-target="input" data-correct-answer="0"
                class="w-16 px-2 py-1 border-b-2 border-dotted border-gray-400 dark:border-gray-500 text-center font-bold bg-transparent dark:text-white"
                maxlength="1" inputmode="numeric">
          <span class="font-bold">= 203</span>
        </div>
      </div>
    </div>
  </div>

  <!-- Quaderno link allineato a destra -->
  <div class="p-4 mb-8 text-right">
    <span class="text-gray-600 dark:text-gray-400">Quaderno ‚Üí</span> <%= link_to "p. 144", pagina_path("bus3_mat_p144"), class: "text-cyan-600 dark:text-cyan-400 font-bold hover:underline" %>
  </div>

  <!-- Footer con controlli -->
  <%= render 'shared/exercise_controls' %>
</div>