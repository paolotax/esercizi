<div class="max-w-7xl mx-auto p-3 md:p-6 bg-white"
     data-controller="exercise-checker fill-blanks auto-advance"
     data-page-viewer-image-url-value="<%= asset_path('bus3_mat/p045/page.png') %>">

  <!-- Header -->
  <%= render 'shared/page_header', pagina: @pagina %>

  <!-- Esercizio 1 -->
  <div class="bg-transparent p-4 md:p-8 mb-8">
    <div class="flex items-center gap-3 mb-6">
      <div class="bg-red-500 text-white rounded-full w-8 h-8 flex items-center justify-center font-bold flex-shrink-0">
        1
      </div>
      <p class="text-base md:text-lg text-gray-700">
        <strong>Osserva e completa.</strong>
      </p>
    </div>

    <div class="flex justify-center mb-6">
      <%= image_tag "bus3_mat/p045/p45_1.jpg",
          alt: "Proprietà distributiva",
          class: "max-w-3xl w-full" %>
    </div>

    <div class="flex justify-center mb-6">
      <table class="border-collapse">
        <tbody>
          <tr>
            <td class="text-center px-4 py-2 text-2xl font-bold">10</td>
            <td class="text-center px-4 py-2 text-2xl font-bold">×</td>
            <td class="text-center px-4 py-2 text-2xl font-bold">2</td>
            <td class="text-center px-4 py-2"></td>
            <td class="text-center px-4 py-2 text-2xl font-bold">3</td>
            <td class="text-center px-4 py-2 text-2xl font-bold">×</td>
            <td class="text-center px-4 py-2 text-2xl font-bold">2</td>
            <td class="text-center px-4 py-2"></td>
          </tr>
          <tr>
            <td class="text-center px-4 py-2"></td>
            <td class="text-center px-4 py-2 text-2xl text-green-600">↓</td>
            <td class="text-center px-4 py-2"></td>
            <td class="text-center px-4 py-2"></td>
            <td class="text-center px-4 py-2"></td>
            <td class="text-center px-4 py-2 text-2xl text-green-600">↓</td>
            <td class="text-center px-4 py-2"></td>
            <td class="text-center px-4 py-2"></td>
          </tr>
          <tr>
            <td class="text-center px-4 py-2"></td>
            <td class="text-center px-4 py-2 text-2xl font-bold">20</td>
            <td class="text-center px-4 py-2"></td>
            <td class="text-center px-4 py-2 text-2xl font-bold">+</td>
            <td class="text-center px-4 py-2"></td>
            <td class="text-center px-4 py-2 text-2xl font-bold">6</td>
            <td class="text-center px-4 py-2"></td>
            <td class="text-center px-4 py-2 text-2xl font-bold flex items-center gap-2">
              <span>=</span>
              <input type="text" data-fill-blanks-target="input" data-correct-answer="26"
                     class="w-16 px-2 py-1 border-b-2 border-dotted border-gray-400 text-center font-bold"
                     maxlength="2" inputmode="numeric">
            </td>
          </tr>
        </tbody>
      </table>
    </div>

    <!-- Box teorico -->
    <div class="bg-green-50 border-3 border-green-400 rounded-lg p-6">
      <p class="text-base text-gray-700">
        <span class="underline font-bold">Proprietà distributiva</span><strong>: se scomponi un fattore in due addendi, puoi moltiplicare ogni addendo per l'altro fattore e sommare i prodotti ottenuti. Il risultato della moltiplicazione non cambia.</strong>
      </p>
    </div>
  </div>

  <!-- Esercizio 2 -->
  <div class="bg-transparent p-4 md:p-8 mb-8">
    <div class="flex items-center gap-3 mb-6">
      <div class="bg-red-500 text-white rounded-full w-8 h-8 flex items-center justify-center font-bold flex-shrink-0">
        2
      </div>
      <p class="text-base md:text-lg text-gray-700">
        <strong>Prova tu ad applicare la proprietà distributiva.</strong>
      </p>
    </div>

    <div class="flex justify-center mb-6">
      <%= image_tag "bus3_mat/p045/p45_2.jpg",
          alt: "Applicazione proprietà distributiva",
          class: "max-w-3xl w-full" %>
    </div>

    <div class="flex justify-center">
      <table class="border-collapse">
        <tbody>
          <tr>
            <td class="text-center px-4 py-2 text-2xl font-bold">10</td>
            <td class="text-center px-4 py-2 text-2xl font-bold">×</td>
            <td class="text-center px-4 py-2 text-2xl font-bold">3</td>
            <td class="text-center px-4 py-2"></td>
            <td class="text-center px-4 py-2 text-2xl font-bold">4</td>
            <td class="text-center px-4 py-2 text-2xl font-bold">×</td>
            <td class="text-center px-4 py-2 text-2xl font-bold">3</td>
            <td class="text-center px-4 py-2"></td>
          </tr>
          <tr>
            <td class="text-center px-4 py-2"></td>
            <td class="text-center px-4 py-2 text-2xl text-green-600">↓</td>
            <td class="text-center px-4 py-2"></td>
            <td class="text-center px-4 py-2"></td>
            <td class="text-center px-4 py-2"></td>
            <td class="text-center px-4 py-2 text-2xl text-green-600">↓</td>
            <td class="text-center px-4 py-2"></td>
            <td class="text-center px-4 py-2"></td>
          </tr>
          <tr>
            <td colspan="3" class="text-center px-4 py-2">
              <input type="text" data-fill-blanks-target="input" data-correct-answer="30"
                     class="w-16 px-2 py-1 border-b-2 border-dotted border-gray-400 text-center font-bold"
                     maxlength="2" inputmode="numeric">
            </td>
            <td class="text-center px-4 py-2 text-2xl font-bold">+</td>
            <td colspan="3" class="text-center px-4 py-2">
              <input type="text" data-fill-blanks-target="input" data-correct-answer="12"
                     class="w-16 px-2 py-1 border-b-2 border-dotted border-gray-400 text-center font-bold"
                     maxlength="2" inputmode="numeric">
            </td>
            <td class="text-center px-4 py-2 text-2xl font-bold flex items-center gap-2">
              <span>=</span>
              <input type="text" data-fill-blanks-target="input" data-correct-answer="42"
                     class="w-16 px-2 py-1 border-b-2 border-dotted border-gray-400 text-center font-bold"
                     maxlength="2" inputmode="numeric">
            </td>
          </tr>
        </tbody>
      </table>
    </div>
  </div>

  <!-- Esercizio 3 -->
  <div class="bg-transparent p-4 md:p-8 mb-8">
    <div class="flex items-center gap-3 mb-6">
      <div class="bg-red-500 text-white rounded-full w-8 h-8 flex items-center justify-center font-bold flex-shrink-0">
        3
      </div>
      <p class="text-base md:text-lg text-gray-700">
        <strong>Applica la proprietà distributiva e calcola. Segui l'esempio.</strong>
      </p>
    </div>

    <div class="space-y-4">
      <!-- Esempio -->
      <div class="p-3 bg-gray-50 rounded">
        <p class="text-base font-bold">
          53 × 4 = (50 + 3) × 4 = (50 × 4) + (3 × 4) = 200 + 12 = 212
        </p>
      </div>

      <!-- Problema 1: 21 × 3 -->
      <div class="flex items-center gap-2 flex-wrap">
        <span class="font-bold">21 × 3 = (</span>
        <input type="text" data-fill-blanks-target="input" data-correct-answer="20"
               class="w-16 px-2 py-1 border-b-2 border-dotted border-gray-400 text-center font-bold"
               maxlength="2" inputmode="numeric">
        <span>+</span>
        <input type="text" data-fill-blanks-target="input" data-correct-answer="1"
               class="w-16 px-2 py-1 border-b-2 border-dotted border-gray-400 text-center font-bold"
               maxlength="1" inputmode="numeric">
        <span>) ×</span>
        <input type="text" data-fill-blanks-target="input" data-correct-answer="3"
               class="w-16 px-2 py-1 border-b-2 border-dotted border-gray-400 text-center font-bold"
               maxlength="1" inputmode="numeric">
        <span>= (</span>
        <input type="text" data-fill-blanks-target="input" data-correct-answer="20"
               class="w-16 px-2 py-1 border-b-2 border-dotted border-gray-400 text-center font-bold"
               maxlength="2" inputmode="numeric">
        <span>×</span>
        <input type="text" data-fill-blanks-target="input" data-correct-answer="3"
               class="w-16 px-2 py-1 border-b-2 border-dotted border-gray-400 text-center font-bold"
               maxlength="1" inputmode="numeric">
        <span>) + (</span>
        <input type="text" data-fill-blanks-target="input" data-correct-answer="1"
               class="w-16 px-2 py-1 border-b-2 border-dotted border-gray-400 text-center font-bold"
               maxlength="1" inputmode="numeric">
        <span>×</span>
        <input type="text" data-fill-blanks-target="input" data-correct-answer="3"
               class="w-16 px-2 py-1 border-b-2 border-dotted border-gray-400 text-center font-bold"
               maxlength="1" inputmode="numeric">
        <span>) =</span>
        <input type="text" data-fill-blanks-target="input" data-correct-answer="60"
               class="w-16 px-2 py-1 border-b-2 border-dotted border-gray-400 text-center font-bold"
               maxlength="2" inputmode="numeric">
        <span>+</span>
        <input type="text" data-fill-blanks-target="input" data-correct-answer="3"
               class="w-16 px-2 py-1 border-b-2 border-dotted border-gray-400 text-center font-bold"
               maxlength="1" inputmode="numeric">
        <span>=</span>
        <input type="text" data-fill-blanks-target="input" data-correct-answer="63"
               class="w-16 px-2 py-1 border-b-2 border-dotted border-gray-400 text-center font-bold"
               maxlength="2" inputmode="numeric">
      </div>

      <!-- Problema 2: 15 × 5 -->
      <div class="flex items-center gap-2 flex-wrap">
        <span class="font-bold">15 × 5 = (</span>
        <input type="text" data-fill-blanks-target="input" data-correct-answer="10"
               class="w-16 px-2 py-1 border-b-2 border-dotted border-gray-400 text-center font-bold"
               maxlength="2" inputmode="numeric">
        <span>+</span>
        <input type="text" data-fill-blanks-target="input" data-correct-answer="5"
               class="w-16 px-2 py-1 border-b-2 border-dotted border-gray-400 text-center font-bold"
               maxlength="1" inputmode="numeric">
        <span>) ×</span>
        <input type="text" data-fill-blanks-target="input" data-correct-answer="5"
               class="w-16 px-2 py-1 border-b-2 border-dotted border-gray-400 text-center font-bold"
               maxlength="1" inputmode="numeric">
        <span>= (</span>
        <input type="text" data-fill-blanks-target="input" data-correct-answer="10"
               class="w-16 px-2 py-1 border-b-2 border-dotted border-gray-400 text-center font-bold"
               maxlength="2" inputmode="numeric">
        <span>×</span>
        <input type="text" data-fill-blanks-target="input" data-correct-answer="5"
               class="w-16 px-2 py-1 border-b-2 border-dotted border-gray-400 text-center font-bold"
               maxlength="1" inputmode="numeric">
        <span>) + (</span>
        <input type="text" data-fill-blanks-target="input" data-correct-answer="5"
               class="w-16 px-2 py-1 border-b-2 border-dotted border-gray-400 text-center font-bold"
               maxlength="1" inputmode="numeric">
        <span>×</span>
        <input type="text" data-fill-blanks-target="input" data-correct-answer="5"
               class="w-16 px-2 py-1 border-b-2 border-dotted border-gray-400 text-center font-bold"
               maxlength="1" inputmode="numeric">
        <span>) =</span>
        <input type="text" data-fill-blanks-target="input" data-correct-answer="50"
               class="w-16 px-2 py-1 border-b-2 border-dotted border-gray-400 text-center font-bold"
               maxlength="2" inputmode="numeric">
        <span>+</span>
        <input type="text" data-fill-blanks-target="input" data-correct-answer="25"
               class="w-16 px-2 py-1 border-b-2 border-dotted border-gray-400 text-center font-bold"
               maxlength="2" inputmode="numeric">
        <span>=</span>
        <input type="text" data-fill-blanks-target="input" data-correct-answer="75"
               class="w-16 px-2 py-1 border-b-2 border-dotted border-gray-400 text-center font-bold"
               maxlength="2" inputmode="numeric">
      </div>
    </div>

    <div class="mt-6 p-4 bg-blue-50 border-2 border-blue-300 rounded-lg">
      <p class="text-base font-bold text-gray-700">
        <strong>Quaderno → p. 149</strong>
      </p>
    </div>
  </div>

  <!-- Footer con controlli -->
  <%= render 'shared/exercise_controls' %>
</div>
