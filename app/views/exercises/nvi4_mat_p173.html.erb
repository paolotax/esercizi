<div class="max-w-6xl mx-auto bg-white dark:bg-gray-900 p-3 md:p-6 transition-colors duration-300"
     data-controller="exercise-checker text-toggle font-controls"
     data-text-toggle-target="content"
     data-font-controls-target="content">

  <%= render 'shared/page_header', pagina: @pagina %>

  <div class="space-y-6">

    <!-- Tabella classi -->
    <div class="overflow-x-auto">
      <table class="w-full border-collapse border-2 border-cyan-400 dark:border-cyan-600 rounded-3xl overflow-hidden">
        <thead>
          <tr>
            <th class="p-2 border-2 border-cyan-400 dark:border-cyan-600 bg-custom-blue-light dark:bg-cyan-900"></th>
            <th colspan="3" class="p-2 border-2 border-cyan-400 dark:border-cyan-600 bg-custom-blue-light dark:bg-cyan-900 text-center font-bold text-cyan-600">CLASSE DELLE MIGLIAIA</th>
            <th colspan="3" class="p-2 border-2 border-cyan-400 dark:border-cyan-600 bg-custom-blue-light dark:bg-cyan-900 text-center font-bold text-cyan-600">CLASSE DELLE UNITÀ SEMPLICI</th>
          </tr>
          <tr>
            <td class="p-2 border-2 border-cyan-400 dark:border-cyan-600 text-center bg-white dark:bg-gray-700">ORDINE</td>
            <td class="p-2 border-2 border-cyan-400 dark:border-cyan-600 text-center bg-white dark:bg-gray-700 font-bold text-cyan-600 dark:text-cyan-400">hk</td>
            <td class="p-2 border-2 border-cyan-400 dark:border-cyan-600 text-center bg-white dark:bg-gray-700 font-bold text-cyan-600 dark:text-cyan-400">dak</td>
            <td class="p-2 border-2 border-cyan-400 dark:border-cyan-600 text-center bg-white dark:bg-gray-700 font-bold text-cyan-600 dark:text-cyan-400">uk</td>
            <td class="p-2 border-2 border-cyan-400 dark:border-cyan-600 text-center bg-white dark:bg-gray-700 font-bold text-cyan-600 dark:text-cyan-400">h</td>
            <td class="p-2 border-2 border-cyan-400 dark:border-cyan-600 text-center bg-white dark:bg-gray-700 font-bold text-cyan-600 dark:text-cyan-400">da</td>
            <td class="p-2 border-2 border-cyan-400 dark:border-cyan-600 text-center bg-white dark:bg-gray-700 font-bold text-cyan-600 dark:text-cyan-400">u</td>
          </tr>
          <tr>
            <td class="p-2 border-2 border-cyan-400 dark:border-cyan-600 text-center bg-custom-blue-light dark:bg-cyan-900"></td>
            <td class="p-2 border-2 border-cyan-400 dark:border-cyan-600 text-center bg-custom-blue-light dark:bg-cyan-900">centinaia di migliaia</td>
            <td class="p-2 border-2 border-cyan-400 dark:border-cyan-600 text-center bg-custom-blue-light dark:bg-cyan-900">decine di migliaia</td>
            <td class="p-2 border-2 border-cyan-400 dark:border-cyan-600 text-center bg-custom-blue-light dark:bg-cyan-900">unità di migliaia</td>
            <td class="p-2 border-2 border-cyan-400 dark:border-cyan-600 text-center bg-custom-blue-light dark:bg-cyan-900">centinaia</td>
            <td class="p-2 border-2 border-cyan-400 dark:border-cyan-600 text-center bg-custom-blue-light dark:bg-cyan-900">decine</td>
            <td class="p-2 border-2 border-cyan-400 dark:border-cyan-600 text-center bg-custom-blue-light dark:bg-cyan-900">unità</td>
          </tr>
          <tr>
            <td class="p-2 border-2 border-cyan-400 dark:border-cyan-600 text-center bg-custom-blue-light dark:bg-cyan-900"></td>
            <td class="p-2 border-2 border-cyan-400 dark:border-cyan-600 text-center bg-custom-blue-light dark:bg-cyan-900 font-bold text-cyan-600"><span class="whitespace-nowrap">100 000</span></td>
            <td class="p-2 border-2 border-cyan-400 dark:border-cyan-600 text-center bg-custom-blue-light dark:bg-cyan-900 font-bold text-cyan-600"><span class="whitespace-nowrap">10 000</span></td>
            <td class="p-2 border-2 border-cyan-400 dark:border-cyan-600 text-center bg-custom-blue-light dark:bg-cyan-900 font-bold text-cyan-600"><span class="whitespace-nowrap">1 000</span></td>
            <td class="p-2 border-2 border-cyan-400 dark:border-cyan-600 text-center bg-custom-blue-light dark:bg-cyan-900 font-bold text-cyan-600">100</td>
            <td class="p-2 border-2 border-cyan-400 dark:border-cyan-600 text-center bg-custom-blue-light dark:bg-cyan-900 font-bold text-cyan-600">10</td>
            <td class="p-2 border-2 border-cyan-400 dark:border-cyan-600 text-center bg-custom-blue-light dark:bg-cyan-900 font-bold text-cyan-600">1</td>
          </tr>
        </thead>
      </table>
    </div>

    <!-- Esercizi IMPARARE TUTTI (1 e 2) -->
    <div class="p-5 bg-white dark:bg-gray-800 rounded-2xl border-3 border-yellow-400 dark:border-yellow-500">
      <div class="grid grid-cols-1 md:grid-cols-2 divide-y-2 md:divide-y-0 md:divide-x-2 divide-<%= @pagina.base_color %>-300">
        <!-- Esercizio 1: Inserisci in tabella -->
        <div class="pb-6 md:pb-0 md:pr-6">
          <p class="font-bold text-gray-700 dark:text-gray-200 mb-4">
            <%= imparare_tutti_badge(1) %>
            Inserisci i numeri in tabella. Poi leggi a voce alta.
          </p>

          <div class="overflow-x-auto">
            <table class="w-full border-collapse border-2 border-cyan-400 dark:border-cyan-600">
              <thead>
                <tr>
                  <th class="p-2 border-2 border-cyan-400 dark:border-cyan-600 border-t-transparent border-l-transparent dark:border-t-transparent dark:border-l-transparent bg-transparent dark:bg-transparent"></th>
                  <th class="p-2 border-2 border-cyan-400 dark:border-cyan-600 bg-custom-blue-light dark:bg-cyan-900 text-center">hk</th>
                  <th class="p-2 border-2 border-cyan-400 dark:border-cyan-600 bg-custom-blue-light dark:bg-cyan-900 text-center">dak</th>
                  <th class="p-2 border-2 border-cyan-400 dark:border-cyan-600 bg-custom-blue-light dark:bg-cyan-900 text-center">uk</th>
                  <th class="p-2 border-2 border-cyan-400 dark:border-cyan-600 bg-custom-blue-light dark:bg-cyan-900 text-center">h</th>
                  <th class="p-2 border-2 border-cyan-400 dark:border-cyan-600 bg-custom-blue-light dark:bg-cyan-900 text-center">da</th>
                  <th class="p-2 border-2 border-cyan-400 dark:border-cyan-600 bg-custom-blue-light dark:bg-cyan-900 text-center">u</th>
                </tr>
              </thead>
              <tbody>
                <!-- Esempio -->
                <tr>
                  <td class="p-2 border-2 border-cyan-400 dark:border-cyan-600 text-center font-bold whitespace-nowrap bg-white dark:bg-gray-700">63 871</td>
                  <td class="p-2 border-2 border-cyan-400 dark:border-cyan-600 text-center bg-white dark:bg-gray-700"></td>
                  <td class="p-2 border-2 border-cyan-400 dark:border-cyan-600 text-center bg-white dark:bg-gray-700 font-bold text-cyan-600 dark:text-cyan-400">6</td>
                  <td class="p-2 border-2 border-cyan-400 dark:border-cyan-600 text-center bg-white dark:bg-gray-700 font-bold text-cyan-600 dark:text-cyan-400">3</td>
                  <td class="p-2 border-2 border-cyan-400 dark:border-cyan-600 text-center bg-white dark:bg-gray-700 font-bold text-cyan-600 dark:text-cyan-400">8</td>
                  <td class="p-2 border-2 border-cyan-400 dark:border-cyan-600 text-center bg-white dark:bg-gray-700 font-bold text-cyan-600 dark:text-cyan-400">7</td>
                  <td class="p-2 border-2 border-cyan-400 dark:border-cyan-600 text-center bg-white dark:bg-gray-700 font-bold text-cyan-600 dark:text-cyan-400">1</td>
                </tr>
                <% [
                  { num: "74 305", answers: ["", "7", "4", "3", "0", "5"] },
                  { num: "67 906", answers: ["", "6", "7", "9", "0", "6"] },
                  { num: "880 352", answers: ["8", "8", "0", "3", "5", "2"] },
                  { num: "409 149", answers: ["4", "0", "9", "1", "4", "9"] },
                  { num: "981 045", answers: ["9", "8", "1", "0", "4", "5"] }
                ].each do |row| %>
                  <tr>
                    <td class="p-2 border-2 border-cyan-400 dark:border-cyan-600 text-center font-bold whitespace-nowrap"><%= row[:num] %></td>
                    <% row[:answers].each do |ans| %>
                      <td class="p-2 border-2 border-cyan-400 dark:border-cyan-600 text-center bg-white dark:bg-gray-700">
                        <input type="text" data-correct-answer="<%= ans %>" class="w-8 border-b-2 border-dotted border-gray-400 dark:border-gray-500 text-center font-bold bg-transparent dark:text-white">
                      </td>
                    <% end %>
                  </tr>
                <% end %>
              </tbody>
            </table>
          </div>
        </div>

        <!-- Esercizio 2: Scrivi in cifre -->
        <div class="pt-6 md:pt-0 md:pl-6">
          <p class="font-bold text-gray-700 dark:text-gray-200 mb-4">
            <%= imparare_tutti_badge(2) %>
            Scrivi in cifre i seguenti numeri.
          </p>

          <div class="space-y-3">
            <div class="flex flex-wrap items-center gap-x-2">
              <span>quattrocentoventitremila</span>
              <span class="text-cyan-500">→</span>
              <span class="font-bold text-cyan-600 whitespace-nowrap">423 000</span>
            </div>
            <%= render 'shared/fill_list',
                color: "cyan",
                arrow: true,
                container_class: "space-y-3",
                items: [
                  { prefix: "centododicimilacentotrentuno", answer: "112131", width: "w-24" },
                  { prefix: "trentaquattromilatrecentodue", answer: "34302", width: "w-24" },
                  { prefix: "cinquantaseimilatrentatré", answer: "56033", width: "w-24" },
                  { prefix: "settantamiladuecentoventidue", answer: "70222", width: "w-24" },
                  { prefix: "ottocentocinquemila", answer: "805000", width: "w-24" },
                  { prefix: "centoventisettemilaventicinque", answer: "127025", width: "w-24" }
                ] %>
          </div>
        </div>
      </div>
    </div>

    <!-- Esercizio 3: Inserisci numeri nelle tabelle -->
    <div>
      <p class="font-bold text-gray-700 dark:text-gray-200 mb-4">
        <%= numero_esercizio_badge(3) %>
        Inserisci i numeri nelle tabelle aggiungendo gli zeri necessari. Poi leggi a voce alta. Segui l'esempio.
      </p>

      <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
        <!-- Prima tabella -->
        <div class="overflow-x-auto">
          <table class="w-full border-collapse border-2 border-cyan-400 dark:border-cyan-600">
            <thead>
              <tr>
                <th class="p-2 border-2 border-cyan-400 dark:border-cyan-600 border-t-transparent border-l-transparent dark:border-t-transparent dark:border-l-transparent bg-transparent dark:bg-transparent"></th>
                <th class="p-2 border-2 border-cyan-400 dark:border-cyan-600 bg-custom-blue-light dark:bg-cyan-900 text-center">hk</th>
                <th class="p-2 border-2 border-cyan-400 dark:border-cyan-600 bg-custom-blue-light dark:bg-cyan-900 text-center">dak</th>
                <th class="p-2 border-2 border-cyan-400 dark:border-cyan-600 bg-custom-blue-light dark:bg-cyan-900 text-center">uk</th>
                <th class="p-2 border-2 border-cyan-400 dark:border-cyan-600 bg-custom-blue-light dark:bg-cyan-900 text-center">h</th>
                <th class="p-2 border-2 border-cyan-400 dark:border-cyan-600 bg-custom-blue-light dark:bg-cyan-900 text-center">da</th>
                <th class="p-2 border-2 border-cyan-400 dark:border-cyan-600 bg-custom-blue-light dark:bg-cyan-900 text-center">u</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td class="p-2 border-2 border-cyan-400 dark:border-cyan-600 text-center font-bold bg-white dark:bg-gray-700">4 hk 9 uk 6 da</td>
                <td class="p-2 border-2 border-cyan-400 dark:border-cyan-600 text-center bg-white dark:bg-gray-700 font-bold text-cyan-600 dark:text-cyan-400">4</td>
                <td class="p-2 border-2 border-cyan-400 dark:border-cyan-600 text-center bg-white dark:bg-gray-700 font-bold text-cyan-600 dark:text-cyan-400">0</td>
                <td class="p-2 border-2 border-cyan-400 dark:border-cyan-600 text-center bg-white dark:bg-gray-700 font-bold text-cyan-600 dark:text-cyan-400">9</td>
                <td class="p-2 border-2 border-cyan-400 dark:border-cyan-600 text-center bg-white dark:bg-gray-700 font-bold text-cyan-600 dark:text-cyan-400">0</td>
                <td class="p-2 border-2 border-cyan-400 dark:border-cyan-600 text-center bg-white dark:bg-gray-700 font-bold text-cyan-600 dark:text-cyan-400">6</td>
                <td class="p-2 border-2 border-cyan-400 dark:border-cyan-600 text-center bg-white dark:bg-gray-700 font-bold text-cyan-600 dark:text-cyan-400">0</td>
              </tr>
              <% [
                { text: "8 dak 8 h 5 u", answers: ["0", "8", "0", "8", "0", "5"] },
                { text: "9 dak 4 uk 2 u", answers: ["0", "9", "4", "0", "0", "2"] }
              ].each do |row| %>
                <tr>
                  <td class="p-2 border-2 border-cyan-400 dark:border-cyan-600 text-center font-bold"><%= row[:text] %></td>
                  <% row[:answers].each do |ans| %>
                    <td class="p-2 border-2 border-cyan-400 dark:border-cyan-600 text-center bg-white dark:bg-gray-700">
                      <input type="text" data-correct-answer="<%= ans %>" class="w-8 border-b-2 border-dotted border-gray-400 dark:border-gray-500 text-center font-bold bg-transparent dark:text-white">
                    </td>
                  <% end %>
                </tr>
              <% end %>
            </tbody>
          </table>
        </div>

        <!-- Seconda tabella -->
        <div class="overflow-x-auto">
          <table class="w-full border-collapse border-2 border-cyan-400 dark:border-cyan-600">
            <thead>
              <tr>
                <th class="p-2 border-2 border-cyan-400 dark:border-cyan-600 border-t-transparent border-l-transparent dark:border-t-transparent dark:border-l-transparent bg-transparent dark:bg-transparent"></th>
                <th class="p-2 border-2 border-cyan-400 dark:border-cyan-600 bg-custom-blue-light dark:bg-cyan-900 text-center">hk</th>
                <th class="p-2 border-2 border-cyan-400 dark:border-cyan-600 bg-custom-blue-light dark:bg-cyan-900 text-center">dak</th>
                <th class="p-2 border-2 border-cyan-400 dark:border-cyan-600 bg-custom-blue-light dark:bg-cyan-900 text-center">uk</th>
                <th class="p-2 border-2 border-cyan-400 dark:border-cyan-600 bg-custom-blue-light dark:bg-cyan-900 text-center">h</th>
                <th class="p-2 border-2 border-cyan-400 dark:border-cyan-600 bg-custom-blue-light dark:bg-cyan-900 text-center">da</th>
                <th class="p-2 border-2 border-cyan-400 dark:border-cyan-600 bg-custom-blue-light dark:bg-cyan-900 text-center">u</th>
              </tr>
            </thead>
            <tbody>
              <% [
                { text: "9 hk 3 uk 5 h 5 u", answers: ["9", "0", "3", "5", "0", "5"] },
                { text: "3 dak 3 da", answers: ["0", "3", "0", "0", "3", "0"] },
                { text: "9 uk 8 da 7 u", answers: ["0", "0", "9", "0", "8", "7"] }
              ].each do |row| %>
                <tr>
                  <td class="p-2 border-2 border-cyan-400 dark:border-cyan-600 text-center font-bold"><%= row[:text] %></td>
                  <% row[:answers].each do |ans| %>
                    <td class="p-2 border-2 border-cyan-400 dark:border-cyan-600 text-center bg-white dark:bg-gray-700">
                      <input type="text" data-correct-answer="<%= ans %>" class="w-8 border-b-2 border-dotted border-gray-400 dark:border-gray-500 text-center font-bold bg-transparent dark:text-white">
                    </td>
                  <% end %>
                </tr>
              <% end %>
            </tbody>
          </table>
        </div>
      </div>
    </div>

    <!-- Esercizio 4: Componi numeri (senza risposte predefinite) -->
    <div>
      <p class="font-bold text-gray-700 dark:text-gray-200 mb-4">
        <%= numero_esercizio_badge(4) %>
        Utilizza tutte le cifre qui a fianco per comporre alcuni numeri. Poi trascrivili accanto in lettere.
      </p>

      <div class="flex items-center gap-4 mb-4">
        <span class="text-gray-600 dark:text-gray-400">Cifre disponibili:</span>
        <div class="flex gap-2">
          <% ["1", "4", "0", "7", "3", "9"].each do |digit| %>
            <span class="w-10 h-10 flex items-center justify-center border-2 border-cyan-400 dark:border-cyan-600 rounded font-bold"><%= digit %></span>
          <% end %>
        </div>
      </div>

      <div class="bg-blue-50 dark:bg-blue-900/30 border border-blue-200 dark:border-blue-700 rounded p-4">
        <p class="text-gray-500 dark:text-gray-400 italic">Componi 5 numeri diversi usando tutte le cifre e scrivili in lettere sul quaderno.</p>
      </div>
    </div>

    <%= render 'shared/exercise_controls' %>
  </div>
</div>
