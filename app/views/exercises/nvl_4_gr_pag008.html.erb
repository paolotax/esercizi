<div class="max-w-6xl mx-auto p-6 bg-gradient-to-br from-pink-50 to-red-50 rounded-lg shadow-lg" data-controller="exercise-checker">
  <!-- Header -->
  <div class="flex items-center justify-between mb-8 border-b-4 border-pink-500 pb-4">
    <div class="flex items-center gap-4">
      <div class="bg-pink-500 text-white rounded-full w-16 h-16 flex items-center justify-center">
        <span class="text-3xl">ðŸ’¡</span>
      </div>
      <div>
        <div class="text-sm text-pink-600 font-semibold uppercase">ORTOGRAFIA</div>
        <h1 class="text-4xl font-bold text-pink-700">La lettera C</h1>
      </div>
    </div>
    <div class="bg-pink-500 text-white font-bold text-4xl px-8 py-4 rounded-full">
      8
    </div>
  </div>

  <!-- Explanation Box -->
  <div class="bg-yellow-50 border-4 border-yellow-400 rounded-lg p-6 mb-8">
    <h2 class="text-2xl font-bold text-pink-600 mb-4">Lettera C</h2>
    <div class="grid md:grid-cols-2 gap-4">
      <div class="border-4 border-red-400 rounded-lg p-4 bg-red-50">
        <h3 class="text-xl font-bold text-red-600 mb-2">Suono dolce</h3>
        <ul class="space-y-2 text-lg">
          <li>â€¢ davanti a <span class="font-bold">E, I</span> â†’ <span class="font-bold text-red-600">cena, cibi</span></li>
        </ul>
      </div>
      <div class="border-4 border-blue-400 rounded-lg p-4 bg-blue-50">
        <h3 class="text-xl font-bold text-blue-600 mb-2">Suono duro</h3>
        <ul class="space-y-2 text-lg">
          <li>â€¢ davanti a <span class="font-bold">A, O, U</span> â†’ <span class="font-bold text-blue-600">casa, tacco, curva</span></li>
          <li>â€¢ davanti a <span class="font-bold">H</span> â†’ <span class="font-bold text-blue-600">amiche, chiave</span></li>
          <li>â€¢ davanti a un'altra consonante â†’ <span class="font-bold text-blue-600">crema</span></li>
        </ul>
      </div>
    </div>
  </div>

  <!-- Exercise 1: Classify words by C sound -->
  <div class="mb-12 bg-white rounded-lg p-6 shadow-md">
    <h2 class="text-2xl font-bold text-pink-600 mb-6">
      <span class="bg-pink-600 text-white rounded-full w-10 h-10 inline-flex items-center justify-center mr-2">1</span>
      IMPARARE TUTTI Leggi e sottolinea in rosso le parole con <span class="text-red-600">C suono dolce</span>,
      in blu le parole con <span class="text-blue-600">C suono duro</span>.
    </h2>

    <div class="grid grid-cols-2 md:grid-cols-4 gap-4" data-controller="word-classifier">
      <% words = [
        {word: 'cinema', correct_color: 'red'},
        {word: 'celeste', correct_color: 'red'},
        {word: 'chiavi', correct_color: 'blue'},
        {word: 'capra', correct_color: 'blue'},
        {word: 'curva', correct_color: 'blue'},
        {word: 'ricetta', correct_color: 'red'},
        {word: 'comico', correct_color: 'blue'},
        {word: 'cipolla', correct_color: 'red'},
        {word: 'cesto', correct_color: 'red'},
        {word: 'cresta', correct_color: 'blue'},
        {word: 'chiodo', correct_color: 'blue'},
        {word: 'dolce', correct_color: 'red'}
      ] %>

      <% words.each do |item| %>
        <div class="border-2 border-gray-300 rounded-lg p-4 bg-gray-50 hover:shadow-lg transition"
             data-controller="card-selector">
          <div class="text-xl font-bold text-gray-800 mb-3">â€¢ <%= item[:word] %></div>
          <div class="flex gap-2">
            <button class="flex-1 py-2 px-3 rounded-lg border-2 transition"
                    data-action="click->card-selector#select"
                    data-card-selector-target="card"
                    data-correct="<%= item[:correct_color] == 'red' %>"
                    style="border-color: #ef4444; color: #ef4444;">
              Dolce
            </button>
            <button class="flex-1 py-2 px-3 rounded-lg border-2 transition"
                    data-action="click->card-selector#select"
                    data-card-selector-target="card"
                    data-correct="<%= item[:correct_color] == 'blue' %>"
                    style="border-color: #3b82f6; color: #3b82f6;">
              Duro
            </button>
          </div>
        </div>
      <% end %>
    </div>
  </div>

  <!-- Exercise 2: Complete words with CA, CO, CU or C + consonant -->
  <div class="mb-12 bg-white rounded-lg p-6 shadow-md">
    <h2 class="text-2xl font-bold text-pink-600 mb-6">
      <span class="bg-pink-600 text-white rounded-full w-10 h-10 inline-flex items-center justify-center mr-2">2</span>
      Completa le parole con <span class="font-bold">CA, CO, CU</span> o con <span class="font-bold">C + consonante</span> (suono duro).
    </h2>

    <div class="grid grid-cols-2 md:grid-cols-4 gap-6" data-controller="fill-blanks">
      <% completions = [
        {prefix: '', suffix: 'chiaio', answer: 'cu'},
        {prefix: '', suffix: 'rota', answer: 'ca'},
        {prefix: '', suffix: 'niglio', answer: 'co'},
        {prefix: 'ama', suffix: '', answer: 'ca'},
        {prefix: '', suffix: 'stode', answer: 'cu'},
        {prefix: 'an', suffix: 'ra', answer: 'co'},
        {prefix: '', suffix: 'iniera', answer: 'cr'},
        {prefix: '', suffix: 'ramella', answer: 'ca'},
        {prefix: 'ac', suffix: 'ppatoio', answer: 'ca'},
        {prefix: 'pan', suffix: '', answer: 'ca'},
        {prefix: '', suffix: 'stagna', answer: 'ca'},
        {prefix: '', suffix: 'gino', answer: 'cu'}
      ] %>

      <% completions.each_with_index do |item, idx| %>
        <div class="flex items-center gap-1 text-xl font-bold">
          <span>â€¢ <%= item[:prefix] %></span>
          <input type="text"
                 class="border-b-4 border-pink-500 bg-transparent w-16 text-center focus:outline-none focus:border-pink-700"
                 data-fill-blanks-target="input"
                 data-answer="<%= item[:answer] %>"
                 data-correct-answer="<%= item[:answer] %>"
                 maxlength="4">
          <span><%= item[:suffix] %></span>
        </div>
      <% end %>
    </div>
  </div>

  <!-- Exercise 3: CE o CHE? CI o CHI? -->
  <div class="mb-12 bg-white rounded-lg p-6 shadow-md">
    <h2 class="text-2xl font-bold text-pink-600 mb-6">
      <span class="bg-pink-600 text-white rounded-full w-10 h-10 inline-flex items-center justify-center mr-2">3</span>
      <span class="font-bold">CE</span> o <span class="font-bold">CHE</span>? <span class="font-bold">CI</span> o <span class="font-bold">CHI</span>?
      Colora il riquadro con la parola corretta.
    </h2>

    <div class="grid md:grid-cols-3 gap-12">
      <% word_pairs = [
        {words: ['cercio', 'cerchio'], correct: 'cerchio', color: 'red'},
        {words: ['amiche', 'amice'], correct: 'amiche', color: 'green'},
        {words: ['voce', 'voche'], correct: 'voce', color: 'yellow'},
        {words: ['chiesa', 'ciesa'], correct: 'chiesa', color: 'cyan'},
        {words: ['civetta', 'chivetta'], correct: 'civetta', color: 'pink'},
        {words: ['ciusa', 'chiusa'], correct: 'chiusa', color: 'purple'},
        {words: ['stecchino', 'steccino'], correct: 'stecchino', color: 'blue'},
        {words: ['oce', 'oche'], correct: 'oche', color: 'orange'},
        {words: ['incendio', 'inchendio'], correct: 'incendio', color: 'green'}
      ] %>

      <% word_pairs.each do |pair| %>
        <div class="flex gap-1" data-controller="card-selector">
          <% pair[:words].each do |word| %>
            <div class="flex-1 border-4 rounded-xl px-6 py-4 text-center font-bold text-2xl cursor-pointer transition hover:scale-105"
                 style="border-color: <%= case pair[:color]
                   when 'red' then '#ef4444'
                   when 'green' then '#84cc16'
                   when 'yellow' then '#eab308'
                   when 'cyan' then '#06b6d4'
                   when 'pink' then '#ec4899'
                   when 'purple' then '#a855f7'
                   when 'blue' then '#3b82f6'
                   when 'orange' then '#f97316'
                   end %>;"
                 data-action="click->card-selector#select"
                 data-card-selector-target="card"
                 data-correct="<%= word == pair[:correct] %>">
              <%= word %>
            </div>
          <% end %>
        </div>
      <% end %>
    </div>
  </div>

  <!-- Exercise Controls -->
  <%= render 'shared/exercise_controls', color: 'pink', current_page: 'nvl_4_gr_pag008' %>
</div>
