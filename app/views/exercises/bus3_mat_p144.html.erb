<div class="max-w-7xl mx-auto p-3 md:p-6 bg-white dark:bg-gray-900 text-black dark:text-white transition-colors duration-300"
     data-controller="exercise-checker text-toggle font-controls"
     data-text-toggle-target="content"
     data-font-controls-target="content">

  <!-- Header -->
  <%= render 'shared/page_header', pagina: @pagina %>

  <div class="space-y-8">

    <!-- Exercise 1: Proprietà associativa -->
    <div class="bg-white dark:bg-gray-800 rounded-lg shadow-lg p-6 mb-6">
      <div class="flex items-start gap-3 mb-6">
        <%= imparare_tutti_badge(1) %>
        <h2 class="font-bold text-gray-800 dark:text-gray-200">Applica la <span class="text-cyan-600 dark:text-cyan-400">proprietà associativa</span> e calcola. Segui l'esempio.</h2>
      </div>

      <div class="grid grid-cols-1 2xl:grid-cols-2 gap-8">
        <div class="space-y-4">
          <!-- Esempio -->
          <div class="bg-cyan-50 dark:bg-cyan-900/30 px-4 py-6 rounded-lg border-2 border-cyan-200 dark:border-cyan-700">
            <div class="flex items-center gap-2 text-gray-700 dark:text-gray-200">
              <span>36 + 4 + 17 =</span>
              <span class="text-cyan-600 dark:text-cyan-400 font-bold">(40 + 17)</span>
              <span>=</span>
              <span class="text-cyan-600 dark:text-cyan-400 font-bold">57</span>
            </div>
          </div>

          <!-- Esercizio -->
          <div class="bg-gray-50 dark:bg-gray-700/50 p-4 rounded-lg">
            <div class="flex items-center gap-2 flex-wrap text-gray-700 dark:text-gray-200">
              <span>6 + 8 + 12 =</span>
              <input type="text" class="w-32 px-3 py-2 border-2 border-gray-300 dark:border-gray-600 rounded text-center bg-transparent" placeholder="..." data-correct-answer="6 + 20">
              <span>=</span>
              <input type="text" class="w-20 px-3 py-2 border-2 border-gray-300 dark:border-gray-600 rounded text-center bg-transparent" placeholder="..." data-correct-answer="26">
            </div>
          </div>
        </div>

        <div class="space-y-4">
          <!-- Esercizio -->
          <div class="bg-gray-50 dark:bg-gray-700/50 p-4 rounded-lg">
            <div class="flex items-center gap-2 flex-wrap text-gray-700 dark:text-gray-200">
              <span>20 + 13 + 17 =</span>
              <input type="text" class="w-32 px-3 py-2 border-2 border-gray-300 dark:border-gray-600 rounded text-center bg-transparent" placeholder="..." data-correct-answer="20 + 30">
              <span>=</span>
              <input type="text" class="w-20 px-3 py-2 border-2 border-gray-300 dark:border-gray-600 rounded text-center bg-transparent" placeholder="..." data-correct-answer="50">
            </div>
          </div>

          <!-- Esercizio -->
          <div class="bg-gray-50 dark:bg-gray-700/50 p-4 rounded-lg">
            <div class="flex items-center gap-2 flex-wrap text-gray-700 dark:text-gray-200">
              <span>31 + 9 + 46 =</span>
              <input type="text" class="w-32 px-3 py-2 border-2 border-gray-300 dark:border-gray-600 rounded text-center bg-transparent" placeholder="..." data-correct-answer="40 + 46">
              <span>=</span>
              <input type="text" class="w-20 px-3 py-2 border-2 border-gray-300 dark:border-gray-600 rounded text-center bg-transparent" placeholder="..." data-correct-answer="86">
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- Exercise 2: Proprietà commutativa -->
    <div class="bg-white dark:bg-gray-800 rounded-lg shadow-lg p-6 mb-6">
      <div class="flex items-start gap-3 mb-6">
        <%= numero_esercizio_badge(2) %>
        <h2 class="font-bold text-gray-800 dark:text-gray-200">Calcola in colonna, poi fai la prova applicando la <span class="text-cyan-600 dark:text-cyan-400">proprietà commutativa</span>.</h2>
      </div>

      <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-4">
        <!-- Riga 1: 542 + 107 e prova -->
        <%= addizione_grid [542, 107], show_addends: true, show_carry: true, style: :column %>
        <%= addizione_grid [107, 542], show_carry: true, style: :column %>

        <!-- Riga 1: 789 + 167 e prova -->
        <%= addizione_grid [789, 167], show_addends: true, show_carry: true, style: :column %>
        <%= addizione_grid [167, 789], show_carry: true, style: :column %>

        <!-- Riga 2: 208 + 435 e prova -->
        <%= addizione_grid [208, 435], show_addends: true, show_carry: true, style: :column %>
        <%= addizione_grid [435, 208], show_carry: true, style: :column %>

        <!-- Riga 2: 135 + 97 e prova -->
        <%= addizione_grid [135, 97], show_addends: true, show_carry: true, style: :column %>
        <%= addizione_grid [97, 135], show_carry: true, style: :column %>
      </div>
    </div>

    <!-- Exercise 3: Identificare proprietà -->
    <div class="bg-white dark:bg-gray-800 rounded-lg shadow-lg p-6 mb-6">
      <div class="flex items-start gap-3 mb-6">
        <%= numero_esercizio_badge(3) %>
        <h2 class="font-bold text-gray-800 dark:text-gray-200">
          Quali proprietà sono state applicate? Scrivi
          <span class="text-cyan-600 dark:text-cyan-400 font-bold">A</span> (associativa),
          <span class="text-orange-600 dark:text-orange-400 font-bold">C</span> (commutativa) o
          <span class="text-purple-600 dark:text-purple-400 font-bold">E</span> (entrambe).
        </h2>
      </div>

      <div class="space-y-4">
        <!-- Example 1 -->
        <div class="flex items-center gap-4 bg-gray-50 dark:bg-gray-700/50 p-4 rounded-lg">
          <div class="flex-1 text-gray-700 dark:text-gray-200">
            26 + 12 + 14 = (26 + 14) + 12 = 40 + 12 = 52
          </div>
          <input type="text" class="w-16 h-16 text-center border-4 border-cyan-400 dark:border-cyan-600 rounded-lg font-bold bg-transparent text-gray-700 dark:text-white" maxlength="1" placeholder="..." data-correct-answer="A">
        </div>

        <!-- Example 2 -->
        <div class="flex items-center gap-4 bg-gray-50 dark:bg-gray-700/50 p-4 rounded-lg">
          <div class="flex-1 text-gray-700 dark:text-gray-200">
            107 + 3 + 17 = 110 + 17 = 127
          </div>
          <input type="text" class="w-16 h-16 text-center border-4 border-cyan-400 dark:border-cyan-600 rounded-lg font-bold bg-transparent text-gray-700 dark:text-white" maxlength="1" placeholder="..." data-correct-answer="A">
        </div>

        <!-- Example 3 -->
        <div class="flex items-center gap-4 bg-gray-50 dark:bg-gray-700/50 p-4 rounded-lg">
          <div class="flex-1 text-gray-700 dark:text-gray-200">
            32 + 128 + 2 = 32 + 130 = 162
          </div>
          <input type="text" class="w-16 h-16 text-center border-4 border-cyan-400 dark:border-cyan-600 rounded-lg font-bold bg-transparent text-gray-700 dark:text-white" maxlength="1" placeholder="..." data-correct-answer="A">
        </div>

        <!-- Example 4 -->
        <div class="flex items-center gap-4 bg-gray-50 dark:bg-gray-700/50 p-4 rounded-lg">
          <div class="flex-1 text-gray-700 dark:text-gray-200">
            115 + 5 + 45 = 45 + 5 + 115 = 165
          </div>
          <input type="text" class="w-16 h-16 text-center border-4 border-cyan-400 dark:border-cyan-600 rounded-lg font-bold bg-transparent text-gray-700 dark:text-white" maxlength="1" placeholder="..." data-correct-answer="C">
        </div>

        <!-- Example 5 -->
        <div class="flex items-center gap-4 bg-gray-50 dark:bg-gray-700/50 p-4 rounded-lg">
          <div class="flex-1 text-gray-700 dark:text-gray-200">
            135 + 19 + 5 = (135 + 5) + 19 = 140 + 19 = 159
          </div>
          <input type="text" class="w-16 h-16 text-center border-4 border-cyan-400 dark:border-cyan-600 rounded-lg font-bold bg-transparent text-gray-700 dark:text-white" maxlength="1" placeholder="..." data-correct-answer="A">
        </div>
      </div>
    </div>

    <!-- Exercise Controls -->
    <%= render 'shared/exercise_controls' %>

  </div>
</div>
