<div class="max-w-[1800px] mx-auto p-4 lg:p-8"
     data-controller="exercise-checker fill-blanks hotspot-editor auto-advance text-toggle font-controls"
     data-text-toggle-target="content"
     data-font-controls-target="content">

  <!-- Header (se disponibile) -->
  <% if @pagina.present? %>
    <%= render 'shared/page_header', pagina: @pagina %>
  <% end %>

  <!-- Two-page horizontal layout like an open book -->
  <div class="grid lg:grid-cols-2 gap-3 lg:gap-0">

    <!-- LEFT PAGE - Page 88 (vassoio dolcetti - solo visualizzazione) -->
    <div class="relative">
      <%= image_tag "bus3_mat/p088/page.png",
            alt: "Pagina 88 - Frazioni in pasticceria - Vassoio 100 dolcetti",
            class: "w-full h-auto select-none pointer-events-none" %>
    </div>

    <!-- RIGHT PAGE - Page 89 (esercizi con input) -->
    <div class="relative" data-hotspot-editor-target="container">
      <%= image_tag "bus3_mat/p089/page.png",
            alt: "Pagina 89 - Gioco e ripasso",
            class: "w-full h-auto select-none pointer-events-none" %>

      <!-- Input overlay per gli esercizi di pagina 89 -->
      <div class="absolute inset-0">
        <%

        inputs_p89 = [
          { label: "Biscotti al cioccolato", top: "25.883%", left: "17.6242%", width: "18.8298%", height: "2.64905%", answer: "trenta centesimi" },
          { label: "Numeratore tortine", top: "23.0302%", left: "72.8511%", width: "8%", height: "2.5%", answer: "34" },
          { label: "Denominatore tortine", top: "25.4453%", left: "72.8511%", width: "8%", height: "2.5%", answer: "100" },
          { label: "Numeratore pastine", top: "64.1057%", left: "26.3688%", width: "8%", height: "2.5%", answer: "19" },
          { label: "Denominatore pastine", top: "67.3396%", left: "26.0851%", width: "8%", height: "2.5%", answer: "100" },
          { label: "Dolcetto 7 centesimi", top: "69.0642%", left: "69.2766%", width: "13.617%", height: "3.350", answer: "crostatine" },
          { label: "Dolcetto rimasto", top: "78.3736%", left: "54.4326%", width: "30%", height: "2.5%", answer: "muffin" },
          { label: "Frazione in cifre numeratore", top: "81.3207%", left: "41.929%", width: "5.57447%", height: "2%", answer: "10" },
          { label: "Frazione in cifre denominatore", top: "83.9056%", left: "42.0709%", width: "6%", height: "2%", answer: "100" },
          { label: "Frazione in lettere", top: "86.6717%", left: "48.4752%", width: "36.5248%", height: "2.5%", answer: "dieci centesimi" },
        ]
        %>

        <% inputs_p89.each do |input| %>
          <div class="absolute"
               style="top: <%= input[:top] %>; left: <%= input[:left] %>; width: <%= input[:width] %>; height: <%= input[:height] %>;"
               data-hotspot-editor-target="hotspot"
               data-image-speech-word-value="<%= input[:label] %>"
               data-auto-advance-target="input"
               data-action="mousedown->hotspot-editor#startDrag">
            <input type="text"
                   data-fill-blanks-target="input"
                   data-correct-answer="<%= input[:answer] %>"
                   class="w-full h-full py-1 bg-white/60 hover:bg-white/80 focus:bg-white border-2 text-black border-transparent hover:border-cyan-500 focus:border-cyan-600 rounded text-center font-bold text-xs sm:text-sm transition-colors"
                   inputmode="<%= input[:answer].to_s.match?(/^\d+$/) ? 'numeric' : 'text' %>"
                   aria-label="<%= input[:label] %>">
          </div>
        <% end %>
      </div>
    </div>

  </div>

  <%= render 'shared/exercise_controls' %>
</div>
