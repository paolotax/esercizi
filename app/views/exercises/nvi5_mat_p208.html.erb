<div class="max-w-6xl mx-auto bg-white p-3 md:p-6"
     data-controller="exercise-checker text-toggle font-controls"
     data-text-toggle-target="content"
     data-font-controls-target="content">

  <%= render 'shared/page_header', pagina: @pagina %>

  <div class="space-y-6">
    <!-- Box riassuntivo teoria -->
    <div class="p-4 bg-custom-blue rounded-lg">
      <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
        <!-- Colonna sinistra -->
        <div class="space-y-4">
          <div>
            <p class="font-bold text-cyan-600 mb-2">Frazioni complementari</p>
            <%= image_tag "nvi5_mat/p208/p208_01.jpg", class: "max-w-[120px]", alt: "frazioni complementari" %>
            <div class="flex items-center gap-2 mt-2">
              <%= render 'shared/frazione', num: 3, den: 4, border: nil %>
              <span>+</span>
              <%= render 'shared/frazione', num: 1, den: 4, border: nil %>
              <span>=</span>
              <%= render 'shared/frazione', num: 4, den: 4, border: nil %>
              <span>= 1</span>
            </div>
          </div>

          <div>
            <p class="font-bold text-cyan-600 mb-2">Frazioni equivalenti</p>
            <%= image_tag "nvi5_mat/p208/p208_02.jpg", class: "max-w-[120px]", alt: "frazioni equivalenti" %>
            <div class="flex items-center gap-2 mt-2">
              <%= render 'shared/frazione', num: 2, den: 4, border: nil %>
              <span>=</span>
              <%= render 'shared/frazione', num: 4, den: 8, border: nil %>
            </div>
          </div>
        </div>

        <!-- Colonna destra -->
        <div class="space-y-4">
          <div>
            <p class="font-bold text-cyan-600 mb-2">Frazioni a confronto</p>
            <%= image_tag "nvi5_mat/p208/p208_03.jpg", class: "max-w-[120px]", alt: "frazioni a confronto" %>
            <div class="flex items-center gap-2 mt-2">
              <%= render 'shared/frazione', num: 2, den: 4, border: nil %>
              <span class="font-bold text-cyan-600">&gt;</span>
              <%= render 'shared/frazione', num: 2, den: 5, border: nil %>
              <span class="mx-2">|</span>
              <%= render 'shared/frazione', num: 4, den: 5, border: nil %>
              <span class="font-bold text-cyan-600">&gt;</span>
              <%= render 'shared/frazione', num: 2, den: 5, border: nil %>
            </div>
          </div>

          <div>
            <p class="font-bold text-cyan-600 mb-2">Frazione di un numero</p>
            <div class="flex items-center gap-2">
              <%= render 'shared/frazione', num: 3, den: 4, border: nil %>
              <span>di 12</span>
              <span class="text-cyan-500">→</span>
              <span>(12 <span class="font-bold">: 4</span>) <span class="font-bold">× 3</span></span>
            </div>
          </div>

          <div>
            <p class="font-bold text-cyan-600 mb-2">Dalla frazione all'intero</p>
            <div class="flex items-center gap-2">
              <%= render 'shared/frazione', num: 3, den: 5, border: nil %>
              <span>= 21</span>
              <span class="text-cyan-500">→</span>
              <span>(21 <span class="font-bold">: 3</span>) <span class="font-bold">× 5</span></span>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- Esercizio 1: IMPARARE TUTTI - Scrivi la frazione complementare -->
    <div class="p-4 bg-white rounded-2xl border-3 border-yellow-400">
      <p class="font-bold text-gray-700 mb-4">
        <%= imparare_tutti_badge(1) %>
        Scrivi la frazione complementare e completa l'uguaglianza.
      </p>

      <div class="grid grid-cols-1 md:grid-cols-3 gap-4">
        <!-- Esempio: 6/14 + 8/14 = 14/14 = 1 -->
        <div class="flex items-center gap-2 flex-wrap">
          <%= render 'shared/frazione', num: 6, den: 14, border: nil %>
          <span>+</span>
          <span class="font-bold text-cyan-600"><%= render 'shared/frazione', num: 8, den: 14, border: nil %></span>
          <span>=</span>
          <span class="font-bold text-cyan-600"><%= render 'shared/frazione', num: 14, den: 14, border: nil %></span>
          <span>= 1</span>
        </div>
        <!-- 23/36 + 13/36 = 36/36 = 1 -->
        <div class="flex items-center gap-2 flex-wrap">
          <%= render 'shared/frazione', num: 23, den: 36, border: nil %>
          <span>+</span>
          <%= render 'shared/frazione', num: nil, den: nil, num_answer: "13", den_answer: "36" %>
          <span>=</span>
          <%= render 'shared/frazione', num: nil, den: nil, num_answer: "36", den_answer: "36" %>
          <span>= 1</span>
        </div>
        <!-- 9/81 + 72/81 = 81/81 = 1 -->
        <div class="flex items-center gap-2 flex-wrap">
          <%= render 'shared/frazione', num: 9, den: 81, border: nil %>
          <span>+</span>
          <%= render 'shared/frazione', num: nil, den: nil, num_answer: "72", den_answer: "81" %>
          <span>=</span>
          <%= render 'shared/frazione', num: nil, den: nil, num_answer: "81", den_answer: "81" %>
          <span>= 1</span>
        </div>
      </div>
    </div>

    <!-- Esercizio 2: IMPARARE TUTTI - Scrivi una frazione equivalente -->
    <div class="p-4 bg-white rounded-2xl border-3 border-yellow-400">
      <p class="font-bold text-gray-700 mb-4">
        <%= imparare_tutti_badge(2) %>
        Scrivi una frazione equivalente a quella data.
      </p>

      <div class="grid grid-cols-2 md:grid-cols-6 gap-4">
        <!-- Esempio: 7/26 → 14/52 -->
        <div class="flex flex-col items-center gap-2">
          <%= render 'shared/frazione', num: 7, den: 26, border: nil %>
          <span class="text-cyan-500">↓</span>
          <span class="font-bold text-cyan-600"><%= render 'shared/frazione', num: 14, den: 52, border: nil %></span>
        </div>
        <!-- 4/35 -->
        <div class="flex flex-col items-center gap-2">
          <%= render 'shared/frazione', num: 4, den: 35, border: nil %>
          <span class="text-cyan-500">↓</span>
          <%= render 'shared/frazione', num: nil, den: nil, num_answer: "8", den_answer: "70" %>
        </div>
        <!-- 14/28 -->
        <div class="flex flex-col items-center gap-2">
          <%= render 'shared/frazione', num: 14, den: 28, border: nil %>
          <span class="text-cyan-500">↓</span>
          <%= render 'shared/frazione', num: nil, den: nil, num_answer: "7", den_answer: "14" %>
        </div>
        <!-- 9/36 -->
        <div class="flex flex-col items-center gap-2">
          <%= render 'shared/frazione', num: 9, den: 36, border: nil %>
          <span class="text-cyan-500">↓</span>
          <%= render 'shared/frazione', num: nil, den: nil, num_answer: "3", den_answer: "12" %>
        </div>
        <!-- 16/20 -->
        <div class="flex flex-col items-center gap-2">
          <%= render 'shared/frazione', num: 16, den: 20, border: nil %>
          <span class="text-cyan-500">↓</span>
          <%= render 'shared/frazione', num: nil, den: nil, num_answer: "4", den_answer: "5" %>
        </div>
        <!-- 33/44 -->
        <div class="flex flex-col items-center gap-2">
          <%= render 'shared/frazione', num: 33, den: 44, border: nil %>
          <span class="text-cyan-500">↓</span>
          <%= render 'shared/frazione', num: nil, den: nil, num_answer: "3", den_answer: "4" %>
        </div>
      </div>
    </div>

    <!-- Esercizio 3: Completa con >, <, = -->
    <div>
      <p class="font-bold text-gray-700 mb-4">
        <span class="font-bold text-cyan-600">3</span>
        Completa con <span class="font-bold text-cyan-600">&gt;</span>, <span class="font-bold text-cyan-600">&lt;</span> oppure <span class="font-bold text-cyan-600">=</span>.
      </p>

      <div class="grid grid-cols-2 md:grid-cols-4 gap-4">
        <!-- 6/30 ? 6/15 -->
        <div class="flex items-center justify-center gap-2">
          <%= render 'shared/frazione', num: 6, den: 30, border: nil %>
          <input type="text" data-correct-answer="<" class="w-10 border-b-2 border-dotted border-gray-400 text-center font-bold bg-transparent">
          <%= render 'shared/frazione', num: 6, den: 15, border: nil %>
        </div>
        <!-- 2/35 ? 2/35 -->
        <div class="flex items-center justify-center gap-2">
          <%= render 'shared/frazione', num: 2, den: 35, border: nil %>
          <input type="text" data-correct-answer="<" class="w-10 border-b-2 border-dotted border-gray-400 text-center font-bold bg-transparent">
          <%= render 'shared/frazione', num: 4, den: 35, border: nil %>
        </div>
        <!-- 9/45 ? 9/40 -->
        <div class="flex items-center justify-center gap-2">
          <%= render 'shared/frazione', num: 9, den: 45, border: nil %>
          <input type="text" data-correct-answer="<" class="w-10 border-b-2 border-dotted border-gray-400 text-center font-bold bg-transparent">
          <%= render 'shared/frazione', num: 9, den: 40, border: nil %>
        </div>
        <!-- 3/30 ? 10/30 -->
        <div class="flex items-center justify-center gap-2">
          <%= render 'shared/frazione', num: 3, den: 30, border: nil %>
          <input type="text" data-correct-answer="<" class="w-10 border-b-2 border-dotted border-gray-400 text-center font-bold bg-transparent">
          <%= render 'shared/frazione', num: 10, den: 30, border: nil %>
        </div>
        <!-- 18/24 ? 20/24 -->
        <div class="flex items-center justify-center gap-2">
          <%= render 'shared/frazione', num: 18, den: 24, border: nil %>
          <input type="text" data-correct-answer="<" class="w-10 border-b-2 border-dotted border-gray-400 text-center font-bold bg-transparent">
          <%= render 'shared/frazione', num: 20, den: 24, border: nil %>
        </div>
        <!-- 12/12 = 24/24 -->
        <div class="flex items-center justify-center gap-2">
          <%= render 'shared/frazione', num: 12, den: 12, border: nil %>
          <input type="text" data-correct-answer="=" class="w-10 border-b-2 border-dotted border-gray-400 text-center font-bold bg-transparent">
          <%= render 'shared/frazione', num: 24, den: 24, border: nil %>
        </div>
        <!-- 17/81 > 8/81 -->
        <div class="flex items-center justify-center gap-2">
          <%= render 'shared/frazione', num: 17, den: 81, border: nil %>
          <input type="text" data-correct-answer=">" class="w-10 border-b-2 border-dotted border-gray-400 text-center font-bold bg-transparent">
          <%= render 'shared/frazione', num: 8, den: 81, border: nil %>
        </div>
        <!-- 5/46 > 5/64 -->
        <div class="flex items-center justify-center gap-2">
          <%= render 'shared/frazione', num: 5, den: 46, border: nil %>
          <input type="text" data-correct-answer=">" class="w-10 border-b-2 border-dotted border-gray-400 text-center font-bold bg-transparent">
          <%= render 'shared/frazione', num: 5, den: 64, border: nil %>
        </div>
        <!-- 32/68 ? 10/68 -->
        <div class="flex items-center justify-center gap-2">
          <%= render 'shared/frazione', num: 32, den: 68, border: nil %>
          <input type="text" data-correct-answer=">" class="w-10 border-b-2 border-dotted border-gray-400 text-center font-bold bg-transparent">
          <%= render 'shared/frazione', num: 10, den: 68, border: nil %>
        </div>
        <!-- 16/10 ? 16/20 -->
        <div class="flex items-center justify-center gap-2">
          <%= render 'shared/frazione', num: 16, den: 10, border: nil %>
          <input type="text" data-correct-answer=">" class="w-10 border-b-2 border-dotted border-gray-400 text-center font-bold bg-transparent">
          <%= render 'shared/frazione', num: 16, den: 20, border: nil %>
        </div>
      </div>
    </div>

    <!-- Esercizio 4: Scegli l'espressione giusta -->
    <div>
      <p class="font-bold text-gray-700 mb-4">
        <span class="font-bold text-cyan-600">4</span>
        Scegli con una <span class="font-bold text-cyan-600">X</span> l'espressione giusta per calcolare:
      </p>

      <div class="space-y-4">
        <!-- 3/13 di 169 -->
        <div class="flex flex-col md:flex-row md:items-center gap-4">
          <span class="text-gray-700 font-bold"><span class="text-cyan-500">•</span> <%= render 'shared/frazione', num: 3, den: 13, border: nil %> di 169</span>
          <div class="flex flex-wrap gap-4">
            <label class="flex items-center gap-2 cursor-pointer hover:bg-cyan-100 p-2 rounded">
              <input type="radio" name="calc_a" class="w-5 h-5" data-correct-answer="false">
              <span>(169 × 3) : 13</span>
            </label>
            <label class="flex items-center gap-2 cursor-pointer hover:bg-cyan-100 p-2 rounded">
              <input type="radio" name="calc_a" class="w-5 h-5" data-correct-answer="true">
              <span>(169 : 13) × 3</span>
            </label>
            <label class="flex items-center gap-2 cursor-pointer hover:bg-cyan-100 p-2 rounded">
              <input type="radio" name="calc_a" class="w-5 h-5" data-correct-answer="false">
              <span>(169 : 3) × 13</span>
            </label>
          </div>
        </div>

        <!-- l'intero se 8/15 = 96 -->
        <div class="flex flex-col md:flex-row md:items-center gap-4">
          <span class="text-gray-700 font-bold"><span class="text-cyan-500">•</span> l'intero se <%= render 'shared/frazione', num: 8, den: 15, border: nil %> = 96</span>
          <div class="flex flex-wrap gap-4">
            <label class="flex items-center gap-2 cursor-pointer hover:bg-cyan-100 p-2 rounded">
              <input type="radio" name="calc_b" class="w-5 h-5" data-correct-answer="false">
              <span>(96 : 15) × 8</span>
            </label>
            <label class="flex items-center gap-2 cursor-pointer hover:bg-cyan-100 p-2 rounded">
              <input type="radio" name="calc_b" class="w-5 h-5" data-correct-answer="false">
              <span>(96 × 8) : 15</span>
            </label>
            <label class="flex items-center gap-2 cursor-pointer hover:bg-cyan-100 p-2 rounded">
              <input type="radio" name="calc_b" class="w-5 h-5" data-correct-answer="true">
              <span>(96 : 8) × 15</span>
            </label>
          </div>
        </div>
      </div>
    </div>

    <!-- Esercizio 5: Risolvi il problema -->
    <div>
      <p class="font-bold text-gray-700 mb-4">
        <span class="font-bold text-cyan-600">5</span>
        Risolvi il problema sul quaderno.
      </p>

      <div class="p-4 bg-cyan-50 rounded-lg">
        <p class="text-gray-700 mb-4">
          Lorenzo, Gabriele e Nicoletta stanno leggendo lo stesso libro di 360 pagine. Lorenzo ne ha letti i <%= render 'shared/frazione', num: 10, den: 12, border: nil %>, Gabriele i <%= render 'shared/frazione', num: 6, den: 9, border: nil %> e Nicoletta i <%= render 'shared/frazione', num: 3, den: 4, border: nil %>. Quale dei tre ha letto più pagine?
        </p>
        <div class="flex items-center gap-2">
          <input type="text" data-correct-answer="Lorenzo" class="w-32 border-b-2 border-dotted border-gray-400 text-center font-bold bg-transparent">
        </div>
      </div>
    </div>

    <%= render 'shared/exercise_controls' %>
  </div>
</div>
