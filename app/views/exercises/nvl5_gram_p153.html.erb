<div class="max-w-6xl mx-auto bg-white dark:bg-gray-900 text-black dark:text-white p-3 md:p-6 transition-colors duration-300"
     data-controller="exercise-checker text-toggle font-controls"
     data-text-toggle-target="content"
     data-font-controls-target="content">

  <%= render 'shared/page_header', pagina: @pagina %>

  <!-- Exercise 1: Fill articles -->
  <div class="mb-6 bg-<%= @pagina.base_color %>-100 dark:bg-<%= @pagina.base_color %>-900/40 rounded-lg p-4 md:p-6" data-controller="fill-blanks">
    <h2 class="font-bold text-<%= @pagina.base_color %>-700 mb-4 flex items-center flex-wrap gap-2">
      <span class="bg-<%= @pagina.base_color %>-500 text-white rounded-full w-8 h-8 md:w-10 md:h-10 inline-flex items-center justify-center font-bold">1</span>
      <span class="bg-yellow-400 text-<%= @pagina.base_color %>-900 px-3 py-1 rounded-lg font-bold">IMPARARE TUTTI</span>
      <span>Scrivi in maniera opportuna gli <span class="text-<%= @pagina.base_color %>-600 font-bold">articoli determinativi, indeterminativi o partitivi</span>. Poi cerchiali con tre colori diversi.</span>
    </h2>

    <div class="space-y-3">
      <div class="bg-white dark:bg-gray-800 rounded-lg px-4 py-3">
        <p class="text-gray-700 dark:text-gray-200">
          • Ai giardini ho incontrato
          <input type="text" class="border-b-2 border-dotted border-gray-400 dark:border-gray-600 bg-transparent dark:text-white px-2 py-1 w-20 focus:outline-none focus:border-<%= @pagina.base_color %>-500 mx-1" data-fill-blanks-target="input" data-answer="delle">
          bambine molto simpatiche.
        </p>
      </div>
      <div class="bg-white dark:bg-gray-800 rounded-lg px-4 py-3">
        <p class="text-gray-700 dark:text-gray-200">
          •
          <input type="text" class="border-b-2 border-dotted border-gray-400 dark:border-gray-600 bg-transparent dark:text-white px-2 py-1 w-16 focus:outline-none focus:border-<%= @pagina.base_color %>-500 mx-1" data-fill-blanks-target="input" data-answer="Il">
          Monte Bianco è
          <input type="text" class="border-b-2 border-dotted border-gray-400 dark:border-gray-600 bg-transparent dark:text-white px-2 py-1 w-16 focus:outline-none focus:border-<%= @pagina.base_color %>-500 mx-1" data-fill-blanks-target="input" data-answer="il">
          monte più alto d'Italia.
        </p>
      </div>
      <div class="bg-white dark:bg-gray-800 rounded-lg px-4 py-3">
        <p class="text-gray-700 dark:text-gray-200">
          •
          <input type="text" class="border-b-2 border-dotted border-gray-400 dark:border-gray-600 bg-transparent dark:text-white px-2 py-1 w-16 focus:outline-none focus:border-<%= @pagina.base_color %>-500 mx-1" data-fill-blanks-target="input" data-answer="Il">
          mio sport preferito è
          <input type="text" class="border-b-2 border-dotted border-gray-400 dark:border-gray-600 bg-transparent dark:text-white px-2 py-1 w-16 focus:outline-none focus:border-<%= @pagina.base_color %>-500 mx-1" data-fill-blanks-target="input" data-answer="la">
          pallavolo.
        </p>
      </div>
      <div class="bg-white dark:bg-gray-800 rounded-lg px-4 py-3">
        <p class="text-gray-700 dark:text-gray-200">
          • In quella pasticceria fanno
          <input type="text" class="border-b-2 border-dotted border-gray-400 dark:border-gray-600 bg-transparent dark:text-white px-2 py-1 w-20 focus:outline-none focus:border-<%= @pagina.base_color %>-500 mx-1" data-fill-blanks-target="input" data-answer="dei">
          biscotti al cioccolato molto buoni.
        </p>
      </div>
      <div class="bg-white dark:bg-gray-800 rounded-lg px-4 py-3">
        <p class="text-gray-700 dark:text-gray-200">
          •
          <input type="text" class="border-b-2 border-dotted border-gray-400 dark:border-gray-600 bg-transparent dark:text-white px-2 py-1 w-16 focus:outline-none focus:border-<%= @pagina.base_color %>-500 mx-1" data-fill-blanks-target="input" data-answer="La">
          casa era avvolta in
          <input type="text" class="border-b-2 border-dotted border-gray-400 dark:border-gray-600 bg-transparent dark:text-white px-2 py-1 w-16 focus:outline-none focus:border-<%= @pagina.base_color %>-500 mx-1" data-fill-blanks-target="input" data-answer="uno">
          strano silenzio: si udiva solo
          <input type="text" class="border-b-2 border-dotted border-gray-400 dark:border-gray-600 bg-transparent dark:text-white px-2 py-1 w-16 focus:outline-none focus:border-<%= @pagina.base_color %>-500 mx-1" data-fill-blanks-target="input" data-answer="lo">
          sgocciolare di
          <input type="text" class="border-b-2 border-dotted border-gray-400 dark:border-gray-600 bg-transparent dark:text-white px-2 py-1 w-16 focus:outline-none focus:border-<%= @pagina.base_color %>-500 mx-1" data-fill-blanks-target="input" data-answer="un">
          rubinetto.
        </p>
      </div>
    </div>
  </div>

  <!-- Exercise 2: Abstract nouns -->
  <div class="mb-6 bg-<%= @pagina.base_color %>-50 dark:bg-<%= @pagina.base_color %>-900/30 rounded-lg p-4 md:p-6" data-controller="word-highlighter" data-word-highlighter-multi-color-value="false">
    <h2 class="font-bold text-<%= @pagina.base_color %>-700 mb-4 flex items-center gap-2">
      <span class="bg-<%= @pagina.base_color %>-500 text-white rounded-full w-8 h-8 md:w-10 md:h-10 inline-flex items-center justify-center font-bold">2</span>
      <span>Sottolinea i <span class="text-<%= @pagina.base_color %>-600 font-bold">nomi astratti<span class="inline-block w-6 h-6 bg-<%= @pagina.base_color %>-300 rounded ml-1 align-middle cursor-pointer" data-word-highlighter-target="colorBox" data-color="<%= @pagina.base_color %>" data-action="click->word-highlighter#selectColor"></span></span>.</span>
    </h2>

    <div class="bg-white dark:bg-gray-800 rounded-lg px-4 py-4 text-gray-700 dark:text-gray-200 leading-relaxed">
      <p>
        <span data-word-highlighter-target="word" data-correct="true" data-action="click->word-highlighter#toggleHighlight" class="px-1 rounded">libertà</span> • caminetto • fratello • <span data-word-highlighter-target="word" data-correct="true" data-action="click->word-highlighter#toggleHighlight" class="px-1 rounded">fratellanza</span> • <span data-word-highlighter-target="word" data-correct="true" data-action="click->word-highlighter#toggleHighlight" class="px-1 rounded">chiarore</span> • cielo • aria • <span data-word-highlighter-target="word" data-correct="true" data-action="click->word-highlighter#toggleHighlight" class="px-1 rounded">silenzio</span> • <span data-word-highlighter-target="word" data-correct="true" data-action="click->word-highlighter#toggleHighlight" class="px-1 rounded">simpatia</span> • <span data-word-highlighter-target="word" data-correct="true" data-action="click->word-highlighter#toggleHighlight" class="px-1 rounded">amicizia</span> • <span data-word-highlighter-target="word" data-correct="true" data-action="click->word-highlighter#toggleHighlight" class="px-1 rounded">astronomia</span> • pianeta • stella • <span data-word-highlighter-target="word" data-correct="true" data-action="click->word-highlighter#toggleHighlight" class="px-1 rounded">grammatica</span> • <span data-word-highlighter-target="word" data-correct="true" data-action="click->word-highlighter#toggleHighlight" class="px-1 rounded">perdono</span>
      </p>
    </div>
  </div>

  <!-- Exercise 3: Compound nouns -->
  <div class="mb-6 bg-<%= @pagina.base_color %>-50 dark:bg-<%= @pagina.base_color %>-900/30 rounded-lg p-4 md:p-6" data-controller="card-selector">
    <h2 class="font-bold text-<%= @pagina.base_color %>-700 mb-4 flex items-center gap-2">
      <span class="bg-<%= @pagina.base_color %>-500 text-white rounded-full w-8 h-8 md:w-10 md:h-10 inline-flex items-center justify-center font-bold">3</span>
      <span>Colora i cartellini con i <span class="text-<%= @pagina.base_color %>-600 font-bold">nomi composti</span>.</span>
    </h2>

    <% nouns = [
      { word: "caporale", compound: true },
      { word: "capostazione", compound: true },
      { word: "appuntamento", compound: false },
      { word: "doposcuola", compound: true },
      { word: "temperamatite", compound: true },
      { word: "autorimessa", compound: true },
      { word: "autorità", compound: false },
      { word: "bisbiglio", compound: false },
      { word: "pianoforte", compound: true },
      { word: "stuzzicadenti", compound: true },
      { word: "tritaghiaccio", compound: true },
      { word: "spremiagrumi", compound: true }
    ] %>

    <div class="grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 gap-3">
      <% nouns.each do |noun| %>
        <div class="border border-gray-300 dark:border-gray-600 rounded-lg px-4 py-3 text-center cursor-pointer transition-all hover:bg-<%= @pagina.base_color %>-50 dark:hover:bg-<%= @pagina.base_color %>-900/30 bg-white dark:bg-gray-800"
             data-card-selector-target="card"
             data-correct="<%= noun[:compound] %>"
             data-action="click->card-selector#toggle">
          <span class="font-semibold text-gray-700 dark:text-gray-200"><%= noun[:word] %></span>
        </div>
      <% end %>
    </div>
  </div>

  <!-- Exercise 4: Write sentences -->
  <div class="mb-6 bg-<%= @pagina.base_color %>-50 dark:bg-<%= @pagina.base_color %>-900/30 rounded-lg p-4 md:p-6">
    <h2 class="font-bold text-<%= @pagina.base_color %>-700 mb-4 flex items-center gap-2">
      <span class="bg-<%= @pagina.base_color %>-500 text-white rounded-full w-8 h-8 md:w-10 md:h-10 inline-flex items-center justify-center font-bold">4</span>
      <span>Per ciascuno di questi nomi scrivi una frase.</span>
    </h2>

    <div class="bg-white dark:bg-gray-800 rounded-lg px-4 py-3 mb-4 text-center">
      <span class="font-bold text-<%= @pagina.base_color %>-700">bracci • braccia • muri • mura</span>
    </div>

    <div class="space-y-3">
      <% 4.times do |i| %>
        <div class="bg-white dark:bg-gray-800 rounded-lg px-4 py-3">
          <input type="text" class="w-full bg-transparent dark:text-white border-b border-dotted border-gray-400 dark:border-gray-600 focus:outline-none focus:border-<%= @pagina.base_color %>-500 py-2" placeholder="Scrivi qui la tua frase...">
        </div>
      <% end %>
    </div>
  </div>

  <!-- Exercise 5: Primitive, derived, altered -->
  <div class="mb-6 bg-<%= @pagina.base_color %>-50 dark:bg-<%= @pagina.base_color %>-900/30 rounded-lg p-4 md:p-6" data-controller="word-highlighter" data-word-highlighter-multi-color-value="true">
    <h2 class="font-bold text-<%= @pagina.base_color %>-700 mb-4 flex items-center gap-2">
      <span class="bg-<%= @pagina.base_color %>-500 text-white rounded-full w-8 h-8 md:w-10 md:h-10 inline-flex items-center justify-center font-bold">5</span>
      <span>Sottolinea in rosso i <span class="text-red-600 font-bold">nomi primitivi<span class="inline-block w-6 h-6 bg-red-300 rounded ml-1 align-middle cursor-pointer" data-word-highlighter-target="colorBox" data-color="red" data-action="click->word-highlighter#selectColor"></span></span>, in blu i <span class="text-blue-600 font-bold">nomi derivati<span class="inline-block w-6 h-6 bg-blue-300 rounded ml-1 align-middle cursor-pointer" data-word-highlighter-target="colorBox" data-color="blue" data-action="click->word-highlighter#selectColor"></span></span>, in verde i <span class="text-green-600 font-bold">nomi alterati<span class="inline-block w-6 h-6 bg-green-300 rounded ml-1 align-middle cursor-pointer" data-word-highlighter-target="colorBox" data-color="green" data-action="click->word-highlighter#selectColor"></span></span>.</span>
    </h2>

    <div class="bg-white dark:bg-gray-800 rounded-lg px-4 py-4 text-gray-700 dark:text-gray-200 leading-relaxed">
      <p>
        <span data-word-highlighter-target="word" data-correct-color="red" data-action="click->word-highlighter#toggleHighlight" class="px-1 rounded">bocca</span> •
        <span data-word-highlighter-target="word" data-correct-color="blue" data-action="click->word-highlighter#toggleHighlight" class="px-1 rounded">boccale</span> •
        <span data-word-highlighter-target="word" data-correct-color="green" data-action="click->word-highlighter#toggleHighlight" class="px-1 rounded">monticello</span> •
        <span data-word-highlighter-target="word" data-correct-color="green" data-action="click->word-highlighter#toggleHighlight" class="px-1 rounded">muretto</span> •
        <span data-word-highlighter-target="word" data-correct-color="blue" data-action="click->word-highlighter#toggleHighlight" class="px-1 rounded">muratore</span> •
        <span data-word-highlighter-target="word" data-correct-color="red" data-action="click->word-highlighter#toggleHighlight" class="px-1 rounded">porta</span> •
        <span data-word-highlighter-target="word" data-correct-color="green" data-action="click->word-highlighter#toggleHighlight" class="px-1 rounded">coltellino</span> •
        <span data-word-highlighter-target="word" data-correct-color="green" data-action="click->word-highlighter#toggleHighlight" class="px-1 rounded">boccuccia</span> •
        <span data-word-highlighter-target="word" data-correct-color="green" data-action="click->word-highlighter#toggleHighlight" class="px-1 rounded">piumetta</span> •
        <span data-word-highlighter-target="word" data-correct-color="blue" data-action="click->word-highlighter#toggleHighlight" class="px-1 rounded">pastificio</span> •
        <span data-word-highlighter-target="word" data-correct-color="blue" data-action="click->word-highlighter#toggleHighlight" class="px-1 rounded">barista</span> •
        <span data-word-highlighter-target="word" data-correct-color="red" data-action="click->word-highlighter#toggleHighlight" class="px-1 rounded">camicia</span> •
        <span data-word-highlighter-target="word" data-correct-color="blue" data-action="click->word-highlighter#toggleHighlight" class="px-1 rounded">pizzaiolo</span> •
        <span data-word-highlighter-target="word" data-correct-color="green" data-action="click->word-highlighter#toggleHighlight" class="px-1 rounded">scatolone</span> •
        <span data-word-highlighter-target="word" data-correct-color="green" data-action="click->word-highlighter#toggleHighlight" class="px-1 rounded">paperella</span>
      </p>
    </div>
  </div>

  <%= render 'shared/exercise_controls' %>

</div>
