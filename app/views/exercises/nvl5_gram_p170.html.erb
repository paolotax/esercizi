<div class="max-w-6xl mx-auto p-3 md:p-8 bg-gradient-to-br from-cyan-50 via-white to-blue-50 rounded-3xl shadow-xl" data-controller="exercise-checker">

  <!-- Header -->
  <div class="mb-8">
    <div class="flex items-start sm:items-center justify-between gap-4 mb-4">
      <div class="flex flex-col-reverse sm:flex-row items-start sm:items-center gap-2 sm:gap-4">
        <div class="bg-cyan-500 text-white text-md sm:text-xl px-2 sm:px-4 py-1.5 sm:py-2 rounded-lg font-bold">
          MORFOLOGIA
        </div>
        <h1 class="text-2xl sm:text-3xl font-bold text-cyan-600">Verbi transitivi e verbi intransitivi</h1>
      </div>
      <div class="flex-shrink-0 bg-cyan-600 text-white rounded-full w-10 h-10 sm:w-12 sm:h-12 flex items-center justify-center font-bold text-lg sm:text-xl">
        170
      </div>
    </div>
  </div>

  <!-- Esercizio 1: Completa e classifica i verbi -->
  <div class="mb-6 bg-white rounded-2xl border-4 border-yellow-200 shadow-2xl p-4 md:p-6" data-controller="fill-blanks word-highlighter multiple-choice" data-word-highlighter-multi-color-value="false">
    <h2 class="text-lg md:text-xl font-bold text-gray-700 mb-4">
      <span class="bg-yellow-600 text-white rounded-full w-8 h-8 md:w-10 md:h-10 inline-flex items-center justify-center mr-2">1</span>
      <span class="bg-yellow-400 text-blue-800 px-2 py-1 rounded text-sm md:text-base font-bold mr-2">IMPARARE TUTTI</span>
      Sottolinea il <strong class="underline">verbo</strong> e completa le frasi con un <strong class="underline">complemento oggetto</strong>, quando è possibile. Se non è possibile, completa con un <strong class="underline">complemento indiretto</strong>. Infine indica con una X se il verbo è <strong class="underline">transitivo</strong> (T) o <strong class="underline">intransitivo</strong> (I).
    </h2>

    <!-- Hidden color selector for monocolor mode -->
    <div class="hidden">
      <span data-word-highlighter-target="colorBox" data-color="blue"></span>
    </div>

    <!-- Box informativo -->
    <div class="bg-blue-50 border-2 border-blue-300 rounded-xl p-4 mb-4">
      <p class="text-gray-700">
        Il <strong>complemento oggetto</strong> non è introdotto da preposizioni e risponde alle domande: <strong>chi? / che cosa?</strong><br>
        I <strong>complementi indiretti</strong> di solito sono introdotti da preposizioni.
      </p>
    </div>

    <div class="space-y-3 text-base md:text-lg">
      <div class="bg-gray-50 border-2 border-gray-200 rounded-xl px-4 py-3 cursor-pointer">
        <div class="flex flex-wrap items-center gap-2 mb-2">
          <span class="text-gray-700">• <span data-word-highlighter-target="word" data-correct="blue" data-action="click->word-highlighter#toggleHighlight" class="px-1 rounded">Corriamo</span></span>
          <input type="text" class="border-b-2 border-gray-400 bg-transparent px-2 py-1 focus:outline-none focus:border-blue-600 w-48" data-fill-blanks-target="input" data-correct-answer="libera" placeholder="">
        </div>
        <div class="flex items-center gap-4 ml-4">
          <label class="flex items-center gap-2 cursor-pointer">
            <input type="radio" name="q1" data-multiple-choice-target="answer" data-correct-answer="false" class="w-5 h-5">
            <span class="font-bold">T</span>
          </label>
          <label class="flex items-center gap-2 cursor-pointer">
            <input type="radio" name="q1" data-multiple-choice-target="answer" data-correct-answer="true" class="w-5 h-5">
            <span class="font-bold">I</span>
          </label>
        </div>
      </div>

      <div class="bg-gray-50 border-2 border-gray-200 rounded-xl px-4 py-3 cursor-pointer">
        <div class="flex flex-wrap items-center gap-2 mb-2">
          <span class="text-gray-700">• Il papà <span data-word-highlighter-target="word" data-correct="blue" data-action="click->word-highlighter#toggleHighlight" class="px-1 rounded">ha comprato</span></span>
          <input type="text" class="border-b-2 border-gray-400 bg-transparent px-2 py-1 focus:outline-none focus:border-blue-600 w-48" data-fill-blanks-target="input" data-correct-answer="libera" placeholder="">
        </div>
        <div class="flex items-center gap-4 ml-4">
          <label class="flex items-center gap-2 cursor-pointer">
            <input type="radio" name="q2" data-multiple-choice-target="answer" data-correct-answer="true" class="w-5 h-5">
            <span class="font-bold">T</span>
          </label>
          <label class="flex items-center gap-2 cursor-pointer">
            <input type="radio" name="q2" data-multiple-choice-target="answer" data-correct-answer="false" class="w-5 h-5">
            <span class="font-bold">I</span>
          </label>
        </div>
      </div>

      <div class="bg-gray-50 border-2 border-gray-200 rounded-xl px-4 py-3 cursor-pointer">
        <div class="flex flex-wrap items-center gap-2 mb-2">
          <span class="text-gray-700">• Per favore, <span data-word-highlighter-target="word" data-correct="blue" data-action="click->word-highlighter#toggleHighlight" class="px-1 rounded">passami</span></span>
          <input type="text" class="border-b-2 border-gray-400 bg-transparent px-2 py-1 focus:outline-none focus:border-blue-600 w-48" data-fill-blanks-target="input" data-correct-answer="libera" placeholder="">
        </div>
        <div class="flex items-center gap-4 ml-4">
          <label class="flex items-center gap-2 cursor-pointer">
            <input type="radio" name="q3" data-multiple-choice-target="answer" data-correct-answer="true" class="w-5 h-5">
            <span class="font-bold">T</span>
          </label>
          <label class="flex items-center gap-2 cursor-pointer">
            <input type="radio" name="q3" data-multiple-choice-target="answer" data-correct-answer="false" class="w-5 h-5">
            <span class="font-bold">I</span>
          </label>
        </div>
      </div>

      <div class="bg-gray-50 border-2 border-gray-200 rounded-xl px-4 py-3 cursor-pointer">
        <div class="flex flex-wrap items-center gap-2 mb-2">
          <span class="text-gray-700">• <span data-word-highlighter-target="word" data-correct="blue" data-action="click->word-highlighter#toggleHighlight" class="px-1 rounded">Conosci</span></span>
          <input type="text" class="border-b-2 border-gray-400 bg-transparent px-2 py-1 focus:outline-none focus:border-blue-600 w-48" data-fill-blanks-target="input" data-correct-answer="libera" placeholder="">
        </div>
        <div class="flex items-center gap-4 ml-4">
          <label class="flex items-center gap-2 cursor-pointer">
            <input type="radio" name="q4" data-multiple-choice-target="answer" data-correct-answer="true" class="w-5 h-5">
            <span class="font-bold">T</span>
          </label>
          <label class="flex items-center gap-2 cursor-pointer">
            <input type="radio" name="q4" data-multiple-choice-target="answer" data-correct-answer="false" class="w-5 h-5">
            <span class="font-bold">I</span>
          </label>
        </div>
      </div>

      <div class="bg-gray-50 border-2 border-gray-200 rounded-xl px-4 py-3 cursor-pointer">
        <div class="flex flex-wrap items-center gap-2 mb-2">
          <span class="text-gray-700">• Due pesci rossi <span data-word-highlighter-target="word" data-correct="blue" data-action="click->word-highlighter#toggleHighlight" class="px-1 rounded">nuotavano</span></span>
          <input type="text" class="border-b-2 border-gray-400 bg-transparent px-2 py-1 focus:outline-none focus:border-blue-600 w-48" data-fill-blanks-target="input" data-correct-answer="libera" placeholder="">
        </div>
        <div class="flex items-center gap-4 ml-4">
          <label class="flex items-center gap-2 cursor-pointer">
            <input type="radio" name="q5" data-multiple-choice-target="answer" data-correct-answer="false" class="w-5 h-5">
            <span class="font-bold">T</span>
          </label>
          <label class="flex items-center gap-2 cursor-pointer">
            <input type="radio" name="q5" data-multiple-choice-target="answer" data-correct-answer="true" class="w-5 h-5">
            <span class="font-bold">I</span>
          </label>
        </div>
      </div>

      <div class="bg-gray-50 border-2 border-gray-200 rounded-xl px-4 py-3 cursor-pointer">
        <div class="flex flex-wrap items-center gap-2 mb-2">
          <span class="text-gray-700">• Una scimmietta <span data-word-highlighter-target="word" data-correct="blue" data-action="click->word-highlighter#toggleHighlight" class="px-1 rounded">mangiava</span></span>
          <input type="text" class="border-b-2 border-gray-400 bg-transparent px-2 py-1 focus:outline-none focus:border-blue-600 w-48" data-fill-blanks-target="input" data-correct-answer="libera" placeholder="">
        </div>
        <div class="flex items-center gap-4 ml-4">
          <label class="flex items-center gap-2 cursor-pointer">
            <input type="radio" name="q6" data-multiple-choice-target="answer" data-correct-answer="true" class="w-5 h-5">
            <span class="font-bold">T</span>
          </label>
          <label class="flex items-center gap-2 cursor-pointer">
            <input type="radio" name="q6" data-multiple-choice-target="answer" data-correct-answer="false" class="w-5 h-5">
            <span class="font-bold">I</span>
          </label>
        </div>
      </div>

      <div class="bg-gray-50 border-2 border-gray-200 rounded-xl px-4 py-3 cursor-pointer">
        <div class="flex flex-wrap items-center gap-2 mb-2">
          <span class="text-gray-700">• Una scimmietta <span data-word-highlighter-target="word" data-correct="blue" data-action="click->word-highlighter#toggleHighlight" class="px-1 rounded">si arrampicava</span></span>
          <input type="text" class="border-b-2 border-gray-400 bg-transparent px-2 py-1 focus:outline-none focus:border-blue-600 w-48" data-fill-blanks-target="input" data-correct-answer="libera" placeholder="">
        </div>
        <div class="flex items-center gap-4 ml-4">
          <label class="flex items-center gap-2 cursor-pointer">
            <input type="radio" name="q7" data-multiple-choice-target="answer" data-correct-answer="false" class="w-5 h-5">
            <span class="font-bold">T</span>
          </label>
          <label class="flex items-center gap-2 cursor-pointer">
            <input type="radio" name="q7" data-multiple-choice-target="answer" data-correct-answer="true" class="w-5 h-5">
            <span class="font-bold">I</span>
          </label>
        </div>
      </div>
    </div>
  </div>

  <!-- Esercizio 2: Sottolinea e cerchia verbi -->
  <div class="mb-6 bg-white rounded-2xl border-4 border-blue-200 shadow-2xl p-4 md:p-6" data-controller="word-highlighter" data-word-highlighter-multi-color-value="true">
    <h2 class="text-lg md:text-xl font-bold text-gray-700 mb-4">
      <span class="bg-blue-600 text-white rounded-full w-8 h-8 md:w-10 md:h-10 inline-flex items-center justify-center mr-2">2</span>
      Sottolinea i <strong class="underline">verbi transitivi<span class="inline-block w-6 h-6 bg-yellow-300 rounded ml-1 align-middle cursor-pointer transition transform hover:scale-110" data-word-highlighter-target="colorBox" data-color="yellow" data-action="click->word-highlighter#selectColor"></span></strong> e cerchia i <strong class="underline">verbi intransitivi<span class="inline-block w-6 h-6 bg-purple-300 rounded ml-1 align-middle cursor-pointer transition transform hover:scale-110" data-word-highlighter-target="colorBox" data-color="purple" data-action="click->word-highlighter#selectColor"></span></strong>.
    </h2>

    <div class="space-y-3 text-base md:text-lg cursor-pointer">
      <div class="bg-white border-2 border-gray-200 rounded-xl px-4 py-3">
        <span class="text-gray-700">• Il postino mi <span data-word-highlighter-target="word" data-correct="yellow" data-action="click->word-highlighter#toggleHighlight" class="px-1 rounded">ha consegnato</span> un pacco.</span>
      </div>

      <div class="bg-white border-2 border-gray-200 rounded-xl px-4 py-3">
        <span class="text-gray-700">• L'anziana donna <span data-word-highlighter-target="word" data-correct="purple" data-action="click->word-highlighter#toggleHighlight" class="px-1 rounded">camminava</span> lentamente.</span>
      </div>

      <div class="bg-white border-2 border-gray-200 rounded-xl px-4 py-3">
        <span class="text-gray-700">• <span data-word-highlighter-target="word" data-correct="yellow" data-action="click->word-highlighter#toggleHighlight" class="px-1 rounded">Devo imparare</span> a memoria una poesia.</span>
      </div>

      <div class="bg-white border-2 border-gray-200 rounded-xl px-4 py-3">
        <span class="text-gray-700">• Il sole <span data-word-highlighter-target="word" data-correct="purple" data-action="click->word-highlighter#toggleHighlight" class="px-1 rounded">è appena tramontato</span>.</span>
      </div>

      <div class="bg-white border-2 border-gray-200 rounded-xl px-4 py-3">
        <span class="text-gray-700">• Un bambino mi <span data-word-highlighter-target="word" data-correct="yellow" data-action="click->word-highlighter#toggleHighlight" class="px-1 rounded">ha salutato</span>.</span>
      </div>

      <div class="bg-white border-2 border-gray-200 rounded-xl px-4 py-3">
        <span class="text-gray-700">• <span data-word-highlighter-target="word" data-correct="purple" data-action="click->word-highlighter#toggleHighlight" class="px-1 rounded">Ho telefonato</span> alla maestra.</span>
      </div>

      <div class="bg-white border-2 border-gray-200 rounded-xl px-4 py-3">
        <span class="text-gray-700">• La pioggia <span data-word-highlighter-target="word" data-correct="purple" data-action="click->word-highlighter#toggleHighlight" class="px-1 rounded">cadde</span> in abbondanza.</span>
      </div>
    </div>
  </div>

  <!-- Esercizio 3: Sottolinea e scrivi frasi -->
  <div class="mb-6 bg-white rounded-2xl border-4 border-green-200 shadow-2xl p-4 md:p-6" data-controller="word-highlighter fill-blanks" data-word-highlighter-multi-color-value="false">
    <h2 class="text-lg md:text-xl font-bold text-gray-700 mb-4">
      <span class="bg-green-600 text-white rounded-full w-8 h-8 md:w-10 md:h-10 inline-flex items-center justify-center mr-2">3</span>
      Sottolinea i <strong class="underline">verbi transitivi<span class="inline-block w-6 h-6 bg-green-300 rounded ml-1 align-middle cursor-pointer transition transform hover:scale-110" data-word-highlighter-target="colorBox" data-color="green" data-action="click->word-highlighter#selectColor"></span></strong>. Poi scegline tre e per ciascuno scrivi una frase con un <strong class="underline">complemento oggetto</strong>.
    </h2>

    <!-- Hidden color selector for monocolor mode -->
    <div class="hidden">
      <span data-word-highlighter-target="colorBox" data-color="green"></span>
    </div>

    <div class="bg-green-50 border-2 border-green-300 rounded-xl p-4 mb-4 cursor-pointer">
      <div class="flex flex-wrap gap-3 text-base md:text-lg">
        <span class="text-gray-700"><span data-word-highlighter-target="word" data-correct="false" data-action="click->word-highlighter#toggleHighlight" class="px-1 rounded">abbaiare</span></span>
        <span class="text-gray-700">•</span>
        <span class="text-gray-700"><span data-word-highlighter-target="word" data-correct="green" data-action="click->word-highlighter#toggleHighlight" class="px-1 rounded">curare</span></span>
        <span class="text-gray-700">•</span>
        <span class="text-gray-700"><span data-word-highlighter-target="word" data-correct="green" data-action="click->word-highlighter#toggleHighlight" class="px-1 rounded">attraversare</span></span>
        <span class="text-gray-700">•</span>
        <span class="text-gray-700"><span data-word-highlighter-target="word" data-correct="green" data-action="click->word-highlighter#toggleHighlight" class="px-1 rounded">guidare</span></span>
        <span class="text-gray-700">•</span>
        <span class="text-gray-700"><span data-word-highlighter-target="word" data-correct="false" data-action="click->word-highlighter#toggleHighlight" class="px-1 rounded">ridere</span></span>
        <span class="text-gray-700">•</span>
        <span class="text-gray-700"><span data-word-highlighter-target="word" data-correct="false" data-action="click->word-highlighter#toggleHighlight" class="px-1 rounded">viaggiare</span></span>
        <span class="text-gray-700">•</span>
        <span class="text-gray-700"><span data-word-highlighter-target="word" data-correct="green" data-action="click->word-highlighter#toggleHighlight" class="px-1 rounded">abbassare</span></span>
        <span class="text-gray-700">•</span>
        <span class="text-gray-700"><span data-word-highlighter-target="word" data-correct="green" data-action="click->word-highlighter#toggleHighlight" class="px-1 rounded">cancellare</span></span>
        <span class="text-gray-700">•</span>
        <span class="text-gray-700"><span data-word-highlighter-target="word" data-correct="green" data-action="click->word-highlighter#toggleHighlight" class="px-1 rounded">aprire</span></span>
        <span class="text-gray-700">•</span>
        <span class="text-gray-700"><span data-word-highlighter-target="word" data-correct="false" data-action="click->word-highlighter#toggleHighlight" class="px-1 rounded">passeggiare</span></span>
        <span class="text-gray-700">•</span>
        <span class="text-gray-700"><span data-word-highlighter-target="word" data-correct="green" data-action="click->word-highlighter#toggleHighlight" class="px-1 rounded">preparare</span></span>
        <span class="text-gray-700">•</span>
        <span class="text-gray-700"><span data-word-highlighter-target="word" data-correct="false" data-action="click->word-highlighter#toggleHighlight" class="px-1 rounded">nuotare</span></span>
      </div>
    </div>

    <div class="space-y-3 text-base md:text-lg">
      <div class="flex items-center gap-2">
        <span class="text-gray-700">•</span>
        <input type="text" class="flex-1 border-b-2 border-green-400 bg-transparent px-2 py-1 focus:outline-none focus:border-green-600" data-fill-blanks-target="input" data-correct-answer="libera" placeholder="">
      </div>
      <div class="flex items-center gap-2">
        <span class="text-gray-700">•</span>
        <input type="text" class="flex-1 border-b-2 border-green-400 bg-transparent px-2 py-1 focus:outline-none focus:border-green-600" data-fill-blanks-target="input" data-correct-answer="libera" placeholder="">
      </div>
      <div class="flex items-center gap-2">
        <span class="text-gray-700">•</span>
        <input type="text" class="flex-1 border-b-2 border-green-400 bg-transparent px-2 py-1 focus:outline-none focus:border-green-600" data-fill-blanks-target="input" data-correct-answer="libera" placeholder="">
      </div>
    </div>
  </div>

  <!-- Footer with reference -->
  <div class="mt-8 text-center">
    <p class="text-red-600 font-bold text-lg">Grammatica pp. <%= link_to "78", pagina_path("nvl5_gram_p078"), class: "text-red-600 hover:text-red-800 underline font-bold" %>, <%= link_to "79", pagina_path("nvl5_gram_p079"), class: "text-red-600 hover:text-red-800 underline font-bold" %></p>
  </div>

  <!-- Exercise controls -->
  <%= render 'shared/exercise_controls', color: 'cyan' %>
</div>
